[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "answers" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "question_id" integer, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "custom" boolean DEFAULT 'f')[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[34mselect sqlite_version(*)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mCREATE  INDEX "index_answers_on_question_id" ON "answers" ("question_id")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCREATE TABLE "attempts" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "interview_id" integer, "poll_id" integer, "client_id" integer, "question_id" integer, "answer_id" integer, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "custom_answer" varchar)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCREATE  INDEX "index_attempts_on_answer_id" ON "attempts" ("answer_id")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.2ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_attempts_on_answer_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_attempts_on_answer_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCREATE  INDEX "index_attempts_on_client_id" ON "attempts" ("client_id")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_attempts_on_client_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_attempts_on_client_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_attempts_on_answer_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_attempts_on_answer_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mCREATE  INDEX "index_attempts_on_interview_id" ON "attempts" ("interview_id")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_attempts_on_interview_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_attempts_on_interview_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_attempts_on_client_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_attempts_on_client_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_attempts_on_answer_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_attempts_on_answer_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCREATE  INDEX "index_attempts_on_poll_id" ON "attempts" ("poll_id")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_attempts_on_poll_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_attempts_on_poll_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.2ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_attempts_on_interview_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_attempts_on_interview_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_attempts_on_client_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_attempts_on_client_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_attempts_on_answer_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_attempts_on_answer_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mCREATE  INDEX "index_attempts_on_question_id" ON "attempts" ("question_id")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "auth_logs" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "username" varchar, "password" varchar, "timeout" integer, "client_device_id" integer, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mCREATE  INDEX "index_auth_logs_on_cleint_device_id" ON "auth_logs" ("client_device_id")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_auth_logs_on_cleint_device_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_auth_logs_on_cleint_device_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mCREATE  INDEX "index_auth_logs_on_password" ON "auth_logs" ("password")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_auth_logs_on_password' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_auth_logs_on_password' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_auth_logs_on_cleint_device_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_auth_logs_on_cleint_device_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCREATE  INDEX "index_auth_logs_on_username" ON "auth_logs" ("username")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "bans" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "until_date" datetime, "location_id" integer, "client_id" integer, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCREATE  INDEX "index_bans_on_client_id" ON "bans" ("client_id")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_bans_on_client_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_bans_on_client_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCREATE  INDEX "index_bans_on_location_id" ON "bans" ("location_id")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "brands" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar DEFAULT 'GYC Free WiFi' NOT NULL, "logo" varchar DEFAULT '/images/logo.png', "bg_color" varchar DEFAULT '#0e1a35', "background" varchar DEFAULT '/images/default_background.png', "redirect_url" varchar DEFAULT 'https://gycwifi.com', "auth_expiration_time" integer DEFAULT 3600 NOT NULL, "category_id" integer NOT NULL, "promo_text" text DEFAULT 'Sample promo text', "slug" varchar NOT NULL, "user_id" integer, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "sms_auth" boolean)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCREATE  INDEX "index_brands_on_slug" ON "brands" ("slug")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_brands_on_slug' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_brands_on_slug' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mCREATE  INDEX "index_brands_on_user_id" ON "brands" ("user_id")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "categories" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "title_en" varchar, "title_ru" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCREATE TABLE "client_accounting_logs" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "created_at" datetime DEFAULT now() NOT NULL, "updated_at" datetime DEFAULT now() NOT NULL, "acctsessionid" varchar, "acctuniqueid" varchar, "username" varchar, "groupname" varchar, "realm" varchar, "nasipaddress" varchar, "nasportid" varchar, "nasporttype" varchar, "acctstarttime" datetime, "acctstoptime" datetime, "acctsessiontime" bigint, "acctauthentic" varchar, "connectinfo_start" varchar, "connectinfo_stop" varchar, "acctinputoctets" bigint, "acctoutputoctets" bigint, "calledstationid" varchar, "callingstationid" varchar, "acctterminatecause" varchar, "servicetype" varchar, "xascendsessionsvrkey" varchar, "framedprotocol" varchar, "framedipaddress" varchar, "acctstartdelay" integer, "acctstopdelay" integer)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mCREATE TABLE "answers" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "question_id" integer, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "custom" boolean DEFAULT 'f')[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34mselect sqlite_version(*)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCREATE  INDEX "index_answers_on_question_id" ON "answers" ("question_id")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "attempts" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "interview_id" integer, "poll_id" integer, "client_id" integer, "question_id" integer, "answer_id" integer, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "custom_answer" varchar)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCREATE  INDEX "index_attempts_on_answer_id" ON "attempts" ("answer_id")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.2ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_attempts_on_answer_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_attempts_on_answer_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCREATE  INDEX "index_attempts_on_client_id" ON "attempts" ("client_id")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_attempts_on_client_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_attempts_on_client_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_attempts_on_answer_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_attempts_on_answer_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mCREATE  INDEX "index_attempts_on_interview_id" ON "attempts" ("interview_id")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_attempts_on_interview_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_attempts_on_interview_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_attempts_on_client_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_attempts_on_client_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.2ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_attempts_on_answer_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_attempts_on_answer_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mCREATE  INDEX "index_attempts_on_poll_id" ON "attempts" ("poll_id")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_attempts_on_poll_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_attempts_on_poll_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_attempts_on_interview_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_attempts_on_interview_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_attempts_on_client_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_attempts_on_client_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_attempts_on_answer_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_attempts_on_answer_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCREATE  INDEX "index_attempts_on_question_id" ON "attempts" ("question_id")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "auth_logs" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "username" varchar, "password" varchar, "timeout" integer, "client_device_id" integer, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCREATE  INDEX "index_auth_logs_on_cleint_device_id" ON "auth_logs" ("client_device_id")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_auth_logs_on_cleint_device_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_auth_logs_on_cleint_device_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCREATE  INDEX "index_auth_logs_on_password" ON "auth_logs" ("password")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_auth_logs_on_password' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_auth_logs_on_password' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_auth_logs_on_cleint_device_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_auth_logs_on_cleint_device_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCREATE  INDEX "index_auth_logs_on_username" ON "auth_logs" ("username")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "bans" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "until_date" datetime, "location_id" integer, "client_id" integer, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mCREATE  INDEX "index_bans_on_client_id" ON "bans" ("client_id")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_bans_on_client_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_bans_on_client_id' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCREATE  INDEX "index_bans_on_location_id" ON "bans" ("location_id")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mCREATE TABLE "brands" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar DEFAULT 'GYC Free WiFi' NOT NULL, "logo" varchar DEFAULT '/images/logo.png', "bg_color" varchar DEFAULT '#0e1a35', "background" varchar DEFAULT '/images/default_background.png', "redirect_url" varchar DEFAULT 'https://gycwifi.com', "auth_expiration_time" integer DEFAULT 3600 NOT NULL, "category_id" integer NOT NULL, "promo_text" text DEFAULT 'Sample promo text', "slug" varchar NOT NULL, "user_id" integer, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "sms_auth" boolean)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCREATE  INDEX "index_brands_on_slug" ON "brands" ("slug")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_brands_on_slug' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_brands_on_slug' AND type='index'
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCREATE  INDEX "index_brands_on_user_id" ON "brands" ("user_id")[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCREATE TABLE "categories" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "title_en" varchar, "title_ru" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCREATE TABLE "client_accounting_logs" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "created_at" datetime DEFAULT now() NOT NULL, "updated_at" datetime DEFAULT now() NOT NULL, "acctsessionid" varchar, "acctuniqueid" varchar, "username" varchar, "groupname" varchar, "realm" varchar, "nasipaddress" varchar, "nasportid" varchar, "nasporttype" varchar, "acctstarttime" datetime, "acctstoptime" datetime, "acctsessiontime" bigint, "acctauthentic" varchar, "connectinfo_start" varchar, "connectinfo_stop" varchar, "acctinputoctets" bigint, "acctoutputoctets" bigint, "calledstationid" varchar, "callingstationid" varchar, "acctterminatecause" varchar, "servicetype" varchar, "xascendsessionsvrkey" varchar, "framedprotocol" varchar, "framedipaddress" varchar, "acctstartdelay" integer, "acctstopdelay" integer)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (150.5ms)[0m  [1m[35mDROP DATABASE IF EXISTS "gycwifi_api_test"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (13.6ms)[0m  [1m[35mCREATE DATABASE "gycwifi_api_test" ENCODING = 'unicode'[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mActiveRecord::SchemaMigration Load (13.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mActiveRecord::SchemaMigration Load (3.6ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mActiveRecord::SchemaMigration Load (1.0ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (5.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mActiveRecord::SchemaMigration Load (1.0ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mActiveRecord::SchemaMigration Load (1.3ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.9ms)[0m  [1m[35mALTER TABLE "answers" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL;ALTER TABLE "attempts" DISABLE TRIGGER ALL;ALTER TABLE "auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "bans" DISABLE TRIGGER ALL;ALTER TABLE "brands" DISABLE TRIGGER ALL;ALTER TABLE "categories" DISABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" DISABLE TRIGGER ALL;ALTER TABLE "client_counters" DISABLE TRIGGER ALL;ALTER TABLE "client_devices" DISABLE TRIGGER ALL;ALTER TABLE "clients" DISABLE TRIGGER ALL;ALTER TABLE "social_accounts" DISABLE TRIGGER ALL;ALTER TABLE "social_logs" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" DISABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" DISABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" DISABLE TRIGGER ALL;ALTER TABLE "layouts" DISABLE TRIGGER ALL;ALTER TABLE "locations" DISABLE TRIGGER ALL;ALTER TABLE "notifications" DISABLE TRIGGER ALL;ALTER TABLE "opinions" DISABLE TRIGGER ALL;ALTER TABLE "pages" DISABLE TRIGGER ALL;ALTER TABLE "payments" DISABLE TRIGGER ALL;ALTER TABLE "polls" DISABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "products" DISABLE TRIGGER ALL;ALTER TABLE "questions" DISABLE TRIGGER ALL;ALTER TABLE "routers" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "sessions" DISABLE TRIGGER ALL;ALTER TABLE "sms_logs" DISABLE TRIGGER ALL;ALTER TABLE "vips" DISABLE TRIGGER ALL;ALTER TABLE "vouchers" DISABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.6ms)[0m  [1m[34m          SELECT schemaname || '.' || tablename
          FROM pg_tables
          WHERE
            tablename !~ '_prt_' AND
            tablename <> 'schema_migrations' AND
            schemaname = ANY (current_schemas(false))
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.5ms)[0m  [1m[34mselect table_name from information_schema.views where table_schema = 'gycwifi_api_test'[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (137.5ms)[0m  [1m[35mTRUNCATE TABLE "public"."answers", "public"."ar_internal_metadata", "public"."attempts", "public"."auth_logs", "public"."bans", "public"."brands", "public"."categories", "public"."client_accounting_logs", "public"."client_counters", "public"."client_devices", "public"."clients", "public"."social_accounts", "public"."social_logs", "public"."users", "public"."delayed_jobs", "public"."device_auth_pendings", "public"."friendly_id_slugs", "public"."layouts", "public"."locations", "public"."notifications", "public"."opinions", "public"."pages", "public"."payments", "public"."polls", "public"."post_auth_logs", "public"."products", "public"."questions", "public"."routers", "public"."sessions", "public"."sms_logs", "public"."vips", "public"."vouchers" RESTART IDENTITY CASCADE;[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[35mALTER TABLE "answers" ENABLE TRIGGER ALL;ALTER TABLE "social_logs" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "layouts" ENABLE TRIGGER ALL;ALTER TABLE "polls" ENABLE TRIGGER ALL;ALTER TABLE "questions" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL;ALTER TABLE "attempts" ENABLE TRIGGER ALL;ALTER TABLE "auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "bans" ENABLE TRIGGER ALL;ALTER TABLE "brands" ENABLE TRIGGER ALL;ALTER TABLE "categories" ENABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" ENABLE TRIGGER ALL;ALTER TABLE "client_counters" ENABLE TRIGGER ALL;ALTER TABLE "client_devices" ENABLE TRIGGER ALL;ALTER TABLE "clients" ENABLE TRIGGER ALL;ALTER TABLE "social_accounts" ENABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" ENABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" ENABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" ENABLE TRIGGER ALL;ALTER TABLE "locations" ENABLE TRIGGER ALL;ALTER TABLE "notifications" ENABLE TRIGGER ALL;ALTER TABLE "opinions" ENABLE TRIGGER ALL;ALTER TABLE "pages" ENABLE TRIGGER ALL;ALTER TABLE "payments" ENABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "products" ENABLE TRIGGER ALL;ALTER TABLE "routers" ENABLE TRIGGER ALL;ALTER TABLE "sessions" ENABLE TRIGGER ALL;ALTER TABLE "sms_logs" ENABLE TRIGGER ALL;ALTER TABLE "vips" ENABLE TRIGGER ALL;ALTER TABLE "vouchers" ENABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(421) 300-2723 x98578"], ["created_at", "2017-07-28 07:35:46.351326"], ["updated_at", "2017-07-28 07:35:46.351326"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Vagram"], ["created_at", "2017-07-28 07:35:46.496345"], ["updated_at", "2017-07-28 07:35:46.496345"], ["local_path", "http://morar.io/hillard_pagac"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Cookley"], ["title_ru", "Название1"], ["created_at", "2017-07-28 07:35:46.513008"], ["updated_at", "2017-07-28 07:35:46.513008"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 1[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (1.2ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 1) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>1, "title"=>"Vagram", "created_at"=>Fri, 28 Jul 2017 07:35:46 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:46 UTC +00:00, "local_path"=>"http://morar.io/hillard_pagac"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "transcof"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "transcof"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.4ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Transcof"], ["category_id", 1], ["slug", "transcof"], ["created_at", "2017-07-28 07:35:46.652311"], ["updated_at", "2017-07-28 07:35:46.652311"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.4ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "aimee"], ["email", "rubie@heidenreich.org"], ["password", "Z34jBiAdQ"], ["created_at", "2017-07-28 07:35:46.698861"], ["updated_at", "2017-07-28 07:35:46.698861"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "veniam-explicabo"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Otcom"], ["phone", "1-674-244-9757"], ["address", "833 Carroll Views"], ["url", "http://denesikwalker.info/annalise"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hillsthompson.biz/clement"], ["auth_expiration_time", 900], ["slug", "veniam-explicabo"], ["brand_id", 1], ["user_id", 1], ["created_at", "2017-07-28 07:35:46.710008"], ["updated_at", "2017-07-28 07:35:46.710008"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 1], ["location_id", 1], ["counter", 10], ["created_at", "2017-07-28 07:35:46.716163"], ["updated_at", "2017-07-28 07:35:46.716163"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "317-382-4567"], ["created_at", "2017-07-28 07:35:46.720782"], ["updated_at", "2017-07-28 07:35:46.720782"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Andalax"], ["created_at", "2017-07-28 07:35:46.727091"], ["updated_at", "2017-07-28 07:35:46.727091"], ["local_path", "http://murazik.biz/adaline"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Holdlamis"], ["title_ru", "Название2"], ["created_at", "2017-07-28 07:35:46.730669"], ["updated_at", "2017-07-28 07:35:46.730669"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 2[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_2[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 2) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>2, "title"=>"Andalax", "created_at"=>Fri, 28 Jul 2017 07:35:46 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:46 UTC +00:00, "local_path"=>"http://murazik.biz/adaline"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Quo Lux"], ["category_id", 2], ["slug", "quo-lux"], ["created_at", "2017-07-28 07:35:46.741499"], ["updated_at", "2017-07-28 07:35:46.741499"], ["layout_id", 2]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "davonte_schaefer"], ["email", "oswald@smithritchie.org"], ["password", "BoJgFa8h13"], ["created_at", "2017-07-28 07:35:46.745947"], ["updated_at", "2017-07-28 07:35:46.745947"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et-nulla"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tampflex"], ["phone", "155.003.3403"], ["address", "968 Marlon Keys"], ["url", "http://goldnersatterfield.org/ashly"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://dietrich.info/amalia_rutherford"], ["auth_expiration_time", 900], ["slug", "et-nulla"], ["brand_id", 2], ["user_id", 2], ["created_at", "2017-07-28 07:35:46.751557"], ["updated_at", "2017-07-28 07:35:46.751557"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 2], ["location_id", 2], ["counter", 9], ["created_at", "2017-07-28 07:35:46.755819"], ["updated_at", "2017-07-28 07:35:46.755819"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Alpha"], ["created_at", "2017-07-28 07:35:46.762113"], ["updated_at", "2017-07-28 07:35:46.762113"], ["local_path", "http://muller.io/ara_mitchell"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Y-find"], ["title_ru", "Название3"], ["created_at", "2017-07-28 07:35:46.765774"], ["updated_at", "2017-07-28 07:35:46.765774"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 3[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_3[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.5ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 3) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>3, "title"=>"Alpha", "created_at"=>Fri, 28 Jul 2017 07:35:46 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:46 UTC +00:00, "local_path"=>"http://muller.io/ara_mitchell"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "pannier"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "pannier"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Pannier"], ["category_id", 3], ["slug", "pannier"], ["created_at", "2017-07-28 07:35:46.776058"], ["updated_at", "2017-07-28 07:35:46.776058"], ["layout_id", 3]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.4ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "amari.walter"], ["email", "lenora@marquardt.name"], ["password", "373u4kCb5vUz"], ["created_at", "2017-07-28 07:35:46.780499"], ["updated_at", "2017-07-28 07:35:46.780499"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptatem_maiores"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Matsoft"], ["phone", "(836) 663-7867"], ["address", "716 Friesen Lakes"], ["url", "http://hermann.net/christian_bergnaum"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://muellerheathcote.name/kaleb.klocko"], ["auth_expiration_time", 900], ["slug", "voluptatem_maiores"], ["brand_id", 3], ["user_id", 3], ["created_at", "2017-07-28 07:35:46.785679"], ["updated_at", "2017-07-28 07:35:46.785679"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 1], ["location_id", 3], ["counter", 10], ["created_at", "2017-07-28 07:35:46.790071"], ["updated_at", "2017-07-28 07:35:46.790071"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "damien_schowalter"], ["email", "edna.hackett@mcdermott.biz"], ["password", "De7eVsMe5cZ1Yq"], ["role_cd", 3], ["created_at", "2017-07-28 07:35:46.794309"], ["updated_at", "2017-07-28 07:35:46.794309"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:46 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"damien_schowalter", "email"=>"edna.hackett@mcdermott.biz", "password"=>"De7eVsMe5cZ1Yq", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"damien_schowalter", :email=>"edna.hackett@mcdermott.biz", :password=>"De7eVsMe5cZ1Yq", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"edna.hackett@mcdermott.biz", "password"=>"De7eVsMe5cZ1Yq"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "damien_schowalter"], ["email", "edna.hackett@mcdermott.biz"], ["password", "De7eVsMe5cZ1Yq"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 4, username: "damien_schowalter", email: "edna.hackett@mcdermott.biz", password: "De7eVsMe5cZ1Yq", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:35:46", updated_at: "2017-07-28 07:35:46", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 4[0m
[INFO ] Completed [32m201 Created[0m in 7ms [30m(Views: 0.3ms | ActiveRecord: 1.1ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=updated_at&updated_at=asc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:46 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"updated_at", "updated_at"=>"asc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 4) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.6ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>4, "username"=>"damien_schowalter", "email"=>"edna.hackett@mcdermott.biz", "password"=>"De7eVsMe5cZ1Yq", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:35:46 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:46 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"updated_at", :updated_at=>"asc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (1.1ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>4, :username=>"damien_schowalter", :email=>"edna.hackett@mcdermott.biz", :password=>"De7eVsMe5cZ1Yq", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:35:46.794Z", :updated_at=>"2017-07-28T07:35:46.794Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:35:46.716163') AND "client_counters"."location_id" IN (1, 2, 3) GROUP BY client_id, phone_number ORDER BY updated_at asc, visits desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (2, 1)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (1.5ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (1, 2)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:35:46.716163') AND "client_counters"."location_id" IN (1, 2, 3) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 104ms [30m(Views: 0.6ms | ActiveRecord: 17.6ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(341) 707-6879 x35306"], ["created_at", "2017-07-28 07:35:46.998362"], ["updated_at", "2017-07-28 07:35:46.998362"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Redhold"], ["created_at", "2017-07-28 07:35:47.005222"], ["updated_at", "2017-07-28 07:35:47.005222"], ["local_path", "http://macejkovic.net/joe"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bitwolf"], ["title_ru", "Название4"], ["created_at", "2017-07-28 07:35:47.009093"], ["updated_at", "2017-07-28 07:35:47.009093"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_4[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 4) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>4, "title"=>"Redhold", "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "local_path"=>"http://macejkovic.net/joe"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "duobam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "duobam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Duobam"], ["category_id", 4], ["slug", "duobam"], ["created_at", "2017-07-28 07:35:47.020865"], ["updated_at", "2017-07-28 07:35:47.020865"], ["layout_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "millie"], ["email", "shanon@damore.name"], ["password", "8l9nSrCwO"], ["created_at", "2017-07-28 07:35:47.025837"], ["updated_at", "2017-07-28 07:35:47.025837"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptatum-non"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tin"], ["phone", "(910) 633-4763"], ["address", "538 Christelle Rapid"], ["url", "http://ohararuel.co/brandyn"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://rowe.info/darien"], ["auth_expiration_time", 900], ["slug", "voluptatum-non"], ["brand_id", 4], ["user_id", 5], ["created_at", "2017-07-28 07:35:47.031785"], ["updated_at", "2017-07-28 07:35:47.031785"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 3], ["location_id", 4], ["counter", 8], ["created_at", "2017-07-28 07:35:47.036593"], ["updated_at", "2017-07-28 07:35:47.036593"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(234) 931-8013 x9747"], ["created_at", "2017-07-28 07:35:47.040423"], ["updated_at", "2017-07-28 07:35:47.040423"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Sub-Ex"], ["created_at", "2017-07-28 07:35:47.047063"], ["updated_at", "2017-07-28 07:35:47.047063"], ["local_path", "http://cummeratakrajcik.io/estevan_treutel"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Ronstring"], ["title_ru", "Название5"], ["created_at", "2017-07-28 07:35:47.050691"], ["updated_at", "2017-07-28 07:35:47.050691"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 5[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_5[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 5) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>5, "title"=>"Sub-Ex", "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "local_path"=>"http://cummeratakrajcik.io/estevan_treutel"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-find"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-find"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Y-find"], ["category_id", 5], ["slug", "y-find"], ["created_at", "2017-07-28 07:35:47.061883"], ["updated_at", "2017-07-28 07:35:47.061883"], ["layout_id", 5]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "myles"], ["email", "emilia@mayert.org"], ["password", "692tW8BaHxIaYeY"], ["created_at", "2017-07-28 07:35:47.066634"], ["updated_at", "2017-07-28 07:35:47.066634"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "iure-deleniti"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bamity"], ["phone", "221.090.9260"], ["address", "1694 Hector Street"], ["url", "http://okuneva.info/citlalli"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://oreilly.name/jody"], ["auth_expiration_time", 900], ["slug", "iure-deleniti"], ["brand_id", 5], ["user_id", 6], ["created_at", "2017-07-28 07:35:47.072516"], ["updated_at", "2017-07-28 07:35:47.072516"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 4], ["location_id", 5], ["counter", 9], ["created_at", "2017-07-28 07:35:47.077146"], ["updated_at", "2017-07-28 07:35:47.077146"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tin"], ["created_at", "2017-07-28 07:35:47.083636"], ["updated_at", "2017-07-28 07:35:47.083636"], ["local_path", "http://hirthe.co/belle_mertz"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bamity"], ["title_ru", "Название6"], ["created_at", "2017-07-28 07:35:47.087464"], ["updated_at", "2017-07-28 07:35:47.087464"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 6[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_6[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 6) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>6, "title"=>"Tin", "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "local_path"=>"http://hirthe.co/belle_mertz"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonsing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonsing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Sonsing"], ["category_id", 6], ["slug", "sonsing"], ["created_at", "2017-07-28 07:35:47.098761"], ["updated_at", "2017-07-28 07:35:47.098761"], ["layout_id", 6]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "stanton"], ["email", "kelley.skiles@nader.io"], ["password", "QkDiMx807"], ["created_at", "2017-07-28 07:35:47.103505"], ["updated_at", "2017-07-28 07:35:47.103505"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "expedita_autem"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Wrapsafe"], ["phone", "207-055-8978"], ["address", "44524 Florine Pike"], ["url", "http://grimes.net/lamont.schaden"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://leuschkestracke.io/bennett"], ["auth_expiration_time", 900], ["slug", "expedita_autem"], ["brand_id", 6], ["user_id", 7], ["created_at", "2017-07-28 07:35:47.109185"], ["updated_at", "2017-07-28 07:35:47.109185"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 3], ["location_id", 6], ["counter", 5], ["created_at", "2017-07-28 07:35:47.113904"], ["updated_at", "2017-07-28 07:35:47.113904"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "treie_frami"], ["email", "dillon@walter.io"], ["password", "C0BkWoAxZ6Qt2"], ["role_cd", 3], ["created_at", "2017-07-28 07:35:47.118284"], ["updated_at", "2017-07-28 07:35:47.118284"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:47 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"treie_frami", "email"=>"dillon@walter.io", "password"=>"C0BkWoAxZ6Qt2", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"treie_frami", :email=>"dillon@walter.io", :password=>"C0BkWoAxZ6Qt2", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"dillon@walter.io", "password"=>"C0BkWoAxZ6Qt2"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "treie_frami"], ["email", "dillon@walter.io"], ["password", "C0BkWoAxZ6Qt2"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 8, username: "treie_frami", email: "dillon@walter.io", password: "C0BkWoAxZ6Qt2", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:35:47", updated_at: "2017-07-28 07:35:47", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 8[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=regular&loyalty_days=7&page=1&sort_field=visits30&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:47 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"regular", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits30", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 8) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>8, "username"=>"treie_frami", "email"=>"dillon@walter.io", "password"=>"C0BkWoAxZ6Qt2", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"regular", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits30", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.8ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>8, :username=>"treie_frami", :email=>"dillon@walter.io", :password=>"C0BkWoAxZ6Qt2", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:35:47.118Z", :updated_at=>"2017-07-28T07:35:47.118Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:35:47.036593') AND "client_counters"."location_id" IN (4, 5, 6) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) > 1) ORDER BY visits30 asc, updated_at desc, visits desc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 3[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.7ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 3[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:35:47.036593') AND "client_counters"."location_id" IN (4, 5, 6) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) > 1)[0m
[INFO ] Completed [32m200 OK[0m in 30ms [30m(Views: 0.4ms | ActiveRecord: 8.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "401-770-4815"], ["created_at", "2017-07-28 07:35:47.168920"], ["updated_at", "2017-07-28 07:35:47.168920"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Hatity"], ["created_at", "2017-07-28 07:35:47.175621"], ["updated_at", "2017-07-28 07:35:47.175621"], ["local_path", "http://tromp.biz/verna_jaskolski"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Y-Solowarm"], ["title_ru", "Название7"], ["created_at", "2017-07-28 07:35:47.179350"], ["updated_at", "2017-07-28 07:35:47.179350"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 7[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_7[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 7) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>7, "title"=>"Hatity", "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "local_path"=>"http://tromp.biz/verna_jaskolski"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "hatity"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "hatity"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Hatity"], ["category_id", 7], ["slug", "hatity"], ["created_at", "2017-07-28 07:35:47.190643"], ["updated_at", "2017-07-28 07:35:47.190643"], ["layout_id", 7]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "je"], ["email", "cathryn@doyle.io"], ["password", "Hj6a2gJqX45b8a"], ["created_at", "2017-07-28 07:35:47.195285"], ["updated_at", "2017-07-28 07:35:47.195285"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "consequatur_deserunt"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Alpha"], ["phone", "994.579.0975"], ["address", "72131 Wuckert Lodge"], ["url", "http://koelpin.com/lavinia_eichmann"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://heidenreichorn.info/rubie.bergstrom"], ["auth_expiration_time", 900], ["slug", "consequatur_deserunt"], ["brand_id", 7], ["user_id", 9], ["created_at", "2017-07-28 07:35:47.201083"], ["updated_at", "2017-07-28 07:35:47.201083"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 5], ["location_id", 7], ["counter", 1], ["created_at", "2017-07-28 07:35:47.205896"], ["updated_at", "2017-07-28 07:35:47.205896"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(598) 957-6550 x246"], ["created_at", "2017-07-28 07:35:47.209755"], ["updated_at", "2017-07-28 07:35:47.209755"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Veribet"], ["created_at", "2017-07-28 07:35:47.216086"], ["updated_at", "2017-07-28 07:35:47.216086"], ["local_path", "http://macgyver.com/xander.senger"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Voyatouch"], ["title_ru", "Название8"], ["created_at", "2017-07-28 07:35:47.219702"], ["updated_at", "2017-07-28 07:35:47.219702"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 8) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>8, "title"=>"Veribet", "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "local_path"=>"http://macgyver.com/xander.senger"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "ventosanzap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "ventosanzap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Ventosanzap"], ["category_id", 8], ["slug", "ventosanzap"], ["created_at", "2017-07-28 07:35:47.230875"], ["updated_at", "2017-07-28 07:35:47.230875"], ["layout_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jeanie"], ["email", "jeff@stokesgerlach.info"], ["password", "517iI8Rk5bTpX"], ["created_at", "2017-07-28 07:35:47.235563"], ["updated_at", "2017-07-28 07:35:47.235563"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et.magnam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zamit"], ["phone", "1-541-463-5691"], ["address", "679 Britney Ville"], ["url", "http://ebert.io/reyna"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://leannonhammes.com/burley"], ["auth_expiration_time", 900], ["slug", "et.magnam"], ["brand_id", 8], ["user_id", 10], ["created_at", "2017-07-28 07:35:47.241292"], ["updated_at", "2017-07-28 07:35:47.241292"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 6], ["location_id", 8], ["counter", 8], ["created_at", "2017-07-28 07:35:47.245851"], ["updated_at", "2017-07-28 07:35:47.245851"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Keylex"], ["created_at", "2017-07-28 07:35:47.252392"], ["updated_at", "2017-07-28 07:35:47.252392"], ["local_path", "http://heaney.biz/otis.stroman"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Tin"], ["title_ru", "Название9"], ["created_at", "2017-07-28 07:35:47.256238"], ["updated_at", "2017-07-28 07:35:47.256238"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 9[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_9[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 9) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>9, "title"=>"Keylex", "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "local_path"=>"http://heaney.biz/otis.stroman"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bigtax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bigtax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bigtax"], ["category_id", 9], ["slug", "bigtax"], ["created_at", "2017-07-28 07:35:47.267177"], ["updated_at", "2017-07-28 07:35:47.267177"], ["layout_id", 9]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "baylee"], ["email", "vallie@schmidt.name"], ["password", "8gM2HdVp4"], ["created_at", "2017-07-28 07:35:47.271915"], ["updated_at", "2017-07-28 07:35:47.271915"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ea_dignissimos"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Y-Solowarm"], ["phone", "710-969-2585"], ["address", "678 Ferne Squares"], ["url", "http://prohaska.info/miller_damore"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hayes.info/earline.bernier"], ["auth_expiration_time", 900], ["slug", "ea_dignissimos"], ["brand_id", 9], ["user_id", 11], ["created_at", "2017-07-28 07:35:47.277766"], ["updated_at", "2017-07-28 07:35:47.277766"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 5], ["location_id", 9], ["counter", 2], ["created_at", "2017-07-28 07:35:47.282415"], ["updated_at", "2017-07-28 07:35:47.282415"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "serenity_carroll"], ["email", "brando_ko@olsonboyer.biz"], ["password", "1060B8MfMyM9"], ["role_cd", 3], ["created_at", "2017-07-28 07:35:47.287011"], ["updated_at", "2017-07-28 07:35:47.287011"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:47 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"serenity_carroll", "email"=>"brando_ko@olsonboyer.biz", "password"=>"1060B8MfMyM9", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"serenity_carroll", :email=>"brando_ko@olsonboyer.biz", :password=>"1060B8MfMyM9", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"brando_ko@olsonboyer.biz", "password"=>"1060B8MfMyM9"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "serenity_carroll"], ["email", "brando_ko@olsonboyer.biz"], ["password", "1060B8MfMyM9"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 12, username: "serenity_carroll", email: "brando_ko@olsonboyer.biz", password: "1060B8MfMyM9", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:35:47", updated_at: "2017-07-28 07:35:47", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 12[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=passed&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:47 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"passed", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 12) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>12, "username"=>"serenity_carroll", "email"=>"brando_ko@olsonboyer.biz", "password"=>"1060B8MfMyM9", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"passed", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>12, :username=>"serenity_carroll", :email=>"brando_ko@olsonboyer.biz", :password=>"1060B8MfMyM9", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:35:47.287Z", :updated_at=>"2017-07-28T07:35:47.287Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:35:47.315453') AND "client_counters"."location_id" IN (7, 8, 9) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1) ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 6[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 6[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:35:47.315453') AND "client_counters"."location_id" IN (7, 8, 9) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1)[0m
[INFO ] Completed [32m200 OK[0m in 29ms [30m(Views: 0.5ms | ActiveRecord: 8.4ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(594) 040-5614"], ["created_at", "2017-07-28 07:35:47.336312"], ["updated_at", "2017-07-28 07:35:47.336312"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Daltfresh"], ["created_at", "2017-07-28 07:35:47.343330"], ["updated_at", "2017-07-28 07:35:47.343330"], ["local_path", "http://lockmanfarrell.info/cornelius_becker"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Asoka"], ["title_ru", "Название10"], ["created_at", "2017-07-28 07:35:47.347132"], ["updated_at", "2017-07-28 07:35:47.347132"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 10[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_10[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 10) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>10, "title"=>"Daltfresh", "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "local_path"=>"http://lockmanfarrell.info/cornelius_becker"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "holdlamis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "holdlamis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Holdlamis"], ["category_id", 10], ["slug", "holdlamis"], ["created_at", "2017-07-28 07:35:47.358843"], ["updated_at", "2017-07-28 07:35:47.358843"], ["layout_id", 10]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "robbie_ziemann"], ["email", "aliza@kochdickens.net"], ["password", "59ToSxQ1E08vSg1"], ["created_at", "2017-07-28 07:35:47.363721"], ["updated_at", "2017-07-28 07:35:47.363721"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "optio.quis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Gembucket"], ["phone", "(517) 031-7449"], ["address", "79912 Michale Loop"], ["url", "http://renner.net/moriah"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kreigerkertzmann.io/shanny"], ["auth_expiration_time", 900], ["slug", "optio.quis"], ["brand_id", 10], ["user_id", 13], ["created_at", "2017-07-28 07:35:47.369513"], ["updated_at", "2017-07-28 07:35:47.369513"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 7], ["location_id", 10], ["counter", 6], ["created_at", "2017-07-28 07:35:47.374474"], ["updated_at", "2017-07-28 07:35:47.374474"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "944-094-8821 x108"], ["created_at", "2017-07-28 07:35:47.378290"], ["updated_at", "2017-07-28 07:35:47.378290"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zontrax"], ["created_at", "2017-07-28 07:35:47.384894"], ["updated_at", "2017-07-28 07:35:47.384894"], ["local_path", "http://thompson.io/adelia.gaylord"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Daltfresh"], ["title_ru", "Название11"], ["created_at", "2017-07-28 07:35:47.388664"], ["updated_at", "2017-07-28 07:35:47.388664"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 11[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_11[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 11) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>11, "title"=>"Zontrax", "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "local_path"=>"http://thompson.io/adelia.gaylord"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "wrapsafe"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "wrapsafe"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Wrapsafe"], ["category_id", 11], ["slug", "wrapsafe"], ["created_at", "2017-07-28 07:35:47.400222"], ["updated_at", "2017-07-28 07:35:47.400222"], ["layout_id", 11]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "antonette_ferry"], ["email", "lorena_bailey@kuhicsawayn.com"], ["password", "L65j0aHcRu"], ["created_at", "2017-07-28 07:35:47.405224"], ["updated_at", "2017-07-28 07:35:47.405224"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et-itaque"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Kanlam"], ["phone", "(909) 276-4828"], ["address", "8358 Scot Camp"], ["url", "http://howeko.co/carolyne.vandervort"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://oconnerhegmann.info/virginie.upton"], ["auth_expiration_time", 900], ["slug", "et-itaque"], ["brand_id", 11], ["user_id", 14], ["created_at", "2017-07-28 07:35:47.410869"], ["updated_at", "2017-07-28 07:35:47.410869"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 8], ["location_id", 11], ["counter", 4], ["created_at", "2017-07-28 07:35:47.415621"], ["updated_at", "2017-07-28 07:35:47.415621"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Alpha"], ["created_at", "2017-07-28 07:35:47.422100"], ["updated_at", "2017-07-28 07:35:47.422100"], ["local_path", "http://moenblanda.net/kieran"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zathin"], ["title_ru", "Название12"], ["created_at", "2017-07-28 07:35:47.425820"], ["updated_at", "2017-07-28 07:35:47.425820"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_12[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 12) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>12, "title"=>"Alpha", "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "local_path"=>"http://moenblanda.net/kieran"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stronghold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stronghold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Stronghold"], ["category_id", 12], ["slug", "stronghold"], ["created_at", "2017-07-28 07:35:47.437056"], ["updated_at", "2017-07-28 07:35:47.437056"], ["layout_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "fern"], ["email", "brianne.nader@zboncakkoepp.io"], ["password", "P5AePxRsH5S"], ["created_at", "2017-07-28 07:35:47.441598"], ["updated_at", "2017-07-28 07:35:47.441598"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "explicabo-laborum"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Voltsillam"], ["phone", "109.386.8460"], ["address", "251 Donnelly Pass"], ["url", "http://mertzsanford.org/bonnie.vonrueden"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://larson.info/johathan"], ["auth_expiration_time", 900], ["slug", "explicabo-laborum"], ["brand_id", 12], ["user_id", 15], ["created_at", "2017-07-28 07:35:47.447360"], ["updated_at", "2017-07-28 07:35:47.447360"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 7], ["location_id", 12], ["counter", 5], ["created_at", "2017-07-28 07:35:47.451939"], ["updated_at", "2017-07-28 07:35:47.451939"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Stronghold"], ["created_at", "2017-07-28 07:35:47.459183"], ["updated_at", "2017-07-28 07:35:47.459183"], ["local_path", "http://kuvalis.org/jaden_considine"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Cookley"], ["title_ru", "Название13"], ["created_at", "2017-07-28 07:35:47.463509"], ["updated_at", "2017-07-28 07:35:47.463509"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 13[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_13[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 13) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>13, "title"=>"Stronghold", "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "local_path"=>"http://kuvalis.org/jaden_considine"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonsing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonsing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Sonsing"], ["category_id", 13], ["slug", "sonsing"], ["created_at", "2017-07-28 07:35:47.475926"], ["updated_at", "2017-07-28 07:35:47.475926"], ["layout_id", 13]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "peggie"], ["email", "eloy@hansen.info"], ["password", "L0PrWjJjAoHrD"], ["created_at", "2017-07-28 07:35:47.481024"], ["updated_at", "2017-07-28 07:35:47.481024"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quae.veniam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bamity"], ["phone", "1-248-752-2593"], ["address", "729 Quigley Highway"], ["url", "http://turner.biz/daphne.lowe"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://zboncakhirthe.co/art_tremblay"], ["auth_expiration_time", 900], ["slug", "quae.veniam"], ["brand_id", 13], ["user_id", 16], ["created_at", "2017-07-28 07:35:47.486852"], ["updated_at", "2017-07-28 07:35:47.486852"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 8], ["location_id", 13], ["counter", 5], ["created_at", "2017-07-20 07:35:47.454434"], ["updated_at", "2017-07-20 07:35:47.454552"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "freda_okuneva"], ["email", "alena_grant@kirlin.io"], ["password", "PhWi7vFpJdWc"], ["role_cd", 3], ["created_at", "2017-07-28 07:35:47.495888"], ["updated_at", "2017-07-28 07:35:47.495888"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:47 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"freda_okuneva", "email"=>"alena_grant@kirlin.io", "password"=>"PhWi7vFpJdWc", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"freda_okuneva", :email=>"alena_grant@kirlin.io", :password=>"PhWi7vFpJdWc", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"alena_grant@kirlin.io", "password"=>"PhWi7vFpJdWc"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "freda_okuneva"], ["email", "alena_grant@kirlin.io"], ["password", "PhWi7vFpJdWc"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 17, username: "freda_okuneva", email: "alena_grant@kirlin.io", password: "PhWi7vFpJdWc", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:35:47", updated_at: "2017-07-28 07:35:47", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 17[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.4ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=passed&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:47 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"passed", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 17) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>17, "username"=>"freda_okuneva", "email"=>"alena_grant@kirlin.io", "password"=>"PhWi7vFpJdWc", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"passed", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>17, :username=>"freda_okuneva", :email=>"alena_grant@kirlin.io", :password=>"PhWi7vFpJdWc", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:35:47.495Z", :updated_at=>"2017-07-28T07:35:47.495Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:35:47.526370') AND "client_counters"."location_id" IN (10, 11, 12, 13) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1) ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 8[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:35:47.526370') AND "client_counters"."location_id" IN (10, 11, 12, 13) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1)[0m
[INFO ] Completed [32m200 OK[0m in 30ms [30m(Views: 0.5ms | ActiveRecord: 7.9ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "765-569-0047 x728"], ["created_at", "2017-07-28 07:35:47.547728"], ["updated_at", "2017-07-28 07:35:47.547728"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Ventosanzap"], ["created_at", "2017-07-28 07:35:47.554486"], ["updated_at", "2017-07-28 07:35:47.554486"], ["local_path", "http://christiansen.info/lucienne.kertzmann"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Mat Lam Tam"], ["title_ru", "Название14"], ["created_at", "2017-07-28 07:35:47.558410"], ["updated_at", "2017-07-28 07:35:47.558410"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 14[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_14[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 14) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>14, "title"=>"Ventosanzap", "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "local_path"=>"http://christiansen.info/lucienne.kertzmann"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Konklux"], ["category_id", 14], ["slug", "konklux"], ["created_at", "2017-07-28 07:35:47.569825"], ["updated_at", "2017-07-28 07:35:47.569825"], ["layout_id", 14]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "estella"], ["email", "roel_lakin@cremin.info"], ["password", "ShKi4hFiJtPw"], ["created_at", "2017-07-28 07:35:47.574423"], ["updated_at", "2017-07-28 07:35:47.574423"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "enim.et"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bigtax"], ["phone", "929-861-8890"], ["address", "2673 Friesen Mission"], ["url", "http://waters.net/aniya_luettgen"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://shanahan.co/talia_dibbert"], ["auth_expiration_time", 900], ["slug", "enim.et"], ["brand_id", 14], ["user_id", 18], ["created_at", "2017-07-28 07:35:47.580238"], ["updated_at", "2017-07-28 07:35:47.580238"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 9], ["location_id", 14], ["counter", 4], ["created_at", "2017-07-28 07:35:47.585206"], ["updated_at", "2017-07-28 07:35:47.585206"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "369.218.1104"], ["created_at", "2017-07-28 07:35:47.589065"], ["updated_at", "2017-07-28 07:35:47.589065"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Konklab"], ["created_at", "2017-07-28 07:35:47.595740"], ["updated_at", "2017-07-28 07:35:47.595740"], ["local_path", "http://kleinturcotte.info/brandon_mcglynn"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Domainer"], ["title_ru", "Название15"], ["created_at", "2017-07-28 07:35:47.599421"], ["updated_at", "2017-07-28 07:35:47.599421"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 15[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_15[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 15) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>15, "title"=>"Konklab", "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "local_path"=>"http://kleinturcotte.info/brandon_mcglynn"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "greenlam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "greenlam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Greenlam"], ["category_id", 15], ["slug", "greenlam"], ["created_at", "2017-07-28 07:35:47.610704"], ["updated_at", "2017-07-28 07:35:47.610704"], ["layout_id", 15]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "gina.leannon"], ["email", "trenton@pollich.name"], ["password", "9jXzA37f546m"], ["created_at", "2017-07-28 07:35:47.615575"], ["updated_at", "2017-07-28 07:35:47.615575"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "fugit-praesentium"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stronghold"], ["phone", "570-872-6699"], ["address", "657 Kamille Radial"], ["url", "http://lakin.name/rosalee"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kuhlman.info/madonna.dare"], ["auth_expiration_time", 900], ["slug", "fugit-praesentium"], ["brand_id", 15], ["user_id", 19], ["created_at", "2017-07-28 07:35:47.621323"], ["updated_at", "2017-07-28 07:35:47.621323"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 10], ["location_id", 15], ["counter", 6], ["created_at", "2017-07-28 07:35:47.626180"], ["updated_at", "2017-07-28 07:35:47.626180"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tempsoft"], ["created_at", "2017-07-28 07:35:47.632680"], ["updated_at", "2017-07-28 07:35:47.632680"], ["local_path", "http://townegrant.name/giovani.dare"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Cardify"], ["title_ru", "Название16"], ["created_at", "2017-07-28 07:35:47.636444"], ["updated_at", "2017-07-28 07:35:47.636444"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 16[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_16[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 16) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>16, "title"=>"Tempsoft", "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "local_path"=>"http://townegrant.name/giovani.dare"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "temp"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "temp"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Temp"], ["category_id", 16], ["slug", "temp"], ["created_at", "2017-07-28 07:35:47.647969"], ["updated_at", "2017-07-28 07:35:47.647969"], ["layout_id", 16]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lenora"], ["email", "carmelo@schroederschmidt.io"], ["password", "QuY0OhU7494wEt"], ["created_at", "2017-07-28 07:35:47.653006"], ["updated_at", "2017-07-28 07:35:47.653006"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quos_a"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Wrapsafe"], ["phone", "481-204-9180"], ["address", "5280 Hackett Dale"], ["url", "http://pollich.com/cade.botsford"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://zboncakledner.co/emily"], ["auth_expiration_time", 900], ["slug", "quos_a"], ["brand_id", 16], ["user_id", 20], ["created_at", "2017-07-28 07:35:47.658883"], ["updated_at", "2017-07-28 07:35:47.658883"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 9], ["location_id", 16], ["counter", 2], ["created_at", "2017-07-28 07:35:47.664085"], ["updated_at", "2017-07-28 07:35:47.664085"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "alfred.ziemann"], ["email", "sadie_buckridge@heathcote.co"], ["password", "7oK57dTnF"], ["role_cd", 3], ["created_at", "2017-07-28 07:35:47.668769"], ["updated_at", "2017-07-28 07:35:47.668769"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:47 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"alfred.ziemann", "email"=>"sadie_buckridge@heathcote.co", "password"=>"7oK57dTnF", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"alfred.ziemann", :email=>"sadie_buckridge@heathcote.co", :password=>"7oK57dTnF", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"sadie_buckridge@heathcote.co", "password"=>"7oK57dTnF"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "alfred.ziemann"], ["email", "sadie_buckridge@heathcote.co"], ["password", "7oK57dTnF"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 21, username: "alfred.ziemann", email: "sadie_buckridge@heathcote.co", password: "7oK57dTnF", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:35:47", updated_at: "2017-07-28 07:35:47", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 21[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:47 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 21) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>21, "username"=>"alfred.ziemann", "email"=>"sadie_buckridge@heathcote.co", "password"=>"7oK57dTnF", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.7ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>21, :username=>"alfred.ziemann", :email=>"sadie_buckridge@heathcote.co", :password=>"7oK57dTnF", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:35:47.668Z", :updated_at=>"2017-07-28T07:35:47.668Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:35:47.585206') AND "client_counters"."location_id" IN (14, 15, 16) GROUP BY client_id, phone_number ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (9, 10)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (9, 10)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:35:47.585206') AND "client_counters"."location_id" IN (14, 15, 16) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 32ms [30m(Views: 0.7ms | ActiveRecord: 8.9ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-644-659-0875 x66275"], ["created_at", "2017-07-28 07:35:47.720783"], ["updated_at", "2017-07-28 07:35:47.720783"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Pannier"], ["created_at", "2017-07-28 07:35:47.727786"], ["updated_at", "2017-07-28 07:35:47.727786"], ["local_path", "http://bins.biz/adrien.runolfsdottir"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fintone"], ["title_ru", "Название17"], ["created_at", "2017-07-28 07:35:47.731761"], ["updated_at", "2017-07-28 07:35:47.731761"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_17[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 17) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>17, "title"=>"Pannier", "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "local_path"=>"http://bins.biz/adrien.runolfsdottir"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bigtax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bigtax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bigtax"], ["category_id", 17], ["slug", "bigtax"], ["created_at", "2017-07-28 07:35:47.743741"], ["updated_at", "2017-07-28 07:35:47.743741"], ["layout_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "sonya"], ["email", "nash_jones@heel.net"], ["password", "J37mA3Co"], ["created_at", "2017-07-28 07:35:47.748921"], ["updated_at", "2017-07-28 07:35:47.748921"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "iusto-perspiciatis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Fixflex"], ["phone", "357-085-1620"], ["address", "46185 Elyssa Walk"], ["url", "http://ferry.co/keon"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://leannonsimonis.com/mireille"], ["auth_expiration_time", 900], ["slug", "iusto-perspiciatis"], ["brand_id", 17], ["user_id", 22], ["created_at", "2017-07-28 07:35:47.754855"], ["updated_at", "2017-07-28 07:35:47.754855"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 11], ["location_id", 17], ["counter", 9], ["created_at", "2017-07-28 07:35:47.759688"], ["updated_at", "2017-07-28 07:35:47.759688"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "337-218-1772 x875"], ["created_at", "2017-07-28 07:35:47.763399"], ["updated_at", "2017-07-28 07:35:47.763399"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Overhold"], ["created_at", "2017-07-28 07:35:47.769805"], ["updated_at", "2017-07-28 07:35:47.769805"], ["local_path", "http://beer.biz/danielle"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Ronstring"], ["title_ru", "Название18"], ["created_at", "2017-07-28 07:35:47.773484"], ["updated_at", "2017-07-28 07:35:47.773484"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 18[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_18[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 18) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>18, "title"=>"Overhold", "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "local_path"=>"http://beer.biz/danielle"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "flowdesk"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "flowdesk"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Flowdesk"], ["category_id", 18], ["slug", "flowdesk"], ["created_at", "2017-07-28 07:35:47.784670"], ["updated_at", "2017-07-28 07:35:47.784670"], ["layout_id", 18]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "eliseo.pfeffer"], ["email", "maximo_windler@dubuque.biz"], ["password", "IvFg03C8R6CcO"], ["created_at", "2017-07-28 07:35:47.789652"], ["updated_at", "2017-07-28 07:35:47.789652"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "iusto_dicta"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Ronstring"], ["phone", "552-922-5799"], ["address", "52401 Haley Spring"], ["url", "http://doylekling.net/reba"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://roberts.name/romaine"], ["auth_expiration_time", 900], ["slug", "iusto_dicta"], ["brand_id", 18], ["user_id", 23], ["created_at", "2017-07-28 07:35:47.795524"], ["updated_at", "2017-07-28 07:35:47.795524"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 12], ["location_id", 18], ["counter", 1], ["created_at", "2017-07-28 07:35:47.800250"], ["updated_at", "2017-07-28 07:35:47.800250"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Toughjoyfax"], ["created_at", "2017-07-28 07:35:47.806756"], ["updated_at", "2017-07-28 07:35:47.806756"], ["local_path", "http://altenwerthstokes.com/onie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Voyatouch"], ["title_ru", "Название19"], ["created_at", "2017-07-28 07:35:47.810428"], ["updated_at", "2017-07-28 07:35:47.810428"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 19[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_19[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 19) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>19, "title"=>"Toughjoyfax", "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "local_path"=>"http://altenwerthstokes.com/onie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "span"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "span"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Span"], ["category_id", 19], ["slug", "span"], ["created_at", "2017-07-28 07:35:47.821604"], ["updated_at", "2017-07-28 07:35:47.821604"], ["layout_id", 19]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "harmon.krajcik"], ["email", "amani@wilderman.io"], ["password", "Tt9v2qJh8"], ["created_at", "2017-07-28 07:35:47.826302"], ["updated_at", "2017-07-28 07:35:47.826302"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "cum_est"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Voltsillam"], ["phone", "435.707.4276"], ["address", "662 Brekke Ports"], ["url", "http://bartoletti.co/brennan"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://boehm.info/wallace_schaden"], ["auth_expiration_time", 900], ["slug", "cum_est"], ["brand_id", 19], ["user_id", 24], ["created_at", "2017-07-28 07:35:47.832272"], ["updated_at", "2017-07-28 07:35:47.832272"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 11], ["location_id", 19], ["counter", 10], ["created_at", "2017-07-28 07:35:47.836946"], ["updated_at", "2017-07-28 07:35:47.836946"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "kirk.welch"], ["email", "drew.lehner@halvorson.org"], ["password", "HpJxOlTq3nUo1rJ7"], ["role_cd", 3], ["created_at", "2017-07-28 07:35:47.841617"], ["updated_at", "2017-07-28 07:35:47.841617"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:47 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"kirk.welch", "email"=>"drew.lehner@halvorson.org", "password"=>"HpJxOlTq3nUo1rJ7", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"kirk.welch", :email=>"drew.lehner@halvorson.org", :password=>"HpJxOlTq3nUo1rJ7", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"drew.lehner@halvorson.org", "password"=>"HpJxOlTq3nUo1rJ7"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "kirk.welch"], ["email", "drew.lehner@halvorson.org"], ["password", "HpJxOlTq3nUo1rJ7"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 25, username: "kirk.welch", email: "drew.lehner@halvorson.org", password: "HpJxOlTq3nUo1rJ7", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:35:47", updated_at: "2017-07-28 07:35:47", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 25[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.1ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=updated_at&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:47 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"updated_at", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 25) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>25, "username"=>"kirk.welch", "email"=>"drew.lehner@halvorson.org", "password"=>"HpJxOlTq3nUo1rJ7", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"updated_at", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.8ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>25, :username=>"kirk.welch", :email=>"drew.lehner@halvorson.org", :password=>"HpJxOlTq3nUo1rJ7", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:35:47.841Z", :updated_at=>"2017-07-28T07:35:47.841Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:35:47.759688') AND "client_counters"."location_id" IN (17, 18, 19) GROUP BY client_id, phone_number ORDER BY updated_at desc, visits desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (11, 12)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (1.4ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (11, 12)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:35:47.759688') AND "client_counters"."location_id" IN (17, 18, 19) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 33ms [30m(Views: 0.6ms | ActiveRecord: 9.4ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(823) 764-5650 x75250"], ["created_at", "2017-07-28 07:35:47.894524"], ["updated_at", "2017-07-28 07:35:47.894524"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Alpha"], ["created_at", "2017-07-28 07:35:47.901451"], ["updated_at", "2017-07-28 07:35:47.901451"], ["local_path", "http://raynorbartoletti.org/robyn.turner"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Rank"], ["title_ru", "Название20"], ["created_at", "2017-07-28 07:35:47.905299"], ["updated_at", "2017-07-28 07:35:47.905299"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 20[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_20[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 20) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>20, "title"=>"Alpha", "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "local_path"=>"http://raynorbartoletti.org/robyn.turner"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tres-zap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tres-zap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tres-Zap"], ["category_id", 20], ["slug", "tres-zap"], ["created_at", "2017-07-28 07:35:47.917138"], ["updated_at", "2017-07-28 07:35:47.917138"], ["layout_id", 20]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "akeem.jacobi"], ["email", "micah_hoppe@walsh.com"], ["password", "6s6gEaWtGc2"], ["created_at", "2017-07-28 07:35:47.922006"], ["updated_at", "2017-07-28 07:35:47.922006"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quis-debitis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Temp"], ["phone", "774-289-6577"], ["address", "6204 McDermott Falls"], ["url", "http://watsica.com/erika"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://erdmanwintheiser.co/darian"], ["auth_expiration_time", 900], ["slug", "quis-debitis"], ["brand_id", 20], ["user_id", 26], ["created_at", "2017-07-28 07:35:47.928035"], ["updated_at", "2017-07-28 07:35:47.928035"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 13], ["location_id", 20], ["counter", 9], ["created_at", "2017-07-28 07:35:47.932792"], ["updated_at", "2017-07-28 07:35:47.932792"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "533.608.7157"], ["created_at", "2017-07-28 07:35:47.936818"], ["updated_at", "2017-07-28 07:35:47.936818"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zontrax"], ["created_at", "2017-07-28 07:35:47.943448"], ["updated_at", "2017-07-28 07:35:47.943448"], ["local_path", "http://carter.name/christopher"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Voyatouch"], ["title_ru", "Название21"], ["created_at", "2017-07-28 07:35:47.947376"], ["updated_at", "2017-07-28 07:35:47.947376"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_21[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 21) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>21, "title"=>"Zontrax", "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "local_path"=>"http://carter.name/christopher"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonsing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonsing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Sonsing"], ["category_id", 21], ["slug", "sonsing"], ["created_at", "2017-07-28 07:35:47.959090"], ["updated_at", "2017-07-28 07:35:47.959090"], ["layout_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "vicente.marquardt"], ["email", "eriberto@gulgowski.io"], ["password", "1vD4Qm9q08C"], ["created_at", "2017-07-28 07:35:47.964301"], ["updated_at", "2017-07-28 07:35:47.964301"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "doloremque.dolores"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Voyatouch"], ["phone", "995-191-9252"], ["address", "21401 Elliot Mountains"], ["url", "http://king.io/rosamond"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://jast.io/catalina_ziemann"], ["auth_expiration_time", 900], ["slug", "doloremque.dolores"], ["brand_id", 21], ["user_id", 27], ["created_at", "2017-07-28 07:35:47.970418"], ["updated_at", "2017-07-28 07:35:47.970418"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 14], ["location_id", 21], ["counter", 3], ["created_at", "2017-07-28 07:35:47.975205"], ["updated_at", "2017-07-28 07:35:47.975205"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Prodder"], ["created_at", "2017-07-28 07:35:47.981350"], ["updated_at", "2017-07-28 07:35:47.981350"], ["local_path", "http://kohler.com/andres"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fix San"], ["title_ru", "Название22"], ["created_at", "2017-07-28 07:35:47.984608"], ["updated_at", "2017-07-28 07:35:47.984608"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 22[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_22[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 22) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>22, "title"=>"Prodder", "created_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:47 UTC +00:00, "local_path"=>"http://kohler.com/andres"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "treeflex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "treeflex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Treeflex"], ["category_id", 22], ["slug", "treeflex"], ["created_at", "2017-07-28 07:35:47.995436"], ["updated_at", "2017-07-28 07:35:47.995436"], ["layout_id", 22]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "burdette.ernser"], ["email", "marisa.ruel@schoen.biz"], ["password", "A85rB40bC"], ["created_at", "2017-07-28 07:35:48.000255"], ["updated_at", "2017-07-28 07:35:48.000255"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "maiores_sit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bitchip"], ["phone", "1-692-944-8999"], ["address", "7757 Hills Road"], ["url", "http://bauchprice.net/halle"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hilll.org/dameon.hane"], ["auth_expiration_time", 900], ["slug", "maiores_sit"], ["brand_id", 22], ["user_id", 28], ["created_at", "2017-07-28 07:35:48.006026"], ["updated_at", "2017-07-28 07:35:48.006026"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 13], ["location_id", 22], ["counter", 2], ["created_at", "2017-07-28 07:35:48.010602"], ["updated_at", "2017-07-28 07:35:48.010602"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-445-145-7626 x609"], ["created_at", "2017-07-28 07:35:48.014875"], ["updated_at", "2017-07-28 07:35:48.014875"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Wrapsafe"], ["created_at", "2017-07-28 07:35:48.020796"], ["updated_at", "2017-07-28 07:35:48.020796"], ["local_path", "http://hermiston.com/dasia_ruel"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bitwolf"], ["title_ru", "Название23"], ["created_at", "2017-07-28 07:35:48.024680"], ["updated_at", "2017-07-28 07:35:48.024680"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 23[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_23[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 23) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>23, "title"=>"Wrapsafe", "created_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "local_path"=>"http://hermiston.com/dasia_ruel"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "lotstring"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "lotstring"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Lotstring"], ["category_id", 23], ["slug", "lotstring"], ["created_at", "2017-07-28 07:35:48.036464"], ["updated_at", "2017-07-28 07:35:48.036464"], ["layout_id", 23]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "monserrat"], ["email", "bert_mann@gutmannhermiston.org"], ["password", "191nSfUgO"], ["created_at", "2017-07-28 07:35:48.041662"], ["updated_at", "2017-07-28 07:35:48.041662"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "sint.ut"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Flowdesk"], ["phone", "1-477-076-1411"], ["address", "61747 Eleonore Terrace"], ["url", "http://cristtremblay.net/kareem_weber"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://bradtke.name/jerod.torphy"], ["auth_expiration_time", 900], ["slug", "sint.ut"], ["brand_id", 23], ["user_id", 29], ["created_at", "2017-07-28 07:35:48.047477"], ["updated_at", "2017-07-28 07:35:48.047477"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 15], ["location_id", 23], ["counter", 8], ["created_at", "2017-06-26 07:35:48.013054"], ["updated_at", "2017-06-26 07:35:48.013166"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "ariane"], ["email", "nyah.kemmer@reinger.io"], ["password", "FeIfWkS1BbHp"], ["role_cd", 3], ["created_at", "2017-07-28 07:35:48.069832"], ["updated_at", "2017-07-28 07:35:48.069832"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:48 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"ariane", "email"=>"nyah.kemmer@reinger.io", "password"=>"FeIfWkS1BbHp", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"ariane", :email=>"nyah.kemmer@reinger.io", :password=>"FeIfWkS1BbHp", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"nyah.kemmer@reinger.io", "password"=>"FeIfWkS1BbHp"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "ariane"], ["email", "nyah.kemmer@reinger.io"], ["password", "FeIfWkS1BbHp"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 30, username: "ariane", email: "nyah.kemmer@reinger.io", password: "FeIfWkS1BbHp", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:35:48", updated_at: "2017-07-28 07:35:48", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 30[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=visits30&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:48 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits30", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 30) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>30, "username"=>"ariane", "email"=>"nyah.kemmer@reinger.io", "password"=>"FeIfWkS1BbHp", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits30", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.6ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>30, :username=>"ariane", :email=>"nyah.kemmer@reinger.io", :password=>"FeIfWkS1BbHp", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:35:48.069Z", :updated_at=>"2017-07-28T07:35:48.069Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-06-26 07:35:48.013054') AND "client_counters"."location_id" IN (20, 21, 22, 23) GROUP BY client_id, phone_number ORDER BY visits30 asc, updated_at desc, visits desc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (15, 14, 13)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.7ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (13, 14, 15)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-06-26 07:35:48.013054') AND "client_counters"."location_id" IN (20, 21, 22, 23) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 32ms [30m(Views: 0.9ms | ActiveRecord: 8.2ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ryder"], ["email", "marcellus@bergstromgusikowski.co"], ["password", "5cFiMdJ4JnZ8XiEb"], ["created_at", "2017-07-28 07:35:48.124091"], ["updated_at", "2017-07-28 07:35:48.124091"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "milan.larkin"], ["email", "adrienne@bernhard.co"], ["password", "01Y1LoCu6737Kj"], ["created_at", "2017-07-28 07:35:48.153685"], ["updated_at", "2017-07-28 07:35:48.153685"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "alison.senger"], ["email", "lionel.schiller@huelshilll.org"], ["password", "IgT2VtFh4rJrBt"], ["created_at", "2017-07-28 07:35:48.172084"], ["updated_at", "2017-07-28 07:35:48.172084"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "al.halvorson"], ["email", "paula.heel@auerrutherford.io"], ["password", "Q67lZuV87h8n3"], ["created_at", "2017-07-28 07:35:48.182831"], ["updated_at", "2017-07-28 07:35:48.182831"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "delphia"], ["email", "odea_senger@koelpin.io"], ["password", "87Yw2yS4T"], ["created_at", "2017-07-28 07:35:48.192922"], ["updated_at", "2017-07-28 07:35:48.192922"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-263-699-8345"], ["created_at", "2017-07-28 07:35:48.225844"], ["updated_at", "2017-07-28 07:35:48.225844"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "preston.goyette"], ["email", "carleton_simonis@moencorwin.name"], ["password", "6jEfKgO77h"], ["created_at", "2017-07-28 07:35:48.231618"], ["updated_at", "2017-07-28 07:35:48.231618"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (2.5ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "526187"], ["username", "frank_parisian"], ["image", "http://vk.com/img/frank_parisian.jpg"], ["profile", "https://vk.com/frank_parisian"], ["email", "ardith_cormier@walker.co"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 16], ["user_id", 36], ["created_at", "2017-07-28 07:35:48.236471"], ["updated_at", "2017-07-28 07:35:48.236471"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Home Ing"], ["created_at", "2017-07-28 07:35:48.245845"], ["updated_at", "2017-07-28 07:35:48.245845"], ["local_path", "http://will.co/michale"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Alphazap"], ["title_ru", "Название24"], ["created_at", "2017-07-28 07:35:48.249634"], ["updated_at", "2017-07-28 07:35:48.249634"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 24[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_24[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 24) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>24, "title"=>"Home Ing", "created_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "local_path"=>"http://will.co/michale"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "namfix"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "namfix"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Namfix"], ["category_id", 24], ["slug", "namfix"], ["created_at", "2017-07-28 07:35:48.261745"], ["updated_at", "2017-07-28 07:35:48.261745"], ["layout_id", 24]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "natus-sint"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Flexidy"], ["phone", "929-231-6372"], ["address", "57579 Magali Underpass"], ["url", "http://klingmohr.biz/jarvis"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hueltreich.org/maude_jones"], ["auth_expiration_time", 900], ["slug", "natus-sint"], ["brand_id", 24], ["user_id", 36], ["created_at", "2017-07-28 07:35:48.267822"], ["updated_at", "2017-07-28 07:35:48.267822"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tres-Zap"], ["created_at", "2017-07-28 07:35:48.317444"], ["updated_at", "2017-07-28 07:35:48.317444"], ["local_path", "http://douglasbradtke.info/felipa.turcotte"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bamity"], ["title_ru", "Название25"], ["created_at", "2017-07-28 07:35:48.321480"], ["updated_at", "2017-07-28 07:35:48.321480"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_25[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 25) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>25, "title"=>"Tres-Zap", "created_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "local_path"=>"http://douglasbradtke.info/felipa.turcotte"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Konklab"], ["category_id", 25], ["slug", "konklab"], ["created_at", "2017-07-28 07:35:48.333298"], ["updated_at", "2017-07-28 07:35:48.333298"], ["layout_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "verla"], ["email", "humberto@swift.net"], ["password", "BuE8ArMy"], ["created_at", "2017-07-28 07:35:48.338260"], ["updated_at", "2017-07-28 07:35:48.338260"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ea_in"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Quo Lux"], ["phone", "879-916-0126"], ["address", "97284 Rempel Fall"], ["url", "http://bashirian.info/jarret.lemke"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://nicolas.biz/agnes.stark"], ["auth_expiration_time", 900], ["slug", "ea_in"], ["brand_id", 25], ["user_id", 37], ["created_at", "2017-07-28 07:35:48.344232"], ["updated_at", "2017-07-28 07:35:48.344232"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "freddy.wyman"], ["email", "tristian_douglas@hettinger.net"], ["password", "71H3T3UgZ"], ["created_at", "2017-07-28 07:35:48.349598"], ["updated_at", "2017-07-28 07:35:48.349598"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5331"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5331"], ["comment", "comment 11"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "20.65.244.11"], ["router_admin_ip", "142.154.125.34"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "896"], ["status", "t"], ["location_id", 25], ["user_id", 38], ["created_at", "2017-07-28 07:35:48.358164"], ["updated_at", "2017-07-28 07:35:48.358164"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5331"], ["id", 1], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 1], ["serial", "643705CA5E36/5331"], ["comment", "comment 11"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "20.65.244.11"], ["router_admin_ip", "142.154.125.34"], ["admin_password", "030dc48afa6a05e8"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "1"], ["status", "t"], ["location_id", 25], ["user_id", 38], ["created_at", "2017-07-28 07:35:48.358164"], ["updated_at", "2017-07-28 07:35:48.358164"], ["id", 1]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: d67f5b6f-d0c8-4cf1-9877-a6c2184ba73e) to Async(routers) with arguments: #<GlobalID:0x007fce275eb2b0 @uri=#<URI::GID gid://wifi-management/Router/1>>
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 6db3b66a-9e6d-41ec-a56b-c8e83760810e) to Async(routers) with arguments: #<GlobalID:0x007fce275eb2b0 @uri=#<URI::GID gid://wifi-management/Router/1>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 1], ["provider", "instagram"], ["location_id", 24], ["router_id", 1], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:48 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"preston.goyette", "email"=>"carleton_simonis@moencorwin.name", "password"=>"6jEfKgO77h", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"preston.goyette", :email=>"carleton_simonis@moencorwin.name", :password=>"6jEfKgO77h", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"carleton_simonis@moencorwin.name", "password"=>"6jEfKgO77h"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "preston.goyette"], ["email", "carleton_simonis@moencorwin.name"], ["password", "6jEfKgO77h"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 36, username: "preston.goyette", email: "carleton_simonis@moencorwin.name", password: "6jEfKgO77h", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:35:48", updated_at: "2017-07-28 07:35:48", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 36[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.1ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/stats/time_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:48 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#time_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_36[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 36) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>36, "username"=>"preston.goyette", "email"=>"carleton_simonis@moencorwin.name", "password"=>"6jEfKgO77h", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"time_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_36[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_36[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>36, :username=>"preston.goyette", :email=>"carleton_simonis@moencorwin.name", :password=>"6jEfKgO77h", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:35:48.231Z", :updated_at=>"2017-07-28T07:35:48.231Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 36[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(24)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 28ms [30m(Views: 1.2ms | ActiveRecord: 5.9ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "921.392.8268 x42630"], ["created_at", "2017-07-28 07:35:48.608919"], ["updated_at", "2017-07-28 07:35:48.608919"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "emily"], ["email", "cameron_pacocha@wisozk.io"], ["password", "KnZ7WgXxO"], ["created_at", "2017-07-28 07:35:48.614362"], ["updated_at", "2017-07-28 07:35:48.614362"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "148996"], ["username", "wilford"], ["image", "http://facebook.com/img/wilford.jpg"], ["profile", "https://facebook.com/wilford"], ["email", "brant@berge.biz"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 17], ["user_id", 39], ["created_at", "2017-07-28 07:35:48.618902"], ["updated_at", "2017-07-28 07:35:48.618902"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Cookley"], ["created_at", "2017-07-28 07:35:48.626483"], ["updated_at", "2017-07-28 07:35:48.626483"], ["local_path", "http://wiegand.info/rosetta.lind"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Alpha"], ["title_ru", "Название26"], ["created_at", "2017-07-28 07:35:48.630593"], ["updated_at", "2017-07-28 07:35:48.630593"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 26[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_26[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 26) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>26, "title"=>"Cookley", "created_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "local_path"=>"http://wiegand.info/rosetta.lind"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sub-ex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sub-ex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Sub-Ex"], ["category_id", 26], ["slug", "sub-ex"], ["created_at", "2017-07-28 07:35:48.642933"], ["updated_at", "2017-07-28 07:35:48.642933"], ["layout_id", 26]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "est.distinctio"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Veribet"], ["phone", "(298) 740-3627"], ["address", "26646 Towne Turnpike"], ["url", "http://cummeratahills.co/richard"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://klein.net/charlotte_hilll"], ["auth_expiration_time", 900], ["slug", "est.distinctio"], ["brand_id", 26], ["user_id", 39], ["created_at", "2017-07-28 07:35:48.649315"], ["updated_at", "2017-07-28 07:35:48.649315"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Asoka"], ["created_at", "2017-07-28 07:35:48.657668"], ["updated_at", "2017-07-28 07:35:48.657668"], ["local_path", "http://wehnerfay.co/lizzie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Viva"], ["title_ru", "Название27"], ["created_at", "2017-07-28 07:35:48.661371"], ["updated_at", "2017-07-28 07:35:48.661371"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 27[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_27[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 27) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>27, "title"=>"Asoka", "created_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "local_path"=>"http://wehnerfay.co/lizzie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "holdlamis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "holdlamis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Holdlamis"], ["category_id", 27], ["slug", "holdlamis"], ["created_at", "2017-07-28 07:35:48.672962"], ["updated_at", "2017-07-28 07:35:48.672962"], ["layout_id", 27]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "grayce_mayer"], ["email", "noemy@stehr.io"], ["password", "W3WtD7YfVtO172Z"], ["created_at", "2017-07-28 07:35:48.678180"], ["updated_at", "2017-07-28 07:35:48.678180"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "reiciendis_excepturi"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Regrant"], ["phone", "747.338.5488"], ["address", "227 Asia Trail"], ["url", "http://price.co/claudia.skiles"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kuvalis.biz/yasmeen"], ["auth_expiration_time", 900], ["slug", "reiciendis_excepturi"], ["brand_id", 27], ["user_id", 40], ["created_at", "2017-07-28 07:35:48.684360"], ["updated_at", "2017-07-28 07:35:48.684360"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ricky"], ["email", "moriah_gaylord@conroy.net"], ["password", "TnXi6kJg7"], ["created_at", "2017-07-28 07:35:48.690139"], ["updated_at", "2017-07-28 07:35:48.690139"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5332"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5332"], ["comment", "comment 12"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "5.199.67.251"], ["router_admin_ip", "118.177.36.201"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "802"], ["status", "t"], ["location_id", 27], ["user_id", 41], ["created_at", "2017-07-28 07:35:48.696308"], ["updated_at", "2017-07-28 07:35:48.696308"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5332"], ["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 2], ["serial", "643705CA5E36/5332"], ["comment", "comment 12"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "5.199.67.251"], ["router_admin_ip", "118.177.36.201"], ["admin_password", "7c8fef463c942638"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "2"], ["status", "t"], ["location_id", 27], ["user_id", 41], ["created_at", "2017-07-28 07:35:48.696308"], ["updated_at", "2017-07-28 07:35:48.696308"], ["id", 2]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: d5ca9ac9-a786-4395-a591-502fe40bd8c3) to Async(routers) with arguments: #<GlobalID:0x007fce26e23b18 @uri=#<URI::GID gid://wifi-management/Router/2>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 64befa9a-8add-4fb5-b2d7-2fe67d728f6c) to Async(routers) with arguments: #<GlobalID:0x007fce26e23b18 @uri=#<URI::GID gid://wifi-management/Router/2>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 2], ["provider", "instagram"], ["location_id", 26], ["router_id", 2], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:48 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"emily", "email"=>"cameron_pacocha@wisozk.io", "password"=>"KnZ7WgXxO", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"emily", :email=>"cameron_pacocha@wisozk.io", :password=>"KnZ7WgXxO", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"cameron_pacocha@wisozk.io", "password"=>"KnZ7WgXxO"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "emily"], ["email", "cameron_pacocha@wisozk.io"], ["password", "KnZ7WgXxO"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 39, username: "emily", email: "cameron_pacocha@wisozk.io", password: "KnZ7WgXxO", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:35:48", updated_at: "2017-07-28 07:35:48", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 39[0m
[INFO ] Completed [32m201 Created[0m in 6ms [30m(Views: 0.3ms | ActiveRecord: 1.3ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/stats/authorizations" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:48 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#authorizations[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 39) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.9ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>39, "username"=>"emily", "email"=>"cameron_pacocha@wisozk.io", "password"=>"KnZ7WgXxO", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"authorizations"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>39, :username=>"emily", :email=>"cameron_pacocha@wisozk.io", :password=>"KnZ7WgXxO", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:35:48.614Z", :updated_at=>"2017-07-28T07:35:48.614Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 39[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[34mSELECT COUNT("social_logs"."id") AS count_id, date_trunc('hour', created_at) AS date_trunc_hour_created_at FROM "social_logs" WHERE "social_logs"."location_id" = 26 AND ("social_logs"."created_at" BETWEEN $1 AND $2) GROUP BY date_trunc('hour', created_at) ORDER BY date_trunc_hour_created_at[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 28ms [30m(Views: 0.2ms | ActiveRecord: 8.9ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "998.700.1998"], ["created_at", "2017-07-28 07:35:48.844288"], ["updated_at", "2017-07-28 07:35:48.844288"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "verona"], ["email", "kaitlin_beatty@sanford.net"], ["password", "CnZbDeTmJ"], ["created_at", "2017-07-28 07:35:48.849130"], ["updated_at", "2017-07-28 07:35:48.849130"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "109425"], ["username", "frederic.ward"], ["image", "http://vk.com/img/frederic.ward.jpg"], ["profile", "https://vk.com/frederic.ward"], ["email", "amina@haagferry.com"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 18], ["user_id", 42], ["created_at", "2017-07-28 07:35:48.853495"], ["updated_at", "2017-07-28 07:35:48.853495"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Home Ing"], ["created_at", "2017-07-28 07:35:48.860867"], ["updated_at", "2017-07-28 07:35:48.860867"], ["local_path", "http://connelly.co/everette"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Konklux"], ["title_ru", "Название28"], ["created_at", "2017-07-28 07:35:48.864620"], ["updated_at", "2017-07-28 07:35:48.864620"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 28[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_28[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 28) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>28, "title"=>"Home Ing", "created_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "local_path"=>"http://connelly.co/everette"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "fixflex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "fixflex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Fixflex"], ["category_id", 28], ["slug", "fixflex"], ["created_at", "2017-07-28 07:35:48.876133"], ["updated_at", "2017-07-28 07:35:48.876133"], ["layout_id", 28]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "porro-at"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Keylex"], ["phone", "650.634.0350"], ["address", "36446 Nikita Locks"], ["url", "http://kingheaney.info/javon_langosh"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://rath.net/leanna"], ["auth_expiration_time", 900], ["slug", "porro-at"], ["brand_id", 28], ["user_id", 42], ["created_at", "2017-07-28 07:35:48.882168"], ["updated_at", "2017-07-28 07:35:48.882168"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bigtax"], ["created_at", "2017-07-28 07:35:48.890573"], ["updated_at", "2017-07-28 07:35:48.890573"], ["local_path", "http://millerklein.io/bria"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Domainer"], ["title_ru", "Название29"], ["created_at", "2017-07-28 07:35:48.894309"], ["updated_at", "2017-07-28 07:35:48.894309"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 29[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_29[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 29) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>29, "title"=>"Bigtax", "created_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "local_path"=>"http://millerklein.io/bria"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "gembucket"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "gembucket"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Gembucket"], ["category_id", 29], ["slug", "gembucket"], ["created_at", "2017-07-28 07:35:48.905562"], ["updated_at", "2017-07-28 07:35:48.905562"], ["layout_id", 29]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "marjolaine"], ["email", "felipa@vonruedenwhite.com"], ["password", "OvPwD32t3zB10yE"], ["created_at", "2017-07-28 07:35:48.910412"], ["updated_at", "2017-07-28 07:35:48.910412"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "suscipit-enim"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Home Ing"], ["phone", "602-483-4249"], ["address", "4852 Nicole Ridge"], ["url", "http://medhurst.biz/lucius"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://jacobson.org/muhammad.walsh"], ["auth_expiration_time", 900], ["slug", "suscipit-enim"], ["brand_id", 29], ["user_id", 43], ["created_at", "2017-07-28 07:35:48.916424"], ["updated_at", "2017-07-28 07:35:48.916424"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "paula"], ["email", "ona@wittingvonrueden.net"], ["password", "4zW5TvBuXeP73b5"], ["created_at", "2017-07-28 07:35:48.921878"], ["updated_at", "2017-07-28 07:35:48.921878"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5333"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5333"], ["comment", "comment 13"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "252.61.158.208"], ["router_admin_ip", "214.142.192.47"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "596"], ["status", "t"], ["location_id", 29], ["user_id", 44], ["created_at", "2017-07-28 07:35:48.927802"], ["updated_at", "2017-07-28 07:35:48.927802"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5333"], ["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 3], ["serial", "643705CA5E36/5333"], ["comment", "comment 13"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "252.61.158.208"], ["router_admin_ip", "214.142.192.47"], ["admin_password", "23a5ae5eeb69bf7c"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "3"], ["status", "t"], ["location_id", 29], ["user_id", 44], ["created_at", "2017-07-28 07:35:48.927802"], ["updated_at", "2017-07-28 07:35:48.927802"], ["id", 3]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 3e43f3de-2351-4d54-a556-d20d7bbe23ac) to Async(routers) with arguments: #<GlobalID:0x007fce231da3c8 @uri=#<URI::GID gid://wifi-management/Router/3>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 92dd26c0-4088-443b-9192-72d6c18c7b20) to Async(routers) with arguments: #<GlobalID:0x007fce231da3c8 @uri=#<URI::GID gid://wifi-management/Router/3>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 3], ["provider", "instagram"], ["location_id", 28], ["router_id", 3], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:49 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"verona", "email"=>"kaitlin_beatty@sanford.net", "password"=>"CnZbDeTmJ", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"verona", :email=>"kaitlin_beatty@sanford.net", :password=>"CnZbDeTmJ", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"kaitlin_beatty@sanford.net", "password"=>"CnZbDeTmJ"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "verona"], ["email", "kaitlin_beatty@sanford.net"], ["password", "CnZbDeTmJ"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 42, username: "verona", email: "kaitlin_beatty@sanford.net", password: "CnZbDeTmJ", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:35:48", updated_at: "2017-07-28 07:35:48", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 42[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/social_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:49 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#social_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_42[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 42) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>42, "username"=>"verona", "email"=>"kaitlin_beatty@sanford.net", "password"=>"CnZbDeTmJ", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:48 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"social_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_42[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_42[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>42, :username=>"verona", :email=>"kaitlin_beatty@sanford.net", :password=>"CnZbDeTmJ", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:35:48.849Z", :updated_at=>"2017-07-28T07:35:48.849Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 42[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" = 28 AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 25ms [30m(Views: 1.2ms | ActiveRecord: 6.1ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-693-748-9684"], ["created_at", "2017-07-28 07:35:49.187148"], ["updated_at", "2017-07-28 07:35:49.187148"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "felipe.hahn"], ["email", "lloyd@welchmorar.biz"], ["password", "3kFnLvVcOo0oL0"], ["created_at", "2017-07-28 07:35:49.192460"], ["updated_at", "2017-07-28 07:35:49.192460"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "158962"], ["username", "chandler"], ["image", "http://vk.com/img/chandler.jpg"], ["profile", "https://vk.com/chandler"], ["email", "kareem@kirlin.org"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 19], ["user_id", 45], ["created_at", "2017-07-28 07:35:49.197072"], ["updated_at", "2017-07-28 07:35:49.197072"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Span"], ["created_at", "2017-07-28 07:35:49.204980"], ["updated_at", "2017-07-28 07:35:49.204980"], ["local_path", "http://kertzmann.com/caria"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Andalax"], ["title_ru", "Название30"], ["created_at", "2017-07-28 07:35:49.209215"], ["updated_at", "2017-07-28 07:35:49.209215"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_30[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 30) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>30, "title"=>"Span", "created_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "local_path"=>"http://kertzmann.com/caria"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "regrant"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "regrant"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Regrant"], ["category_id", 30], ["slug", "regrant"], ["created_at", "2017-07-28 07:35:49.222375"], ["updated_at", "2017-07-28 07:35:49.222375"], ["layout_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptas-ut"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Temp"], ["phone", "820-728-0792"], ["address", "81782 Gutmann Underpass"], ["url", "http://bernhardjakubowski.io/lue_feil"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://luettgen.co/gloria"], ["auth_expiration_time", 900], ["slug", "voluptas-ut"], ["brand_id", 30], ["user_id", 45], ["created_at", "2017-07-28 07:35:49.229384"], ["updated_at", "2017-07-28 07:35:49.229384"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Cookley"], ["created_at", "2017-07-28 07:35:49.237928"], ["updated_at", "2017-07-28 07:35:49.237928"], ["local_path", "http://hansen.com/dangelo"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Mat Lam Tam"], ["title_ru", "Название31"], ["created_at", "2017-07-28 07:35:49.241739"], ["updated_at", "2017-07-28 07:35:49.241739"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 31[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_31[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 31) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>31, "title"=>"Cookley", "created_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "local_path"=>"http://hansen.com/dangelo"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "job"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "job"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Job"], ["category_id", 31], ["slug", "job"], ["created_at", "2017-07-28 07:35:49.252838"], ["updated_at", "2017-07-28 07:35:49.252838"], ["layout_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "brady"], ["email", "sallie@fadel.net"], ["password", "AsXk4tUe"], ["created_at", "2017-07-28 07:35:49.257743"], ["updated_at", "2017-07-28 07:35:49.257743"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "exercitationem_consequuntur"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Veribet"], ["phone", "567.189.2624"], ["address", "7513 Newell Passage"], ["url", "http://okon.info/rebeka.corkery"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ferryhauck.com/jeffrey"], ["auth_expiration_time", 900], ["slug", "exercitationem_consequuntur"], ["brand_id", 31], ["user_id", 46], ["created_at", "2017-07-28 07:35:49.263695"], ["updated_at", "2017-07-28 07:35:49.263695"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "cade.ratke"], ["email", "gennaro.thiel@baileyharber.name"], ["password", "4zO2H715NbEm1vZ0"], ["created_at", "2017-07-28 07:35:49.269030"], ["updated_at", "2017-07-28 07:35:49.269030"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5334"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5334"], ["comment", "comment 14"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "179.178.13.35"], ["router_admin_ip", "136.47.114.56"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "362"], ["status", "t"], ["location_id", 31], ["user_id", 47], ["created_at", "2017-07-28 07:35:49.274772"], ["updated_at", "2017-07-28 07:35:49.274772"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5334"], ["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 4], ["serial", "643705CA5E36/5334"], ["comment", "comment 14"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "179.178.13.35"], ["router_admin_ip", "136.47.114.56"], ["admin_password", "ca3b7a369180d45f"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "4"], ["status", "t"], ["location_id", 31], ["user_id", 47], ["created_at", "2017-07-28 07:35:49.274772"], ["updated_at", "2017-07-28 07:35:49.274772"], ["id", 4]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 01e5a77e-9d8f-4442-80d7-2e81f087e6dd) to Async(routers) with arguments: #<GlobalID:0x007fce25b60a58 @uri=#<URI::GID gid://wifi-management/Router/4>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 6e71c9e7-55e2-4843-8a1a-b2528a906cb7) to Async(routers) with arguments: #<GlobalID:0x007fce25b60a58 @uri=#<URI::GID gid://wifi-management/Router/4>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 4], ["provider", "instagram"], ["location_id", 30], ["router_id", 4], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "269-101-9814 x25951"], ["created_at", "2017-07-28 07:35:49.460187"], ["updated_at", "2017-07-28 07:35:49.460187"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "antonina"], ["email", "brennan.marquardt@bahringer.net"], ["password", "155xW2Rb137c"], ["created_at", "2017-07-28 07:35:49.465253"], ["updated_at", "2017-07-28 07:35:49.465253"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "966398"], ["username", "jamir_bogan"], ["image", "http://facebook.com/img/jamir_bogan.jpg"], ["profile", "https://facebook.com/jamir_bogan"], ["email", "ayden@beier.name"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 20], ["user_id", 48], ["created_at", "2017-07-28 07:35:49.469702"], ["updated_at", "2017-07-28 07:35:49.469702"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Konklab"], ["created_at", "2017-07-28 07:35:49.476934"], ["updated_at", "2017-07-28 07:35:49.476934"], ["local_path", "http://prohaska.io/maudie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "It"], ["title_ru", "Название32"], ["created_at", "2017-07-28 07:35:49.480794"], ["updated_at", "2017-07-28 07:35:49.480794"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 32[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_32[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 32) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>32, "title"=>"Konklab", "created_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "local_path"=>"http://prohaska.io/maudie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voltsillam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voltsillam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Voltsillam"], ["category_id", 32], ["slug", "voltsillam"], ["created_at", "2017-07-28 07:35:49.492390"], ["updated_at", "2017-07-28 07:35:49.492390"], ["layout_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quo_consectetur"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Domainer"], ["phone", "(862) 629-3627"], ["address", "4701 Herzog Knolls"], ["url", "http://blick.biz/marcelina"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://lemke.net/torrey.mitchell"], ["auth_expiration_time", 900], ["slug", "quo_consectetur"], ["brand_id", 32], ["user_id", 48], ["created_at", "2017-07-28 07:35:49.498563"], ["updated_at", "2017-07-28 07:35:49.498563"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tin"], ["created_at", "2017-07-28 07:35:49.507418"], ["updated_at", "2017-07-28 07:35:49.507418"], ["local_path", "http://hermandavis.net/bret.cremin"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Biodex"], ["title_ru", "Название33"], ["created_at", "2017-07-28 07:35:49.511188"], ["updated_at", "2017-07-28 07:35:49.511188"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 33[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_33[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 33) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>33, "title"=>"Tin", "created_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "local_path"=>"http://hermandavis.net/bret.cremin"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "lotstring"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "lotstring"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Lotstring"], ["category_id", 33], ["slug", "lotstring"], ["created_at", "2017-07-28 07:35:49.522412"], ["updated_at", "2017-07-28 07:35:49.522412"], ["layout_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "eladio.beahan"], ["email", "liliane@leuschke.org"], ["password", "BcXvSxQa0v"], ["created_at", "2017-07-28 07:35:49.527110"], ["updated_at", "2017-07-28 07:35:49.527110"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "exercitationem_cupiditate"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Greenlam"], ["phone", "(391) 745-9125"], ["address", "755 Conroy Manors"], ["url", "http://tillmanflatley.io/efren.simonis"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kulaskonopelski.biz/titus"], ["auth_expiration_time", 900], ["slug", "exercitationem_cupiditate"], ["brand_id", 33], ["user_id", 49], ["created_at", "2017-07-28 07:35:49.533072"], ["updated_at", "2017-07-28 07:35:49.533072"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "oda"], ["email", "armando@kirlin.net"], ["password", "3o92StWiKm8q3gK"], ["created_at", "2017-07-28 07:35:49.538590"], ["updated_at", "2017-07-28 07:35:49.538590"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5335"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5335"], ["comment", "comment 15"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "220.150.102.238"], ["router_admin_ip", "49.241.6.76"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "320"], ["status", "t"], ["location_id", 33], ["user_id", 50], ["created_at", "2017-07-28 07:35:49.544406"], ["updated_at", "2017-07-28 07:35:49.544406"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5335"], ["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 5], ["serial", "643705CA5E36/5335"], ["comment", "comment 15"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "220.150.102.238"], ["router_admin_ip", "49.241.6.76"], ["admin_password", "eb713b762c56dd93"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "5"], ["status", "t"], ["location_id", 33], ["user_id", 50], ["created_at", "2017-07-28 07:35:49.544406"], ["updated_at", "2017-07-28 07:35:49.544406"], ["id", 5]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 9d65a185-5ddb-486b-84a1-f6adc586bbe7) to Async(routers) with arguments: #<GlobalID:0x007fce1fa40a20 @uri=#<URI::GID gid://wifi-management/Router/5>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: ee97748b-0f89-49ad-9bb3-0c0530677cf5) to Async(routers) with arguments: #<GlobalID:0x007fce1fa40a20 @uri=#<URI::GID gid://wifi-management/Router/5>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 5], ["provider", "instagram"], ["location_id", 32], ["router_id", 5], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:49 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"antonina", "email"=>"brennan.marquardt@bahringer.net", "password"=>"155xW2Rb137c", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"antonina", :email=>"brennan.marquardt@bahringer.net", :password=>"155xW2Rb137c", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"brennan.marquardt@bahringer.net", "password"=>"155xW2Rb137c"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "antonina"], ["email", "brennan.marquardt@bahringer.net"], ["password", "155xW2Rb137c"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 48, username: "antonina", email: "brennan.marquardt@bahringer.net", password: "155xW2Rb137c", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:35:49", updated_at: "2017-07-28 07:35:49", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 48[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/locations_list" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:49 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#locations_list[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_48[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 48) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>48, "username"=>"antonina", "email"=>"brennan.marquardt@bahringer.net", "password"=>"155xW2Rb137c", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"locations_list"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_48[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_48[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>48, :username=>"antonina", :email=>"brennan.marquardt@bahringer.net", :password=>"155xW2Rb137c", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:35:49.465Z", :updated_at=>"2017-07-28T07:35:49.465Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 48[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Load (0.8ms)[0m  [1m[34mSELECT "locations".* FROM "locations" WHERE "locations"."user_id" = 48[0m
[INFO ] Completed [32m200 OK[0m in 23ms [30m(Views: 0.2ms | ActiveRecord: 5.4ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "965.063.2148 x3400"], ["created_at", "2017-07-28 07:35:49.653747"], ["updated_at", "2017-07-28 07:35:49.653747"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "kaylie.stanton"], ["email", "jacquelyn@gerhold.com"], ["password", "4pDvLxP8CvF6MrZ"], ["created_at", "2017-07-28 07:35:49.658706"], ["updated_at", "2017-07-28 07:35:49.658706"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "404396"], ["username", "samir_tremblay"], ["image", "http://twitter.com/img/samir_tremblay.jpg"], ["profile", "https://twitter.com/samir_tremblay"], ["email", "eldridge@prosacco.net"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 21], ["user_id", 51], ["created_at", "2017-07-28 07:35:49.662876"], ["updated_at", "2017-07-28 07:35:49.662876"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tresom"], ["created_at", "2017-07-28 07:35:49.670361"], ["updated_at", "2017-07-28 07:35:49.670361"], ["local_path", "http://krajcik.org/clark"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Latlux"], ["title_ru", "Название34"], ["created_at", "2017-07-28 07:35:49.674218"], ["updated_at", "2017-07-28 07:35:49.674218"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 34[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_34[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 34) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>34, "title"=>"Tresom", "created_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "local_path"=>"http://krajcik.org/clark"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cardify"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cardify"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Cardify"], ["category_id", 34], ["slug", "cardify"], ["created_at", "2017-07-28 07:35:49.685881"], ["updated_at", "2017-07-28 07:35:49.685881"], ["layout_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ipsa_error"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Home Ing"], ["phone", "831-491-6333"], ["address", "7226 Dare Prairie"], ["url", "http://green.net/ford.klocko"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://quigley.co/norval"], ["auth_expiration_time", 900], ["slug", "ipsa_error"], ["brand_id", 34], ["user_id", 51], ["created_at", "2017-07-28 07:35:49.691787"], ["updated_at", "2017-07-28 07:35:49.691787"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Daltfresh"], ["created_at", "2017-07-28 07:35:49.699940"], ["updated_at", "2017-07-28 07:35:49.699940"], ["local_path", "http://daniel.net/hilton"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Sonair"], ["title_ru", "Название35"], ["created_at", "2017-07-28 07:35:49.703730"], ["updated_at", "2017-07-28 07:35:49.703730"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 35[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_35[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 35) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>35, "title"=>"Daltfresh", "created_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "local_path"=>"http://daniel.net/hilton"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "namfix"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "namfix"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Namfix"], ["category_id", 35], ["slug", "namfix"], ["created_at", "2017-07-28 07:35:49.714942"], ["updated_at", "2017-07-28 07:35:49.714942"], ["layout_id", 35]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "blake.bergstrom"], ["email", "dangelo@ratke.net"], ["password", "991zB83o0"], ["created_at", "2017-07-28 07:35:49.719855"], ["updated_at", "2017-07-28 07:35:49.719855"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptatem_perspiciatis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Regrant"], ["phone", "1-455-711-4561"], ["address", "855 Verner Garden"], ["url", "http://hayes.net/rose"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://christiansentrantow.io/darlene"], ["auth_expiration_time", 900], ["slug", "voluptatem_perspiciatis"], ["brand_id", 35], ["user_id", 52], ["created_at", "2017-07-28 07:35:49.726118"], ["updated_at", "2017-07-28 07:35:49.726118"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "emmanuel"], ["email", "genevieve@hyatt.net"], ["password", "Jp0jGbG7FlBv5g"], ["created_at", "2017-07-28 07:35:49.731524"], ["updated_at", "2017-07-28 07:35:49.731524"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5336"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5336"], ["comment", "comment 16"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "146.164.128.99"], ["router_admin_ip", "29.168.79.47"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "433"], ["status", "t"], ["location_id", 35], ["user_id", 53], ["created_at", "2017-07-28 07:35:49.737170"], ["updated_at", "2017-07-28 07:35:49.737170"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5336"], ["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 6], ["serial", "643705CA5E36/5336"], ["comment", "comment 16"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "146.164.128.99"], ["router_admin_ip", "29.168.79.47"], ["admin_password", "46a56428a79c8d2e"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "6"], ["status", "t"], ["location_id", 35], ["user_id", 53], ["created_at", "2017-07-28 07:35:49.737170"], ["updated_at", "2017-07-28 07:35:49.737170"], ["id", 6]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: a05d4b68-f70a-46a6-96a8-72fb328fcda9) to Async(routers) with arguments: #<GlobalID:0x007fce1cfc9350 @uri=#<URI::GID gid://wifi-management/Router/6>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: b95946ec-109b-48bc-a26f-216f00aec6b4) to Async(routers) with arguments: #<GlobalID:0x007fce1cfc9350 @uri=#<URI::GID gid://wifi-management/Router/6>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.4ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 6], ["provider", "instagram"], ["location_id", 34], ["router_id", 6], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:49 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"kaylie.stanton", "email"=>"jacquelyn@gerhold.com", "password"=>"4pDvLxP8CvF6MrZ", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"kaylie.stanton", :email=>"jacquelyn@gerhold.com", :password=>"4pDvLxP8CvF6MrZ", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"jacquelyn@gerhold.com", "password"=>"4pDvLxP8CvF6MrZ"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "kaylie.stanton"], ["email", "jacquelyn@gerhold.com"], ["password", "4pDvLxP8CvF6MrZ"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 51, username: "kaylie.stanton", email: "jacquelyn@gerhold.com", password: "4pDvLxP8CvF6MrZ", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:35:49", updated_at: "2017-07-28 07:35:49", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 51[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/all_connects" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:49 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#all_connects[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_51[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 51) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>51, "username"=>"kaylie.stanton", "email"=>"jacquelyn@gerhold.com", "password"=>"4pDvLxP8CvF6MrZ", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"all_connects"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_51[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_51[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>51, :username=>"kaylie.stanton", :email=>"jacquelyn@gerhold.com", :password=>"4pDvLxP8CvF6MrZ", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:35:49.658Z", :updated_at=>"2017-07-28T07:35:49.658Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 51[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 34[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 34 AND ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-06-28 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 34 AND ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 26ms [30m(Views: 0.2ms | ActiveRecord: 7.1ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(431) 823-7335 x26845"], ["created_at", "2017-07-28 07:35:49.910355"], ["updated_at", "2017-07-28 07:35:49.910355"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "kari_kub"], ["email", "berenice.johns@gleichnergottlieb.co"], ["password", "6b65S2QcY"], ["created_at", "2017-07-28 07:35:49.915378"], ["updated_at", "2017-07-28 07:35:49.915378"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "37422"], ["username", "mortimer"], ["image", "http://facebook.com/img/mortimer.jpg"], ["profile", "https://facebook.com/mortimer"], ["email", "jonas@kuvalis.com"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 22], ["user_id", 54], ["created_at", "2017-07-28 07:35:49.920231"], ["updated_at", "2017-07-28 07:35:49.920231"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Quo Lux"], ["created_at", "2017-07-28 07:35:49.927564"], ["updated_at", "2017-07-28 07:35:49.927564"], ["local_path", "http://nitzsche.com/finn"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Greenlam"], ["title_ru", "Название36"], ["created_at", "2017-07-28 07:35:49.931518"], ["updated_at", "2017-07-28 07:35:49.931518"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_36[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 36) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>36, "title"=>"Quo Lux", "created_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "local_path"=>"http://nitzsche.com/finn"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cardguard"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cardguard"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Cardguard"], ["category_id", 36], ["slug", "cardguard"], ["created_at", "2017-07-28 07:35:49.943236"], ["updated_at", "2017-07-28 07:35:49.943236"], ["layout_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quaerat_velit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Fixflex"], ["phone", "333-276-3912"], ["address", "328 Durgan Mountains"], ["url", "http://herzogdavis.co/reginald"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://gibson.name/carlotta"], ["auth_expiration_time", 900], ["slug", "quaerat_velit"], ["brand_id", 36], ["user_id", 54], ["created_at", "2017-07-28 07:35:49.949541"], ["updated_at", "2017-07-28 07:35:49.949541"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Matsoft"], ["created_at", "2017-07-28 07:35:49.958568"], ["updated_at", "2017-07-28 07:35:49.958568"], ["local_path", "http://wilkinson.info/stone"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Span"], ["title_ru", "Название37"], ["created_at", "2017-07-28 07:35:49.962472"], ["updated_at", "2017-07-28 07:35:49.962472"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 37[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_37[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 37) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>37, "title"=>"Matsoft", "created_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "local_path"=>"http://wilkinson.info/stone"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tempsoft"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tempsoft"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tempsoft"], ["category_id", 37], ["slug", "tempsoft"], ["created_at", "2017-07-28 07:35:49.974072"], ["updated_at", "2017-07-28 07:35:49.974072"], ["layout_id", 37]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "geovanny.witting"], ["email", "tremaine.huel@torphy.org"], ["password", "TnWzUc0sZ"], ["created_at", "2017-07-28 07:35:49.978909"], ["updated_at", "2017-07-28 07:35:49.978909"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "consequatur_at"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Aerified"], ["phone", "1-805-704-9197"], ["address", "3648 Thompson Forest"], ["url", "http://kozey.co/blake_quitzon"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://herzog.co/maureen"], ["auth_expiration_time", 900], ["slug", "consequatur_at"], ["brand_id", 37], ["user_id", 55], ["created_at", "2017-07-28 07:35:49.984922"], ["updated_at", "2017-07-28 07:35:49.984922"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "germaine.mann"], ["email", "cordell.legros@smith.org"], ["password", "Er48U3HlM86"], ["created_at", "2017-07-28 07:35:49.990246"], ["updated_at", "2017-07-28 07:35:49.990246"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5337"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5337"], ["comment", "comment 17"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "200.46.73.252"], ["router_admin_ip", "156.158.150.64"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "637"], ["status", "t"], ["location_id", 37], ["user_id", 56], ["created_at", "2017-07-28 07:35:49.996138"], ["updated_at", "2017-07-28 07:35:49.996138"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5337"], ["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 7], ["serial", "643705CA5E36/5337"], ["comment", "comment 17"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "200.46.73.252"], ["router_admin_ip", "156.158.150.64"], ["admin_password", "6ed094dd4a3ec369"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "7"], ["status", "t"], ["location_id", 37], ["user_id", 56], ["created_at", "2017-07-28 07:35:49.996138"], ["updated_at", "2017-07-28 07:35:49.996138"], ["id", 7]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: a3c055db-b499-4bf5-865b-571256d477cb) to Async(routers) with arguments: #<GlobalID:0x007fce1bfc4388 @uri=#<URI::GID gid://wifi-management/Router/7>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 41eb30bf-3abc-4a9a-8189-3a88279c5787) to Async(routers) with arguments: #<GlobalID:0x007fce1bfc4388 @uri=#<URI::GID gid://wifi-management/Router/7>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 7], ["provider", "instagram"], ["location_id", 36], ["router_id", 7], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:50 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"kari_kub", "email"=>"berenice.johns@gleichnergottlieb.co", "password"=>"6b65S2QcY", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"kari_kub", :email=>"berenice.johns@gleichnergottlieb.co", :password=>"6b65S2QcY", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"berenice.johns@gleichnergottlieb.co", "password"=>"6b65S2QcY"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "kari_kub"], ["email", "berenice.johns@gleichnergottlieb.co"], ["password", "6b65S2QcY"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 54, username: "kari_kub", email: "berenice.johns@gleichnergottlieb.co", password: "6b65S2QcY", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:35:49", updated_at: "2017-07-28 07:35:49", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 54[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.1ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/new_old_users_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:50 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#new_old_users_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_54[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 54) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>54, "username"=>"kari_kub", "email"=>"berenice.johns@gleichnergottlieb.co", "password"=>"6b65S2QcY", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:49 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"new_old_users_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_54[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_54[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>54, :username=>"kari_kub", :email=>"berenice.johns@gleichnergottlieb.co", :password=>"6b65S2QcY", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:35:49.915Z", :updated_at=>"2017-07-28T07:35:49.915Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 54[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.9ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" = 36 AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 38ms [30m(Views: 1.1ms | ActiveRecord: 11.8ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(996) 474-4185 x0106"], ["created_at", "2017-07-28 07:35:50.138570"], ["updated_at", "2017-07-28 07:35:50.138570"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "pete.crooks"], ["email", "janick_turcotte@eichmann.io"], ["password", "ZnU7Th6aEiNzXaIx"], ["created_at", "2017-07-28 07:35:50.143308"], ["updated_at", "2017-07-28 07:35:50.143308"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "297998"], ["username", "ivy_lakin"], ["image", "http://vk.com/img/ivy_lakin.jpg"], ["profile", "https://vk.com/ivy_lakin"], ["email", "izabella@lowe.info"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 23], ["user_id", 57], ["created_at", "2017-07-28 07:35:50.147540"], ["updated_at", "2017-07-28 07:35:50.147540"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Alpha"], ["created_at", "2017-07-28 07:35:50.154324"], ["updated_at", "2017-07-28 07:35:50.154324"], ["local_path", "http://champlinhane.org/darrell_torp"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Andalax"], ["title_ru", "Название38"], ["created_at", "2017-07-28 07:35:50.158190"], ["updated_at", "2017-07-28 07:35:50.158190"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 38[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_38[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 38) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>38, "title"=>"Alpha", "created_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "local_path"=>"http://champlinhane.org/darrell_torp"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "duobam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "duobam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Duobam"], ["category_id", 38], ["slug", "duobam"], ["created_at", "2017-07-28 07:35:50.169646"], ["updated_at", "2017-07-28 07:35:50.169646"], ["layout_id", 38]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "dolore-perspiciatis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Ronstring"], ["phone", "964-710-1919"], ["address", "92565 Merle Streets"], ["url", "http://damore.co/octavia"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://cronin.org/dorian"], ["auth_expiration_time", 900], ["slug", "dolore-perspiciatis"], ["brand_id", 38], ["user_id", 57], ["created_at", "2017-07-28 07:35:50.175540"], ["updated_at", "2017-07-28 07:35:50.175540"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Sonsing"], ["created_at", "2017-07-28 07:35:50.183428"], ["updated_at", "2017-07-28 07:35:50.183428"], ["local_path", "http://schmeler.org/malvina"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Asoka"], ["title_ru", "Название39"], ["created_at", "2017-07-28 07:35:50.187190"], ["updated_at", "2017-07-28 07:35:50.187190"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_39[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 39) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>39, "title"=>"Sonsing", "created_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "local_path"=>"http://schmeler.org/malvina"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "holdlamis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "holdlamis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Holdlamis"], ["category_id", 39], ["slug", "holdlamis"], ["created_at", "2017-07-28 07:35:50.198161"], ["updated_at", "2017-07-28 07:35:50.198161"], ["layout_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "claria"], ["email", "vita@pfeffercummerata.name"], ["password", "0qA5HxZiYdYbPzC"], ["created_at", "2017-07-28 07:35:50.202832"], ["updated_at", "2017-07-28 07:35:50.202832"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "dolore.adipisci"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Aerified"], ["phone", "1-914-089-5621"], ["address", "32472 Ziemann Corners"], ["url", "http://tremblay.io/martin.upton"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://bodelarkin.biz/fatima_paucek"], ["auth_expiration_time", 900], ["slug", "dolore.adipisci"], ["brand_id", 39], ["user_id", 58], ["created_at", "2017-07-28 07:35:50.208652"], ["updated_at", "2017-07-28 07:35:50.208652"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "gloria"], ["email", "xzavier@bernhard.net"], ["password", "AoRqHlFdZhRnJfNp"], ["created_at", "2017-07-28 07:35:50.214088"], ["updated_at", "2017-07-28 07:35:50.214088"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5338"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5338"], ["comment", "comment 18"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "193.84.58.249"], ["router_admin_ip", "107.83.230.155"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "381"], ["status", "t"], ["location_id", 39], ["user_id", 59], ["created_at", "2017-07-28 07:35:50.219722"], ["updated_at", "2017-07-28 07:35:50.219722"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5338"], ["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 8], ["serial", "643705CA5E36/5338"], ["comment", "comment 18"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "193.84.58.249"], ["router_admin_ip", "107.83.230.155"], ["admin_password", "927f73c87e415dfc"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "8"], ["status", "t"], ["location_id", 39], ["user_id", 59], ["created_at", "2017-07-28 07:35:50.219722"], ["updated_at", "2017-07-28 07:35:50.219722"], ["id", 8]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: af376d16-2103-4cb7-bfb7-3804af8a84fa) to Async(routers) with arguments: #<GlobalID:0x007fce26f1cb28 @uri=#<URI::GID gid://wifi-management/Router/8>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 61dd7639-4c2a-4554-ac52-81babf064851) to Async(routers) with arguments: #<GlobalID:0x007fce26f1cb28 @uri=#<URI::GID gid://wifi-management/Router/8>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 8], ["provider", "instagram"], ["location_id", 38], ["router_id", 8], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:50 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"pete.crooks", "email"=>"janick_turcotte@eichmann.io", "password"=>"ZnU7Th6aEiNzXaIx", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"pete.crooks", :email=>"janick_turcotte@eichmann.io", :password=>"ZnU7Th6aEiNzXaIx", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"janick_turcotte@eichmann.io", "password"=>"ZnU7Th6aEiNzXaIx"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "pete.crooks"], ["email", "janick_turcotte@eichmann.io"], ["password", "ZnU7Th6aEiNzXaIx"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 57, username: "pete.crooks", email: "janick_turcotte@eichmann.io", password: "ZnU7Th6aEiNzXaIx", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:35:50", updated_at: "2017-07-28 07:35:50", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 57[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/visitors_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:50 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#visitors_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_57[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 57) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>57, "username"=>"pete.crooks", "email"=>"janick_turcotte@eichmann.io", "password"=>"ZnU7Th6aEiNzXaIx", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"visitors_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_57[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_57[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>57, :username=>"pete.crooks", :email=>"janick_turcotte@eichmann.io", :password=>"ZnU7Th6aEiNzXaIx", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:35:50.143Z", :updated_at=>"2017-07-28T07:35:50.143Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 57[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.0ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" = 38 AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 38ms [30m(Views: 14.6ms | ActiveRecord: 6.6ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-822-402-8089 x4167"], ["created_at", "2017-07-28 07:35:50.460203"], ["updated_at", "2017-07-28 07:35:50.460203"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "leopold.funk"], ["email", "alvah@gerhold.info"], ["password", "3wF7QnK172VvG"], ["created_at", "2017-07-28 07:35:50.465150"], ["updated_at", "2017-07-28 07:35:50.465150"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "315345"], ["username", "jack.herzog"], ["image", "http://vk.com/img/jack.herzog.jpg"], ["profile", "https://vk.com/jack.herzog"], ["email", "herbert@purdy.co"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 24], ["user_id", 60], ["created_at", "2017-07-28 07:35:50.469664"], ["updated_at", "2017-07-28 07:35:50.469664"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Regrant"], ["created_at", "2017-07-28 07:35:50.476991"], ["updated_at", "2017-07-28 07:35:50.476991"], ["local_path", "http://wunsch.com/jaiden"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Vagram"], ["title_ru", "Название40"], ["created_at", "2017-07-28 07:35:50.480908"], ["updated_at", "2017-07-28 07:35:50.480908"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 40[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_40[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 40) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>40, "title"=>"Regrant", "created_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "local_path"=>"http://wunsch.com/jaiden"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tampflex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tampflex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tampflex"], ["category_id", 40], ["slug", "tampflex"], ["created_at", "2017-07-28 07:35:50.492799"], ["updated_at", "2017-07-28 07:35:50.492799"], ["layout_id", 40]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "rerum-ex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Veribet"], ["phone", "123-289-5341"], ["address", "3146 Sammie Overpass"], ["url", "http://bednar.name/ruthe"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://olson.com/gabriella_macgyver"], ["auth_expiration_time", 900], ["slug", "rerum-ex"], ["brand_id", 40], ["user_id", 60], ["created_at", "2017-07-28 07:35:50.499113"], ["updated_at", "2017-07-28 07:35:50.499113"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Stronghold"], ["created_at", "2017-07-28 07:35:50.507358"], ["updated_at", "2017-07-28 07:35:50.507358"], ["local_path", "http://langworth.org/robyn"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Cookley"], ["title_ru", "Название41"], ["created_at", "2017-07-28 07:35:50.511322"], ["updated_at", "2017-07-28 07:35:50.511322"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 41[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_41[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 41) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>41, "title"=>"Stronghold", "created_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "local_path"=>"http://langworth.org/robyn"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zontrax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zontrax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zontrax"], ["category_id", 41], ["slug", "zontrax"], ["created_at", "2017-07-28 07:35:50.522401"], ["updated_at", "2017-07-28 07:35:50.522401"], ["layout_id", 41]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "samantha_smitham"], ["email", "austin_turcotte@hirthe.io"], ["password", "4d62A6479"], ["created_at", "2017-07-28 07:35:50.527134"], ["updated_at", "2017-07-28 07:35:50.527134"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "laboriosam_officiis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Cookley"], ["phone", "265.938.3321"], ["address", "230 Hintz Row"], ["url", "http://bashirian.biz/briana_hickle"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hudson.net/sherman"], ["auth_expiration_time", 900], ["slug", "laboriosam_officiis"], ["brand_id", 41], ["user_id", 61], ["created_at", "2017-07-28 07:35:50.533242"], ["updated_at", "2017-07-28 07:35:50.533242"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "melisa.mccullough"], ["email", "troy.brakus@macgyverbaumbach.co"], ["password", "Fl8dDzEoQ4Z5E0U"], ["created_at", "2017-07-28 07:35:50.538318"], ["updated_at", "2017-07-28 07:35:50.538318"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5339"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5339"], ["comment", "comment 19"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "253.4.18.82"], ["router_admin_ip", "149.199.246.159"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "456"], ["status", "t"], ["location_id", 41], ["user_id", 62], ["created_at", "2017-07-28 07:35:50.543976"], ["updated_at", "2017-07-28 07:35:50.543976"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5339"], ["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 9], ["serial", "643705CA5E36/5339"], ["comment", "comment 19"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "253.4.18.82"], ["router_admin_ip", "149.199.246.159"], ["admin_password", "e677094f785716df"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "9"], ["status", "t"], ["location_id", 41], ["user_id", 62], ["created_at", "2017-07-28 07:35:50.543976"], ["updated_at", "2017-07-28 07:35:50.543976"], ["id", 9]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: c3a310ee-58e4-4bf4-a1fb-8bdae2df5aaa) to Async(routers) with arguments: #<GlobalID:0x007fce2340a008 @uri=#<URI::GID gid://wifi-management/Router/9>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 6ae69208-5302-4aef-8128-dc4bfc85758b) to Async(routers) with arguments: #<GlobalID:0x007fce2340a008 @uri=#<URI::GID gid://wifi-management/Router/9>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 9], ["provider", "instagram"], ["location_id", 40], ["router_id", 9], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-765-746-2067 x1285"], ["created_at", "2017-07-28 07:35:50.744465"], ["updated_at", "2017-07-28 07:35:50.744465"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "wilfred"], ["email", "antonietta_borer@okuneva.com"], ["password", "E0KmT81cZtKq3"], ["created_at", "2017-07-28 07:35:50.749511"], ["updated_at", "2017-07-28 07:35:50.749511"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "925091"], ["username", "odea_dubuque"], ["image", "http://vk.com/img/odea_dubuque.jpg"], ["profile", "https://vk.com/odea_dubuque"], ["email", "joey_stracke@deckowbrekke.org"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 25], ["user_id", 63], ["created_at", "2017-07-28 07:35:50.753806"], ["updated_at", "2017-07-28 07:35:50.753806"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Stronghold"], ["created_at", "2017-07-28 07:35:50.761373"], ["updated_at", "2017-07-28 07:35:50.761373"], ["local_path", "http://moriettemckenzie.co/leland"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Stronghold"], ["title_ru", "Название42"], ["created_at", "2017-07-28 07:35:50.765112"], ["updated_at", "2017-07-28 07:35:50.765112"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_42[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 42) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>42, "title"=>"Stronghold", "created_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "local_path"=>"http://moriettemckenzie.co/leland"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "prodder"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "prodder"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Prodder"], ["category_id", 42], ["slug", "prodder"], ["created_at", "2017-07-28 07:35:50.776748"], ["updated_at", "2017-07-28 07:35:50.776748"], ["layout_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "sit-voluptas"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Alpha"], ["phone", "517-238-6013"], ["address", "23935 Hirthe Cliffs"], ["url", "http://emard.net/brandyn_vonrueden"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://rau.info/dean"], ["auth_expiration_time", 900], ["slug", "sit-voluptas"], ["brand_id", 42], ["user_id", 63], ["created_at", "2017-07-28 07:35:50.783357"], ["updated_at", "2017-07-28 07:35:50.783357"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Span"], ["created_at", "2017-07-28 07:35:50.791872"], ["updated_at", "2017-07-28 07:35:50.791872"], ["local_path", "http://stiedemannlangworth.info/brandon_satterfield"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Lotlux"], ["title_ru", "Название43"], ["created_at", "2017-07-28 07:35:50.796024"], ["updated_at", "2017-07-28 07:35:50.796024"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 43[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_43[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 43) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>43, "title"=>"Span", "created_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "local_path"=>"http://stiedemannlangworth.info/brandon_satterfield"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cookley"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cookley"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Cookley"], ["category_id", 43], ["slug", "cookley"], ["created_at", "2017-07-28 07:35:50.807633"], ["updated_at", "2017-07-28 07:35:50.807633"], ["layout_id", 43]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "marcelina.welch"], ["email", "eulalia@kilback.org"], ["password", "30GyRc1sSw0r4c"], ["created_at", "2017-07-28 07:35:50.812526"], ["updated_at", "2017-07-28 07:35:50.812526"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "doloremque_assumenda"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Konklab"], ["phone", "1-891-997-3046"], ["address", "4998 Erdman Drive"], ["url", "http://oconner.io/bud"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://greenholt.info/shirley"], ["auth_expiration_time", 900], ["slug", "doloremque_assumenda"], ["brand_id", 43], ["user_id", 64], ["created_at", "2017-07-28 07:35:50.818904"], ["updated_at", "2017-07-28 07:35:50.818904"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jean.mayer"], ["email", "griffin@tremblay.co"], ["password", "J0E06w1g"], ["created_at", "2017-07-28 07:35:50.824257"], ["updated_at", "2017-07-28 07:35:50.824257"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53310"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53310"], ["comment", "comment 110"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "45.252.167.189"], ["router_admin_ip", "95.251.47.146"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "118"], ["status", "t"], ["location_id", 43], ["user_id", 65], ["created_at", "2017-07-28 07:35:50.830124"], ["updated_at", "2017-07-28 07:35:50.830124"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53310"], ["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 10], ["serial", "643705CA5E36/53310"], ["comment", "comment 110"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "45.252.167.189"], ["router_admin_ip", "95.251.47.146"], ["admin_password", "3a081433ec1f1915"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "10"], ["status", "t"], ["location_id", 43], ["user_id", 65], ["created_at", "2017-07-28 07:35:50.830124"], ["updated_at", "2017-07-28 07:35:50.830124"], ["id", 10]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: bf172014-efa9-40ad-bebf-ad3762a92400) to Async(routers) with arguments: #<GlobalID:0x007fce26fc5b10 @uri=#<URI::GID gid://wifi-management/Router/10>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: f38afaa9-f809-44d8-b1bf-59a57d28ccac) to Async(routers) with arguments: #<GlobalID:0x007fce26fc5b10 @uri=#<URI::GID gid://wifi-management/Router/10>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.4ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 10], ["provider", "instagram"], ["location_id", 42], ["router_id", 10], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:50 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"wilfred", "email"=>"antonietta_borer@okuneva.com", "password"=>"E0KmT81cZtKq3", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"wilfred", :email=>"antonietta_borer@okuneva.com", :password=>"E0KmT81cZtKq3", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"antonietta_borer@okuneva.com", "password"=>"E0KmT81cZtKq3"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "wilfred"], ["email", "antonietta_borer@okuneva.com"], ["password", "E0KmT81cZtKq3"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 63, username: "wilfred", email: "antonietta_borer@okuneva.com", password: "E0KmT81cZtKq3", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:35:50", updated_at: "2017-07-28 07:35:50", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 63[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/age_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:50 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#age_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 63[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_63[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 63) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>63, "username"=>"wilfred", "email"=>"antonietta_borer@okuneva.com", "password"=>"E0KmT81cZtKq3", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"age_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 63[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_63[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 63[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_63[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>63, :username=>"wilfred", :email=>"antonietta_borer@okuneva.com", :password=>"E0KmT81cZtKq3", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:35:50.749Z", :updated_at=>"2017-07-28T07:35:50.749Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 63[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.6ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(42) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 25ms [30m(Views: 1.3ms | ActiveRecord: 7.3ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-793-692-7165"], ["created_at", "2017-07-28 07:35:50.939612"], ["updated_at", "2017-07-28 07:35:50.939612"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "katelin.hauck"], ["email", "jacey_hoeger@rippin.biz"], ["password", "8oHhCnTv0"], ["created_at", "2017-07-28 07:35:50.944370"], ["updated_at", "2017-07-28 07:35:50.944370"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "867769"], ["username", "estella"], ["image", "http://vk.com/img/estella.jpg"], ["profile", "https://vk.com/estella"], ["email", "gerry@tremblay.co"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 26], ["user_id", 66], ["created_at", "2017-07-28 07:35:50.948707"], ["updated_at", "2017-07-28 07:35:50.948707"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Sub-Ex"], ["created_at", "2017-07-28 07:35:50.955823"], ["updated_at", "2017-07-28 07:35:50.955823"], ["local_path", "http://conn.io/kaandra_kovacek"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Andalax"], ["title_ru", "Название44"], ["created_at", "2017-07-28 07:35:50.959652"], ["updated_at", "2017-07-28 07:35:50.959652"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 44[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_44[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 44) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>44, "title"=>"Sub-Ex", "created_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "local_path"=>"http://conn.io/kaandra_kovacek"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "prodder"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "prodder"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Prodder"], ["category_id", 44], ["slug", "prodder"], ["created_at", "2017-07-28 07:35:50.971218"], ["updated_at", "2017-07-28 07:35:50.971218"], ["layout_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "est_esse"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Wrapsafe"], ["phone", "1-420-516-8576"], ["address", "9153 Jess Route"], ["url", "http://koeppkling.org/elvis"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://krisward.name/maudie_beatty"], ["auth_expiration_time", 900], ["slug", "est_esse"], ["brand_id", 44], ["user_id", 66], ["created_at", "2017-07-28 07:35:50.977322"], ["updated_at", "2017-07-28 07:35:50.977322"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Temp"], ["created_at", "2017-07-28 07:35:50.985542"], ["updated_at", "2017-07-28 07:35:50.985542"], ["local_path", "http://connaufderhar.io/caitlyn.dare"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Tampflex"], ["title_ru", "Название45"], ["created_at", "2017-07-28 07:35:50.989168"], ["updated_at", "2017-07-28 07:35:50.989168"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 45[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_45[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 45) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>45, "title"=>"Temp", "created_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "local_path"=>"http://connaufderhar.io/caitlyn.dare"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "it"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "it"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "It"], ["category_id", 45], ["slug", "it"], ["created_at", "2017-07-28 07:35:51.000121"], ["updated_at", "2017-07-28 07:35:51.000121"], ["layout_id", 45]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "marlin_buckridge"], ["email", "favian_champlin@ratke.net"], ["password", "O2Y0F17iP4Fe"], ["created_at", "2017-07-28 07:35:51.004965"], ["updated_at", "2017-07-28 07:35:51.004965"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et-odio"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zamit"], ["phone", "1-890-369-9856"], ["address", "93851 Cole Cove"], ["url", "http://pouroscollins.com/wilma_hayes"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://lehnerprosacco.net/audrey"], ["auth_expiration_time", 900], ["slug", "et-odio"], ["brand_id", 45], ["user_id", 67], ["created_at", "2017-07-28 07:35:51.010963"], ["updated_at", "2017-07-28 07:35:51.010963"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "kiley_considine"], ["email", "cathy_wuckert@stracke.org"], ["password", "En1iCmEiMc5f"], ["created_at", "2017-07-28 07:35:51.016245"], ["updated_at", "2017-07-28 07:35:51.016245"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53311"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53311"], ["comment", "comment 111"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "31.199.251.52"], ["router_admin_ip", "200.176.90.119"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "998"], ["status", "t"], ["location_id", 45], ["user_id", 68], ["created_at", "2017-07-28 07:35:51.022072"], ["updated_at", "2017-07-28 07:35:51.022072"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53311"], ["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 11], ["serial", "643705CA5E36/53311"], ["comment", "comment 111"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "31.199.251.52"], ["router_admin_ip", "200.176.90.119"], ["admin_password", "751b5bb4a7cd45cf"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "11"], ["status", "t"], ["location_id", 45], ["user_id", 68], ["created_at", "2017-07-28 07:35:51.022072"], ["updated_at", "2017-07-28 07:35:51.022072"], ["id", 11]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 27e01477-7ba7-4025-9b45-4e7475269524) to Async(routers) with arguments: #<GlobalID:0x007fce1fbbc0c0 @uri=#<URI::GID gid://wifi-management/Router/11>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 44878956-3e4b-4c83-bb24-9bbc4bb3e786) to Async(routers) with arguments: #<GlobalID:0x007fce1fbbc0c0 @uri=#<URI::GID gid://wifi-management/Router/11>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 11], ["provider", "instagram"], ["location_id", 44], ["router_id", 11], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:51 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"katelin.hauck", "email"=>"jacey_hoeger@rippin.biz", "password"=>"8oHhCnTv0", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"katelin.hauck", :email=>"jacey_hoeger@rippin.biz", :password=>"8oHhCnTv0", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"jacey_hoeger@rippin.biz", "password"=>"8oHhCnTv0"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "katelin.hauck"], ["email", "jacey_hoeger@rippin.biz"], ["password", "8oHhCnTv0"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 66, username: "katelin.hauck", email: "jacey_hoeger@rippin.biz", password: "8oHhCnTv0", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:35:50", updated_at: "2017-07-28 07:35:50", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 66[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/gender_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:51 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#gender_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 66[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_66[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 66) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>66, "username"=>"katelin.hauck", "email"=>"jacey_hoeger@rippin.biz", "password"=>"8oHhCnTv0", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:50 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"gender_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 66[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_66[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 66[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_66[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>66, :username=>"katelin.hauck", :email=>"jacey_hoeger@rippin.biz", :password=>"8oHhCnTv0", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:35:50.944Z", :updated_at=>"2017-07-28T07:35:50.944Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 66[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.9ms)[0m  [1m[34mSELECT DISTINCT COUNT(DISTINCT social_accounts.id) AS count_social_accounts_id, "gender" AS gender FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" = 44 AND ("social_logs"."updated_at" BETWEEN $1 AND $2) GROUP BY "gender"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 24ms [30m(Views: 1.2ms | ActiveRecord: 6.0ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "981.441.9272 x0991"], ["created_at", "2017-07-28 07:35:51.146783"], ["updated_at", "2017-07-28 07:35:51.146783"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "wilhelmine"], ["email", "sigurd_wintheiser@lynch.com"], ["password", "N7B2Gm2r4m3e0d4"], ["created_at", "2017-07-28 07:35:51.151607"], ["updated_at", "2017-07-28 07:35:51.151607"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "832923"], ["username", "ellen"], ["image", "http://instagram.com/img/ellen.jpg"], ["profile", "https://instagram.com/ellen"], ["email", "merle@barton.org"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 27], ["user_id", 69], ["created_at", "2017-07-28 07:35:51.156110"], ["updated_at", "2017-07-28 07:35:51.156110"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Sonair"], ["created_at", "2017-07-28 07:35:51.163522"], ["updated_at", "2017-07-28 07:35:51.163522"], ["local_path", "http://schillerrippin.name/lowell"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Stringtough"], ["title_ru", "Название46"], ["created_at", "2017-07-28 07:35:51.167366"], ["updated_at", "2017-07-28 07:35:51.167366"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 46[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_46[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 46) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>46, "title"=>"Sonair", "created_at"=>Fri, 28 Jul 2017 07:35:51 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:51 UTC +00:00, "local_path"=>"http://schillerrippin.name/lowell"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "regrant"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "regrant"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Regrant"], ["category_id", 46], ["slug", "regrant"], ["created_at", "2017-07-28 07:35:51.179357"], ["updated_at", "2017-07-28 07:35:51.179357"], ["layout_id", 46]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ullam_reiciendis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Fix San"], ["phone", "(608) 535-1907"], ["address", "725 Lindsey Radial"], ["url", "http://roob.io/hosea"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://gutkowski.net/levi"], ["auth_expiration_time", 900], ["slug", "ullam_reiciendis"], ["brand_id", 46], ["user_id", 69], ["created_at", "2017-07-28 07:35:51.185633"], ["updated_at", "2017-07-28 07:35:51.185633"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bitchip"], ["created_at", "2017-07-28 07:35:51.194127"], ["updated_at", "2017-07-28 07:35:51.194127"], ["local_path", "http://jones.net/nyah"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Regrant"], ["title_ru", "Название47"], ["created_at", "2017-07-28 07:35:51.198003"], ["updated_at", "2017-07-28 07:35:51.198003"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 47[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_47[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 47) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>47, "title"=>"Bitchip", "created_at"=>Fri, 28 Jul 2017 07:35:51 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:51 UTC +00:00, "local_path"=>"http://jones.net/nyah"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zaam-dox"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zaam-dox"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zaam-Dox"], ["category_id", 47], ["slug", "zaam-dox"], ["created_at", "2017-07-28 07:35:51.208907"], ["updated_at", "2017-07-28 07:35:51.208907"], ["layout_id", 47]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "aron"], ["email", "shaniya.gerlach@vandervort.com"], ["password", "OjDp0qLbE"], ["created_at", "2017-07-28 07:35:51.213789"], ["updated_at", "2017-07-28 07:35:51.213789"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "dolore.non"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Opela"], ["phone", "345-104-8052"], ["address", "433 Buckridge Locks"], ["url", "http://schuster.org/ayana"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://rath.org/makenzie"], ["auth_expiration_time", 900], ["slug", "dolore.non"], ["brand_id", 47], ["user_id", 70], ["created_at", "2017-07-28 07:35:51.219732"], ["updated_at", "2017-07-28 07:35:51.219732"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "vida"], ["email", "mariana.nienow@howellrenner.com"], ["password", "7xW9537vJa7f"], ["created_at", "2017-07-28 07:35:51.225050"], ["updated_at", "2017-07-28 07:35:51.225050"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53312"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53312"], ["comment", "comment 112"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "163.22.130.31"], ["router_admin_ip", "99.74.198.217"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "516"], ["status", "t"], ["location_id", 47], ["user_id", 71], ["created_at", "2017-07-28 07:35:51.230928"], ["updated_at", "2017-07-28 07:35:51.230928"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53312"], ["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 12], ["serial", "643705CA5E36/53312"], ["comment", "comment 112"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "163.22.130.31"], ["router_admin_ip", "99.74.198.217"], ["admin_password", "149c8c0f217390da"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "12"], ["status", "t"], ["location_id", 47], ["user_id", 71], ["created_at", "2017-07-28 07:35:51.230928"], ["updated_at", "2017-07-28 07:35:51.230928"], ["id", 12]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 5475c3fb-a93b-44a9-b889-840d5f4952c4) to Async(routers) with arguments: #<GlobalID:0x007fce27383310 @uri=#<URI::GID gid://wifi-management/Router/12>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 6126cfc4-7fc5-4a74-93df-61945fdb57a0) to Async(routers) with arguments: #<GlobalID:0x007fce27383310 @uri=#<URI::GID gid://wifi-management/Router/12>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 12], ["provider", "instagram"], ["location_id", 46], ["router_id", 12], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:51 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"wilhelmine", "email"=>"sigurd_wintheiser@lynch.com", "password"=>"N7B2Gm2r4m3e0d4", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"wilhelmine", :email=>"sigurd_wintheiser@lynch.com", :password=>"N7B2Gm2r4m3e0d4", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"sigurd_wintheiser@lynch.com", "password"=>"N7B2Gm2r4m3e0d4"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "wilhelmine"], ["email", "sigurd_wintheiser@lynch.com"], ["password", "N7B2Gm2r4m3e0d4"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 69, username: "wilhelmine", email: "sigurd_wintheiser@lynch.com", password: "N7B2Gm2r4m3e0d4", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:35:51", updated_at: "2017-07-28 07:35:51", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 69[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/new_old_users" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:51 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#new_old_users[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 69[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_69[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 69) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>69, "username"=>"wilhelmine", "email"=>"sigurd_wintheiser@lynch.com", "password"=>"N7B2Gm2r4m3e0d4", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:35:51 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:51 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"new_old_users"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 69[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_69[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 69[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_69[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>69, :username=>"wilhelmine", :email=>"sigurd_wintheiser@lynch.com", :password=>"N7B2Gm2r4m3e0d4", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:35:51.151Z", :updated_at=>"2017-07-28T07:35:51.151Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 69[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.8ms)[0m  [1m[34m
      select
        newusrs.chart_interval,
        ttlusrs.returning as returning_users,
        newusrs.new_users,
        ttlusrs.returning + newusrs.new_users as total
      from (select
          chart_interval,
          count (id) as new_users
        from (select
            distinct cl.id,
            date_trunc('day', dd)::date as chart_interval
          FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
          left outer join social_accounts sa on date_trunc('day', sa.created_at) = date_trunc('day', dd)
          left outer join clients cl on sa.client_id = cl.id
          join social_logs sl on sa.id = sl.social_account_id
            and location_id in(46)
      	  order by chart_interval) as chart
        group by chart_interval
        order by chart_interval
      ) as newusrs join (select
          date_trunc('day', dd):: date as chart_interval,
          count (distinct cl.id) as returning
        FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
        left outer join social_logs sl on date_trunc('day', sl.created_at) = date_trunc('day', dd)
          and location_id in(46)
        join social_accounts sa on sa.id = sl.social_account_id
        left outer join clients cl on date_trunc('day', cl.created_at) < date_trunc('day', dd)
          and sa.client_id = cl.id
        group by chart_interval
        order by chart_interval
      ) as ttlusrs on ttlusrs.chart_interval = newusrs.chart_interval[0m
[INFO ] Completed [32m200 OK[0m in 24ms [30m(Views: 0.6ms | ActiveRecord: 8.3ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-565-918-6698"], ["created_at", "2017-07-28 07:35:51.480201"], ["updated_at", "2017-07-28 07:35:51.480201"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "bart_haley"], ["email", "ahmed@runolfonlittle.co"], ["password", "P3U1DhIz8"], ["created_at", "2017-07-28 07:35:51.485037"], ["updated_at", "2017-07-28 07:35:51.485037"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "345494"], ["username", "eliane_grant"], ["image", "http://twitter.com/img/eliane_grant.jpg"], ["profile", "https://twitter.com/eliane_grant"], ["email", "cristopher@prohaska.org"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 28], ["user_id", 72], ["created_at", "2017-07-28 07:35:51.489324"], ["updated_at", "2017-07-28 07:35:51.489324"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Cardguard"], ["created_at", "2017-07-28 07:35:51.496366"], ["updated_at", "2017-07-28 07:35:51.496366"], ["local_path", "http://mcculloughkirlin.net/shyann.spinka"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fixflex"], ["title_ru", "Название48"], ["created_at", "2017-07-28 07:35:51.500653"], ["updated_at", "2017-07-28 07:35:51.500653"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_48[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 48) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>48, "title"=>"Cardguard", "created_at"=>Fri, 28 Jul 2017 07:35:51 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:51 UTC +00:00, "local_path"=>"http://mcculloughkirlin.net/shyann.spinka"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "ventosanzap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "ventosanzap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Ventosanzap"], ["category_id", 48], ["slug", "ventosanzap"], ["created_at", "2017-07-28 07:35:51.512502"], ["updated_at", "2017-07-28 07:35:51.512502"], ["layout_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "nihil.culpa"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Lotlux"], ["phone", "1-266-397-6030"], ["address", "7449 Tania Villages"], ["url", "http://will.biz/brian_goyette"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://schaden.info/jean"], ["auth_expiration_time", 900], ["slug", "nihil.culpa"], ["brand_id", 48], ["user_id", 72], ["created_at", "2017-07-28 07:35:51.518597"], ["updated_at", "2017-07-28 07:35:51.518597"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Stim"], ["created_at", "2017-07-28 07:35:51.527254"], ["updated_at", "2017-07-28 07:35:51.527254"], ["local_path", "http://goyette.org/ashley_pollich"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zoolab"], ["title_ru", "Название49"], ["created_at", "2017-07-28 07:35:51.531164"], ["updated_at", "2017-07-28 07:35:51.531164"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 49[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_49[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 49) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>49, "title"=>"Stim", "created_at"=>Fri, 28 Jul 2017 07:35:51 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:51 UTC +00:00, "local_path"=>"http://goyette.org/ashley_pollich"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bytecard"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bytecard"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bytecard"], ["category_id", 49], ["slug", "bytecard"], ["created_at", "2017-07-28 07:35:51.542367"], ["updated_at", "2017-07-28 07:35:51.542367"], ["layout_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ward.murazik"], ["email", "bill@hilll.name"], ["password", "KcDrGdIxX8"], ["created_at", "2017-07-28 07:35:51.547409"], ["updated_at", "2017-07-28 07:35:51.547409"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "in_veritatis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Y-Solowarm"], ["phone", "1-570-742-5899"], ["address", "811 Lueilwitz Way"], ["url", "http://collierskiles.org/carmel"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://bosco.co/raegan"], ["auth_expiration_time", 900], ["slug", "in_veritatis"], ["brand_id", 49], ["user_id", 73], ["created_at", "2017-07-28 07:35:51.553384"], ["updated_at", "2017-07-28 07:35:51.553384"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "alberta_kohler"], ["email", "norma@berge.com"], ["password", "D69gAnI0XeYh"], ["created_at", "2017-07-28 07:35:51.558717"], ["updated_at", "2017-07-28 07:35:51.558717"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53313"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53313"], ["comment", "comment 113"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "206.81.236.39"], ["router_admin_ip", "207.88.205.208"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "484"], ["status", "t"], ["location_id", 49], ["user_id", 74], ["created_at", "2017-07-28 07:35:51.564215"], ["updated_at", "2017-07-28 07:35:51.564215"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53313"], ["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 13], ["serial", "643705CA5E36/53313"], ["comment", "comment 113"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "206.81.236.39"], ["router_admin_ip", "207.88.205.208"], ["admin_password", "3b0fdd62dfff95ef"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "13"], ["status", "t"], ["location_id", 49], ["user_id", 74], ["created_at", "2017-07-28 07:35:51.564215"], ["updated_at", "2017-07-28 07:35:51.564215"], ["id", 13]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 44da9f89-1862-4656-bbfd-8886c2b8f4a8) to Async(routers) with arguments: #<GlobalID:0x007fce26d3faa8 @uri=#<URI::GID gid://wifi-management/Router/13>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: ff0cdc15-8c4a-4790-9e22-f5d784b215b1) to Async(routers) with arguments: #<GlobalID:0x007fce26d3faa8 @uri=#<URI::GID gid://wifi-management/Router/13>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.4ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 13], ["provider", "instagram"], ["location_id", 48], ["router_id", 13], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:52 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"bart_haley", "email"=>"ahmed@runolfonlittle.co", "password"=>"P3U1DhIz8", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"bart_haley", :email=>"ahmed@runolfonlittle.co", :password=>"P3U1DhIz8", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"ahmed@runolfonlittle.co", "password"=>"P3U1DhIz8"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "bart_haley"], ["email", "ahmed@runolfonlittle.co"], ["password", "P3U1DhIz8"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 72, username: "bart_haley", email: "ahmed@runolfonlittle.co", password: "P3U1DhIz8", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:35:51", updated_at: "2017-07-28 07:35:51", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 72[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/clients_count" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:52 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#clients_count[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 72[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_72[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 72) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>72, "username"=>"bart_haley", "email"=>"ahmed@runolfonlittle.co", "password"=>"P3U1DhIz8", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:35:51 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:51 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"clients_count"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 72[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_72[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 72[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_72[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>72, :username=>"bart_haley", :email=>"ahmed@runolfonlittle.co", :password=>"P3U1DhIz8", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:35:51.485Z", :updated_at=>"2017-07-28T07:35:51.485Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 72[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 48[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 48 AND ("client_visits"."updated_at" BETWEEN $1 AND $2)[0m  [["updated_at", "2017-06-28 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 48 AND ("client_visits"."updated_at" BETWEEN $1 AND $2)[0m  [["updated_at", "2017-07-21 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 26ms [30m(Views: 0.2ms | ActiveRecord: 7.8ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "368-481-9636 x4678"], ["created_at", "2017-07-28 07:35:52.063607"], ["updated_at", "2017-07-28 07:35:52.063607"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "syble"], ["email", "irma.cole@crona.io"], ["password", "3yRoK12pX"], ["created_at", "2017-07-28 07:35:52.068603"], ["updated_at", "2017-07-28 07:35:52.068603"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "88762"], ["username", "sophia"], ["image", "http://twitter.com/img/sophia.jpg"], ["profile", "https://twitter.com/sophia"], ["email", "grover@bradtkepaucek.com"], ["gender", "female"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 29], ["user_id", 75], ["created_at", "2017-07-28 07:35:52.072713"], ["updated_at", "2017-07-28 07:35:52.072713"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Aerified"], ["created_at", "2017-07-28 07:35:52.079672"], ["updated_at", "2017-07-28 07:35:52.079672"], ["local_path", "http://prohaskaklocko.co/shanelle"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Latlux"], ["title_ru", "Название50"], ["created_at", "2017-07-28 07:35:52.083352"], ["updated_at", "2017-07-28 07:35:52.083352"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 50[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_50[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 50) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>50, "title"=>"Aerified", "created_at"=>Fri, 28 Jul 2017 07:35:52 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:52 UTC +00:00, "local_path"=>"http://prohaskaklocko.co/shanelle"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Quo Lux"], ["category_id", 50], ["slug", "quo-lux"], ["created_at", "2017-07-28 07:35:52.094429"], ["updated_at", "2017-07-28 07:35:52.094429"], ["layout_id", 50]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "josianne"], ["email", "shawna@miller.co"], ["password", "7u6iSlWs"], ["created_at", "2017-07-28 07:35:52.099257"], ["updated_at", "2017-07-28 07:35:52.099257"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "sed_saepe"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bigtax"], ["phone", "148.170.6090"], ["address", "24646 Juanita Brooks"], ["url", "http://douglas.com/rene"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://bergnaumdare.org/sadie"], ["auth_expiration_time", 900], ["slug", "sed_saepe"], ["brand_id", 50], ["user_id", 76], ["created_at", "2017-07-28 07:35:52.104960"], ["updated_at", "2017-07-28 07:35:52.104960"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Redhold"], ["created_at", "2017-07-28 07:35:52.112441"], ["updated_at", "2017-07-28 07:35:52.112441"], ["local_path", "http://schroeder.info/jamar_quigley"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Konklab"], ["title_ru", "Название51"], ["created_at", "2017-07-28 07:35:52.115742"], ["updated_at", "2017-07-28 07:35:52.115742"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_51[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 51) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>51, "title"=>"Redhold", "created_at"=>Fri, 28 Jul 2017 07:35:52 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:52 UTC +00:00, "local_path"=>"http://schroeder.info/jamar_quigley"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "asoka"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "asoka"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Asoka"], ["category_id", 51], ["slug", "asoka"], ["created_at", "2017-07-28 07:35:52.126126"], ["updated_at", "2017-07-28 07:35:52.126126"], ["layout_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "bradley"], ["email", "dandre@macejkovic.co"], ["password", "25XaAm5mRv"], ["created_at", "2017-07-28 07:35:52.130980"], ["updated_at", "2017-07-28 07:35:52.130980"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "assumenda.perspiciatis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tresom"], ["phone", "(431) 976-0527"], ["address", "822 Terry Center"], ["url", "http://ortiz.info/edwardo.harber"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://dareokeefe.biz/lloyd"], ["auth_expiration_time", 900], ["slug", "assumenda.perspiciatis"], ["brand_id", 51], ["user_id", 77], ["created_at", "2017-07-28 07:35:52.137208"], ["updated_at", "2017-07-28 07:35:52.137208"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "elmo"], ["email", "carolina_mante@caingerhold.name"], ["password", "3dXjFgE9Jf"], ["created_at", "2017-07-28 07:35:52.142844"], ["updated_at", "2017-07-28 07:35:52.142844"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53314"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53314"], ["comment", "comment 114"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "97.41.3.202"], ["router_admin_ip", "37.169.247.63"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "947"], ["status", "t"], ["location_id", 51], ["user_id", 78], ["created_at", "2017-07-28 07:35:52.148692"], ["updated_at", "2017-07-28 07:35:52.148692"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (2.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53314"], ["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 14], ["serial", "643705CA5E36/53314"], ["comment", "comment 114"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "97.41.3.202"], ["router_admin_ip", "37.169.247.63"], ["admin_password", "601314d907c5a1ee"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "14"], ["status", "t"], ["location_id", 51], ["user_id", 78], ["created_at", "2017-07-28 07:35:52.148692"], ["updated_at", "2017-07-28 07:35:52.148692"], ["id", 14]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 915bb90f-7cf9-4a8e-982b-f284507d2dd1) to Async(routers) with arguments: #<GlobalID:0x007fce23194580 @uri=#<URI::GID gid://wifi-management/Router/14>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 1d7ddc56-c182-4dd6-893e-883b40820dbd) to Async(routers) with arguments: #<GlobalID:0x007fce23194580 @uri=#<URI::GID gid://wifi-management/Router/14>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 14], ["provider", "instagram"], ["location_id", 50], ["router_id", 14], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/totals" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:52 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#all_connections[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"all_connections"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-06-28 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(50, 51)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" IN (50, 51) AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.8ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(50, 51) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (4.1ms)[0m  [1m[34m
      select
        newusrs.chart_interval,
        ttlusrs.returning as returning_users,
        newusrs.new_users,
        ttlusrs.returning + newusrs.new_users as total
      from (select
          chart_interval,
          count (id) as new_users
        from (select
            distinct cl.id,
            date_trunc('day', dd)::date as chart_interval
          FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
          left outer join social_accounts sa on date_trunc('day', sa.created_at) = date_trunc('day', dd)
          left outer join clients cl on sa.client_id = cl.id
          join social_logs sl on sa.id = sl.social_account_id
            and location_id in(50, 51)
      	  order by chart_interval) as chart
        group by chart_interval
        order by chart_interval
      ) as newusrs join (select
          date_trunc('day', dd):: date as chart_interval,
          count (distinct cl.id) as returning
        FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
        left outer join social_logs sl on date_trunc('day', sl.created_at) = date_trunc('day', dd)
          and location_id in(50, 51)
        join social_accounts sa on sa.id = sl.social_account_id
        left outer join clients cl on date_trunc('day', cl.created_at) < date_trunc('day', dd)
          and sa.client_id = cl.id
        group by chart_interval
        order by chart_interval
      ) as ttlusrs on ttlusrs.chart_interval = newusrs.chart_interval[0m
[INFO ] Completed [32m200 OK[0m in 30ms [30m(Views: 4.0ms | ActiveRecord: 13.0ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "683-200-6464"], ["created_at", "2017-07-28 07:35:52.486112"], ["updated_at", "2017-07-28 07:35:52.486112"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "isabel.hermann"], ["email", "pascale@fisher.info"], ["password", "X3AmLgD0C2KrM"], ["created_at", "2017-07-28 07:35:52.491072"], ["updated_at", "2017-07-28 07:35:52.491072"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "601342"], ["username", "henriette_bartell"], ["image", "http://vk.com/img/henriette_bartell.jpg"], ["profile", "https://vk.com/henriette_bartell"], ["email", "skylar_hartmann@muller.info"], ["gender", "female"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 30], ["user_id", 79], ["created_at", "2017-07-28 07:35:52.495540"], ["updated_at", "2017-07-28 07:35:52.495540"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Job"], ["created_at", "2017-07-28 07:35:52.503096"], ["updated_at", "2017-07-28 07:35:52.503096"], ["local_path", "http://schultz.net/nils.rodriguez"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Ronstring"], ["title_ru", "Название52"], ["created_at", "2017-07-28 07:35:52.507118"], ["updated_at", "2017-07-28 07:35:52.507118"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 52[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_52[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 52) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>52, "title"=>"Job", "created_at"=>Fri, 28 Jul 2017 07:35:52 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:52 UTC +00:00, "local_path"=>"http://schultz.net/nils.rodriguez"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitwolf"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitwolf"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bitwolf"], ["category_id", 52], ["slug", "bitwolf"], ["created_at", "2017-07-28 07:35:52.519344"], ["updated_at", "2017-07-28 07:35:52.519344"], ["layout_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "arthur_reilly"], ["email", "buddy_thiel@breitenbergmckenzie.info"], ["password", "Jl41MfD4Og"], ["created_at", "2017-07-28 07:35:52.524233"], ["updated_at", "2017-07-28 07:35:52.524233"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "assumenda_sit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Rank"], ["phone", "815-671-8299"], ["address", "7222 Taurean Burg"], ["url", "http://weimann.io/cesar.luettgen"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://torphy.biz/corene"], ["auth_expiration_time", 900], ["slug", "assumenda_sit"], ["brand_id", 52], ["user_id", 80], ["created_at", "2017-07-28 07:35:52.530764"], ["updated_at", "2017-07-28 07:35:52.530764"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "It"], ["created_at", "2017-07-28 07:35:52.539167"], ["updated_at", "2017-07-28 07:35:52.539167"], ["local_path", "http://howell.net/jude"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Subin"], ["title_ru", "Название53"], ["created_at", "2017-07-28 07:35:52.543439"], ["updated_at", "2017-07-28 07:35:52.543439"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 53[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_53[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 53) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>53, "title"=>"It", "created_at"=>Fri, 28 Jul 2017 07:35:52 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:52 UTC +00:00, "local_path"=>"http://howell.net/jude"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Konklab"], ["category_id", 53], ["slug", "konklab"], ["created_at", "2017-07-28 07:35:52.554785"], ["updated_at", "2017-07-28 07:35:52.554785"], ["layout_id", 53]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "keshaun.wolf"], ["email", "cynthia@hoeger.io"], ["password", "AjEgDnDeHsK10r"], ["created_at", "2017-07-28 07:35:52.559683"], ["updated_at", "2017-07-28 07:35:52.559683"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "eum.fuga"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stronghold"], ["phone", "560-369-1371"], ["address", "552 Russell Ways"], ["url", "http://williamson.co/bobby_macejkovic"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://mitchell.info/brielle.cremin"], ["auth_expiration_time", 900], ["slug", "eum.fuga"], ["brand_id", 53], ["user_id", 81], ["created_at", "2017-07-28 07:35:52.565366"], ["updated_at", "2017-07-28 07:35:52.565366"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "caden.fay"], ["email", "agnes@cormier.info"], ["password", "GkBqM52fUiO"], ["created_at", "2017-07-28 07:35:52.570345"], ["updated_at", "2017-07-28 07:35:52.570345"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53315"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53315"], ["comment", "comment 115"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "102.176.231.70"], ["router_admin_ip", "99.111.58.91"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "486"], ["status", "t"], ["location_id", 53], ["user_id", 82], ["created_at", "2017-07-28 07:35:52.575717"], ["updated_at", "2017-07-28 07:35:52.575717"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53315"], ["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 15], ["serial", "643705CA5E36/53315"], ["comment", "comment 115"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "102.176.231.70"], ["router_admin_ip", "99.111.58.91"], ["admin_password", "31302b1d1f7b8874"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "15"], ["status", "t"], ["location_id", 53], ["user_id", 82], ["created_at", "2017-07-28 07:35:52.575717"], ["updated_at", "2017-07-28 07:35:52.575717"], ["id", 15]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 31e24d1d-5f99-45a0-a935-3ecbf7e6c4b0) to Async(routers) with arguments: #<GlobalID:0x007fce25945f98 @uri=#<URI::GID gid://wifi-management/Router/15>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 7ff55da6-1c40-4f25-aff9-0740f6338325) to Async(routers) with arguments: #<GlobalID:0x007fce25945f98 @uri=#<URI::GID gid://wifi-management/Router/15>>
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 15], ["provider", "instagram"], ["location_id", 52], ["router_id", 15], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/time" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:52 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#time_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"time_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(52, 53)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 6ms [30m(Views: 1.3ms | ActiveRecord: 2.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "259.585.2932"], ["created_at", "2017-07-28 07:35:52.797604"], ["updated_at", "2017-07-28 07:35:52.797604"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "carmen_jenkins"], ["email", "sylvia.gutkowski@gerlachnicolas.org"], ["password", "8aJ2Y5UxQs8"], ["created_at", "2017-07-28 07:35:52.802583"], ["updated_at", "2017-07-28 07:35:52.802583"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "219460"], ["username", "cortez_langosh"], ["image", "http://facebook.com/img/cortez_langosh.jpg"], ["profile", "https://facebook.com/cortez_langosh"], ["email", "angeline@berge.info"], ["gender", "female"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 31], ["user_id", 83], ["created_at", "2017-07-28 07:35:52.806749"], ["updated_at", "2017-07-28 07:35:52.806749"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Sonsing"], ["created_at", "2017-07-28 07:35:52.814124"], ["updated_at", "2017-07-28 07:35:52.814124"], ["local_path", "http://quitzondare.co/luz"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Transcof"], ["title_ru", "Название54"], ["created_at", "2017-07-28 07:35:52.818012"], ["updated_at", "2017-07-28 07:35:52.818012"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_54[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 54) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>54, "title"=>"Sonsing", "created_at"=>Fri, 28 Jul 2017 07:35:52 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:52 UTC +00:00, "local_path"=>"http://quitzondare.co/luz"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "ventosanzap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "ventosanzap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Ventosanzap"], ["category_id", 54], ["slug", "ventosanzap"], ["created_at", "2017-07-28 07:35:52.829826"], ["updated_at", "2017-07-28 07:35:52.829826"], ["layout_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "carol"], ["email", "salma.cole@bernier.net"], ["password", "7v51QkIg1k13O5Js"], ["created_at", "2017-07-28 07:35:52.834817"], ["updated_at", "2017-07-28 07:35:52.834817"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quo.velit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Cardify"], ["phone", "670.087.4027"], ["address", "277 Hosea Groves"], ["url", "http://homenickbosco.io/andrew_gislason"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ruecker.co/linnie_hackett"], ["auth_expiration_time", 900], ["slug", "quo.velit"], ["brand_id", 54], ["user_id", 84], ["created_at", "2017-07-28 07:35:52.840846"], ["updated_at", "2017-07-28 07:35:52.840846"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zoolab"], ["created_at", "2017-07-28 07:35:52.848544"], ["updated_at", "2017-07-28 07:35:52.848544"], ["local_path", "http://feil.name/gordon"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Vagram"], ["title_ru", "Название55"], ["created_at", "2017-07-28 07:35:52.852622"], ["updated_at", "2017-07-28 07:35:52.852622"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 55[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_55[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 55) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>55, "title"=>"Zoolab", "created_at"=>Fri, 28 Jul 2017 07:35:52 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:52 UTC +00:00, "local_path"=>"http://feil.name/gordon"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "solarbreeze"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "solarbreeze"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Solarbreeze"], ["category_id", 55], ["slug", "solarbreeze"], ["created_at", "2017-07-28 07:35:52.863904"], ["updated_at", "2017-07-28 07:35:52.863904"], ["layout_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "trent_armstrong"], ["email", "mariam@wintheiser.info"], ["password", "CnO5JlO100QjA"], ["created_at", "2017-07-28 07:35:52.868995"], ["updated_at", "2017-07-28 07:35:52.868995"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "odit-voluptas"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Opela"], ["phone", "1-193-898-8100"], ["address", "56201 Ericka Highway"], ["url", "http://oberbrunnerzieme.com/alfreda"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hoeger.io/peggie"], ["auth_expiration_time", 900], ["slug", "odit-voluptas"], ["brand_id", 55], ["user_id", 85], ["created_at", "2017-07-28 07:35:52.875200"], ["updated_at", "2017-07-28 07:35:52.875200"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "leonard"], ["email", "krystel@torpbernhard.co"], ["password", "PlLh4wCv"], ["created_at", "2017-07-28 07:35:52.880569"], ["updated_at", "2017-07-28 07:35:52.880569"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53316"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53316"], ["comment", "comment 116"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "247.44.26.104"], ["router_admin_ip", "114.157.53.167"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "649"], ["status", "t"], ["location_id", 55], ["user_id", 86], ["created_at", "2017-07-28 07:35:52.886353"], ["updated_at", "2017-07-28 07:35:52.886353"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53316"], ["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 16], ["serial", "643705CA5E36/53316"], ["comment", "comment 116"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "247.44.26.104"], ["router_admin_ip", "114.157.53.167"], ["admin_password", "f444d7900eb6c0f5"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "16"], ["status", "t"], ["location_id", 55], ["user_id", 86], ["created_at", "2017-07-28 07:35:52.886353"], ["updated_at", "2017-07-28 07:35:52.886353"], ["id", 16]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 43002910-7175-433f-a36e-f0b0754de7cb) to Async(routers) with arguments: #<GlobalID:0x007fce22b97f60 @uri=#<URI::GID gid://wifi-management/Router/16>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: ae2be9a1-2fb5-410d-9c5f-c399867d89be) to Async(routers) with arguments: #<GlobalID:0x007fce22b97f60 @uri=#<URI::GID gid://wifi-management/Router/16>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 16], ["provider", "instagram"], ["location_id", 54], ["router_id", 16], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/social" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:53 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#social_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"social_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" IN (54, 55) AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 6ms [30m(Views: 1.3ms | ActiveRecord: 2.0ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(369) 573-6021 x144"], ["created_at", "2017-07-28 07:35:53.535295"], ["updated_at", "2017-07-28 07:35:53.535295"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "stella.lubowitz"], ["email", "jaleel_shields@gibsonjakubowski.io"], ["password", "J4QtMvHkBeAzA6"], ["created_at", "2017-07-28 07:35:53.540408"], ["updated_at", "2017-07-28 07:35:53.540408"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "879411"], ["username", "hilma"], ["image", "http://instagram.com/img/hilma.jpg"], ["profile", "https://instagram.com/hilma"], ["email", "nia.bernhard@lynchparisian.com"], ["gender", "female"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 32], ["user_id", 87], ["created_at", "2017-07-28 07:35:53.544813"], ["updated_at", "2017-07-28 07:35:53.544813"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Home Ing"], ["created_at", "2017-07-28 07:35:53.552162"], ["updated_at", "2017-07-28 07:35:53.552162"], ["local_path", "http://kris.org/carmen.davis"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Prodder"], ["title_ru", "Название56"], ["created_at", "2017-07-28 07:35:53.555928"], ["updated_at", "2017-07-28 07:35:53.555928"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 56[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_56[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 56) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>56, "title"=>"Home Ing", "created_at"=>Fri, 28 Jul 2017 07:35:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:53 UTC +00:00, "local_path"=>"http://kris.org/carmen.davis"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zaam-dox"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zaam-dox"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zaam-Dox"], ["category_id", 56], ["slug", "zaam-dox"], ["created_at", "2017-07-28 07:35:53.567344"], ["updated_at", "2017-07-28 07:35:53.567344"], ["layout_id", 56]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "odell_hudson"], ["email", "jazmin.oconner@baileyjacobson.name"], ["password", "2hRa9z45GmPuZiR"], ["created_at", "2017-07-28 07:35:53.572086"], ["updated_at", "2017-07-28 07:35:53.572086"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "sunt.accusantium"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Fix San"], ["phone", "299.596.6409"], ["address", "413 Lucienne Flat"], ["url", "http://fritsch.info/hannah_torp"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hammes.net/ova"], ["auth_expiration_time", 900], ["slug", "sunt.accusantium"], ["brand_id", 56], ["user_id", 88], ["created_at", "2017-07-28 07:35:53.577951"], ["updated_at", "2017-07-28 07:35:53.577951"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Alpha"], ["created_at", "2017-07-28 07:35:53.585785"], ["updated_at", "2017-07-28 07:35:53.585785"], ["local_path", "http://kochbechtelar.co/marcos"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Tresom"], ["title_ru", "Название57"], ["created_at", "2017-07-28 07:35:53.589402"], ["updated_at", "2017-07-28 07:35:53.589402"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_57[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 57) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>57, "title"=>"Alpha", "created_at"=>Fri, 28 Jul 2017 07:35:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:53 UTC +00:00, "local_path"=>"http://kochbechtelar.co/marcos"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "viva"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "viva"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Viva"], ["category_id", 57], ["slug", "viva"], ["created_at", "2017-07-28 07:35:53.600427"], ["updated_at", "2017-07-28 07:35:53.600427"], ["layout_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "clinton"], ["email", "roslyn@purdy.biz"], ["password", "QbM0BiFjSmJp"], ["created_at", "2017-07-28 07:35:53.605014"], ["updated_at", "2017-07-28 07:35:53.605014"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "nostrum.magnam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zaam-Dox"], ["phone", "1-405-467-6102"], ["address", "5003 Kunde Plaza"], ["url", "http://toyhermiston.io/mertie.baumbach"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hodkiewicz.io/maryjane_skiles"], ["auth_expiration_time", 900], ["slug", "nostrum.magnam"], ["brand_id", 57], ["user_id", 89], ["created_at", "2017-07-28 07:35:53.610668"], ["updated_at", "2017-07-28 07:35:53.610668"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "guillermo_zulauf"], ["email", "helene@renner.co"], ["password", "8jTsNsFr1bP6"], ["created_at", "2017-07-28 07:35:53.615957"], ["updated_at", "2017-07-28 07:35:53.615957"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53317"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53317"], ["comment", "comment 117"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "198.224.44.60"], ["router_admin_ip", "32.98.185.158"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "395"], ["status", "t"], ["location_id", 57], ["user_id", 90], ["created_at", "2017-07-28 07:35:53.621623"], ["updated_at", "2017-07-28 07:35:53.621623"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53317"], ["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 17], ["serial", "643705CA5E36/53317"], ["comment", "comment 117"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "198.224.44.60"], ["router_admin_ip", "32.98.185.158"], ["admin_password", "aba4747f024afded"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "17"], ["status", "t"], ["location_id", 57], ["user_id", 90], ["created_at", "2017-07-28 07:35:53.621623"], ["updated_at", "2017-07-28 07:35:53.621623"], ["id", 17]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 67e79cdf-c80a-4913-8515-3718a8491169) to Async(routers) with arguments: #<GlobalID:0x007fce1b433820 @uri=#<URI::GID gid://wifi-management/Router/17>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 529cd348-1e48-4e15-9e64-6900298c7a5a) to Async(routers) with arguments: #<GlobalID:0x007fce1b433820 @uri=#<URI::GID gid://wifi-management/Router/17>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 17], ["provider", "instagram"], ["location_id", 56], ["router_id", 17], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/age" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:53 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#age_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"age_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.0ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(56, 57) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 6ms [30m(Views: 1.3ms | ActiveRecord: 2.8ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "717-166-0402 x2073"], ["created_at", "2017-07-28 07:35:53.996093"], ["updated_at", "2017-07-28 07:35:53.996093"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "alexys.ruel"], ["email", "jailyn_bednar@ruecker.info"], ["password", "2aEq1xUhWiKe54J8"], ["created_at", "2017-07-28 07:35:54.001229"], ["updated_at", "2017-07-28 07:35:54.001229"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "774916"], ["username", "kaleb"], ["image", "http://vk.com/img/kaleb.jpg"], ["profile", "https://vk.com/kaleb"], ["email", "janick@hahn.net"], ["gender", "female"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 33], ["user_id", 91], ["created_at", "2017-07-28 07:35:54.006065"], ["updated_at", "2017-07-28 07:35:54.006065"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Veribet"], ["created_at", "2017-07-28 07:35:54.013858"], ["updated_at", "2017-07-28 07:35:54.013858"], ["local_path", "http://langworth.net/lizzie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Konklab"], ["title_ru", "Название58"], ["created_at", "2017-07-28 07:35:54.017750"], ["updated_at", "2017-07-28 07:35:54.017750"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 58[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_58[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 58) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>58, "title"=>"Veribet", "created_at"=>Fri, 28 Jul 2017 07:35:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:54 UTC +00:00, "local_path"=>"http://langworth.net/lizzie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tresom"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tresom"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tresom"], ["category_id", 58], ["slug", "tresom"], ["created_at", "2017-07-28 07:35:54.029972"], ["updated_at", "2017-07-28 07:35:54.029972"], ["layout_id", 58]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jaida.goldner"], ["email", "elnora.heathcote@wildermancarroll.org"], ["password", "D1Eo0pYn"], ["created_at", "2017-07-28 07:35:54.034788"], ["updated_at", "2017-07-28 07:35:54.034788"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "consectetur-quas"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bitchip"], ["phone", "(711) 694-4384"], ["address", "869 Reilly Trace"], ["url", "http://nicolasruecker.co/rene"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://murazik.io/haie"], ["auth_expiration_time", 900], ["slug", "consectetur-quas"], ["brand_id", 58], ["user_id", 92], ["created_at", "2017-07-28 07:35:54.040942"], ["updated_at", "2017-07-28 07:35:54.040942"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Stim"], ["created_at", "2017-07-28 07:35:54.048970"], ["updated_at", "2017-07-28 07:35:54.048970"], ["local_path", "http://greenfelder.biz/vivien.mcdermott"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Latlux"], ["title_ru", "Название59"], ["created_at", "2017-07-28 07:35:54.052712"], ["updated_at", "2017-07-28 07:35:54.052712"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 59[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_59[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 59) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>59, "title"=>"Stim", "created_at"=>Fri, 28 Jul 2017 07:35:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:35:54 UTC +00:00, "local_path"=>"http://greenfelder.biz/vivien.mcdermott"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Konklux"], ["category_id", 59], ["slug", "konklux"], ["created_at", "2017-07-28 07:35:54.063833"], ["updated_at", "2017-07-28 07:35:54.063833"], ["layout_id", 59]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "oren_marquardt"], ["email", "andy@yundtcartwright.name"], ["password", "2o18WnTr7v9p"], ["created_at", "2017-07-28 07:35:54.068617"], ["updated_at", "2017-07-28 07:35:54.068617"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ut_doloribus"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Namfix"], ["phone", "(613) 595-4880"], ["address", "24579 Howell Bridge"], ["url", "http://medhurstmcclure.biz/ruthe"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://thompson.co/meggie.hintz"], ["auth_expiration_time", 900], ["slug", "ut_doloribus"], ["brand_id", 59], ["user_id", 93], ["created_at", "2017-07-28 07:35:54.074712"], ["updated_at", "2017-07-28 07:35:54.074712"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "cooper"], ["email", "mara@waters.com"], ["password", "5eKy1sFyRgA4OgPl"], ["created_at", "2017-07-28 07:35:54.080022"], ["updated_at", "2017-07-28 07:35:54.080022"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53318"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53318"], ["comment", "comment 118"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "223.233.175.136"], ["router_admin_ip", "8.208.87.174"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "391"], ["status", "t"], ["location_id", 59], ["user_id", 94], ["created_at", "2017-07-28 07:35:54.086097"], ["updated_at", "2017-07-28 07:35:54.086097"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53318"], ["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 18], ["serial", "643705CA5E36/53318"], ["comment", "comment 118"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "223.233.175.136"], ["router_admin_ip", "8.208.87.174"], ["admin_password", "a8e9963434490479"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "18"], ["status", "t"], ["location_id", 59], ["user_id", 94], ["created_at", "2017-07-28 07:35:54.086097"], ["updated_at", "2017-07-28 07:35:54.086097"], ["id", 18]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 028c01ea-84df-42ec-82bf-73c1eaee4a16) to Async(routers) with arguments: #<GlobalID:0x007fce1f82ae98 @uri=#<URI::GID gid://wifi-management/Router/18>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 08849dff-7601-4983-aa32-eae6fcbfeef9) to Async(routers) with arguments: #<GlobalID:0x007fce1f82ae98 @uri=#<URI::GID gid://wifi-management/Router/18>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 18], ["provider", "instagram"], ["location_id", 58], ["router_id", 18], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/visitors" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:35:54 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#visitors_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"visitors_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" IN (58, 59) AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 7ms [30m(Views: 1.3ms | ActiveRecord: 2.2ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mActiveRecord::SchemaMigration Load (1.3ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (5.6ms)[0m  [1m[35mALTER TABLE "answers" DISABLE TRIGGER ALL;ALTER TABLE "social_logs" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "layouts" DISABLE TRIGGER ALL;ALTER TABLE "polls" DISABLE TRIGGER ALL;ALTER TABLE "questions" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL;ALTER TABLE "attempts" DISABLE TRIGGER ALL;ALTER TABLE "auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "bans" DISABLE TRIGGER ALL;ALTER TABLE "brands" DISABLE TRIGGER ALL;ALTER TABLE "categories" DISABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" DISABLE TRIGGER ALL;ALTER TABLE "client_counters" DISABLE TRIGGER ALL;ALTER TABLE "client_devices" DISABLE TRIGGER ALL;ALTER TABLE "clients" DISABLE TRIGGER ALL;ALTER TABLE "social_accounts" DISABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" DISABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" DISABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" DISABLE TRIGGER ALL;ALTER TABLE "locations" DISABLE TRIGGER ALL;ALTER TABLE "notifications" DISABLE TRIGGER ALL;ALTER TABLE "opinions" DISABLE TRIGGER ALL;ALTER TABLE "pages" DISABLE TRIGGER ALL;ALTER TABLE "payments" DISABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "products" DISABLE TRIGGER ALL;ALTER TABLE "routers" DISABLE TRIGGER ALL;ALTER TABLE "sessions" DISABLE TRIGGER ALL;ALTER TABLE "sms_logs" DISABLE TRIGGER ALL;ALTER TABLE "vips" DISABLE TRIGGER ALL;ALTER TABLE "vouchers" DISABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.8ms)[0m  [1m[34m          SELECT schemaname || '.' || tablename
          FROM pg_tables
          WHERE
            tablename !~ '_prt_' AND
            tablename <> 'schema_migrations' AND
            schemaname = ANY (current_schemas(false))
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.5ms)[0m  [1m[34mselect table_name from information_schema.views where table_schema = 'gycwifi_api_test'[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (152.2ms)[0m  [1m[35mTRUNCATE TABLE "public"."answers", "public"."social_logs", "public"."users", "public"."layouts", "public"."polls", "public"."questions", "public"."ar_internal_metadata", "public"."attempts", "public"."auth_logs", "public"."bans", "public"."brands", "public"."categories", "public"."client_accounting_logs", "public"."client_counters", "public"."client_devices", "public"."clients", "public"."social_accounts", "public"."delayed_jobs", "public"."device_auth_pendings", "public"."friendly_id_slugs", "public"."locations", "public"."notifications", "public"."opinions", "public"."pages", "public"."payments", "public"."post_auth_logs", "public"."products", "public"."routers", "public"."sessions", "public"."sms_logs", "public"."vips", "public"."vouchers" RESTART IDENTITY CASCADE;[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.9ms)[0m  [1m[35mALTER TABLE "answers" ENABLE TRIGGER ALL;ALTER TABLE "social_logs" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "layouts" ENABLE TRIGGER ALL;ALTER TABLE "polls" ENABLE TRIGGER ALL;ALTER TABLE "questions" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL;ALTER TABLE "attempts" ENABLE TRIGGER ALL;ALTER TABLE "auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "bans" ENABLE TRIGGER ALL;ALTER TABLE "brands" ENABLE TRIGGER ALL;ALTER TABLE "categories" ENABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" ENABLE TRIGGER ALL;ALTER TABLE "client_counters" ENABLE TRIGGER ALL;ALTER TABLE "client_devices" ENABLE TRIGGER ALL;ALTER TABLE "clients" ENABLE TRIGGER ALL;ALTER TABLE "social_accounts" ENABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" ENABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" ENABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" ENABLE TRIGGER ALL;ALTER TABLE "locations" ENABLE TRIGGER ALL;ALTER TABLE "notifications" ENABLE TRIGGER ALL;ALTER TABLE "opinions" ENABLE TRIGGER ALL;ALTER TABLE "pages" ENABLE TRIGGER ALL;ALTER TABLE "payments" ENABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "products" ENABLE TRIGGER ALL;ALTER TABLE "routers" ENABLE TRIGGER ALL;ALTER TABLE "sessions" ENABLE TRIGGER ALL;ALTER TABLE "sms_logs" ENABLE TRIGGER ALL;ALTER TABLE "vips" ENABLE TRIGGER ALL;ALTER TABLE "vouchers" ENABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (2.0ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "759-946-2716 x122"], ["created_at", "2017-07-28 07:36:09.219297"], ["updated_at", "2017-07-28 07:36:09.219297"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bigtax"], ["created_at", "2017-07-28 07:36:09.360346"], ["updated_at", "2017-07-28 07:36:09.360346"], ["local_path", "http://stokes.org/ozella.hamill"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fintone"], ["title_ru", "Название1"], ["created_at", "2017-07-28 07:36:09.375819"], ["updated_at", "2017-07-28 07:36:09.375819"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 1[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (1.4ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 1) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>1, "title"=>"Bigtax", "created_at"=>Fri, 28 Jul 2017 07:36:09 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:09 UTC +00:00, "local_path"=>"http://stokes.org/ozella.hamill"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "andalax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "andalax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Andalax"], ["category_id", 1], ["slug", "andalax"], ["created_at", "2017-07-28 07:36:09.505379"], ["updated_at", "2017-07-28 07:36:09.505379"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "eula_bashirian"], ["email", "hailee.torp@roberts.io"], ["password", "0pKg41RbGe"], ["created_at", "2017-07-28 07:36:09.552133"], ["updated_at", "2017-07-28 07:36:09.552133"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "dolorem-earum"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bytecard"], ["phone", "1-445-849-3125"], ["address", "92820 Lueilwitz Mews"], ["url", "http://bernier.co/arielle.abshire"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hettingerrempel.biz/cleo"], ["auth_expiration_time", 900], ["slug", "dolorem-earum"], ["brand_id", 1], ["user_id", 1], ["created_at", "2017-07-28 07:36:09.563898"], ["updated_at", "2017-07-28 07:36:09.563898"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 1], ["location_id", 1], ["counter", 4], ["created_at", "2017-07-28 07:36:09.570770"], ["updated_at", "2017-07-28 07:36:09.570770"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "646.118.4795 x192"], ["created_at", "2017-07-28 07:36:09.576025"], ["updated_at", "2017-07-28 07:36:09.576025"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bitchip"], ["created_at", "2017-07-28 07:36:09.582842"], ["updated_at", "2017-07-28 07:36:09.582842"], ["local_path", "http://bashirian.net/alec.jacobi"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Gembucket"], ["title_ru", "Название2"], ["created_at", "2017-07-28 07:36:09.586853"], ["updated_at", "2017-07-28 07:36:09.586853"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 2[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_2[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 2) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>2, "title"=>"Bitchip", "created_at"=>Fri, 28 Jul 2017 07:36:09 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:09 UTC +00:00, "local_path"=>"http://bashirian.net/alec.jacobi"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "solarbreeze"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "solarbreeze"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Solarbreeze"], ["category_id", 2], ["slug", "solarbreeze"], ["created_at", "2017-07-28 07:36:09.598666"], ["updated_at", "2017-07-28 07:36:09.598666"], ["layout_id", 2]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "wilford.bode"], ["email", "cesar@blickdavis.co"], ["password", "DpAqHdDi"], ["created_at", "2017-07-28 07:36:09.603583"], ["updated_at", "2017-07-28 07:36:09.603583"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et-expedita"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stronghold"], ["phone", "(175) 252-4554"], ["address", "95233 Kassulke Alley"], ["url", "http://hagenechuster.org/vernon_fay"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://nader.co/michaela.schumm"], ["auth_expiration_time", 900], ["slug", "et-expedita"], ["brand_id", 2], ["user_id", 2], ["created_at", "2017-07-28 07:36:09.609646"], ["updated_at", "2017-07-28 07:36:09.609646"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 2], ["location_id", 2], ["counter", 4], ["created_at", "2017-07-28 07:36:09.614716"], ["updated_at", "2017-07-28 07:36:09.614716"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "It"], ["created_at", "2017-07-28 07:36:09.621248"], ["updated_at", "2017-07-28 07:36:09.621248"], ["local_path", "http://doyle.biz/robert"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Biodex"], ["title_ru", "Название3"], ["created_at", "2017-07-28 07:36:09.625192"], ["updated_at", "2017-07-28 07:36:09.625192"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 3[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_3[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 3) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>3, "title"=>"It", "created_at"=>Fri, 28 Jul 2017 07:36:09 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:09 UTC +00:00, "local_path"=>"http://doyle.biz/robert"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "it"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "it"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "It"], ["category_id", 3], ["slug", "it"], ["created_at", "2017-07-28 07:36:09.636395"], ["updated_at", "2017-07-28 07:36:09.636395"], ["layout_id", 3]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "vivian.mertz"], ["email", "toby.mcglynn@sengerfeest.biz"], ["password", "4gL7YpRpK"], ["created_at", "2017-07-28 07:36:09.641121"], ["updated_at", "2017-07-28 07:36:09.641121"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "reprehenderit-ad"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zontrax"], ["phone", "1-377-624-2571"], ["address", "62061 Bartoletti Villages"], ["url", "http://wisoky.io/stan"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://botsford.biz/brock_greenholt"], ["auth_expiration_time", 900], ["slug", "reprehenderit-ad"], ["brand_id", 3], ["user_id", 3], ["created_at", "2017-07-28 07:36:09.647102"], ["updated_at", "2017-07-28 07:36:09.647102"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 1], ["location_id", 3], ["counter", 6], ["created_at", "2017-07-28 07:36:09.651797"], ["updated_at", "2017-07-28 07:36:09.651797"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "luz_cruickshank"], ["email", "giles@balistreriupton.com"], ["password", "0rY6CwDbOrV3RoV"], ["role_cd", 3], ["created_at", "2017-07-28 07:36:09.656420"], ["updated_at", "2017-07-28 07:36:09.656420"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:09 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"luz_cruickshank", "email"=>"giles@balistreriupton.com", "password"=>"0rY6CwDbOrV3RoV", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"luz_cruickshank", :email=>"giles@balistreriupton.com", :password=>"0rY6CwDbOrV3RoV", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"giles@balistreriupton.com", "password"=>"0rY6CwDbOrV3RoV"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "luz_cruickshank"], ["email", "giles@balistreriupton.com"], ["password", "0rY6CwDbOrV3RoV"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 4, username: "luz_cruickshank", email: "giles@balistreriupton.com", password: "0rY6CwDbOrV3RoV", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:36:09", updated_at: "2017-07-28 07:36:09", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 4[0m
[INFO ] Completed [32m201 Created[0m in 7ms [30m(Views: 0.3ms | ActiveRecord: 1.5ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=updated_at&updated_at=asc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:09 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"updated_at", "updated_at"=>"asc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 4) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.2ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>4, "username"=>"luz_cruickshank", "email"=>"giles@balistreriupton.com", "password"=>"0rY6CwDbOrV3RoV", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:09 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:09 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"updated_at", :updated_at=>"asc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (1.3ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>4, :username=>"luz_cruickshank", :email=>"giles@balistreriupton.com", :password=>"0rY6CwDbOrV3RoV", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:36:09.656Z", :updated_at=>"2017-07-28T07:36:09.656Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.2ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:36:09.570770') AND "client_counters"."location_id" IN (1, 2, 3) GROUP BY client_id, phone_number ORDER BY updated_at asc, visits desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (2, 1)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (1.6ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (1, 2)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:36:09.570770') AND "client_counters"."location_id" IN (1, 2, 3) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 104ms [30m(Views: 0.6ms | ActiveRecord: 21.8ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "311-926-2164 x23630"], ["created_at", "2017-07-28 07:36:09.854884"], ["updated_at", "2017-07-28 07:36:09.854884"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Job"], ["created_at", "2017-07-28 07:36:09.862157"], ["updated_at", "2017-07-28 07:36:09.862157"], ["local_path", "http://wunschpouros.com/letitia.ziemann"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Ventosanzap"], ["title_ru", "Название4"], ["created_at", "2017-07-28 07:36:09.865880"], ["updated_at", "2017-07-28 07:36:09.865880"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_4[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 4) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>4, "title"=>"Job", "created_at"=>Fri, 28 Jul 2017 07:36:09 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:09 UTC +00:00, "local_path"=>"http://wunschpouros.com/letitia.ziemann"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "regrant"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "regrant"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Regrant"], ["category_id", 4], ["slug", "regrant"], ["created_at", "2017-07-28 07:36:09.878224"], ["updated_at", "2017-07-28 07:36:09.878224"], ["layout_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "deshawn"], ["email", "jermain@koch.info"], ["password", "PxK9U47rNbExJ"], ["created_at", "2017-07-28 07:36:09.883310"], ["updated_at", "2017-07-28 07:36:09.883310"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "qui_quam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Cardify"], ["phone", "898.974.3045"], ["address", "98811 Bashirian Avenue"], ["url", "http://roob.name/bobby.keler"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://krajcik.info/jack"], ["auth_expiration_time", 900], ["slug", "qui_quam"], ["brand_id", 4], ["user_id", 5], ["created_at", "2017-07-28 07:36:09.889518"], ["updated_at", "2017-07-28 07:36:09.889518"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 3], ["location_id", 4], ["counter", 1], ["created_at", "2017-07-28 07:36:09.894557"], ["updated_at", "2017-07-28 07:36:09.894557"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "208-604-6426 x9511"], ["created_at", "2017-07-28 07:36:09.898361"], ["updated_at", "2017-07-28 07:36:09.898361"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zathin"], ["created_at", "2017-07-28 07:36:09.904902"], ["updated_at", "2017-07-28 07:36:09.904902"], ["local_path", "http://oberbrunner.biz/antoinette"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bamity"], ["title_ru", "Название5"], ["created_at", "2017-07-28 07:36:09.908610"], ["updated_at", "2017-07-28 07:36:09.908610"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 5[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_5[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 5) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>5, "title"=>"Zathin", "created_at"=>Fri, 28 Jul 2017 07:36:09 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:09 UTC +00:00, "local_path"=>"http://oberbrunner.biz/antoinette"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bigtax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bigtax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bigtax"], ["category_id", 5], ["slug", "bigtax"], ["created_at", "2017-07-28 07:36:09.919776"], ["updated_at", "2017-07-28 07:36:09.919776"], ["layout_id", 5]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "zoila.bernhard"], ["email", "natalie@mertz.net"], ["password", "Pq8t1zDoYcBq9vT"], ["created_at", "2017-07-28 07:36:09.924421"], ["updated_at", "2017-07-28 07:36:09.924421"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ut-ducimus"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Veribet"], ["phone", "1-448-944-6628"], ["address", "5652 Ralph Forge"], ["url", "http://hyattjenkins.co/evie.rohan"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://gleason.io/jimmie_wisoky"], ["auth_expiration_time", 900], ["slug", "ut-ducimus"], ["brand_id", 5], ["user_id", 6], ["created_at", "2017-07-28 07:36:09.930388"], ["updated_at", "2017-07-28 07:36:09.930388"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 4], ["location_id", 5], ["counter", 1], ["created_at", "2017-07-28 07:36:09.935242"], ["updated_at", "2017-07-28 07:36:09.935242"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Greenlam"], ["created_at", "2017-07-28 07:36:09.941420"], ["updated_at", "2017-07-28 07:36:09.941420"], ["local_path", "http://jaskolski.net/terrell_fisher"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Otcom"], ["title_ru", "Название6"], ["created_at", "2017-07-28 07:36:09.945264"], ["updated_at", "2017-07-28 07:36:09.945264"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 6[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_6[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 6) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>6, "title"=>"Greenlam", "created_at"=>Fri, 28 Jul 2017 07:36:09 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:09 UTC +00:00, "local_path"=>"http://jaskolski.net/terrell_fisher"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "otcom"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "otcom"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Otcom"], ["category_id", 6], ["slug", "otcom"], ["created_at", "2017-07-28 07:36:09.956544"], ["updated_at", "2017-07-28 07:36:09.956544"], ["layout_id", 6]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "keegan"], ["email", "mallory.dare@jacobsonemmerich.info"], ["password", "Ep5hOgDcEnB1EvEc"], ["created_at", "2017-07-28 07:36:09.961364"], ["updated_at", "2017-07-28 07:36:09.961364"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quos.ut"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stringtough"], ["phone", "(893) 005-6110"], ["address", "98707 Gorczany Way"], ["url", "http://manteeffertz.co/valentine"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ward.co/jody.robel"], ["auth_expiration_time", 900], ["slug", "quos.ut"], ["brand_id", 6], ["user_id", 7], ["created_at", "2017-07-28 07:36:09.967446"], ["updated_at", "2017-07-28 07:36:09.967446"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 3], ["location_id", 6], ["counter", 2], ["created_at", "2017-07-28 07:36:09.972127"], ["updated_at", "2017-07-28 07:36:09.972127"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "freda_abernathy"], ["email", "julianne_abbott@langosh.net"], ["password", "XmRlGnQvJ1GnD"], ["role_cd", 3], ["created_at", "2017-07-28 07:36:09.976830"], ["updated_at", "2017-07-28 07:36:09.976830"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:09 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"freda_abernathy", "email"=>"julianne_abbott@langosh.net", "password"=>"XmRlGnQvJ1GnD", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"freda_abernathy", :email=>"julianne_abbott@langosh.net", :password=>"XmRlGnQvJ1GnD", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"julianne_abbott@langosh.net", "password"=>"XmRlGnQvJ1GnD"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "freda_abernathy"], ["email", "julianne_abbott@langosh.net"], ["password", "XmRlGnQvJ1GnD"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 8, username: "freda_abernathy", email: "julianne_abbott@langosh.net", password: "XmRlGnQvJ1GnD", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:36:09", updated_at: "2017-07-28 07:36:09", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 8[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=regular&loyalty_days=7&page=1&sort_field=visits30&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:09 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"regular", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits30", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 8) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>8, "username"=>"freda_abernathy", "email"=>"julianne_abbott@langosh.net", "password"=>"XmRlGnQvJ1GnD", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:09 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:09 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"regular", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits30", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.7ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>8, :username=>"freda_abernathy", :email=>"julianne_abbott@langosh.net", :password=>"XmRlGnQvJ1GnD", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:36:09.976Z", :updated_at=>"2017-07-28T07:36:09.976Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.5ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:36:09.894557') AND "client_counters"."location_id" IN (4, 5, 6) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) > 1) ORDER BY visits30 asc, updated_at desc, visits desc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 3[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 3[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:36:09.894557') AND "client_counters"."location_id" IN (4, 5, 6) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) > 1)[0m
[INFO ] Completed [32m200 OK[0m in 31ms [30m(Views: 0.3ms | ActiveRecord: 9.4ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(807) 879-1651 x354"], ["created_at", "2017-07-28 07:36:10.027711"], ["updated_at", "2017-07-28 07:36:10.027711"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Stim"], ["created_at", "2017-07-28 07:36:10.034550"], ["updated_at", "2017-07-28 07:36:10.034550"], ["local_path", "http://cainschulist.name/jewell.hyatt"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Alphazap"], ["title_ru", "Название7"], ["created_at", "2017-07-28 07:36:10.038290"], ["updated_at", "2017-07-28 07:36:10.038290"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 7[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_7[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 7) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>7, "title"=>"Stim", "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "local_path"=>"http://cainschulist.name/jewell.hyatt"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voyatouch"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voyatouch"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Voyatouch"], ["category_id", 7], ["slug", "voyatouch"], ["created_at", "2017-07-28 07:36:10.049589"], ["updated_at", "2017-07-28 07:36:10.049589"], ["layout_id", 7]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "susanna.hermann"], ["email", "velda@stracke.info"], ["password", "Z3GbVzPgTgW8IrX"], ["created_at", "2017-07-28 07:36:10.054643"], ["updated_at", "2017-07-28 07:36:10.054643"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "aut_perferendis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Toughjoyfax"], ["phone", "1-822-676-7416"], ["address", "28348 Robel Lock"], ["url", "http://ankundinghowe.co/evans"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://abernathy.net/max"], ["auth_expiration_time", 900], ["slug", "aut_perferendis"], ["brand_id", 7], ["user_id", 9], ["created_at", "2017-07-28 07:36:10.060998"], ["updated_at", "2017-07-28 07:36:10.060998"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 5], ["location_id", 7], ["counter", 9], ["created_at", "2017-07-28 07:36:10.065792"], ["updated_at", "2017-07-28 07:36:10.065792"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-989-229-4495 x614"], ["created_at", "2017-07-28 07:36:10.069763"], ["updated_at", "2017-07-28 07:36:10.069763"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Cardify"], ["created_at", "2017-07-28 07:36:10.076418"], ["updated_at", "2017-07-28 07:36:10.076418"], ["local_path", "http://greendoyle.com/enos"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Domainer"], ["title_ru", "Название8"], ["created_at", "2017-07-28 07:36:10.080370"], ["updated_at", "2017-07-28 07:36:10.080370"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (1.4ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 8) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>8, "title"=>"Cardify", "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "local_path"=>"http://greendoyle.com/enos"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "keylex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "keylex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Keylex"], ["category_id", 8], ["slug", "keylex"], ["created_at", "2017-07-28 07:36:10.139837"], ["updated_at", "2017-07-28 07:36:10.139837"], ["layout_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "efrain_west"], ["email", "tomasa@hamill.net"], ["password", "A78uBn0t96Sg5b"], ["created_at", "2017-07-28 07:36:10.145727"], ["updated_at", "2017-07-28 07:36:10.145727"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptatem.esse"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Daltfresh"], ["phone", "988-061-9023"], ["address", "44838 Rippin Ways"], ["url", "http://purdy.biz/johnson.fritsch"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://zieme.info/kristin.hills"], ["auth_expiration_time", 900], ["slug", "voluptatem.esse"], ["brand_id", 8], ["user_id", 10], ["created_at", "2017-07-28 07:36:10.151978"], ["updated_at", "2017-07-28 07:36:10.151978"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 6], ["location_id", 8], ["counter", 1], ["created_at", "2017-07-28 07:36:10.156804"], ["updated_at", "2017-07-28 07:36:10.156804"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Rank"], ["created_at", "2017-07-28 07:36:10.163545"], ["updated_at", "2017-07-28 07:36:10.163545"], ["local_path", "http://carrollklein.org/euna"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Rank"], ["title_ru", "Название9"], ["created_at", "2017-07-28 07:36:10.167428"], ["updated_at", "2017-07-28 07:36:10.167428"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 9[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_9[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 9) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>9, "title"=>"Rank", "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "local_path"=>"http://carrollklein.org/euna"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Quo Lux"], ["category_id", 9], ["slug", "quo-lux"], ["created_at", "2017-07-28 07:36:10.178602"], ["updated_at", "2017-07-28 07:36:10.178602"], ["layout_id", 9]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "modesto"], ["email", "dakota_volkman@windler.co"], ["password", "A4399kMg"], ["created_at", "2017-07-28 07:36:10.183489"], ["updated_at", "2017-07-28 07:36:10.183489"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "doloremque-sunt"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Redhold"], ["phone", "1-117-854-2080"], ["address", "8174 Liam Crescent"], ["url", "http://okeefe.name/pascale"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://colerunolfon.info/moriah_pfeffer"], ["auth_expiration_time", 900], ["slug", "doloremque-sunt"], ["brand_id", 9], ["user_id", 11], ["created_at", "2017-07-28 07:36:10.189767"], ["updated_at", "2017-07-28 07:36:10.189767"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 5], ["location_id", 9], ["counter", 5], ["created_at", "2017-07-28 07:36:10.194651"], ["updated_at", "2017-07-28 07:36:10.194651"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "malinda_upton"], ["email", "gabriel_prohaska@douglas.net"], ["password", "HfYnXtWnZkR909Ju"], ["role_cd", 3], ["created_at", "2017-07-28 07:36:10.199662"], ["updated_at", "2017-07-28 07:36:10.199662"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:10 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"malinda_upton", "email"=>"gabriel_prohaska@douglas.net", "password"=>"HfYnXtWnZkR909Ju", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"malinda_upton", :email=>"gabriel_prohaska@douglas.net", :password=>"HfYnXtWnZkR909Ju", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"gabriel_prohaska@douglas.net", "password"=>"HfYnXtWnZkR909Ju"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "malinda_upton"], ["email", "gabriel_prohaska@douglas.net"], ["password", "HfYnXtWnZkR909Ju"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 12, username: "malinda_upton", email: "gabriel_prohaska@douglas.net", password: "HfYnXtWnZkR909Ju", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:36:10", updated_at: "2017-07-28 07:36:10", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 12[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=passed&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:10 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"passed", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 12) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>12, "username"=>"malinda_upton", "email"=>"gabriel_prohaska@douglas.net", "password"=>"HfYnXtWnZkR909Ju", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"passed", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>12, :username=>"malinda_upton", :email=>"gabriel_prohaska@douglas.net", :password=>"HfYnXtWnZkR909Ju", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:36:10.199Z", :updated_at=>"2017-07-28T07:36:10.199Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:36:10.229849') AND "client_counters"."location_id" IN (7, 8, 9) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1) ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 6[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 6[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:36:10.229849') AND "client_counters"."location_id" IN (7, 8, 9) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1)[0m
[INFO ] Completed [32m200 OK[0m in 30ms [30m(Views: 0.5ms | ActiveRecord: 8.3ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "586.903.6125"], ["created_at", "2017-07-28 07:36:10.250502"], ["updated_at", "2017-07-28 07:36:10.250502"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Trippledex"], ["created_at", "2017-07-28 07:36:10.257821"], ["updated_at", "2017-07-28 07:36:10.257821"], ["local_path", "http://greenfelder.org/brionna_greenholt"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Job"], ["title_ru", "Название10"], ["created_at", "2017-07-28 07:36:10.261924"], ["updated_at", "2017-07-28 07:36:10.261924"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 10[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_10[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 10) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>10, "title"=>"Trippledex", "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "local_path"=>"http://greenfelder.org/brionna_greenholt"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "asoka"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "asoka"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Asoka"], ["category_id", 10], ["slug", "asoka"], ["created_at", "2017-07-28 07:36:10.273948"], ["updated_at", "2017-07-28 07:36:10.273948"], ["layout_id", 10]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "sigmund.leffler"], ["email", "tremaine_grimes@sporerhowell.co"], ["password", "JoBv115nKw3"], ["created_at", "2017-07-28 07:36:10.279084"], ["updated_at", "2017-07-28 07:36:10.279084"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "velit.aspernatur"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tres-Zap"], ["phone", "1-742-405-3619"], ["address", "249 Randall Ville"], ["url", "http://conroy.co/magdalena.pouros"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://erdman.name/quinton"], ["auth_expiration_time", 900], ["slug", "velit.aspernatur"], ["brand_id", 10], ["user_id", 13], ["created_at", "2017-07-28 07:36:10.285372"], ["updated_at", "2017-07-28 07:36:10.285372"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 7], ["location_id", 10], ["counter", 4], ["created_at", "2017-07-28 07:36:10.290218"], ["updated_at", "2017-07-28 07:36:10.290218"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "485.422.1110 x732"], ["created_at", "2017-07-28 07:36:10.294165"], ["updated_at", "2017-07-28 07:36:10.294165"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Ventosanzap"], ["created_at", "2017-07-28 07:36:10.301012"], ["updated_at", "2017-07-28 07:36:10.301012"], ["local_path", "http://shieldsweber.org/yoshiko"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bamity"], ["title_ru", "Название11"], ["created_at", "2017-07-28 07:36:10.305039"], ["updated_at", "2017-07-28 07:36:10.305039"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 11[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_11[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 11) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>11, "title"=>"Ventosanzap", "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "local_path"=>"http://shieldsweber.org/yoshiko"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voyatouch"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voyatouch"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Voyatouch"], ["category_id", 11], ["slug", "voyatouch"], ["created_at", "2017-07-28 07:36:10.316766"], ["updated_at", "2017-07-28 07:36:10.316766"], ["layout_id", 11]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ezekiel"], ["email", "marshall@pfeffer.info"], ["password", "3g6zS9Zr"], ["created_at", "2017-07-28 07:36:10.321976"], ["updated_at", "2017-07-28 07:36:10.321976"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "accusamus_laborum"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Voyatouch"], ["phone", "562.887.1112"], ["address", "5616 Mraz Junctions"], ["url", "http://lowe.org/reginald"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://langrippin.name/celestino.kutch"], ["auth_expiration_time", 900], ["slug", "accusamus_laborum"], ["brand_id", 11], ["user_id", 14], ["created_at", "2017-07-28 07:36:10.328270"], ["updated_at", "2017-07-28 07:36:10.328270"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 8], ["location_id", 11], ["counter", 3], ["created_at", "2017-07-28 07:36:10.333190"], ["updated_at", "2017-07-28 07:36:10.333190"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bitchip"], ["created_at", "2017-07-28 07:36:10.339905"], ["updated_at", "2017-07-28 07:36:10.339905"], ["local_path", "http://nitzsche.net/marilie.zboncak"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Duobam"], ["title_ru", "Название12"], ["created_at", "2017-07-28 07:36:10.343985"], ["updated_at", "2017-07-28 07:36:10.343985"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_12[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 12) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>12, "title"=>"Bitchip", "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "local_path"=>"http://nitzsche.net/marilie.zboncak"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "greenlam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "greenlam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Greenlam"], ["category_id", 12], ["slug", "greenlam"], ["created_at", "2017-07-28 07:36:10.355500"], ["updated_at", "2017-07-28 07:36:10.355500"], ["layout_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "kailey.mills"], ["email", "christop.ohara@swaniawski.io"], ["password", "4eV2PmCl7"], ["created_at", "2017-07-28 07:36:10.360656"], ["updated_at", "2017-07-28 07:36:10.360656"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "sequi-ut"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Quo Lux"], ["phone", "(815) 588-4350"], ["address", "64357 Madge Shoals"], ["url", "http://reichertskiles.info/gay"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://gleichner.io/rozella_gorczany"], ["auth_expiration_time", 900], ["slug", "sequi-ut"], ["brand_id", 12], ["user_id", 15], ["created_at", "2017-07-28 07:36:10.367012"], ["updated_at", "2017-07-28 07:36:10.367012"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 7], ["location_id", 12], ["counter", 6], ["created_at", "2017-07-28 07:36:10.371773"], ["updated_at", "2017-07-28 07:36:10.371773"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Konklux"], ["created_at", "2017-07-28 07:36:10.379136"], ["updated_at", "2017-07-28 07:36:10.379136"], ["local_path", "http://senger.info/jarrell"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zaam-Dox"], ["title_ru", "Название13"], ["created_at", "2017-07-28 07:36:10.383303"], ["updated_at", "2017-07-28 07:36:10.383303"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 13[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_13[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 13) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>13, "title"=>"Konklux", "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "local_path"=>"http://senger.info/jarrell"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "namfix"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "namfix"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Namfix"], ["category_id", 13], ["slug", "namfix"], ["created_at", "2017-07-28 07:36:10.396013"], ["updated_at", "2017-07-28 07:36:10.396013"], ["layout_id", 13]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "malika"], ["email", "amos@bergnaum.io"], ["password", "L3R1NvSf0g12Y"], ["created_at", "2017-07-28 07:36:10.401538"], ["updated_at", "2017-07-28 07:36:10.401538"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "error.repellendus"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Treeflex"], ["phone", "375.816.7934"], ["address", "53057 Charity Flats"], ["url", "http://halvorson.org/joaquin"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://bernier.info/efren.walsh"], ["auth_expiration_time", 900], ["slug", "error.repellendus"], ["brand_id", 13], ["user_id", 16], ["created_at", "2017-07-28 07:36:10.407967"], ["updated_at", "2017-07-28 07:36:10.407967"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 8], ["location_id", 13], ["counter", 7], ["created_at", "2017-07-20 07:36:10.374274"], ["updated_at", "2017-07-20 07:36:10.374393"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "jaeden.keler"], ["email", "wade.jacobson@bogan.net"], ["password", "71Mp8u53Eu"], ["role_cd", 3], ["created_at", "2017-07-28 07:36:10.418370"], ["updated_at", "2017-07-28 07:36:10.418370"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:10 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"jaeden.keler", "email"=>"wade.jacobson@bogan.net", "password"=>"71Mp8u53Eu", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"jaeden.keler", :email=>"wade.jacobson@bogan.net", :password=>"71Mp8u53Eu", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"wade.jacobson@bogan.net", "password"=>"71Mp8u53Eu"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "jaeden.keler"], ["email", "wade.jacobson@bogan.net"], ["password", "71Mp8u53Eu"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 17, username: "jaeden.keler", email: "wade.jacobson@bogan.net", password: "71Mp8u53Eu", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:36:10", updated_at: "2017-07-28 07:36:10", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 17[0m
[INFO ] Completed [32m201 Created[0m in 6ms [30m(Views: 0.4ms | ActiveRecord: 1.1ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=passed&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:10 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"passed", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 17) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>17, "username"=>"jaeden.keler", "email"=>"wade.jacobson@bogan.net", "password"=>"71Mp8u53Eu", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"passed", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>17, :username=>"jaeden.keler", :email=>"wade.jacobson@bogan.net", :password=>"71Mp8u53Eu", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:36:10.418Z", :updated_at=>"2017-07-28T07:36:10.418Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:36:10.451342') AND "client_counters"."location_id" IN (10, 11, 12, 13) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1) ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 8[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:36:10.451342') AND "client_counters"."location_id" IN (10, 11, 12, 13) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1)[0m
[INFO ] Completed [32m200 OK[0m in 33ms [30m(Views: 0.5ms | ActiveRecord: 8.7ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "672-323-9463 x51205"], ["created_at", "2017-07-28 07:36:10.474428"], ["updated_at", "2017-07-28 07:36:10.474428"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bitwolf"], ["created_at", "2017-07-28 07:36:10.481865"], ["updated_at", "2017-07-28 07:36:10.481865"], ["local_path", "http://parker.co/delores_fadel"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Konklux"], ["title_ru", "Название14"], ["created_at", "2017-07-28 07:36:10.486309"], ["updated_at", "2017-07-28 07:36:10.486309"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 14[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_14[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 14) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>14, "title"=>"Bitwolf", "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "local_path"=>"http://parker.co/delores_fadel"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voltsillam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voltsillam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Voltsillam"], ["category_id", 14], ["slug", "voltsillam"], ["created_at", "2017-07-28 07:36:10.498998"], ["updated_at", "2017-07-28 07:36:10.498998"], ["layout_id", 14]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "general"], ["email", "ryann_schiller@stokes.io"], ["password", "D1ElToD2N"], ["created_at", "2017-07-28 07:36:10.504098"], ["updated_at", "2017-07-28 07:36:10.504098"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "nam-inventore"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Alpha"], ["phone", "1-514-745-4384"], ["address", "8019 Kariane Curve"], ["url", "http://cruickshankgleason.com/lois_ferry"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://marks.org/marty_conn"], ["auth_expiration_time", 900], ["slug", "nam-inventore"], ["brand_id", 14], ["user_id", 18], ["created_at", "2017-07-28 07:36:10.510427"], ["updated_at", "2017-07-28 07:36:10.510427"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 9], ["location_id", 14], ["counter", 6], ["created_at", "2017-07-28 07:36:10.515232"], ["updated_at", "2017-07-28 07:36:10.515232"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "245.416.2731 x05595"], ["created_at", "2017-07-28 07:36:10.519255"], ["updated_at", "2017-07-28 07:36:10.519255"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Fixflex"], ["created_at", "2017-07-28 07:36:10.525985"], ["updated_at", "2017-07-28 07:36:10.525985"], ["local_path", "http://kshlerin.co/omer"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zoolab"], ["title_ru", "Название15"], ["created_at", "2017-07-28 07:36:10.529700"], ["updated_at", "2017-07-28 07:36:10.529700"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 15[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_15[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 15) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>15, "title"=>"Fixflex", "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "local_path"=>"http://kshlerin.co/omer"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tresom"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tresom"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tresom"], ["category_id", 15], ["slug", "tresom"], ["created_at", "2017-07-28 07:36:10.541037"], ["updated_at", "2017-07-28 07:36:10.541037"], ["layout_id", 15]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "alphonso.conn"], ["email", "keon.johnson@bergemacejkovic.net"], ["password", "2mH1UyPkBxZ6X"], ["created_at", "2017-07-28 07:36:10.546947"], ["updated_at", "2017-07-28 07:36:10.546947"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "illum-dolores"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Y-Solowarm"], ["phone", "146-404-4025"], ["address", "7639 Noel Tunnel"], ["url", "http://borer.co/fritz"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://weinatkeler.org/israel_hudson"], ["auth_expiration_time", 900], ["slug", "illum-dolores"], ["brand_id", 15], ["user_id", 19], ["created_at", "2017-07-28 07:36:10.553133"], ["updated_at", "2017-07-28 07:36:10.553133"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 10], ["location_id", 15], ["counter", 1], ["created_at", "2017-07-28 07:36:10.558054"], ["updated_at", "2017-07-28 07:36:10.558054"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Vagram"], ["created_at", "2017-07-28 07:36:10.564792"], ["updated_at", "2017-07-28 07:36:10.564792"], ["local_path", "http://stoltenberg.co/rebekah"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Lotlux"], ["title_ru", "Название16"], ["created_at", "2017-07-28 07:36:10.568472"], ["updated_at", "2017-07-28 07:36:10.568472"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 16[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_16[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 16) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>16, "title"=>"Vagram", "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "local_path"=>"http://stoltenberg.co/rebekah"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "greenlam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "greenlam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Greenlam"], ["category_id", 16], ["slug", "greenlam"], ["created_at", "2017-07-28 07:36:10.579640"], ["updated_at", "2017-07-28 07:36:10.579640"], ["layout_id", 16]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jovanny"], ["email", "herbert@cremin.org"], ["password", "UiNmO1ZoUn"], ["created_at", "2017-07-28 07:36:10.584748"], ["updated_at", "2017-07-28 07:36:10.584748"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "omnis_corrupti"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zathin"], ["phone", "1-680-013-9571"], ["address", "12933 Hayes Ramp"], ["url", "http://blockgorczany.org/evert.hermiston"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://bogisich.net/ozzie.herman"], ["auth_expiration_time", 900], ["slug", "omnis_corrupti"], ["brand_id", 16], ["user_id", 20], ["created_at", "2017-07-28 07:36:10.590718"], ["updated_at", "2017-07-28 07:36:10.590718"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 9], ["location_id", 16], ["counter", 9], ["created_at", "2017-07-28 07:36:10.595610"], ["updated_at", "2017-07-28 07:36:10.595610"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "holden.torp"], ["email", "clemmie_kirlin@cristaltenwerth.com"], ["password", "C5Jm1pGt"], ["role_cd", 3], ["created_at", "2017-07-28 07:36:10.600481"], ["updated_at", "2017-07-28 07:36:10.600481"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:10 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"holden.torp", "email"=>"clemmie_kirlin@cristaltenwerth.com", "password"=>"C5Jm1pGt", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"holden.torp", :email=>"clemmie_kirlin@cristaltenwerth.com", :password=>"C5Jm1pGt", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"clemmie_kirlin@cristaltenwerth.com", "password"=>"C5Jm1pGt"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "holden.torp"], ["email", "clemmie_kirlin@cristaltenwerth.com"], ["password", "C5Jm1pGt"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 21, username: "holden.torp", email: "clemmie_kirlin@cristaltenwerth.com", password: "C5Jm1pGt", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:36:10", updated_at: "2017-07-28 07:36:10", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 21[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:10 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 21) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>21, "username"=>"holden.torp", "email"=>"clemmie_kirlin@cristaltenwerth.com", "password"=>"C5Jm1pGt", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.8ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>21, :username=>"holden.torp", :email=>"clemmie_kirlin@cristaltenwerth.com", :password=>"C5Jm1pGt", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:36:10.600Z", :updated_at=>"2017-07-28T07:36:10.600Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:36:10.515232') AND "client_counters"."location_id" IN (14, 15, 16) GROUP BY client_id, phone_number ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (9, 10)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (9, 10)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:36:10.515232') AND "client_counters"."location_id" IN (14, 15, 16) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 32ms [30m(Views: 0.6ms | ActiveRecord: 8.7ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-580-477-7802"], ["created_at", "2017-07-28 07:36:10.652386"], ["updated_at", "2017-07-28 07:36:10.652386"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Stringtough"], ["created_at", "2017-07-28 07:36:10.659408"], ["updated_at", "2017-07-28 07:36:10.659408"], ["local_path", "http://nikolaus.net/idella.labadie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Y-find"], ["title_ru", "Название17"], ["created_at", "2017-07-28 07:36:10.663235"], ["updated_at", "2017-07-28 07:36:10.663235"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_17[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 17) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>17, "title"=>"Stringtough", "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "local_path"=>"http://nikolaus.net/idella.labadie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cookley"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cookley"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Cookley"], ["category_id", 17], ["slug", "cookley"], ["created_at", "2017-07-28 07:36:10.675031"], ["updated_at", "2017-07-28 07:36:10.675031"], ["layout_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "zaria"], ["email", "lillie@franeckipadberg.net"], ["password", "2bSzGiKj2e466tQ"], ["created_at", "2017-07-28 07:36:10.679921"], ["updated_at", "2017-07-28 07:36:10.679921"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "dolores-et"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Gembucket"], ["phone", "1-341-324-4326"], ["address", "16412 Alvah Mountain"], ["url", "http://trantow.name/demond_upton"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://franecki.biz/garett"], ["auth_expiration_time", 900], ["slug", "dolores-et"], ["brand_id", 17], ["user_id", 22], ["created_at", "2017-07-28 07:36:10.686034"], ["updated_at", "2017-07-28 07:36:10.686034"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 11], ["location_id", 17], ["counter", 6], ["created_at", "2017-07-28 07:36:10.690829"], ["updated_at", "2017-07-28 07:36:10.690829"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "505.555.0862 x37045"], ["created_at", "2017-07-28 07:36:10.694747"], ["updated_at", "2017-07-28 07:36:10.694747"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tresom"], ["created_at", "2017-07-28 07:36:10.701536"], ["updated_at", "2017-07-28 07:36:10.701536"], ["local_path", "http://nolan.info/bernhard_zulauf"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Regrant"], ["title_ru", "Название18"], ["created_at", "2017-07-28 07:36:10.705268"], ["updated_at", "2017-07-28 07:36:10.705268"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 18[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_18[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 18) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>18, "title"=>"Tresom", "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "local_path"=>"http://nolan.info/bernhard_zulauf"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "redhold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "redhold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Redhold"], ["category_id", 18], ["slug", "redhold"], ["created_at", "2017-07-28 07:36:10.716737"], ["updated_at", "2017-07-28 07:36:10.716737"], ["layout_id", 18]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "odie_wiza"], ["email", "johnathan_doyle@ferryblanda.org"], ["password", "VnEbGhWnW"], ["created_at", "2017-07-28 07:36:10.721576"], ["updated_at", "2017-07-28 07:36:10.721576"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "necessitatibus-minus"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zaam-Dox"], ["phone", "(321) 826-5865"], ["address", "999 Abernathy Shores"], ["url", "http://cremin.org/buster_schulist"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://purdykub.co/linda.greenholt"], ["auth_expiration_time", 900], ["slug", "necessitatibus-minus"], ["brand_id", 18], ["user_id", 23], ["created_at", "2017-07-28 07:36:10.727565"], ["updated_at", "2017-07-28 07:36:10.727565"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 12], ["location_id", 18], ["counter", 9], ["created_at", "2017-07-28 07:36:10.732672"], ["updated_at", "2017-07-28 07:36:10.732672"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zamit"], ["created_at", "2017-07-28 07:36:10.739081"], ["updated_at", "2017-07-28 07:36:10.739081"], ["local_path", "http://schroeder.com/cade.skiles"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Opela"], ["title_ru", "Название19"], ["created_at", "2017-07-28 07:36:10.742872"], ["updated_at", "2017-07-28 07:36:10.742872"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 19[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_19[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 19) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>19, "title"=>"Zamit", "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "local_path"=>"http://schroeder.com/cade.skiles"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "latlux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "latlux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Latlux"], ["category_id", 19], ["slug", "latlux"], ["created_at", "2017-07-28 07:36:10.754012"], ["updated_at", "2017-07-28 07:36:10.754012"], ["layout_id", 19]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "andre.langosh"], ["email", "cade_durgan@gerlach.com"], ["password", "4sZsT5Gn"], ["created_at", "2017-07-28 07:36:10.758664"], ["updated_at", "2017-07-28 07:36:10.758664"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "perferendis-dolores"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Treeflex"], ["phone", "189-978-6514"], ["address", "24659 Batz Motorway"], ["url", "http://wolf.biz/stewart_flatley"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://maggio.io/tamara_medhurst"], ["auth_expiration_time", 900], ["slug", "perferendis-dolores"], ["brand_id", 19], ["user_id", 24], ["created_at", "2017-07-28 07:36:10.764565"], ["updated_at", "2017-07-28 07:36:10.764565"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 11], ["location_id", 19], ["counter", 6], ["created_at", "2017-07-28 07:36:10.769359"], ["updated_at", "2017-07-28 07:36:10.769359"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "wilbert"], ["email", "oran@bartoletti.info"], ["password", "Xh3s051wZ"], ["role_cd", 3], ["created_at", "2017-07-28 07:36:10.774034"], ["updated_at", "2017-07-28 07:36:10.774034"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:10 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"wilbert", "email"=>"oran@bartoletti.info", "password"=>"Xh3s051wZ", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"wilbert", :email=>"oran@bartoletti.info", :password=>"Xh3s051wZ", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"oran@bartoletti.info", "password"=>"Xh3s051wZ"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "wilbert"], ["email", "oran@bartoletti.info"], ["password", "Xh3s051wZ"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 25, username: "wilbert", email: "oran@bartoletti.info", password: "Xh3s051wZ", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:36:10", updated_at: "2017-07-28 07:36:10", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 25[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=updated_at&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:10 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"updated_at", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 25) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>25, "username"=>"wilbert", "email"=>"oran@bartoletti.info", "password"=>"Xh3s051wZ", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"updated_at", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.8ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>25, :username=>"wilbert", :email=>"oran@bartoletti.info", :password=>"Xh3s051wZ", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:36:10.774Z", :updated_at=>"2017-07-28T07:36:10.774Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:36:10.690829') AND "client_counters"."location_id" IN (17, 18, 19) GROUP BY client_id, phone_number ORDER BY updated_at desc, visits desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (11, 12)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (11, 12)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:36:10.690829') AND "client_counters"."location_id" IN (17, 18, 19) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 31ms [30m(Views: 0.6ms | ActiveRecord: 8.8ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(454) 363-7171 x437"], ["created_at", "2017-07-28 07:36:10.825309"], ["updated_at", "2017-07-28 07:36:10.825309"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Opela"], ["created_at", "2017-07-28 07:36:10.832328"], ["updated_at", "2017-07-28 07:36:10.832328"], ["local_path", "http://okeefecrooks.com/albin"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Rank"], ["title_ru", "Название20"], ["created_at", "2017-07-28 07:36:10.836249"], ["updated_at", "2017-07-28 07:36:10.836249"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 20[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_20[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 20) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>20, "title"=>"Opela", "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "local_path"=>"http://okeefecrooks.com/albin"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "mat-lam-tam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "mat-lam-tam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Mat Lam Tam"], ["category_id", 20], ["slug", "mat-lam-tam"], ["created_at", "2017-07-28 07:36:10.847759"], ["updated_at", "2017-07-28 07:36:10.847759"], ["layout_id", 20]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ed_damore"], ["email", "palma.crona@heel.io"], ["password", "ZjGkWf80JtM5"], ["created_at", "2017-07-28 07:36:10.852862"], ["updated_at", "2017-07-28 07:36:10.852862"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "eius-officiis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Home Ing"], ["phone", "118.252.5336"], ["address", "65211 Wilkinson Wells"], ["url", "http://bradtke.io/jailyn_ortiz"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hermannemmerich.co/ubaldo"], ["auth_expiration_time", 900], ["slug", "eius-officiis"], ["brand_id", 20], ["user_id", 26], ["created_at", "2017-07-28 07:36:10.858900"], ["updated_at", "2017-07-28 07:36:10.858900"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 13], ["location_id", 20], ["counter", 2], ["created_at", "2017-07-28 07:36:10.863786"], ["updated_at", "2017-07-28 07:36:10.863786"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-718-735-5626 x5029"], ["created_at", "2017-07-28 07:36:10.867734"], ["updated_at", "2017-07-28 07:36:10.867734"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tin"], ["created_at", "2017-07-28 07:36:10.874398"], ["updated_at", "2017-07-28 07:36:10.874398"], ["local_path", "http://brakus.io/river"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Veribet"], ["title_ru", "Название21"], ["created_at", "2017-07-28 07:36:10.878379"], ["updated_at", "2017-07-28 07:36:10.878379"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_21[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 21) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>21, "title"=>"Tin", "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "local_path"=>"http://brakus.io/river"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stim"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stim"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Stim"], ["category_id", 21], ["slug", "stim"], ["created_at", "2017-07-28 07:36:10.889989"], ["updated_at", "2017-07-28 07:36:10.889989"], ["layout_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "karli_leuschke"], ["email", "delilah.douglas@powlowski.io"], ["password", "FvBfJnE9U32fRbH"], ["created_at", "2017-07-28 07:36:10.895052"], ["updated_at", "2017-07-28 07:36:10.895052"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "placeat-autem"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Regrant"], ["phone", "(571) 552-3435"], ["address", "7850 Fisher Stravenue"], ["url", "http://goodwin.co/leo_schiller"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hudson.io/brenna"], ["auth_expiration_time", 900], ["slug", "placeat-autem"], ["brand_id", 21], ["user_id", 27], ["created_at", "2017-07-28 07:36:10.901407"], ["updated_at", "2017-07-28 07:36:10.901407"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 14], ["location_id", 21], ["counter", 2], ["created_at", "2017-07-28 07:36:10.906377"], ["updated_at", "2017-07-28 07:36:10.906377"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Y-find"], ["created_at", "2017-07-28 07:36:10.912926"], ["updated_at", "2017-07-28 07:36:10.912926"], ["local_path", "http://auer.co/janice"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Temp"], ["title_ru", "Название22"], ["created_at", "2017-07-28 07:36:10.916554"], ["updated_at", "2017-07-28 07:36:10.916554"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 22[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_22[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 22) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>22, "title"=>"Y-find", "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "local_path"=>"http://auer.co/janice"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "viva"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "viva"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Viva"], ["category_id", 22], ["slug", "viva"], ["created_at", "2017-07-28 07:36:10.927294"], ["updated_at", "2017-07-28 07:36:10.927294"], ["layout_id", 22]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "claude_willms"], ["email", "mikel.grimes@thompson.com"], ["password", "NdJiHnWe"], ["created_at", "2017-07-28 07:36:10.931978"], ["updated_at", "2017-07-28 07:36:10.931978"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quia.non"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zoolab"], ["phone", "518.450.5314"], ["address", "89797 Nona Spring"], ["url", "http://frami.name/maiya.buckridge"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://moore.com/johathan"], ["auth_expiration_time", 900], ["slug", "quia.non"], ["brand_id", 22], ["user_id", 28], ["created_at", "2017-07-28 07:36:10.937644"], ["updated_at", "2017-07-28 07:36:10.937644"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 13], ["location_id", 22], ["counter", 5], ["created_at", "2017-07-28 07:36:10.942202"], ["updated_at", "2017-07-28 07:36:10.942202"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(518) 549-3621"], ["created_at", "2017-07-28 07:36:10.946328"], ["updated_at", "2017-07-28 07:36:10.946328"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Sub-Ex"], ["created_at", "2017-07-28 07:36:10.952306"], ["updated_at", "2017-07-28 07:36:10.952306"], ["local_path", "http://labadie.net/zola_littel"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Flexidy"], ["title_ru", "Название23"], ["created_at", "2017-07-28 07:36:10.955839"], ["updated_at", "2017-07-28 07:36:10.955839"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 23[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_23[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 23) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>23, "title"=>"Sub-Ex", "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "local_path"=>"http://labadie.net/zola_littel"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Quo Lux"], ["category_id", 23], ["slug", "quo-lux"], ["created_at", "2017-07-28 07:36:10.966692"], ["updated_at", "2017-07-28 07:36:10.966692"], ["layout_id", 23]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "dashawn.kshlerin"], ["email", "elyse_reinger@hackett.co"], ["password", "AhJ60cSyQtV3Y"], ["created_at", "2017-07-28 07:36:10.971340"], ["updated_at", "2017-07-28 07:36:10.971340"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "asperiores-aut"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bitchip"], ["phone", "543.438.2643"], ["address", "21678 Mayert Fall"], ["url", "http://schumm.net/sydney"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://rowe.io/caandra"], ["auth_expiration_time", 900], ["slug", "asperiores-aut"], ["brand_id", 23], ["user_id", 29], ["created_at", "2017-07-28 07:36:10.977117"], ["updated_at", "2017-07-28 07:36:10.977117"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 15], ["location_id", 23], ["counter", 2], ["created_at", "2017-06-26 07:36:10.944488"], ["updated_at", "2017-06-26 07:36:10.944603"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "destin_kovacek"], ["email", "meredith@schinner.org"], ["password", "XuPpI4SoI5Yt"], ["role_cd", 3], ["created_at", "2017-07-28 07:36:10.986961"], ["updated_at", "2017-07-28 07:36:10.986961"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:11 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"destin_kovacek", "email"=>"meredith@schinner.org", "password"=>"XuPpI4SoI5Yt", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"destin_kovacek", :email=>"meredith@schinner.org", :password=>"XuPpI4SoI5Yt", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"meredith@schinner.org", "password"=>"XuPpI4SoI5Yt"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "destin_kovacek"], ["email", "meredith@schinner.org"], ["password", "XuPpI4SoI5Yt"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 30, username: "destin_kovacek", email: "meredith@schinner.org", password: "XuPpI4SoI5Yt", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:36:10", updated_at: "2017-07-28 07:36:10", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 30[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=visits30&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:11 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits30", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 30) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>30, "username"=>"destin_kovacek", "email"=>"meredith@schinner.org", "password"=>"XuPpI4SoI5Yt", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:10 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits30", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.7ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>30, :username=>"destin_kovacek", :email=>"meredith@schinner.org", :password=>"XuPpI4SoI5Yt", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:36:10.986Z", :updated_at=>"2017-07-28T07:36:10.986Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-06-26 07:36:10.944488') AND "client_counters"."location_id" IN (20, 21, 22, 23) GROUP BY client_id, phone_number ORDER BY visits30 asc, updated_at desc, visits desc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (15, 14, 13)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (13, 14, 15)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-06-26 07:36:10.944488') AND "client_counters"."location_id" IN (20, 21, 22, 23) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 34ms [30m(Views: 0.8ms | ActiveRecord: 9.0ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "armani.mayert"], ["email", "oran@marks.info"], ["password", "GjHaR93tM"], ["created_at", "2017-07-28 07:36:11.055380"], ["updated_at", "2017-07-28 07:36:11.055380"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "theodora"], ["email", "deborah@hueldavis.net"], ["password", "KvD9Sv9iRrK"], ["created_at", "2017-07-28 07:36:11.084968"], ["updated_at", "2017-07-28 07:36:11.084968"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "rowena"], ["email", "malcolm@sauer.co"], ["password", "U7FsIcP6GfPnL"], ["created_at", "2017-07-28 07:36:11.102864"], ["updated_at", "2017-07-28 07:36:11.102864"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "elyse_ziemann"], ["email", "rashawn.mertz@steuber.co"], ["password", "9lBeCe9eIj9jJm"], ["created_at", "2017-07-28 07:36:11.113502"], ["updated_at", "2017-07-28 07:36:11.113502"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "quincy_collier"], ["email", "josh.gottlieb@mayertsmitham.biz"], ["password", "0qQiX8FkPaBo4w"], ["created_at", "2017-07-28 07:36:11.124016"], ["updated_at", "2017-07-28 07:36:11.124016"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "458.637.0451"], ["created_at", "2017-07-28 07:36:11.156563"], ["updated_at", "2017-07-28 07:36:11.156563"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "misael.tremblay"], ["email", "leda@stromanbaumbach.info"], ["password", "G5KpP4Ti"], ["created_at", "2017-07-28 07:36:11.162131"], ["updated_at", "2017-07-28 07:36:11.162131"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "856354"], ["username", "willis"], ["image", "http://facebook.com/img/willis.jpg"], ["profile", "https://facebook.com/willis"], ["email", "norma@kelerbednar.com"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 16], ["user_id", 36], ["created_at", "2017-07-28 07:36:11.167134"], ["updated_at", "2017-07-28 07:36:11.167134"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tres-Zap"], ["created_at", "2017-07-28 07:36:11.175627"], ["updated_at", "2017-07-28 07:36:11.175627"], ["local_path", "http://abshiremosciski.biz/colleen.wunsch"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Biodex"], ["title_ru", "Название24"], ["created_at", "2017-07-28 07:36:11.179540"], ["updated_at", "2017-07-28 07:36:11.179540"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 24[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_24[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 24) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>24, "title"=>"Tres-Zap", "created_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "local_path"=>"http://abshiremosciski.biz/colleen.wunsch"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "ronstring"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "ronstring"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Ronstring"], ["category_id", 24], ["slug", "ronstring"], ["created_at", "2017-07-28 07:36:11.191651"], ["updated_at", "2017-07-28 07:36:11.191651"], ["layout_id", 24]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "dolore-ducimus"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Holdlamis"], ["phone", "608-438-5634"], ["address", "9703 Okuneva Glen"], ["url", "http://ledner.net/carmel"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://white.name/idella_jacobs"], ["auth_expiration_time", 900], ["slug", "dolore-ducimus"], ["brand_id", 24], ["user_id", 36], ["created_at", "2017-07-28 07:36:11.197523"], ["updated_at", "2017-07-28 07:36:11.197523"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zamit"], ["created_at", "2017-07-28 07:36:11.245817"], ["updated_at", "2017-07-28 07:36:11.245817"], ["local_path", "http://morarkeeling.net/pierce"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Opela"], ["title_ru", "Название25"], ["created_at", "2017-07-28 07:36:11.249780"], ["updated_at", "2017-07-28 07:36:11.249780"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_25[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 25) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>25, "title"=>"Zamit", "created_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "local_path"=>"http://morarkeeling.net/pierce"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cardify"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cardify"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Cardify"], ["category_id", 25], ["slug", "cardify"], ["created_at", "2017-07-28 07:36:11.261202"], ["updated_at", "2017-07-28 07:36:11.261202"], ["layout_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "brittany.gorczany"], ["email", "elaina.beahan@quitzon.info"], ["password", "NtJtYpYa5wXsHqD"], ["created_at", "2017-07-28 07:36:11.265925"], ["updated_at", "2017-07-28 07:36:11.265925"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "suscipit-atque"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Voltsillam"], ["phone", "673.463.9285"], ["address", "905 Raynor Station"], ["url", "http://bechtelarreilly.name/devante"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kuphal.name/lulu"], ["auth_expiration_time", 900], ["slug", "suscipit-atque"], ["brand_id", 25], ["user_id", 37], ["created_at", "2017-07-28 07:36:11.271755"], ["updated_at", "2017-07-28 07:36:11.271755"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "terrill_bergstrom"], ["email", "hobart_keebler@rueckerrowe.org"], ["password", "JjBqAxNpEcW28yKz"], ["created_at", "2017-07-28 07:36:11.277195"], ["updated_at", "2017-07-28 07:36:11.277195"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5331"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5331"], ["comment", "comment 11"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "16.80.9.57"], ["router_admin_ip", "23.192.20.165"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "11"], ["status", "t"], ["location_id", 25], ["user_id", 38], ["created_at", "2017-07-28 07:36:11.285582"], ["updated_at", "2017-07-28 07:36:11.285582"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5331"], ["id", 1], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 1], ["serial", "643705CA5E36/5331"], ["comment", "comment 11"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "16.80.9.57"], ["router_admin_ip", "23.192.20.165"], ["admin_password", "1a1ed55dee003626"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "1"], ["status", "t"], ["location_id", 25], ["user_id", 38], ["created_at", "2017-07-28 07:36:11.285582"], ["updated_at", "2017-07-28 07:36:11.285582"], ["id", 1]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 873db058-cf62-4f42-8a25-91ddb6e502fd) to Async(routers) with arguments: #<GlobalID:0x007ff1047f0650 @uri=#<URI::GID gid://wifi-management/Router/1>>
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 86976087-99dc-4a43-8d71-299a22c00751) to Async(routers) with arguments: #<GlobalID:0x007ff1047f0650 @uri=#<URI::GID gid://wifi-management/Router/1>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 1], ["provider", "instagram"], ["location_id", 24], ["router_id", 1], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:11 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"misael.tremblay", "email"=>"leda@stromanbaumbach.info", "password"=>"G5KpP4Ti", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"misael.tremblay", :email=>"leda@stromanbaumbach.info", :password=>"G5KpP4Ti", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"leda@stromanbaumbach.info", "password"=>"G5KpP4Ti"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "misael.tremblay"], ["email", "leda@stromanbaumbach.info"], ["password", "G5KpP4Ti"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 36, username: "misael.tremblay", email: "leda@stromanbaumbach.info", password: "G5KpP4Ti", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:11", updated_at: "2017-07-28 07:36:11", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 36[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/stats/time_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:11 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#time_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_36[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 36) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>36, "username"=>"misael.tremblay", "email"=>"leda@stromanbaumbach.info", "password"=>"G5KpP4Ti", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"time_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_36[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_36[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>36, :username=>"misael.tremblay", :email=>"leda@stromanbaumbach.info", :password=>"G5KpP4Ti", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:11.162Z", :updated_at=>"2017-07-28T07:36:11.162Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 36[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(24)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 27ms [30m(Views: 1.2ms | ActiveRecord: 6.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "533.403.9805 x089"], ["created_at", "2017-07-28 07:36:11.473641"], ["updated_at", "2017-07-28 07:36:11.473641"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "osbaldo.beahan"], ["email", "winfield_ratke@dooleyebert.com"], ["password", "TkYzTrFm65R"], ["created_at", "2017-07-28 07:36:11.479207"], ["updated_at", "2017-07-28 07:36:11.479207"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "527515"], ["username", "ray"], ["image", "http://instagram.com/img/ray.jpg"], ["profile", "https://instagram.com/ray"], ["email", "charity.bartoletti@miller.net"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 17], ["user_id", 39], ["created_at", "2017-07-28 07:36:11.483953"], ["updated_at", "2017-07-28 07:36:11.483953"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Wrapsafe"], ["created_at", "2017-07-28 07:36:11.491554"], ["updated_at", "2017-07-28 07:36:11.491554"], ["local_path", "http://kerluke.io/jayce_rath"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Temp"], ["title_ru", "Название26"], ["created_at", "2017-07-28 07:36:11.495637"], ["updated_at", "2017-07-28 07:36:11.495637"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 26[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_26[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 26) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>26, "title"=>"Wrapsafe", "created_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "local_path"=>"http://kerluke.io/jayce_rath"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voltsillam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voltsillam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Voltsillam"], ["category_id", 26], ["slug", "voltsillam"], ["created_at", "2017-07-28 07:36:11.508517"], ["updated_at", "2017-07-28 07:36:11.508517"], ["layout_id", 26]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ut_nisi"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Opela"], ["phone", "246.144.5979"], ["address", "9220 Boyd Point"], ["url", "http://west.io/jamel"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://beier.io/justice_rippin"], ["auth_expiration_time", 900], ["slug", "ut_nisi"], ["brand_id", 26], ["user_id", 39], ["created_at", "2017-07-28 07:36:11.515158"], ["updated_at", "2017-07-28 07:36:11.515158"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tin"], ["created_at", "2017-07-28 07:36:11.523585"], ["updated_at", "2017-07-28 07:36:11.523585"], ["local_path", "http://thompson.co/cecilia_schuppe"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bitwolf"], ["title_ru", "Название27"], ["created_at", "2017-07-28 07:36:11.527267"], ["updated_at", "2017-07-28 07:36:11.527267"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 27[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_27[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 27) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>27, "title"=>"Tin", "created_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "local_path"=>"http://thompson.co/cecilia_schuppe"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "home-ing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "home-ing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Home Ing"], ["category_id", 27], ["slug", "home-ing"], ["created_at", "2017-07-28 07:36:11.538231"], ["updated_at", "2017-07-28 07:36:11.538231"], ["layout_id", 27]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lorine"], ["email", "dashawn@haagmcglynn.name"], ["password", "WtGvUlX10v1uSl"], ["created_at", "2017-07-28 07:36:11.542855"], ["updated_at", "2017-07-28 07:36:11.542855"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "non-sapiente"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Span"], ["phone", "(520) 779-3460"], ["address", "8997 Raphael Unions"], ["url", "http://marquardt.info/nicklaus"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hahn.co/winfield"], ["auth_expiration_time", 900], ["slug", "non-sapiente"], ["brand_id", 27], ["user_id", 40], ["created_at", "2017-07-28 07:36:11.548675"], ["updated_at", "2017-07-28 07:36:11.548675"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "sammy"], ["email", "rosalee_predovic@auer.net"], ["password", "2bAjNwVf86Sx88"], ["created_at", "2017-07-28 07:36:11.553791"], ["updated_at", "2017-07-28 07:36:11.553791"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5332"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5332"], ["comment", "comment 12"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "81.165.35.181"], ["router_admin_ip", "125.234.29.87"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "920"], ["status", "t"], ["location_id", 27], ["user_id", 41], ["created_at", "2017-07-28 07:36:11.559548"], ["updated_at", "2017-07-28 07:36:11.559548"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5332"], ["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 2], ["serial", "643705CA5E36/5332"], ["comment", "comment 12"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "81.165.35.181"], ["router_admin_ip", "125.234.29.87"], ["admin_password", "7c6727d58ff54b25"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "2"], ["status", "t"], ["location_id", 27], ["user_id", 41], ["created_at", "2017-07-28 07:36:11.559548"], ["updated_at", "2017-07-28 07:36:11.559548"], ["id", 2]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: bf9810e6-dd6f-4f2c-81a6-b63f2e6e9aed) to Async(routers) with arguments: #<GlobalID:0x007ff104502790 @uri=#<URI::GID gid://wifi-management/Router/2>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 9f909cac-7e86-4835-afee-183409daa267) to Async(routers) with arguments: #<GlobalID:0x007ff104502790 @uri=#<URI::GID gid://wifi-management/Router/2>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.3ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 2], ["provider", "instagram"], ["location_id", 26], ["router_id", 2], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:11 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"osbaldo.beahan", "email"=>"winfield_ratke@dooleyebert.com", "password"=>"TkYzTrFm65R", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"osbaldo.beahan", :email=>"winfield_ratke@dooleyebert.com", :password=>"TkYzTrFm65R", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"winfield_ratke@dooleyebert.com", "password"=>"TkYzTrFm65R"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "osbaldo.beahan"], ["email", "winfield_ratke@dooleyebert.com"], ["password", "TkYzTrFm65R"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 39, username: "osbaldo.beahan", email: "winfield_ratke@dooleyebert.com", password: "TkYzTrFm65R", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:11", updated_at: "2017-07-28 07:36:11", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 39[0m
[INFO ] Completed [32m201 Created[0m in 6ms [30m(Views: 0.3ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/stats/authorizations" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:11 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#authorizations[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 39) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.5ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>39, "username"=>"osbaldo.beahan", "email"=>"winfield_ratke@dooleyebert.com", "password"=>"TkYzTrFm65R", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"authorizations"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>39, :username=>"osbaldo.beahan", :email=>"winfield_ratke@dooleyebert.com", :password=>"TkYzTrFm65R", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:11.479Z", :updated_at=>"2017-07-28T07:36:11.479Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 39[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[34mSELECT COUNT("social_logs"."id") AS count_id, date_trunc('hour', created_at) AS date_trunc_hour_created_at FROM "social_logs" WHERE "social_logs"."location_id" = 26 AND ("social_logs"."created_at" BETWEEN $1 AND $2) GROUP BY date_trunc('hour', created_at) ORDER BY date_trunc_hour_created_at[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 28ms [30m(Views: 0.2ms | ActiveRecord: 8.9ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(463) 075-0057"], ["created_at", "2017-07-28 07:36:11.673165"], ["updated_at", "2017-07-28 07:36:11.673165"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "katheryn_welch"], ["email", "amya@shanahan.net"], ["password", "EjCgMyVt331gNbR"], ["created_at", "2017-07-28 07:36:11.678086"], ["updated_at", "2017-07-28 07:36:11.678086"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "635532"], ["username", "jena"], ["image", "http://facebook.com/img/jena.jpg"], ["profile", "https://facebook.com/jena"], ["email", "mack_sawayn@torphyquitzon.co"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 18], ["user_id", 42], ["created_at", "2017-07-28 07:36:11.682321"], ["updated_at", "2017-07-28 07:36:11.682321"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tin"], ["created_at", "2017-07-28 07:36:11.689376"], ["updated_at", "2017-07-28 07:36:11.689376"], ["local_path", "http://mitchell.net/sallie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Domainer"], ["title_ru", "Название28"], ["created_at", "2017-07-28 07:36:11.693276"], ["updated_at", "2017-07-28 07:36:11.693276"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 28[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_28[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 28) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>28, "title"=>"Tin", "created_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "local_path"=>"http://mitchell.net/sallie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zoolab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zoolab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zoolab"], ["category_id", 28], ["slug", "zoolab"], ["created_at", "2017-07-28 07:36:11.704602"], ["updated_at", "2017-07-28 07:36:11.704602"], ["layout_id", 28]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "officiis-aut"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zathin"], ["phone", "674.071.2173"], ["address", "815 Conroy Plains"], ["url", "http://lemketurcotte.com/emely.rempel"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://casper.net/amber.ullrich"], ["auth_expiration_time", 900], ["slug", "officiis-aut"], ["brand_id", 28], ["user_id", 42], ["created_at", "2017-07-28 07:36:11.710704"], ["updated_at", "2017-07-28 07:36:11.710704"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Y-Solowarm"], ["created_at", "2017-07-28 07:36:11.718875"], ["updated_at", "2017-07-28 07:36:11.718875"], ["local_path", "http://schneider.org/johathan"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bamity"], ["title_ru", "Название29"], ["created_at", "2017-07-28 07:36:11.722485"], ["updated_at", "2017-07-28 07:36:11.722485"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 29[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_29[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 29) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>29, "title"=>"Y-Solowarm", "created_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "local_path"=>"http://schneider.org/johathan"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "namfix"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "namfix"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Namfix"], ["category_id", 29], ["slug", "namfix"], ["created_at", "2017-07-28 07:36:11.733536"], ["updated_at", "2017-07-28 07:36:11.733536"], ["layout_id", 29]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "justine_koelpin"], ["email", "santa@ornbeatty.info"], ["password", "DrFb2b62PvHzN"], ["created_at", "2017-07-28 07:36:11.738599"], ["updated_at", "2017-07-28 07:36:11.738599"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "blanditiis-accusamus"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Biodex"], ["phone", "417.112.2976"], ["address", "7643 Lavada Isle"], ["url", "http://kunde.info/anabel"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ritchie.co/camilla"], ["auth_expiration_time", 900], ["slug", "blanditiis-accusamus"], ["brand_id", 29], ["user_id", 43], ["created_at", "2017-07-28 07:36:11.744704"], ["updated_at", "2017-07-28 07:36:11.744704"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "harmon"], ["email", "gus@sporer.org"], ["password", "JoUiWb4fU7SeZxI9"], ["created_at", "2017-07-28 07:36:11.749999"], ["updated_at", "2017-07-28 07:36:11.749999"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5333"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5333"], ["comment", "comment 13"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "5.201.252.226"], ["router_admin_ip", "238.106.15.181"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "223"], ["status", "t"], ["location_id", 29], ["user_id", 44], ["created_at", "2017-07-28 07:36:11.755740"], ["updated_at", "2017-07-28 07:36:11.755740"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5333"], ["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 3], ["serial", "643705CA5E36/5333"], ["comment", "comment 13"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "5.201.252.226"], ["router_admin_ip", "238.106.15.181"], ["admin_password", "cfee02d1cbaed1c4"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "3"], ["status", "t"], ["location_id", 29], ["user_id", 44], ["created_at", "2017-07-28 07:36:11.755740"], ["updated_at", "2017-07-28 07:36:11.755740"], ["id", 3]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: aa00550b-db4d-43aa-be8d-a97fc8eb0823) to Async(routers) with arguments: #<GlobalID:0x007ff0fa715500 @uri=#<URI::GID gid://wifi-management/Router/3>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 3497b26b-95a8-4b85-8258-6d760474b78a) to Async(routers) with arguments: #<GlobalID:0x007ff0fa715500 @uri=#<URI::GID gid://wifi-management/Router/3>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 3], ["provider", "instagram"], ["location_id", 28], ["router_id", 3], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:11 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"katheryn_welch", "email"=>"amya@shanahan.net", "password"=>"EjCgMyVt331gNbR", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"katheryn_welch", :email=>"amya@shanahan.net", :password=>"EjCgMyVt331gNbR", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"amya@shanahan.net", "password"=>"EjCgMyVt331gNbR"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "katheryn_welch"], ["email", "amya@shanahan.net"], ["password", "EjCgMyVt331gNbR"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 42, username: "katheryn_welch", email: "amya@shanahan.net", password: "EjCgMyVt331gNbR", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:11", updated_at: "2017-07-28 07:36:11", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 42[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/social_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:11 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#social_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_42[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 42) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>42, "username"=>"katheryn_welch", "email"=>"amya@shanahan.net", "password"=>"EjCgMyVt331gNbR", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"social_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_42[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_42[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>42, :username=>"katheryn_welch", :email=>"amya@shanahan.net", :password=>"EjCgMyVt331gNbR", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:11.678Z", :updated_at=>"2017-07-28T07:36:11.678Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 42[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" = 28 AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 25ms [30m(Views: 1.2ms | ActiveRecord: 5.8ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "989.906.2446"], ["created_at", "2017-07-28 07:36:11.842342"], ["updated_at", "2017-07-28 07:36:11.842342"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.4ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "adelbert_kozey"], ["email", "wilhelm_bernhard@zboncak.io"], ["password", "BzAfJnDkTnQuD518"], ["created_at", "2017-07-28 07:36:11.848185"], ["updated_at", "2017-07-28 07:36:11.848185"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.6ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "550963"], ["username", "edwin_lemke"], ["image", "http://instagram.com/img/edwin_lemke.jpg"], ["profile", "https://instagram.com/edwin_lemke"], ["email", "berta_raynor@lubowitzsmitham.net"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 19], ["user_id", 45], ["created_at", "2017-07-28 07:36:11.853344"], ["updated_at", "2017-07-28 07:36:11.853344"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Flowdesk"], ["created_at", "2017-07-28 07:36:11.861740"], ["updated_at", "2017-07-28 07:36:11.861740"], ["local_path", "http://corwin.co/rico"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Flexidy"], ["title_ru", "Название30"], ["created_at", "2017-07-28 07:36:11.865980"], ["updated_at", "2017-07-28 07:36:11.865980"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_30[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 30) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>30, "title"=>"Flowdesk", "created_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "local_path"=>"http://corwin.co/rico"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (2.0ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "keylex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "keylex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Keylex"], ["category_id", 30], ["slug", "keylex"], ["created_at", "2017-07-28 07:36:11.879443"], ["updated_at", "2017-07-28 07:36:11.879443"], ["layout_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptates-molestiae"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Duobam"], ["phone", "(413) 591-4055"], ["address", "347 Matteo Row"], ["url", "http://ruecker.name/aliza_okeefe"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://veumcollins.net/bethany_haley"], ["auth_expiration_time", 900], ["slug", "voluptates-molestiae"], ["brand_id", 30], ["user_id", 45], ["created_at", "2017-07-28 07:36:11.886519"], ["updated_at", "2017-07-28 07:36:11.886519"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Wrapsafe"], ["created_at", "2017-07-28 07:36:11.895048"], ["updated_at", "2017-07-28 07:36:11.895048"], ["local_path", "http://quitzon.info/susana_bartell"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Span"], ["title_ru", "Название31"], ["created_at", "2017-07-28 07:36:11.898862"], ["updated_at", "2017-07-28 07:36:11.898862"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 31[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_31[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 31) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>31, "title"=>"Wrapsafe", "created_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "local_path"=>"http://quitzon.info/susana_bartell"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voltsillam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voltsillam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Voltsillam"], ["category_id", 31], ["slug", "voltsillam"], ["created_at", "2017-07-28 07:36:11.910034"], ["updated_at", "2017-07-28 07:36:11.910034"], ["layout_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "crystal_effertz"], ["email", "elisabeth_frami@moen.org"], ["password", "7rYcEo0vJb509"], ["created_at", "2017-07-28 07:36:11.914891"], ["updated_at", "2017-07-28 07:36:11.914891"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "aperiam_rerum"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Regrant"], ["phone", "(533) 293-6511"], ["address", "858 Cora Lodge"], ["url", "http://runolfsdottir.info/jonatan"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://corwinstrosin.co/brian"], ["auth_expiration_time", 900], ["slug", "aperiam_rerum"], ["brand_id", 31], ["user_id", 46], ["created_at", "2017-07-28 07:36:11.920950"], ["updated_at", "2017-07-28 07:36:11.920950"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "giovani_kerluke"], ["email", "vito@bayer.org"], ["password", "UaNd56K2Nv8uKr"], ["created_at", "2017-07-28 07:36:11.926323"], ["updated_at", "2017-07-28 07:36:11.926323"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5334"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5334"], ["comment", "comment 14"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "217.211.89.48"], ["router_admin_ip", "36.181.214.245"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "837"], ["status", "t"], ["location_id", 31], ["user_id", 47], ["created_at", "2017-07-28 07:36:11.932299"], ["updated_at", "2017-07-28 07:36:11.932299"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5334"], ["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 4], ["serial", "643705CA5E36/5334"], ["comment", "comment 14"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "217.211.89.48"], ["router_admin_ip", "36.181.214.245"], ["admin_password", "89042ab7f4e08a30"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "4"], ["status", "t"], ["location_id", 31], ["user_id", 47], ["created_at", "2017-07-28 07:36:11.932299"], ["updated_at", "2017-07-28 07:36:11.932299"], ["id", 4]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: cff6f161-55ca-4349-b1e5-dee8c1e15c3f) to Async(routers) with arguments: #<GlobalID:0x007ff0fa374f68 @uri=#<URI::GID gid://wifi-management/Router/4>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: e1ce1ce3-c14b-4c62-a0af-853724a2473e) to Async(routers) with arguments: #<GlobalID:0x007ff0fa374f68 @uri=#<URI::GID gid://wifi-management/Router/4>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 4], ["provider", "instagram"], ["location_id", 30], ["router_id", 4], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(635) 736-8421 x2217"], ["created_at", "2017-07-28 07:36:11.991109"], ["updated_at", "2017-07-28 07:36:11.991109"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "nyah_jaskolski"], ["email", "ramon@dickinson.io"], ["password", "G17u49HdAp2kE"], ["created_at", "2017-07-28 07:36:11.995727"], ["updated_at", "2017-07-28 07:36:11.995727"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "844155"], ["username", "hermann_doyle"], ["image", "http://vk.com/img/hermann_doyle.jpg"], ["profile", "https://vk.com/hermann_doyle"], ["email", "ferne_crona@cole.com"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 20], ["user_id", 48], ["created_at", "2017-07-28 07:36:12.000140"], ["updated_at", "2017-07-28 07:36:12.000140"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zathin"], ["created_at", "2017-07-28 07:36:12.007671"], ["updated_at", "2017-07-28 07:36:12.007671"], ["local_path", "http://purdy.info/tevin"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Voltsillam"], ["title_ru", "Название32"], ["created_at", "2017-07-28 07:36:12.011438"], ["updated_at", "2017-07-28 07:36:12.011438"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 32[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_32[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 32) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>32, "title"=>"Zathin", "created_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "local_path"=>"http://purdy.info/tevin"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zaam-dox"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zaam-dox"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zaam-Dox"], ["category_id", 32], ["slug", "zaam-dox"], ["created_at", "2017-07-28 07:36:12.023142"], ["updated_at", "2017-07-28 07:36:12.023142"], ["layout_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "officia-esse"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Domainer"], ["phone", "509-998-9058"], ["address", "8544 Leannon Forest"], ["url", "http://treutel.net/aglae"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://mayer.org/kirstin"], ["auth_expiration_time", 900], ["slug", "officia-esse"], ["brand_id", 32], ["user_id", 48], ["created_at", "2017-07-28 07:36:12.029128"], ["updated_at", "2017-07-28 07:36:12.029128"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Duobam"], ["created_at", "2017-07-28 07:36:12.037432"], ["updated_at", "2017-07-28 07:36:12.037432"], ["local_path", "http://moore.com/jean.thiel"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Quo Lux"], ["title_ru", "Название33"], ["created_at", "2017-07-28 07:36:12.041203"], ["updated_at", "2017-07-28 07:36:12.041203"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 33[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_33[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 33) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>33, "title"=>"Duobam", "created_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "local_path"=>"http://moore.com/jean.thiel"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitchip"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitchip"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bitchip"], ["category_id", 33], ["slug", "bitchip"], ["created_at", "2017-07-28 07:36:12.052505"], ["updated_at", "2017-07-28 07:36:12.052505"], ["layout_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "violette_spinka"], ["email", "alana@stark.io"], ["password", "MfJ6Io7i8s9p"], ["created_at", "2017-07-28 07:36:12.057286"], ["updated_at", "2017-07-28 07:36:12.057286"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptatibus_itaque"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tin"], ["phone", "849.739.5700"], ["address", "469 Werner Prairie"], ["url", "http://emard.io/laron_murphy"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://okuneva.net/electa"], ["auth_expiration_time", 900], ["slug", "voluptatibus_itaque"], ["brand_id", 33], ["user_id", 49], ["created_at", "2017-07-28 07:36:12.063140"], ["updated_at", "2017-07-28 07:36:12.063140"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "donato.barrows"], ["email", "tremaine@wymanhowell.co"], ["password", "TbE0BoVuLr5rJq"], ["created_at", "2017-07-28 07:36:12.068534"], ["updated_at", "2017-07-28 07:36:12.068534"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5335"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5335"], ["comment", "comment 15"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "50.8.4.3"], ["router_admin_ip", "26.33.107.166"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "745"], ["status", "t"], ["location_id", 33], ["user_id", 50], ["created_at", "2017-07-28 07:36:12.074313"], ["updated_at", "2017-07-28 07:36:12.074313"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5335"], ["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 5], ["serial", "643705CA5E36/5335"], ["comment", "comment 15"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "50.8.4.3"], ["router_admin_ip", "26.33.107.166"], ["admin_password", "5c5dcd3f8a6ed697"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "5"], ["status", "t"], ["location_id", 33], ["user_id", 50], ["created_at", "2017-07-28 07:36:12.074313"], ["updated_at", "2017-07-28 07:36:12.074313"], ["id", 5]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 3a2b14ef-a5e8-4900-a77e-d6678229252b) to Async(routers) with arguments: #<GlobalID:0x007ff101252e80 @uri=#<URI::GID gid://wifi-management/Router/5>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 62d7d305-f695-4fab-8563-42fe8863b1f0) to Async(routers) with arguments: #<GlobalID:0x007ff101252e80 @uri=#<URI::GID gid://wifi-management/Router/5>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 5], ["provider", "instagram"], ["location_id", 32], ["router_id", 5], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:12 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"nyah_jaskolski", "email"=>"ramon@dickinson.io", "password"=>"G17u49HdAp2kE", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"nyah_jaskolski", :email=>"ramon@dickinson.io", :password=>"G17u49HdAp2kE", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"ramon@dickinson.io", "password"=>"G17u49HdAp2kE"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "nyah_jaskolski"], ["email", "ramon@dickinson.io"], ["password", "G17u49HdAp2kE"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 48, username: "nyah_jaskolski", email: "ramon@dickinson.io", password: "G17u49HdAp2kE", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:11", updated_at: "2017-07-28 07:36:11", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 48[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.7ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/locations_list" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:12 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#locations_list[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_48[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 48) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>48, "username"=>"nyah_jaskolski", "email"=>"ramon@dickinson.io", "password"=>"G17u49HdAp2kE", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:11 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"locations_list"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_48[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_48[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>48, :username=>"nyah_jaskolski", :email=>"ramon@dickinson.io", :password=>"G17u49HdAp2kE", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:11.995Z", :updated_at=>"2017-07-28T07:36:11.995Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 48[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Load (0.6ms)[0m  [1m[34mSELECT "locations".* FROM "locations" WHERE "locations"."user_id" = 48[0m
[INFO ] Completed [32m200 OK[0m in 23ms [30m(Views: 0.3ms | ActiveRecord: 4.8ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "226.392.9011"], ["created_at", "2017-07-28 07:36:12.207420"], ["updated_at", "2017-07-28 07:36:12.207420"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "myrtis_muller"], ["email", "elijah@rosenbaumhills.io"], ["password", "BdJpV6V3Ak"], ["created_at", "2017-07-28 07:36:12.212040"], ["updated_at", "2017-07-28 07:36:12.212040"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "185801"], ["username", "keshawn"], ["image", "http://instagram.com/img/keshawn.jpg"], ["profile", "https://instagram.com/keshawn"], ["email", "vidal.crist@west.net"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 21], ["user_id", 51], ["created_at", "2017-07-28 07:36:12.216456"], ["updated_at", "2017-07-28 07:36:12.216456"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Voyatouch"], ["created_at", "2017-07-28 07:36:12.223280"], ["updated_at", "2017-07-28 07:36:12.223280"], ["local_path", "http://murphystoltenberg.net/hanna"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Flexidy"], ["title_ru", "Название34"], ["created_at", "2017-07-28 07:36:12.226742"], ["updated_at", "2017-07-28 07:36:12.226742"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 34[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_34[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 34) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>34, "title"=>"Voyatouch", "created_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "local_path"=>"http://murphystoltenberg.net/hanna"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bytecard"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bytecard"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bytecard"], ["category_id", 34], ["slug", "bytecard"], ["created_at", "2017-07-28 07:36:12.237785"], ["updated_at", "2017-07-28 07:36:12.237785"], ["layout_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "qui.repudiandae"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Span"], ["phone", "714.816.9996"], ["address", "5451 Ebba Greens"], ["url", "http://kiehndouglas.net/monty"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://macgyver.com/sim.bosco"], ["auth_expiration_time", 900], ["slug", "qui.repudiandae"], ["brand_id", 34], ["user_id", 51], ["created_at", "2017-07-28 07:36:12.243215"], ["updated_at", "2017-07-28 07:36:12.243215"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Home Ing"], ["created_at", "2017-07-28 07:36:12.251196"], ["updated_at", "2017-07-28 07:36:12.251196"], ["local_path", "http://howeschowalter.co/desmond"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Flexidy"], ["title_ru", "Название35"], ["created_at", "2017-07-28 07:36:12.254685"], ["updated_at", "2017-07-28 07:36:12.254685"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 35[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_35[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (1.0ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 35) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>35, "title"=>"Home Ing", "created_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "local_path"=>"http://howeschowalter.co/desmond"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zoolab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zoolab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zoolab"], ["category_id", 35], ["slug", "zoolab"], ["created_at", "2017-07-28 07:36:12.265754"], ["updated_at", "2017-07-28 07:36:12.265754"], ["layout_id", 35]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "maritza.weinat"], ["email", "rosetta_nienow@reichel.name"], ["password", "NwJw77GkQfY8"], ["created_at", "2017-07-28 07:36:12.270357"], ["updated_at", "2017-07-28 07:36:12.270357"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "magnam.consectetur"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Regrant"], ["phone", "(415) 680-5408"], ["address", "21807 Waelchi Prairie"], ["url", "http://morarkirlin.name/edison"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hayes.net/gianni"], ["auth_expiration_time", 900], ["slug", "magnam.consectetur"], ["brand_id", 35], ["user_id", 52], ["created_at", "2017-07-28 07:36:12.276118"], ["updated_at", "2017-07-28 07:36:12.276118"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "maribel_sanford"], ["email", "eldred_wolff@roob.name"], ["password", "7yQuJaVxNiZ1"], ["created_at", "2017-07-28 07:36:12.281570"], ["updated_at", "2017-07-28 07:36:12.281570"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5336"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5336"], ["comment", "comment 16"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "71.234.244.158"], ["router_admin_ip", "125.174.5.83"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "758"], ["status", "t"], ["location_id", 35], ["user_id", 53], ["created_at", "2017-07-28 07:36:12.287125"], ["updated_at", "2017-07-28 07:36:12.287125"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5336"], ["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 6], ["serial", "643705CA5E36/5336"], ["comment", "comment 16"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "71.234.244.158"], ["router_admin_ip", "125.174.5.83"], ["admin_password", "4035b1abaa9f5ca3"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "6"], ["status", "t"], ["location_id", 35], ["user_id", 53], ["created_at", "2017-07-28 07:36:12.287125"], ["updated_at", "2017-07-28 07:36:12.287125"], ["id", 6]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 6a27f4a8-bba4-4e3f-8746-bad78f2b401b) to Async(routers) with arguments: #<GlobalID:0x007ff100a2def8 @uri=#<URI::GID gid://wifi-management/Router/6>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 4e29f25f-4eab-4817-a1bd-6a67858645d6) to Async(routers) with arguments: #<GlobalID:0x007ff100a2def8 @uri=#<URI::GID gid://wifi-management/Router/6>>
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.4ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 6], ["provider", "instagram"], ["location_id", 34], ["router_id", 6], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:12 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"myrtis_muller", "email"=>"elijah@rosenbaumhills.io", "password"=>"BdJpV6V3Ak", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"myrtis_muller", :email=>"elijah@rosenbaumhills.io", :password=>"BdJpV6V3Ak", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"elijah@rosenbaumhills.io", "password"=>"BdJpV6V3Ak"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "myrtis_muller"], ["email", "elijah@rosenbaumhills.io"], ["password", "BdJpV6V3Ak"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 51, username: "myrtis_muller", email: "elijah@rosenbaumhills.io", password: "BdJpV6V3Ak", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:12", updated_at: "2017-07-28 07:36:12", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 51[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/all_connects" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:12 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#all_connects[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_51[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 51) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>51, "username"=>"myrtis_muller", "email"=>"elijah@rosenbaumhills.io", "password"=>"BdJpV6V3Ak", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"all_connects"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_51[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_51[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>51, :username=>"myrtis_muller", :email=>"elijah@rosenbaumhills.io", :password=>"BdJpV6V3Ak", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:12.212Z", :updated_at=>"2017-07-28T07:36:12.212Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 51[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 34[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 34 AND ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-06-28 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 34 AND ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 25ms [30m(Views: 0.2ms | ActiveRecord: 7.1ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "450-760-0732"], ["created_at", "2017-07-28 07:36:12.421556"], ["updated_at", "2017-07-28 07:36:12.421556"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "leo"], ["email", "glen@kris.com"], ["password", "Sb29Ck761rDoX"], ["created_at", "2017-07-28 07:36:12.426571"], ["updated_at", "2017-07-28 07:36:12.426571"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "152621"], ["username", "harold"], ["image", "http://instagram.com/img/harold.jpg"], ["profile", "https://instagram.com/harold"], ["email", "marge@bailey.io"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 22], ["user_id", 54], ["created_at", "2017-07-28 07:36:12.431218"], ["updated_at", "2017-07-28 07:36:12.431218"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Redhold"], ["created_at", "2017-07-28 07:36:12.438250"], ["updated_at", "2017-07-28 07:36:12.438250"], ["local_path", "http://welchebert.biz/roberta.blick"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Tempsoft"], ["title_ru", "Название36"], ["created_at", "2017-07-28 07:36:12.442174"], ["updated_at", "2017-07-28 07:36:12.442174"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_36[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 36) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>36, "title"=>"Redhold", "created_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "local_path"=>"http://welchebert.biz/roberta.blick"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitchip"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitchip"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bitchip"], ["category_id", 36], ["slug", "bitchip"], ["created_at", "2017-07-28 07:36:12.453751"], ["updated_at", "2017-07-28 07:36:12.453751"], ["layout_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "velit_maxime"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Alpha"], ["phone", "1-880-333-5308"], ["address", "43174 Bosco Knoll"], ["url", "http://conn.biz/connie"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://baumbachfay.biz/vivienne.marquardt"], ["auth_expiration_time", 900], ["slug", "velit_maxime"], ["brand_id", 36], ["user_id", 54], ["created_at", "2017-07-28 07:36:12.459755"], ["updated_at", "2017-07-28 07:36:12.459755"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Alphazap"], ["created_at", "2017-07-28 07:36:12.468202"], ["updated_at", "2017-07-28 07:36:12.468202"], ["local_path", "http://macgyver.co/deven_pollich"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Quo Lux"], ["title_ru", "Название37"], ["created_at", "2017-07-28 07:36:12.472026"], ["updated_at", "2017-07-28 07:36:12.472026"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 37[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_37[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 37) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>37, "title"=>"Alphazap", "created_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "local_path"=>"http://macgyver.co/deven_pollich"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-solowarm"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-solowarm"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Y-Solowarm"], ["category_id", 37], ["slug", "y-solowarm"], ["created_at", "2017-07-28 07:36:12.483418"], ["updated_at", "2017-07-28 07:36:12.483418"], ["layout_id", 37]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "glenda_toy"], ["email", "amari.buckridge@zulauf.net"], ["password", "SbI5751gBh8w"], ["created_at", "2017-07-28 07:36:12.488219"], ["updated_at", "2017-07-28 07:36:12.488219"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "molestiae-nihil"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Konklab"], ["phone", "282-962-5170"], ["address", "537 Broderick Ville"], ["url", "http://quigleyeichmann.org/patsy"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hahnquitzon.info/rowland"], ["auth_expiration_time", 900], ["slug", "molestiae-nihil"], ["brand_id", 37], ["user_id", 55], ["created_at", "2017-07-28 07:36:12.494431"], ["updated_at", "2017-07-28 07:36:12.494431"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "roman"], ["email", "wanda.gleichner@rolfsonkovacek.com"], ["password", "G3O9S0EhMjI5V"], ["created_at", "2017-07-28 07:36:12.499863"], ["updated_at", "2017-07-28 07:36:12.499863"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5337"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5337"], ["comment", "comment 17"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "134.25.122.21"], ["router_admin_ip", "141.175.76.22"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "562"], ["status", "t"], ["location_id", 37], ["user_id", 56], ["created_at", "2017-07-28 07:36:12.505778"], ["updated_at", "2017-07-28 07:36:12.505778"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5337"], ["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 7], ["serial", "643705CA5E36/5337"], ["comment", "comment 17"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "134.25.122.21"], ["router_admin_ip", "141.175.76.22"], ["admin_password", "0edf4f58ee3d8169"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "7"], ["status", "t"], ["location_id", 37], ["user_id", 56], ["created_at", "2017-07-28 07:36:12.505778"], ["updated_at", "2017-07-28 07:36:12.505778"], ["id", 7]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: ae0979c4-a65c-4232-9e28-300940cc1ab5) to Async(routers) with arguments: #<GlobalID:0x007ff0fe103208 @uri=#<URI::GID gid://wifi-management/Router/7>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 75f4daa4-f48a-4f86-a667-19239556de1b) to Async(routers) with arguments: #<GlobalID:0x007ff0fe103208 @uri=#<URI::GID gid://wifi-management/Router/7>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 7], ["provider", "instagram"], ["location_id", 36], ["router_id", 7], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:12 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"leo", "email"=>"glen@kris.com", "password"=>"Sb29Ck761rDoX", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"leo", :email=>"glen@kris.com", :password=>"Sb29Ck761rDoX", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"glen@kris.com", "password"=>"Sb29Ck761rDoX"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "leo"], ["email", "glen@kris.com"], ["password", "Sb29Ck761rDoX"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 54, username: "leo", email: "glen@kris.com", password: "Sb29Ck761rDoX", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:12", updated_at: "2017-07-28 07:36:12", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 54[0m
[INFO ] Completed [32m201 Created[0m in 6ms [30m(Views: 0.3ms | ActiveRecord: 1.4ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/new_old_users_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:12 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#new_old_users_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_54[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 54) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>54, "username"=>"leo", "email"=>"glen@kris.com", "password"=>"Sb29Ck761rDoX", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"new_old_users_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_54[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_54[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>54, :username=>"leo", :email=>"glen@kris.com", :password=>"Sb29Ck761rDoX", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:12.426Z", :updated_at=>"2017-07-28T07:36:12.426Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 54[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.3ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" = 36 AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 38ms [30m(Views: 1.1ms | ActiveRecord: 13.7ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "786.558.1536"], ["created_at", "2017-07-28 07:36:12.934453"], ["updated_at", "2017-07-28 07:36:12.934453"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "hardy"], ["email", "elouise_ko@oconner.com"], ["password", "3oHcXcZxIwV"], ["created_at", "2017-07-28 07:36:12.939402"], ["updated_at", "2017-07-28 07:36:12.939402"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "571930"], ["username", "hosea.greenholt"], ["image", "http://vk.com/img/hosea.greenholt.jpg"], ["profile", "https://vk.com/hosea.greenholt"], ["email", "brent_cronin@yundtrowe.com"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 23], ["user_id", 57], ["created_at", "2017-07-28 07:36:12.943748"], ["updated_at", "2017-07-28 07:36:12.943748"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Fix San"], ["created_at", "2017-07-28 07:36:12.950597"], ["updated_at", "2017-07-28 07:36:12.950597"], ["local_path", "http://boyer.biz/luigi_daniel"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bitwolf"], ["title_ru", "Название38"], ["created_at", "2017-07-28 07:36:12.954426"], ["updated_at", "2017-07-28 07:36:12.954426"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 38[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_38[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 38) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>38, "title"=>"Fix San", "created_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "local_path"=>"http://boyer.biz/luigi_daniel"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "wrapsafe"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "wrapsafe"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Wrapsafe"], ["category_id", 38], ["slug", "wrapsafe"], ["created_at", "2017-07-28 07:36:12.965889"], ["updated_at", "2017-07-28 07:36:12.965889"], ["layout_id", 38]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "deserunt-et"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Veribet"], ["phone", "768-050-0571"], ["address", "92026 Annabell Square"], ["url", "http://thompsonkuphal.io/laney.altenwerth"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://feilemmerich.name/athena"], ["auth_expiration_time", 900], ["slug", "deserunt-et"], ["brand_id", 38], ["user_id", 57], ["created_at", "2017-07-28 07:36:12.971945"], ["updated_at", "2017-07-28 07:36:12.971945"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Cardify"], ["created_at", "2017-07-28 07:36:12.980049"], ["updated_at", "2017-07-28 07:36:12.980049"], ["local_path", "http://schneider.org/santiago"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Quo Lux"], ["title_ru", "Название39"], ["created_at", "2017-07-28 07:36:12.983948"], ["updated_at", "2017-07-28 07:36:12.983948"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_39[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 39) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>39, "title"=>"Cardify", "created_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "local_path"=>"http://schneider.org/santiago"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "lotstring"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "lotstring"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Lotstring"], ["category_id", 39], ["slug", "lotstring"], ["created_at", "2017-07-28 07:36:12.994682"], ["updated_at", "2017-07-28 07:36:12.994682"], ["layout_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "nina"], ["email", "alisha.gleichner@becker.net"], ["password", "S4WaY4Qr"], ["created_at", "2017-07-28 07:36:12.999530"], ["updated_at", "2017-07-28 07:36:12.999530"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "dolorem.pariatur"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bitchip"], ["phone", "1-347-278-6252"], ["address", "9262 Bechtelar Estates"], ["url", "http://reynoldtrosin.com/werner"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://pfannerstill.net/jillian"], ["auth_expiration_time", 900], ["slug", "dolorem.pariatur"], ["brand_id", 39], ["user_id", 58], ["created_at", "2017-07-28 07:36:13.005523"], ["updated_at", "2017-07-28 07:36:13.005523"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "wellington"], ["email", "dexter_muller@grant.net"], ["password", "6tOhIcQz"], ["created_at", "2017-07-28 07:36:13.010854"], ["updated_at", "2017-07-28 07:36:13.010854"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5338"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5338"], ["comment", "comment 18"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "141.208.168.120"], ["router_admin_ip", "237.179.12.154"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "756"], ["status", "t"], ["location_id", 39], ["user_id", 59], ["created_at", "2017-07-28 07:36:13.016682"], ["updated_at", "2017-07-28 07:36:13.016682"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5338"], ["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 8], ["serial", "643705CA5E36/5338"], ["comment", "comment 18"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "141.208.168.120"], ["router_admin_ip", "237.179.12.154"], ["admin_password", "eca3d34ccb8db1ad"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "8"], ["status", "t"], ["location_id", 39], ["user_id", 59], ["created_at", "2017-07-28 07:36:13.016682"], ["updated_at", "2017-07-28 07:36:13.016682"], ["id", 8]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: f0720613-8911-418d-ab2b-d01142a40149) to Async(routers) with arguments: #<GlobalID:0x007ff10343a958 @uri=#<URI::GID gid://wifi-management/Router/8>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 81e00b13-a549-4e5d-b787-a5261b684597) to Async(routers) with arguments: #<GlobalID:0x007ff10343a958 @uri=#<URI::GID gid://wifi-management/Router/8>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.3ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (4.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 8], ["provider", "instagram"], ["location_id", 38], ["router_id", 8], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:13 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"hardy", "email"=>"elouise_ko@oconner.com", "password"=>"3oHcXcZxIwV", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"hardy", :email=>"elouise_ko@oconner.com", :password=>"3oHcXcZxIwV", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"elouise_ko@oconner.com", "password"=>"3oHcXcZxIwV"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "hardy"], ["email", "elouise_ko@oconner.com"], ["password", "3oHcXcZxIwV"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 57, username: "hardy", email: "elouise_ko@oconner.com", password: "3oHcXcZxIwV", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:12", updated_at: "2017-07-28 07:36:12", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 57[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/visitors_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:13 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#visitors_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_57[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 57) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>57, "username"=>"hardy", "email"=>"elouise_ko@oconner.com", "password"=>"3oHcXcZxIwV", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:12 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"visitors_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_57[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_57[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>57, :username=>"hardy", :email=>"elouise_ko@oconner.com", :password=>"3oHcXcZxIwV", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:12.939Z", :updated_at=>"2017-07-28T07:36:12.939Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 57[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.1ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" = 38 AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 24ms [30m(Views: 1.0ms | ActiveRecord: 7.1ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "602-704-1944"], ["created_at", "2017-07-28 07:36:13.443954"], ["updated_at", "2017-07-28 07:36:13.443954"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jaron"], ["email", "jannie.fritsch@erdman.io"], ["password", "17C76nFn3nUmD"], ["created_at", "2017-07-28 07:36:13.449187"], ["updated_at", "2017-07-28 07:36:13.449187"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "218691"], ["username", "chyna"], ["image", "http://twitter.com/img/chyna.jpg"], ["profile", "https://twitter.com/chyna"], ["email", "karelle@marks.net"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 24], ["user_id", 60], ["created_at", "2017-07-28 07:36:13.454003"], ["updated_at", "2017-07-28 07:36:13.454003"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tin"], ["created_at", "2017-07-28 07:36:13.461993"], ["updated_at", "2017-07-28 07:36:13.461993"], ["local_path", "http://mannpaucek.name/lonny.johnson"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bytecard"], ["title_ru", "Название40"], ["created_at", "2017-07-28 07:36:13.466126"], ["updated_at", "2017-07-28 07:36:13.466126"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 40[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_40[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 40) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>40, "title"=>"Tin", "created_at"=>Fri, 28 Jul 2017 07:36:13 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:13 UTC +00:00, "local_path"=>"http://mannpaucek.name/lonny.johnson"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "gembucket"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "gembucket"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Gembucket"], ["category_id", 40], ["slug", "gembucket"], ["created_at", "2017-07-28 07:36:13.479381"], ["updated_at", "2017-07-28 07:36:13.479381"], ["layout_id", 40]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "nihil.voluptatem"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Holdlamis"], ["phone", "926-198-2938"], ["address", "3657 Glover Crest"], ["url", "http://weimann.com/tyree.ritchie"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kunze.io/name_johns"], ["auth_expiration_time", 900], ["slug", "nihil.voluptatem"], ["brand_id", 40], ["user_id", 60], ["created_at", "2017-07-28 07:36:13.485954"], ["updated_at", "2017-07-28 07:36:13.485954"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Otcom"], ["created_at", "2017-07-28 07:36:13.495204"], ["updated_at", "2017-07-28 07:36:13.495204"], ["local_path", "http://towne.name/kayla"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Subin"], ["title_ru", "Название41"], ["created_at", "2017-07-28 07:36:13.499027"], ["updated_at", "2017-07-28 07:36:13.499027"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 41[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_41[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 41) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>41, "title"=>"Otcom", "created_at"=>Fri, 28 Jul 2017 07:36:13 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:13 UTC +00:00, "local_path"=>"http://towne.name/kayla"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tempsoft"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tempsoft"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tempsoft"], ["category_id", 41], ["slug", "tempsoft"], ["created_at", "2017-07-28 07:36:13.510506"], ["updated_at", "2017-07-28 07:36:13.510506"], ["layout_id", 41]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "vickie.ortiz"], ["email", "alverta_bogan@spinka.co"], ["password", "EfRtQ2Up790q"], ["created_at", "2017-07-28 07:36:13.515742"], ["updated_at", "2017-07-28 07:36:13.515742"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "beatae-eligendi"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Viva"], ["phone", "1-674-303-1189"], ["address", "966 Allison Ford"], ["url", "http://rohan.name/aglae.kohler"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://denesik.com/alanna_johns"], ["auth_expiration_time", 900], ["slug", "beatae-eligendi"], ["brand_id", 41], ["user_id", 61], ["created_at", "2017-07-28 07:36:13.522289"], ["updated_at", "2017-07-28 07:36:13.522289"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "brenden"], ["email", "guie.auer@townecarroll.biz"], ["password", "R77g3jR0EgHu31"], ["created_at", "2017-07-28 07:36:13.527709"], ["updated_at", "2017-07-28 07:36:13.527709"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5339"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5339"], ["comment", "comment 19"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "134.249.153.136"], ["router_admin_ip", "86.157.186.20"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "391"], ["status", "t"], ["location_id", 41], ["user_id", 62], ["created_at", "2017-07-28 07:36:13.533807"], ["updated_at", "2017-07-28 07:36:13.533807"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5339"], ["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 9], ["serial", "643705CA5E36/5339"], ["comment", "comment 19"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "134.249.153.136"], ["router_admin_ip", "86.157.186.20"], ["admin_password", "94a504e1e8842961"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "9"], ["status", "t"], ["location_id", 41], ["user_id", 62], ["created_at", "2017-07-28 07:36:13.533807"], ["updated_at", "2017-07-28 07:36:13.533807"], ["id", 9]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 933210db-fa52-4045-9079-eae23508c34f) to Async(routers) with arguments: #<GlobalID:0x007ff10455d578 @uri=#<URI::GID gid://wifi-management/Router/9>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 4329fd37-ed11-4668-a4f0-e6196d892783) to Async(routers) with arguments: #<GlobalID:0x007ff10455d578 @uri=#<URI::GID gid://wifi-management/Router/9>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 9], ["provider", "instagram"], ["location_id", 40], ["router_id", 9], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(635) 190-4114"], ["created_at", "2017-07-28 07:36:13.819814"], ["updated_at", "2017-07-28 07:36:13.819814"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "leonie_spinka"], ["email", "stanley.koch@hagenes.io"], ["password", "F9XwNkWaEuH4Ky8"], ["created_at", "2017-07-28 07:36:13.824833"], ["updated_at", "2017-07-28 07:36:13.824833"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "635344"], ["username", "hilma_ullrich"], ["image", "http://instagram.com/img/hilma_ullrich.jpg"], ["profile", "https://instagram.com/hilma_ullrich"], ["email", "benton@medhurstsipes.net"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 25], ["user_id", 63], ["created_at", "2017-07-28 07:36:13.829399"], ["updated_at", "2017-07-28 07:36:13.829399"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "It"], ["created_at", "2017-07-28 07:36:13.836652"], ["updated_at", "2017-07-28 07:36:13.836652"], ["local_path", "http://deckowwuckert.net/alba"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Konklab"], ["title_ru", "Название42"], ["created_at", "2017-07-28 07:36:13.840676"], ["updated_at", "2017-07-28 07:36:13.840676"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_42[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 42) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>42, "title"=>"It", "created_at"=>Fri, 28 Jul 2017 07:36:13 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:13 UTC +00:00, "local_path"=>"http://deckowwuckert.net/alba"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stim"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stim"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Stim"], ["category_id", 42], ["slug", "stim"], ["created_at", "2017-07-28 07:36:13.852416"], ["updated_at", "2017-07-28 07:36:13.852416"], ["layout_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ut-quia"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bitwolf"], ["phone", "198-409-8937"], ["address", "64057 Nedra Meadows"], ["url", "http://mcdermott.co/arlo"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://turner.io/polly_schimmel"], ["auth_expiration_time", 900], ["slug", "ut-quia"], ["brand_id", 42], ["user_id", 63], ["created_at", "2017-07-28 07:36:13.858805"], ["updated_at", "2017-07-28 07:36:13.858805"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Y-find"], ["created_at", "2017-07-28 07:36:13.867199"], ["updated_at", "2017-07-28 07:36:13.867199"], ["local_path", "http://tillman.co/vidal_pfannerstill"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zathin"], ["title_ru", "Название43"], ["created_at", "2017-07-28 07:36:13.871002"], ["updated_at", "2017-07-28 07:36:13.871002"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 43[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_43[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 43) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>43, "title"=>"Y-find", "created_at"=>Fri, 28 Jul 2017 07:36:13 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:13 UTC +00:00, "local_path"=>"http://tillman.co/vidal_pfannerstill"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "transcof"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "transcof"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Transcof"], ["category_id", 43], ["slug", "transcof"], ["created_at", "2017-07-28 07:36:13.882271"], ["updated_at", "2017-07-28 07:36:13.882271"], ["layout_id", 43]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "fannie"], ["email", "vladimir@walshgreenholt.org"], ["password", "Ap4eKfDq2a"], ["created_at", "2017-07-28 07:36:13.887281"], ["updated_at", "2017-07-28 07:36:13.887281"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quis_consequuntur"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Aerified"], ["phone", "1-161-600-0723"], ["address", "404 Mann Squares"], ["url", "http://shields.name/rusty"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://gaylord.net/ova.schaefer"], ["auth_expiration_time", 900], ["slug", "quis_consequuntur"], ["brand_id", 43], ["user_id", 64], ["created_at", "2017-07-28 07:36:13.893280"], ["updated_at", "2017-07-28 07:36:13.893280"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "dorcas"], ["email", "junius_parker@hintzerdman.com"], ["password", "Pg7yPtOn"], ["created_at", "2017-07-28 07:36:13.898978"], ["updated_at", "2017-07-28 07:36:13.898978"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53310"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53310"], ["comment", "comment 110"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "245.65.197.109"], ["router_admin_ip", "248.230.35.147"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "215"], ["status", "t"], ["location_id", 43], ["user_id", 65], ["created_at", "2017-07-28 07:36:13.905166"], ["updated_at", "2017-07-28 07:36:13.905166"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53310"], ["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 10], ["serial", "643705CA5E36/53310"], ["comment", "comment 110"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "245.65.197.109"], ["router_admin_ip", "248.230.35.147"], ["admin_password", "73a69cd9f9f1735c"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "10"], ["status", "t"], ["location_id", 43], ["user_id", 65], ["created_at", "2017-07-28 07:36:13.905166"], ["updated_at", "2017-07-28 07:36:13.905166"], ["id", 10]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: aa2831ef-894c-4ad6-8344-de30621a5327) to Async(routers) with arguments: #<GlobalID:0x007ff103660f98 @uri=#<URI::GID gid://wifi-management/Router/10>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 85896696-fd38-40d8-9087-e3d74e14fd53) to Async(routers) with arguments: #<GlobalID:0x007ff103660f98 @uri=#<URI::GID gid://wifi-management/Router/10>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 10], ["provider", "instagram"], ["location_id", 42], ["router_id", 10], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:14 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"leonie_spinka", "email"=>"stanley.koch@hagenes.io", "password"=>"F9XwNkWaEuH4Ky8", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"leonie_spinka", :email=>"stanley.koch@hagenes.io", :password=>"F9XwNkWaEuH4Ky8", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"stanley.koch@hagenes.io", "password"=>"F9XwNkWaEuH4Ky8"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "leonie_spinka"], ["email", "stanley.koch@hagenes.io"], ["password", "F9XwNkWaEuH4Ky8"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 63, username: "leonie_spinka", email: "stanley.koch@hagenes.io", password: "F9XwNkWaEuH4Ky8", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:13", updated_at: "2017-07-28 07:36:13", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 63[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/age_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:14 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#age_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 63[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_63[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 63) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>63, "username"=>"leonie_spinka", "email"=>"stanley.koch@hagenes.io", "password"=>"F9XwNkWaEuH4Ky8", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:13 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:13 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"age_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 63[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_63[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 63[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_63[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>63, :username=>"leonie_spinka", :email=>"stanley.koch@hagenes.io", :password=>"F9XwNkWaEuH4Ky8", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:13.824Z", :updated_at=>"2017-07-28T07:36:13.824Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 63[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.8ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(42) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 26ms [30m(Views: 1.2ms | ActiveRecord: 9.0ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(876) 206-7919 x04528"], ["created_at", "2017-07-28 07:36:14.283377"], ["updated_at", "2017-07-28 07:36:14.283377"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "emelia"], ["email", "eldridge.weber@beierkeler.co"], ["password", "U7O7B2AhIwIlGxSk"], ["created_at", "2017-07-28 07:36:14.288592"], ["updated_at", "2017-07-28 07:36:14.288592"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "106874"], ["username", "wava_jacobs"], ["image", "http://twitter.com/img/wava_jacobs.jpg"], ["profile", "https://twitter.com/wava_jacobs"], ["email", "amina.hintz@kiehn.com"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 26], ["user_id", 66], ["created_at", "2017-07-28 07:36:14.293057"], ["updated_at", "2017-07-28 07:36:14.293057"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Pannier"], ["created_at", "2017-07-28 07:36:14.300491"], ["updated_at", "2017-07-28 07:36:14.300491"], ["local_path", "http://hamillzulauf.io/mathilde"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Y-find"], ["title_ru", "Название44"], ["created_at", "2017-07-28 07:36:14.304427"], ["updated_at", "2017-07-28 07:36:14.304427"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 44[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_44[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 44) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>44, "title"=>"Pannier", "created_at"=>Fri, 28 Jul 2017 07:36:14 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:14 UTC +00:00, "local_path"=>"http://hamillzulauf.io/mathilde"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "rank"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "rank"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Rank"], ["category_id", 44], ["slug", "rank"], ["created_at", "2017-07-28 07:36:14.316175"], ["updated_at", "2017-07-28 07:36:14.316175"], ["layout_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "deserunt_expedita"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zoolab"], ["phone", "1-837-864-4251"], ["address", "86922 Keebler Crest"], ["url", "http://morar.biz/lisette"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://lehner.info/justyn_lueilwitz"], ["auth_expiration_time", 900], ["slug", "deserunt_expedita"], ["brand_id", 44], ["user_id", 66], ["created_at", "2017-07-28 07:36:14.322463"], ["updated_at", "2017-07-28 07:36:14.322463"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Lotlux"], ["created_at", "2017-07-28 07:36:14.330925"], ["updated_at", "2017-07-28 07:36:14.330925"], ["local_path", "http://rodriguez.name/tania.gleason"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Domainer"], ["title_ru", "Название45"], ["created_at", "2017-07-28 07:36:14.334775"], ["updated_at", "2017-07-28 07:36:14.334775"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 45[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_45[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 45) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>45, "title"=>"Lotlux", "created_at"=>Fri, 28 Jul 2017 07:36:14 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:14 UTC +00:00, "local_path"=>"http://rodriguez.name/tania.gleason"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alpha"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alpha"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Alpha"], ["category_id", 45], ["slug", "alpha"], ["created_at", "2017-07-28 07:36:14.346257"], ["updated_at", "2017-07-28 07:36:14.346257"], ["layout_id", 45]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "elmore.kub"], ["email", "estrella.bernhard@lynch.com"], ["password", "02TaJiQhB9X1Qu"], ["created_at", "2017-07-28 07:36:14.351206"], ["updated_at", "2017-07-28 07:36:14.351206"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "deleniti.assumenda"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Job"], ["phone", "786.557.2775"], ["address", "83588 Kub Glens"], ["url", "http://schummschulist.org/lela.quigley"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://greenfelder.name/gabriella"], ["auth_expiration_time", 900], ["slug", "deleniti.assumenda"], ["brand_id", 45], ["user_id", 67], ["created_at", "2017-07-28 07:36:14.357519"], ["updated_at", "2017-07-28 07:36:14.357519"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "karen"], ["email", "ellis.kulas@swaniawski.biz"], ["password", "HhHtE7N75tW"], ["created_at", "2017-07-28 07:36:14.363083"], ["updated_at", "2017-07-28 07:36:14.363083"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53311"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53311"], ["comment", "comment 111"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "158.222.250.151"], ["router_admin_ip", "3.4.212.244"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "955"], ["status", "t"], ["location_id", 45], ["user_id", 68], ["created_at", "2017-07-28 07:36:14.369093"], ["updated_at", "2017-07-28 07:36:14.369093"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53311"], ["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 11], ["serial", "643705CA5E36/53311"], ["comment", "comment 111"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "158.222.250.151"], ["router_admin_ip", "3.4.212.244"], ["admin_password", "6c7f846e49b0b938"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "11"], ["status", "t"], ["location_id", 45], ["user_id", 68], ["created_at", "2017-07-28 07:36:14.369093"], ["updated_at", "2017-07-28 07:36:14.369093"], ["id", 11]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: b71192b2-3b9a-4831-bb54-0114af18fdc2) to Async(routers) with arguments: #<GlobalID:0x007ff0fb65eea8 @uri=#<URI::GID gid://wifi-management/Router/11>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: ec38ba0d-202f-4c8b-b816-443745e4e051) to Async(routers) with arguments: #<GlobalID:0x007ff0fb65eea8 @uri=#<URI::GID gid://wifi-management/Router/11>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 11], ["provider", "instagram"], ["location_id", 44], ["router_id", 11], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:14 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"emelia", "email"=>"eldridge.weber@beierkeler.co", "password"=>"U7O7B2AhIwIlGxSk", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"emelia", :email=>"eldridge.weber@beierkeler.co", :password=>"U7O7B2AhIwIlGxSk", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"eldridge.weber@beierkeler.co", "password"=>"U7O7B2AhIwIlGxSk"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "emelia"], ["email", "eldridge.weber@beierkeler.co"], ["password", "U7O7B2AhIwIlGxSk"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 66, username: "emelia", email: "eldridge.weber@beierkeler.co", password: "U7O7B2AhIwIlGxSk", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:14", updated_at: "2017-07-28 07:36:14", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 66[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/gender_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:14 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#gender_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 66[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_66[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 66) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>66, "username"=>"emelia", "email"=>"eldridge.weber@beierkeler.co", "password"=>"U7O7B2AhIwIlGxSk", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:14 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:14 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"gender_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 66[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_66[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 66[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_66[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>66, :username=>"emelia", :email=>"eldridge.weber@beierkeler.co", :password=>"U7O7B2AhIwIlGxSk", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:14.288Z", :updated_at=>"2017-07-28T07:36:14.288Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 66[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.4ms)[0m  [1m[34mSELECT DISTINCT COUNT(DISTINCT social_accounts.id) AS count_social_accounts_id, "gender" AS gender FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" = 44 AND ("social_logs"."updated_at" BETWEEN $1 AND $2) GROUP BY "gender"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 26ms [30m(Views: 1.2ms | ActiveRecord: 6.8ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "956-119-3002"], ["created_at", "2017-07-28 07:36:14.510124"], ["updated_at", "2017-07-28 07:36:14.510124"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "clovis.kreiger"], ["email", "darrion@mcglynn.co"], ["password", "6bXwBgN1Ka"], ["created_at", "2017-07-28 07:36:14.514956"], ["updated_at", "2017-07-28 07:36:14.514956"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "3972"], ["username", "zoe.farrell"], ["image", "http://instagram.com/img/zoe.farrell.jpg"], ["profile", "https://instagram.com/zoe.farrell"], ["email", "mario@pfannerstillmccullough.info"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 27], ["user_id", 69], ["created_at", "2017-07-28 07:36:14.519070"], ["updated_at", "2017-07-28 07:36:14.519070"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Lotlux"], ["created_at", "2017-07-28 07:36:14.526112"], ["updated_at", "2017-07-28 07:36:14.526112"], ["local_path", "http://kohler.org/rosendo.wintheiser"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Stronghold"], ["title_ru", "Название46"], ["created_at", "2017-07-28 07:36:14.529626"], ["updated_at", "2017-07-28 07:36:14.529626"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 46[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_46[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 46) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>46, "title"=>"Lotlux", "created_at"=>Fri, 28 Jul 2017 07:36:14 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:14 UTC +00:00, "local_path"=>"http://kohler.org/rosendo.wintheiser"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "aerified"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "aerified"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Aerified"], ["category_id", 46], ["slug", "aerified"], ["created_at", "2017-07-28 07:36:14.541168"], ["updated_at", "2017-07-28 07:36:14.541168"], ["layout_id", 46]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "delectus-voluptas"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Job"], ["phone", "1-566-846-4508"], ["address", "98478 Lueilwitz Overpass"], ["url", "http://sipes.name/vern"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://walsh.net/oliver_kihn"], ["auth_expiration_time", 900], ["slug", "delectus-voluptas"], ["brand_id", 46], ["user_id", 69], ["created_at", "2017-07-28 07:36:14.547195"], ["updated_at", "2017-07-28 07:36:14.547195"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Home Ing"], ["created_at", "2017-07-28 07:36:14.555430"], ["updated_at", "2017-07-28 07:36:14.555430"], ["local_path", "http://weinatcollins.net/cristal"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Wrapsafe"], ["title_ru", "Название47"], ["created_at", "2017-07-28 07:36:14.559191"], ["updated_at", "2017-07-28 07:36:14.559191"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 47[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_47[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 47) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>47, "title"=>"Home Ing", "created_at"=>Fri, 28 Jul 2017 07:36:14 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:14 UTC +00:00, "local_path"=>"http://weinatcollins.net/cristal"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "solarbreeze"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "solarbreeze"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Solarbreeze"], ["category_id", 47], ["slug", "solarbreeze"], ["created_at", "2017-07-28 07:36:14.570197"], ["updated_at", "2017-07-28 07:36:14.570197"], ["layout_id", 47]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "adrianna"], ["email", "jacynthe@ziemann.biz"], ["password", "UzTzGuRkW608W"], ["created_at", "2017-07-28 07:36:14.575084"], ["updated_at", "2017-07-28 07:36:14.575084"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et-voluptates"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Rank"], ["phone", "679-591-5495"], ["address", "14713 Hyatt Passage"], ["url", "http://andersonwintheiser.io/petra_roberts"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://haley.org/adrien"], ["auth_expiration_time", 900], ["slug", "et-voluptates"], ["brand_id", 47], ["user_id", 70], ["created_at", "2017-07-28 07:36:14.580940"], ["updated_at", "2017-07-28 07:36:14.580940"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "julian.bartell"], ["email", "louvenia@blickhegmann.info"], ["password", "Rt27CkS0"], ["created_at", "2017-07-28 07:36:14.586120"], ["updated_at", "2017-07-28 07:36:14.586120"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53312"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53312"], ["comment", "comment 112"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "68.224.125.215"], ["router_admin_ip", "18.230.239.34"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "626"], ["status", "t"], ["location_id", 47], ["user_id", 71], ["created_at", "2017-07-28 07:36:14.591752"], ["updated_at", "2017-07-28 07:36:14.591752"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53312"], ["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 12], ["serial", "643705CA5E36/53312"], ["comment", "comment 112"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "68.224.125.215"], ["router_admin_ip", "18.230.239.34"], ["admin_password", "0fca66a4a973f758"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "12"], ["status", "t"], ["location_id", 47], ["user_id", 71], ["created_at", "2017-07-28 07:36:14.591752"], ["updated_at", "2017-07-28 07:36:14.591752"], ["id", 12]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 91f9f05a-cb73-4237-b00b-fdbc2747509b) to Async(routers) with arguments: #<GlobalID:0x007ff10323f770 @uri=#<URI::GID gid://wifi-management/Router/12>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: c52cbfba-acdb-4468-be94-c722fd925283) to Async(routers) with arguments: #<GlobalID:0x007ff10323f770 @uri=#<URI::GID gid://wifi-management/Router/12>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 12], ["provider", "instagram"], ["location_id", 46], ["router_id", 12], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:14 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"clovis.kreiger", "email"=>"darrion@mcglynn.co", "password"=>"6bXwBgN1Ka", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"clovis.kreiger", :email=>"darrion@mcglynn.co", :password=>"6bXwBgN1Ka", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"darrion@mcglynn.co", "password"=>"6bXwBgN1Ka"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "clovis.kreiger"], ["email", "darrion@mcglynn.co"], ["password", "6bXwBgN1Ka"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 69, username: "clovis.kreiger", email: "darrion@mcglynn.co", password: "6bXwBgN1Ka", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:14", updated_at: "2017-07-28 07:36:14", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 69[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/new_old_users" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:14 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#new_old_users[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 69[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_69[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 69) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>69, "username"=>"clovis.kreiger", "email"=>"darrion@mcglynn.co", "password"=>"6bXwBgN1Ka", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:14 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:14 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"new_old_users"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 69[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_69[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 69[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_69[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>69, :username=>"clovis.kreiger", :email=>"darrion@mcglynn.co", :password=>"6bXwBgN1Ka", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:14.514Z", :updated_at=>"2017-07-28T07:36:14.514Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 69[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.6ms)[0m  [1m[34m
      select
        newusrs.chart_interval,
        ttlusrs.returning as returning_users,
        newusrs.new_users,
        ttlusrs.returning + newusrs.new_users as total
      from (select
          chart_interval,
          count (id) as new_users
        from (select
            distinct cl.id,
            date_trunc('day', dd)::date as chart_interval
          FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
          left outer join social_accounts sa on date_trunc('day', sa.created_at) = date_trunc('day', dd)
          left outer join clients cl on sa.client_id = cl.id
          join social_logs sl on sa.id = sl.social_account_id
            and location_id in(46)
      	  order by chart_interval) as chart
        group by chart_interval
        order by chart_interval
      ) as newusrs join (select
          date_trunc('day', dd):: date as chart_interval,
          count (distinct cl.id) as returning
        FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
        left outer join social_logs sl on date_trunc('day', sl.created_at) = date_trunc('day', dd)
          and location_id in(46)
        join social_accounts sa on sa.id = sl.social_account_id
        left outer join clients cl on date_trunc('day', cl.created_at) < date_trunc('day', dd)
          and sa.client_id = cl.id
        group by chart_interval
        order by chart_interval
      ) as ttlusrs on ttlusrs.chart_interval = newusrs.chart_interval[0m
[INFO ] Completed [32m200 OK[0m in 26ms [30m(Views: 0.7ms | ActiveRecord: 8.4ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-681-987-5850 x08889"], ["created_at", "2017-07-28 07:36:14.832101"], ["updated_at", "2017-07-28 07:36:14.832101"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "shaun"], ["email", "ernie@brekke.com"], ["password", "Se3sSu44Y0U"], ["created_at", "2017-07-28 07:36:14.837851"], ["updated_at", "2017-07-28 07:36:14.837851"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "349460"], ["username", "meta"], ["image", "http://instagram.com/img/meta.jpg"], ["profile", "https://instagram.com/meta"], ["email", "stephan@lemkezboncak.com"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 28], ["user_id", 72], ["created_at", "2017-07-28 07:36:14.842649"], ["updated_at", "2017-07-28 07:36:14.842649"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Konklab"], ["created_at", "2017-07-28 07:36:14.850124"], ["updated_at", "2017-07-28 07:36:14.850124"], ["local_path", "http://wiegand.com/aliya_hartmann"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Latlux"], ["title_ru", "Название48"], ["created_at", "2017-07-28 07:36:14.854202"], ["updated_at", "2017-07-28 07:36:14.854202"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_48[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 48) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>48, "title"=>"Konklab", "created_at"=>Fri, 28 Jul 2017 07:36:14 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:14 UTC +00:00, "local_path"=>"http://wiegand.com/aliya_hartmann"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Quo Lux"], ["category_id", 48], ["slug", "quo-lux"], ["created_at", "2017-07-28 07:36:14.866234"], ["updated_at", "2017-07-28 07:36:14.866234"], ["layout_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "similique-qui"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Wrapsafe"], ["phone", "(922) 236-6488"], ["address", "48105 Deron Hills"], ["url", "http://dickinson.net/carson"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://christiansenhintz.name/paige.conn"], ["auth_expiration_time", 900], ["slug", "similique-qui"], ["brand_id", 48], ["user_id", 72], ["created_at", "2017-07-28 07:36:14.872308"], ["updated_at", "2017-07-28 07:36:14.872308"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Solarbreeze"], ["created_at", "2017-07-28 07:36:14.881108"], ["updated_at", "2017-07-28 07:36:14.881108"], ["local_path", "http://bashiriansawayn.name/luisa.kemmer"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Flexidy"], ["title_ru", "Название49"], ["created_at", "2017-07-28 07:36:14.885256"], ["updated_at", "2017-07-28 07:36:14.885256"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 49[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_49[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 49) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>49, "title"=>"Solarbreeze", "created_at"=>Fri, 28 Jul 2017 07:36:14 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:14 UTC +00:00, "local_path"=>"http://bashiriansawayn.name/luisa.kemmer"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "regrant"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "regrant"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Regrant"], ["category_id", 49], ["slug", "regrant"], ["created_at", "2017-07-28 07:36:14.897349"], ["updated_at", "2017-07-28 07:36:14.897349"], ["layout_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "sibyl"], ["email", "corbin@mayert.com"], ["password", "GvUaB47yPs1wSmA"], ["created_at", "2017-07-28 07:36:14.902260"], ["updated_at", "2017-07-28 07:36:14.902260"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "nostrum.doloremque"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Voltsillam"], ["phone", "692-026-2194"], ["address", "49219 Schoen Stream"], ["url", "http://ullrichjacobson.io/adrienne"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://stamm.co/nettie"], ["auth_expiration_time", 900], ["slug", "nostrum.doloremque"], ["brand_id", 49], ["user_id", 73], ["created_at", "2017-07-28 07:36:14.908455"], ["updated_at", "2017-07-28 07:36:14.908455"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "reina"], ["email", "tyshawn@stromanstiedemann.io"], ["password", "Wi61MgLoP"], ["created_at", "2017-07-28 07:36:14.913835"], ["updated_at", "2017-07-28 07:36:14.913835"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53313"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53313"], ["comment", "comment 113"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "182.164.202.228"], ["router_admin_ip", "107.12.117.31"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "966"], ["status", "t"], ["location_id", 49], ["user_id", 74], ["created_at", "2017-07-28 07:36:14.919566"], ["updated_at", "2017-07-28 07:36:14.919566"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53313"], ["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 13], ["serial", "643705CA5E36/53313"], ["comment", "comment 113"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "182.164.202.228"], ["router_admin_ip", "107.12.117.31"], ["admin_password", "b348ba56cc77569b"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "13"], ["status", "t"], ["location_id", 49], ["user_id", 74], ["created_at", "2017-07-28 07:36:14.919566"], ["updated_at", "2017-07-28 07:36:14.919566"], ["id", 13]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 0cf961ce-94e3-4cca-9947-9568336d2aec) to Async(routers) with arguments: #<GlobalID:0x007ff0fb7b5dd8 @uri=#<URI::GID gid://wifi-management/Router/13>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 5eb4c957-186e-4d56-a0da-21375b836232) to Async(routers) with arguments: #<GlobalID:0x007ff0fb7b5dd8 @uri=#<URI::GID gid://wifi-management/Router/13>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 13], ["provider", "instagram"], ["location_id", 48], ["router_id", 13], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:15 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"shaun", "email"=>"ernie@brekke.com", "password"=>"Se3sSu44Y0U", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"shaun", :email=>"ernie@brekke.com", :password=>"Se3sSu44Y0U", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"ernie@brekke.com", "password"=>"Se3sSu44Y0U"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "shaun"], ["email", "ernie@brekke.com"], ["password", "Se3sSu44Y0U"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 72, username: "shaun", email: "ernie@brekke.com", password: "Se3sSu44Y0U", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:14", updated_at: "2017-07-28 07:36:14", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 72[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/clients_count" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:15 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#clients_count[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 72[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_72[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 72) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>72, "username"=>"shaun", "email"=>"ernie@brekke.com", "password"=>"Se3sSu44Y0U", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:14 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:14 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"clients_count"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 72[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_72[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 72[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_72[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>72, :username=>"shaun", :email=>"ernie@brekke.com", :password=>"Se3sSu44Y0U", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:14.837Z", :updated_at=>"2017-07-28T07:36:14.837Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 72[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.0ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 48[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 48 AND ("client_visits"."updated_at" BETWEEN $1 AND $2)[0m  [["updated_at", "2017-06-28 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 48 AND ("client_visits"."updated_at" BETWEEN $1 AND $2)[0m  [["updated_at", "2017-07-21 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 26ms [30m(Views: 0.2ms | ActiveRecord: 8.8ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "472.272.8602 x30532"], ["created_at", "2017-07-28 07:36:15.108605"], ["updated_at", "2017-07-28 07:36:15.108605"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "clinton"], ["email", "davonte@hartmann.biz"], ["password", "PtYj2mBe"], ["created_at", "2017-07-28 07:36:15.113501"], ["updated_at", "2017-07-28 07:36:15.113501"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "803124"], ["username", "velva.sauer"], ["image", "http://instagram.com/img/velva.sauer.jpg"], ["profile", "https://instagram.com/velva.sauer"], ["email", "carmen_mckenzie@gibson.co"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 29], ["user_id", 75], ["created_at", "2017-07-28 07:36:15.117752"], ["updated_at", "2017-07-28 07:36:15.117752"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Lotlux"], ["created_at", "2017-07-28 07:36:15.125098"], ["updated_at", "2017-07-28 07:36:15.125098"], ["local_path", "http://dickinson.com/flavie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Alphazap"], ["title_ru", "Название50"], ["created_at", "2017-07-28 07:36:15.128635"], ["updated_at", "2017-07-28 07:36:15.128635"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 50[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_50[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 50) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>50, "title"=>"Lotlux", "created_at"=>Fri, 28 Jul 2017 07:36:15 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:15 UTC +00:00, "local_path"=>"http://dickinson.com/flavie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "pannier"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "pannier"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Pannier"], ["category_id", 50], ["slug", "pannier"], ["created_at", "2017-07-28 07:36:15.140005"], ["updated_at", "2017-07-28 07:36:15.140005"], ["layout_id", 50]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "selmer"], ["email", "cody_nader@feest.net"], ["password", "1uKb12MtHl8"], ["created_at", "2017-07-28 07:36:15.144990"], ["updated_at", "2017-07-28 07:36:15.144990"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "omnis_sit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Sub-Ex"], ["phone", "780.638.1325"], ["address", "5662 Cristopher Neck"], ["url", "http://williamson.info/greyson_volkman"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://grimes.co/dorthy.jones"], ["auth_expiration_time", 900], ["slug", "omnis_sit"], ["brand_id", 50], ["user_id", 76], ["created_at", "2017-07-28 07:36:15.151321"], ["updated_at", "2017-07-28 07:36:15.151321"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Voyatouch"], ["created_at", "2017-07-28 07:36:15.159306"], ["updated_at", "2017-07-28 07:36:15.159306"], ["local_path", "http://eichmann.io/evie.spinka"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zontrax"], ["title_ru", "Название51"], ["created_at", "2017-07-28 07:36:15.163475"], ["updated_at", "2017-07-28 07:36:15.163475"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_51[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 51) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>51, "title"=>"Voyatouch", "created_at"=>Fri, 28 Jul 2017 07:36:15 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:15 UTC +00:00, "local_path"=>"http://eichmann.io/evie.spinka"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "kanlam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "kanlam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Kanlam"], ["category_id", 51], ["slug", "kanlam"], ["created_at", "2017-07-28 07:36:15.174923"], ["updated_at", "2017-07-28 07:36:15.174923"], ["layout_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lance"], ["email", "orin.williamson@flatley.io"], ["password", "0xY0U13jY9Zu3wI6"], ["created_at", "2017-07-28 07:36:15.179980"], ["updated_at", "2017-07-28 07:36:15.179980"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "in-molestiae"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Fintone"], ["phone", "823.234.7674"], ["address", "9997 Robel Burgs"], ["url", "http://gerhold.name/marlee_jacobi"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://adamimonis.com/josefa.grant"], ["auth_expiration_time", 900], ["slug", "in-molestiae"], ["brand_id", 51], ["user_id", 77], ["created_at", "2017-07-28 07:36:15.186020"], ["updated_at", "2017-07-28 07:36:15.186020"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "rickie.stiedemann"], ["email", "beie.ferry@brakuslangworth.info"], ["password", "Zs6hMfS6L1P1S2"], ["created_at", "2017-07-28 07:36:15.191421"], ["updated_at", "2017-07-28 07:36:15.191421"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53314"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53314"], ["comment", "comment 114"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "157.138.33.165"], ["router_admin_ip", "35.171.69.176"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "24"], ["status", "t"], ["location_id", 51], ["user_id", 78], ["created_at", "2017-07-28 07:36:15.197283"], ["updated_at", "2017-07-28 07:36:15.197283"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53314"], ["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 14], ["serial", "643705CA5E36/53314"], ["comment", "comment 114"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "157.138.33.165"], ["router_admin_ip", "35.171.69.176"], ["admin_password", "cd28d498fda1bbcd"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "14"], ["status", "t"], ["location_id", 51], ["user_id", 78], ["created_at", "2017-07-28 07:36:15.197283"], ["updated_at", "2017-07-28 07:36:15.197283"], ["id", 14]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 9f48565d-7fde-4335-b8d0-932f90ca7828) to Async(routers) with arguments: #<GlobalID:0x007ff104017730 @uri=#<URI::GID gid://wifi-management/Router/14>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 53d12a81-a525-4487-b5c5-87a3dc0cf858) to Async(routers) with arguments: #<GlobalID:0x007ff104017730 @uri=#<URI::GID gid://wifi-management/Router/14>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.4ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 14], ["provider", "instagram"], ["location_id", 50], ["router_id", 14], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/totals" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:15 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#all_connections[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"all_connections"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-06-28 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(50, 51)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" IN (50, 51) AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(50, 51) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[34m
      select
        newusrs.chart_interval,
        ttlusrs.returning as returning_users,
        newusrs.new_users,
        ttlusrs.returning + newusrs.new_users as total
      from (select
          chart_interval,
          count (id) as new_users
        from (select
            distinct cl.id,
            date_trunc('day', dd)::date as chart_interval
          FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
          left outer join social_accounts sa on date_trunc('day', sa.created_at) = date_trunc('day', dd)
          left outer join clients cl on sa.client_id = cl.id
          join social_logs sl on sa.id = sl.social_account_id
            and location_id in(50, 51)
      	  order by chart_interval) as chart
        group by chart_interval
        order by chart_interval
      ) as newusrs join (select
          date_trunc('day', dd):: date as chart_interval,
          count (distinct cl.id) as returning
        FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
        left outer join social_logs sl on date_trunc('day', sl.created_at) = date_trunc('day', dd)
          and location_id in(50, 51)
        join social_accounts sa on sa.id = sl.social_account_id
        left outer join clients cl on date_trunc('day', cl.created_at) < date_trunc('day', dd)
          and sa.client_id = cl.id
        group by chart_interval
        order by chart_interval
      ) as ttlusrs on ttlusrs.chart_interval = newusrs.chart_interval[0m
[INFO ] Completed [32m200 OK[0m in 24ms [30m(Views: 4.1ms | ActiveRecord: 7.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(597) 162-1360 x6326"], ["created_at", "2017-07-28 07:36:15.629962"], ["updated_at", "2017-07-28 07:36:15.629962"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "mose.cormier"], ["email", "wilford@millsgerlach.name"], ["password", "EtLjQeVqE55m5uK0"], ["created_at", "2017-07-28 07:36:15.634746"], ["updated_at", "2017-07-28 07:36:15.634746"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "683539"], ["username", "violette_macejkovic"], ["image", "http://instagram.com/img/violette_macejkovic.jpg"], ["profile", "https://instagram.com/violette_macejkovic"], ["email", "alberta@reichel.info"], ["gender", "female"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 30], ["user_id", 79], ["created_at", "2017-07-28 07:36:15.638685"], ["updated_at", "2017-07-28 07:36:15.638685"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Hatity"], ["created_at", "2017-07-28 07:36:15.645792"], ["updated_at", "2017-07-28 07:36:15.645792"], ["local_path", "http://grahamhegmann.info/athena"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Quo Lux"], ["title_ru", "Название52"], ["created_at", "2017-07-28 07:36:15.649367"], ["updated_at", "2017-07-28 07:36:15.649367"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 52[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_52[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.5ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 52) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>52, "title"=>"Hatity", "created_at"=>Fri, 28 Jul 2017 07:36:15 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:15 UTC +00:00, "local_path"=>"http://grahamhegmann.info/athena"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Konklux"], ["category_id", 52], ["slug", "konklux"], ["created_at", "2017-07-28 07:36:15.660671"], ["updated_at", "2017-07-28 07:36:15.660671"], ["layout_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jerrell_yundt"], ["email", "ryley.kovacek@kreigerjohnson.name"], ["password", "Zv6rQ6QsV5D"], ["created_at", "2017-07-28 07:36:15.665246"], ["updated_at", "2017-07-28 07:36:15.665246"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "qui.quibusdam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Otcom"], ["phone", "675-993-6119"], ["address", "49773 Davis Roads"], ["url", "http://carterwiza.info/king"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://willmsthompson.name/dante"], ["auth_expiration_time", 900], ["slug", "qui.quibusdam"], ["brand_id", 52], ["user_id", 80], ["created_at", "2017-07-28 07:36:15.671006"], ["updated_at", "2017-07-28 07:36:15.671006"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Regrant"], ["created_at", "2017-07-28 07:36:15.678641"], ["updated_at", "2017-07-28 07:36:15.678641"], ["local_path", "http://wiegandboyer.io/adela.morar"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Rank"], ["title_ru", "Название53"], ["created_at", "2017-07-28 07:36:15.682117"], ["updated_at", "2017-07-28 07:36:15.682117"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 53[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_53[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.5ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 53) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>53, "title"=>"Regrant", "created_at"=>Fri, 28 Jul 2017 07:36:15 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:15 UTC +00:00, "local_path"=>"http://wiegandboyer.io/adela.morar"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alpha"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alpha"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Alpha"], ["category_id", 53], ["slug", "alpha"], ["created_at", "2017-07-28 07:36:15.692803"], ["updated_at", "2017-07-28 07:36:15.692803"], ["layout_id", 53]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "baylee"], ["email", "dominic_mann@millsbernier.info"], ["password", "3o1pWl5xLiIvG6M"], ["created_at", "2017-07-28 07:36:15.697410"], ["updated_at", "2017-07-28 07:36:15.697410"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "sit-ratione"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Regrant"], ["phone", "(257) 350-0846"], ["address", "90655 Jarret Valleys"], ["url", "http://pricehilll.org/taylor"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://runolfongaylord.org/emory.schulist"], ["auth_expiration_time", 900], ["slug", "sit-ratione"], ["brand_id", 53], ["user_id", 81], ["created_at", "2017-07-28 07:36:15.703039"], ["updated_at", "2017-07-28 07:36:15.703039"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lottie.olson"], ["email", "vladimir_mann@pfeffer.biz"], ["password", "Z6OaSfPw8076Zv5"], ["created_at", "2017-07-28 07:36:15.708278"], ["updated_at", "2017-07-28 07:36:15.708278"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53315"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53315"], ["comment", "comment 115"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "243.192.189.71"], ["router_admin_ip", "146.204.254.152"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "198"], ["status", "t"], ["location_id", 53], ["user_id", 82], ["created_at", "2017-07-28 07:36:15.713744"], ["updated_at", "2017-07-28 07:36:15.713744"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53315"], ["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 15], ["serial", "643705CA5E36/53315"], ["comment", "comment 115"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "243.192.189.71"], ["router_admin_ip", "146.204.254.152"], ["admin_password", "b9fc99bf477675f4"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "15"], ["status", "t"], ["location_id", 53], ["user_id", 82], ["created_at", "2017-07-28 07:36:15.713744"], ["updated_at", "2017-07-28 07:36:15.713744"], ["id", 15]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 2da18447-e6f4-4e0a-ab11-9401736d1ea8) to Async(routers) with arguments: #<GlobalID:0x007ff101193580 @uri=#<URI::GID gid://wifi-management/Router/15>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 7f18e3b6-67de-49e2-bdc3-16d3dbd145e4) to Async(routers) with arguments: #<GlobalID:0x007ff101193580 @uri=#<URI::GID gid://wifi-management/Router/15>>
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 15], ["provider", "instagram"], ["location_id", 52], ["router_id", 15], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/time" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:15 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#time_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"time_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(52, 53)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 5ms [30m(Views: 1.2ms | ActiveRecord: 2.0ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(814) 867-0191 x044"], ["created_at", "2017-07-28 07:36:15.925262"], ["updated_at", "2017-07-28 07:36:15.925262"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "shemar.bogisich"], ["email", "rebecca.bednar@price.co"], ["password", "BwZt7432NwW59a"], ["created_at", "2017-07-28 07:36:15.929952"], ["updated_at", "2017-07-28 07:36:15.929952"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "165655"], ["username", "rowland"], ["image", "http://instagram.com/img/rowland.jpg"], ["profile", "https://instagram.com/rowland"], ["email", "virginia.erdman@schuppebecker.com"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 31], ["user_id", 83], ["created_at", "2017-07-28 07:36:15.933993"], ["updated_at", "2017-07-28 07:36:15.933993"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Home Ing"], ["created_at", "2017-07-28 07:36:15.941100"], ["updated_at", "2017-07-28 07:36:15.941100"], ["local_path", "http://rolfsonherman.info/penelope"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bytecard"], ["title_ru", "Название54"], ["created_at", "2017-07-28 07:36:15.944381"], ["updated_at", "2017-07-28 07:36:15.944381"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_54[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.5ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 54) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>54, "title"=>"Home Ing", "created_at"=>Fri, 28 Jul 2017 07:36:15 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:15 UTC +00:00, "local_path"=>"http://rolfsonherman.info/penelope"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tin"], ["category_id", 54], ["slug", "tin"], ["created_at", "2017-07-28 07:36:15.955284"], ["updated_at", "2017-07-28 07:36:15.955284"], ["layout_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "pierre_wolff"], ["email", "dominic.nienow@carter.org"], ["password", "SuX8H4FuFaCyU"], ["created_at", "2017-07-28 07:36:15.960084"], ["updated_at", "2017-07-28 07:36:15.960084"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "magni-voluptate"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zaam-Dox"], ["phone", "(222) 833-7894"], ["address", "734 Johnny Harbors"], ["url", "http://hanedicki.io/dean"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://mayer.org/keon_cummings"], ["auth_expiration_time", 900], ["slug", "magni-voluptate"], ["brand_id", 54], ["user_id", 84], ["created_at", "2017-07-28 07:36:15.965868"], ["updated_at", "2017-07-28 07:36:15.965868"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Y-Solowarm"], ["created_at", "2017-07-28 07:36:15.973622"], ["updated_at", "2017-07-28 07:36:15.973622"], ["local_path", "http://kaulkekulas.info/treva.rowe"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bigtax"], ["title_ru", "Название55"], ["created_at", "2017-07-28 07:36:15.977002"], ["updated_at", "2017-07-28 07:36:15.977002"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 55[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_55[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.5ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 55) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>55, "title"=>"Y-Solowarm", "created_at"=>Fri, 28 Jul 2017 07:36:15 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:15 UTC +00:00, "local_path"=>"http://kaulkekulas.info/treva.rowe"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitwolf"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitwolf"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bitwolf"], ["category_id", 55], ["slug", "bitwolf"], ["created_at", "2017-07-28 07:36:15.987714"], ["updated_at", "2017-07-28 07:36:15.987714"], ["layout_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jamal"], ["email", "liliane@steubermacgyver.info"], ["password", "7wJqHlJgPqFxLvYs"], ["created_at", "2017-07-28 07:36:15.992411"], ["updated_at", "2017-07-28 07:36:15.992411"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "rerum_accusantium"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Alpha"], ["phone", "1-694-829-0528"], ["address", "48425 Darion Landing"], ["url", "http://kunde.net/buddy.altenwerth"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://heller.co/carmel"], ["auth_expiration_time", 900], ["slug", "rerum_accusantium"], ["brand_id", 55], ["user_id", 85], ["created_at", "2017-07-28 07:36:15.997991"], ["updated_at", "2017-07-28 07:36:15.997991"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "dahlia"], ["email", "sasha.heidenreich@feil.biz"], ["password", "C16nOj17Y"], ["created_at", "2017-07-28 07:36:16.003177"], ["updated_at", "2017-07-28 07:36:16.003177"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53316"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53316"], ["comment", "comment 116"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "94.186.51.139"], ["router_admin_ip", "73.171.252.116"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "279"], ["status", "t"], ["location_id", 55], ["user_id", 86], ["created_at", "2017-07-28 07:36:16.008570"], ["updated_at", "2017-07-28 07:36:16.008570"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53316"], ["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 16], ["serial", "643705CA5E36/53316"], ["comment", "comment 116"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "94.186.51.139"], ["router_admin_ip", "73.171.252.116"], ["admin_password", "0535581c71c9db05"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "16"], ["status", "t"], ["location_id", 55], ["user_id", 86], ["created_at", "2017-07-28 07:36:16.008570"], ["updated_at", "2017-07-28 07:36:16.008570"], ["id", 16]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 60ca0b50-79d1-4b57-a21a-47d99b4df84f) to Async(routers) with arguments: #<GlobalID:0x007ff100adc368 @uri=#<URI::GID gid://wifi-management/Router/16>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 26b70487-f58e-4332-b0a9-90e0d6780857) to Async(routers) with arguments: #<GlobalID:0x007ff100adc368 @uri=#<URI::GID gid://wifi-management/Router/16>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 16], ["provider", "instagram"], ["location_id", 54], ["router_id", 16], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/social" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:16 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#social_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"social_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.6ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" IN (54, 55) AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 7ms [30m(Views: 1.3ms | ActiveRecord: 2.3ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-379-571-9304 x50377"], ["created_at", "2017-07-28 07:36:16.360466"], ["updated_at", "2017-07-28 07:36:16.360466"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "demetris_predovic"], ["email", "beatrice@wyman.name"], ["password", "W112Hz5tN4"], ["created_at", "2017-07-28 07:36:16.365420"], ["updated_at", "2017-07-28 07:36:16.365420"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "717269"], ["username", "henri_heathcote"], ["image", "http://vk.com/img/henri_heathcote.jpg"], ["profile", "https://vk.com/henri_heathcote"], ["email", "mohamed_botsford@kihn.name"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 32], ["user_id", 87], ["created_at", "2017-07-28 07:36:16.369897"], ["updated_at", "2017-07-28 07:36:16.369897"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Holdlamis"], ["created_at", "2017-07-28 07:36:16.377441"], ["updated_at", "2017-07-28 07:36:16.377441"], ["local_path", "http://auervandervort.co/josiane.kreiger"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Keylex"], ["title_ru", "Название56"], ["created_at", "2017-07-28 07:36:16.381625"], ["updated_at", "2017-07-28 07:36:16.381625"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 56[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_56[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.9ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 56) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>56, "title"=>"Holdlamis", "created_at"=>Fri, 28 Jul 2017 07:36:16 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:16 UTC +00:00, "local_path"=>"http://auervandervort.co/josiane.kreiger"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "holdlamis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "holdlamis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Holdlamis"], ["category_id", 56], ["slug", "holdlamis"], ["created_at", "2017-07-28 07:36:16.393858"], ["updated_at", "2017-07-28 07:36:16.393858"], ["layout_id", 56]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jayce"], ["email", "roxane.towne@johnson.io"], ["password", "VkEhT3G34sVi"], ["created_at", "2017-07-28 07:36:16.398782"], ["updated_at", "2017-07-28 07:36:16.398782"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "dicta.similique"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Ronstring"], ["phone", "816.033.3850"], ["address", "6463 Murazik Parks"], ["url", "http://pollich.com/wyatt_harber"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://bergnaum.biz/nigel"], ["auth_expiration_time", 900], ["slug", "dicta.similique"], ["brand_id", 56], ["user_id", 88], ["created_at", "2017-07-28 07:36:16.404946"], ["updated_at", "2017-07-28 07:36:16.404946"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Veribet"], ["created_at", "2017-07-28 07:36:16.412861"], ["updated_at", "2017-07-28 07:36:16.412861"], ["local_path", "http://damore.com/vallie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bitwolf"], ["title_ru", "Название57"], ["created_at", "2017-07-28 07:36:16.416785"], ["updated_at", "2017-07-28 07:36:16.416785"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_57[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 57) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>57, "title"=>"Veribet", "created_at"=>Fri, 28 Jul 2017 07:36:16 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:16 UTC +00:00, "local_path"=>"http://damore.com/vallie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zamit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zamit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zamit"], ["category_id", 57], ["slug", "zamit"], ["created_at", "2017-07-28 07:36:16.427924"], ["updated_at", "2017-07-28 07:36:16.427924"], ["layout_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "hugh"], ["email", "oliver.schaden@pacochajacobi.biz"], ["password", "AnIoEc6pXhF"], ["created_at", "2017-07-28 07:36:16.432714"], ["updated_at", "2017-07-28 07:36:16.432714"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "nostrum_illo"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Keylex"], ["phone", "400.052.6062"], ["address", "5856 Kozey Port"], ["url", "http://sanfordstanton.biz/jason_armstrong"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://mckenzietremblay.biz/fletcher"], ["auth_expiration_time", 900], ["slug", "nostrum_illo"], ["brand_id", 57], ["user_id", 89], ["created_at", "2017-07-28 07:36:16.438896"], ["updated_at", "2017-07-28 07:36:16.438896"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lila"], ["email", "lee@west.org"], ["password", "X5PtEd3u3p24Zr"], ["created_at", "2017-07-28 07:36:16.444591"], ["updated_at", "2017-07-28 07:36:16.444591"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53317"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53317"], ["comment", "comment 117"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "166.3.215.251"], ["router_admin_ip", "156.117.192.62"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "135"], ["status", "t"], ["location_id", 57], ["user_id", 90], ["created_at", "2017-07-28 07:36:16.450580"], ["updated_at", "2017-07-28 07:36:16.450580"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53317"], ["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 17], ["serial", "643705CA5E36/53317"], ["comment", "comment 117"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "166.3.215.251"], ["router_admin_ip", "156.117.192.62"], ["admin_password", "971a57f5ef9ed775"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "17"], ["status", "t"], ["location_id", 57], ["user_id", 90], ["created_at", "2017-07-28 07:36:16.450580"], ["updated_at", "2017-07-28 07:36:16.450580"], ["id", 17]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: c6b94fb5-4ca8-4f2a-a43e-d2db31e05ef9) to Async(routers) with arguments: #<GlobalID:0x007ff0fe497680 @uri=#<URI::GID gid://wifi-management/Router/17>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: b6d97879-c659-436c-b0f4-ed2d848944cc) to Async(routers) with arguments: #<GlobalID:0x007ff0fe497680 @uri=#<URI::GID gid://wifi-management/Router/17>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.4ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 17], ["provider", "instagram"], ["location_id", 56], ["router_id", 17], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/age" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:16 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#age_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"age_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(56, 57) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 5ms [30m(Views: 1.3ms | ActiveRecord: 1.8ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "425.320.1454 x90869"], ["created_at", "2017-07-28 07:36:16.613572"], ["updated_at", "2017-07-28 07:36:16.613572"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "major"], ["email", "christ@schaefergaylord.co"], ["password", "V120QfHgY"], ["created_at", "2017-07-28 07:36:16.618293"], ["updated_at", "2017-07-28 07:36:16.618293"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "382576"], ["username", "tyrell_cruickshank"], ["image", "http://twitter.com/img/tyrell_cruickshank.jpg"], ["profile", "https://twitter.com/tyrell_cruickshank"], ["email", "annette@douglas.info"], ["gender", "female"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 33], ["user_id", 91], ["created_at", "2017-07-28 07:36:16.622854"], ["updated_at", "2017-07-28 07:36:16.622854"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Fixflex"], ["created_at", "2017-07-28 07:36:16.630410"], ["updated_at", "2017-07-28 07:36:16.630410"], ["local_path", "http://sipes.info/remington_bogisich"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Sub-Ex"], ["title_ru", "Название58"], ["created_at", "2017-07-28 07:36:16.634123"], ["updated_at", "2017-07-28 07:36:16.634123"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 58[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_58[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 58) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>58, "title"=>"Fixflex", "created_at"=>Fri, 28 Jul 2017 07:36:16 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:16 UTC +00:00, "local_path"=>"http://sipes.info/remington_bogisich"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "home-ing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "home-ing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Home Ing"], ["category_id", 58], ["slug", "home-ing"], ["created_at", "2017-07-28 07:36:16.645633"], ["updated_at", "2017-07-28 07:36:16.645633"], ["layout_id", 58]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "richie"], ["email", "terence@green.name"], ["password", "Mg29RcM4WyW"], ["created_at", "2017-07-28 07:36:16.650626"], ["updated_at", "2017-07-28 07:36:16.650626"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "culpa-corporis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Namfix"], ["phone", "550-561-7624"], ["address", "38781 West Ranch"], ["url", "http://lakin.co/elijah"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://brekkeshields.name/kennith"], ["auth_expiration_time", 900], ["slug", "culpa-corporis"], ["brand_id", 58], ["user_id", 92], ["created_at", "2017-07-28 07:36:16.656780"], ["updated_at", "2017-07-28 07:36:16.656780"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Subin"], ["created_at", "2017-07-28 07:36:16.664853"], ["updated_at", "2017-07-28 07:36:16.664853"], ["local_path", "http://mcdermottcummerata.org/virginia_purdy"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Biodex"], ["title_ru", "Название59"], ["created_at", "2017-07-28 07:36:16.668460"], ["updated_at", "2017-07-28 07:36:16.668460"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 59[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_59[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 59) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>59, "title"=>"Subin", "created_at"=>Fri, 28 Jul 2017 07:36:16 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:16 UTC +00:00, "local_path"=>"http://mcdermottcummerata.org/virginia_purdy"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bigtax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bigtax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bigtax"], ["category_id", 59], ["slug", "bigtax"], ["created_at", "2017-07-28 07:36:16.679653"], ["updated_at", "2017-07-28 07:36:16.679653"], ["layout_id", 59]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "eldon"], ["email", "katelin.weinat@mosciskiruel.net"], ["password", "511wMjTk"], ["created_at", "2017-07-28 07:36:16.684278"], ["updated_at", "2017-07-28 07:36:16.684278"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "earum.error"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zathin"], ["phone", "415.907.7814"], ["address", "3778 Nathan Isle"], ["url", "http://thompson.com/aaron.beatty"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hermann.net/alysa.kaulke"], ["auth_expiration_time", 900], ["slug", "earum.error"], ["brand_id", 59], ["user_id", 93], ["created_at", "2017-07-28 07:36:16.690048"], ["updated_at", "2017-07-28 07:36:16.690048"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "abby_labadie"], ["email", "lisandro@wisozk.co"], ["password", "LxJk7iU2ZnVaFt"], ["created_at", "2017-07-28 07:36:16.695149"], ["updated_at", "2017-07-28 07:36:16.695149"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53318"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53318"], ["comment", "comment 118"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "131.43.68.197"], ["router_admin_ip", "245.225.52.218"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "401"], ["status", "t"], ["location_id", 59], ["user_id", 94], ["created_at", "2017-07-28 07:36:16.700539"], ["updated_at", "2017-07-28 07:36:16.700539"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53318"], ["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 18], ["serial", "643705CA5E36/53318"], ["comment", "comment 118"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "131.43.68.197"], ["router_admin_ip", "245.225.52.218"], ["admin_password", "fffa7c109cccd105"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "18"], ["status", "t"], ["location_id", 59], ["user_id", 94], ["created_at", "2017-07-28 07:36:16.700539"], ["updated_at", "2017-07-28 07:36:16.700539"], ["id", 18]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: a7d3c6d5-a26b-446b-b790-2f3cf062dbf8) to Async(routers) with arguments: #<GlobalID:0x007ff1030f05b8 @uri=#<URI::GID gid://wifi-management/Router/18>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 5e114592-8454-46d3-91d4-331c08136f15) to Async(routers) with arguments: #<GlobalID:0x007ff1030f05b8 @uri=#<URI::GID gid://wifi-management/Router/18>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 18], ["provider", "instagram"], ["location_id", 58], ["router_id", 18], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/visitors" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:16 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#visitors_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"visitors_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.5ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" IN (58, 59) AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 6ms [30m(Views: 1.0ms | ActiveRecord: 2.1ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mActiveRecord::SchemaMigration Load (1.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.4ms)[0m  [1m[35mALTER TABLE "answers" DISABLE TRIGGER ALL;ALTER TABLE "social_logs" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "layouts" DISABLE TRIGGER ALL;ALTER TABLE "polls" DISABLE TRIGGER ALL;ALTER TABLE "questions" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL;ALTER TABLE "attempts" DISABLE TRIGGER ALL;ALTER TABLE "auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "bans" DISABLE TRIGGER ALL;ALTER TABLE "brands" DISABLE TRIGGER ALL;ALTER TABLE "categories" DISABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" DISABLE TRIGGER ALL;ALTER TABLE "client_counters" DISABLE TRIGGER ALL;ALTER TABLE "client_devices" DISABLE TRIGGER ALL;ALTER TABLE "clients" DISABLE TRIGGER ALL;ALTER TABLE "social_accounts" DISABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" DISABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" DISABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" DISABLE TRIGGER ALL;ALTER TABLE "locations" DISABLE TRIGGER ALL;ALTER TABLE "notifications" DISABLE TRIGGER ALL;ALTER TABLE "opinions" DISABLE TRIGGER ALL;ALTER TABLE "pages" DISABLE TRIGGER ALL;ALTER TABLE "payments" DISABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "products" DISABLE TRIGGER ALL;ALTER TABLE "routers" DISABLE TRIGGER ALL;ALTER TABLE "sessions" DISABLE TRIGGER ALL;ALTER TABLE "sms_logs" DISABLE TRIGGER ALL;ALTER TABLE "vips" DISABLE TRIGGER ALL;ALTER TABLE "vouchers" DISABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.5ms)[0m  [1m[34m          SELECT schemaname || '.' || tablename
          FROM pg_tables
          WHERE
            tablename !~ '_prt_' AND
            tablename <> 'schema_migrations' AND
            schemaname = ANY (current_schemas(false))
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.0ms)[0m  [1m[34mselect table_name from information_schema.views where table_schema = 'gycwifi_api_test'[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (138.6ms)[0m  [1m[35mTRUNCATE TABLE "public"."answers", "public"."social_logs", "public"."users", "public"."layouts", "public"."polls", "public"."questions", "public"."ar_internal_metadata", "public"."attempts", "public"."auth_logs", "public"."bans", "public"."brands", "public"."categories", "public"."client_accounting_logs", "public"."client_counters", "public"."client_devices", "public"."clients", "public"."social_accounts", "public"."delayed_jobs", "public"."device_auth_pendings", "public"."friendly_id_slugs", "public"."locations", "public"."notifications", "public"."opinions", "public"."pages", "public"."payments", "public"."post_auth_logs", "public"."products", "public"."routers", "public"."sessions", "public"."sms_logs", "public"."vips", "public"."vouchers" RESTART IDENTITY CASCADE;[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.0ms)[0m  [1m[35mALTER TABLE "answers" ENABLE TRIGGER ALL;ALTER TABLE "social_logs" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "layouts" ENABLE TRIGGER ALL;ALTER TABLE "polls" ENABLE TRIGGER ALL;ALTER TABLE "questions" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL;ALTER TABLE "attempts" ENABLE TRIGGER ALL;ALTER TABLE "auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "bans" ENABLE TRIGGER ALL;ALTER TABLE "brands" ENABLE TRIGGER ALL;ALTER TABLE "categories" ENABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" ENABLE TRIGGER ALL;ALTER TABLE "client_counters" ENABLE TRIGGER ALL;ALTER TABLE "client_devices" ENABLE TRIGGER ALL;ALTER TABLE "clients" ENABLE TRIGGER ALL;ALTER TABLE "social_accounts" ENABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" ENABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" ENABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" ENABLE TRIGGER ALL;ALTER TABLE "locations" ENABLE TRIGGER ALL;ALTER TABLE "notifications" ENABLE TRIGGER ALL;ALTER TABLE "opinions" ENABLE TRIGGER ALL;ALTER TABLE "pages" ENABLE TRIGGER ALL;ALTER TABLE "payments" ENABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "products" ENABLE TRIGGER ALL;ALTER TABLE "routers" ENABLE TRIGGER ALL;ALTER TABLE "sessions" ENABLE TRIGGER ALL;ALTER TABLE "sms_logs" ENABLE TRIGGER ALL;ALTER TABLE "vips" ENABLE TRIGGER ALL;ALTER TABLE "vouchers" ENABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (2.0ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "251.838.5805"], ["created_at", "2017-07-28 07:36:33.873196"], ["updated_at", "2017-07-28 07:36:33.873196"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bitwolf"], ["created_at", "2017-07-28 07:36:34.013298"], ["updated_at", "2017-07-28 07:36:34.013298"], ["local_path", "http://kreigercormier.io/stephania"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Flowdesk"], ["title_ru", "Название1"], ["created_at", "2017-07-28 07:36:34.030252"], ["updated_at", "2017-07-28 07:36:34.030252"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 1[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (1.1ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 1) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>1, "title"=>"Bitwolf", "created_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "local_path"=>"http://kreigercormier.io/stephania"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "temp"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "temp"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Temp"], ["category_id", 1], ["slug", "temp"], ["created_at", "2017-07-28 07:36:34.169415"], ["updated_at", "2017-07-28 07:36:34.169415"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "rodrigo"], ["email", "matteo@erdman.com"], ["password", "GoDeKn8q4sJt"], ["created_at", "2017-07-28 07:36:34.215491"], ["updated_at", "2017-07-28 07:36:34.215491"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "eum_illo"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.6ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Kanlam"], ["phone", "1-607-428-2825"], ["address", "78561 Pfannerstill Plains"], ["url", "http://yost.biz/addie.kris"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ryanpfeffer.com/alayna_ratke"], ["auth_expiration_time", 900], ["slug", "eum_illo"], ["brand_id", 1], ["user_id", 1], ["created_at", "2017-07-28 07:36:34.226747"], ["updated_at", "2017-07-28 07:36:34.226747"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 1], ["location_id", 1], ["counter", 10], ["created_at", "2017-07-28 07:36:34.233498"], ["updated_at", "2017-07-28 07:36:34.233498"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-841-509-5239 x88930"], ["created_at", "2017-07-28 07:36:34.238424"], ["updated_at", "2017-07-28 07:36:34.238424"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Domainer"], ["created_at", "2017-07-28 07:36:34.245153"], ["updated_at", "2017-07-28 07:36:34.245153"], ["local_path", "http://nicolas.info/mozell.emard"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zathin"], ["title_ru", "Название2"], ["created_at", "2017-07-28 07:36:34.249113"], ["updated_at", "2017-07-28 07:36:34.249113"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 2[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_2[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 2) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>2, "title"=>"Domainer", "created_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "local_path"=>"http://nicolas.info/mozell.emard"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stringtough"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stringtough"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Stringtough"], ["category_id", 2], ["slug", "stringtough"], ["created_at", "2017-07-28 07:36:34.260964"], ["updated_at", "2017-07-28 07:36:34.260964"], ["layout_id", 2]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "collin"], ["email", "fatima@smitham.biz"], ["password", "FfBiRfTj19QaL"], ["created_at", "2017-07-28 07:36:34.266097"], ["updated_at", "2017-07-28 07:36:34.266097"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "iusto_nemo"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zoolab"], ["phone", "447-374-2953"], ["address", "74425 Leannon Cape"], ["url", "http://hanequitzon.net/toy"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://pollich.com/tracy"], ["auth_expiration_time", 900], ["slug", "iusto_nemo"], ["brand_id", 2], ["user_id", 2], ["created_at", "2017-07-28 07:36:34.272250"], ["updated_at", "2017-07-28 07:36:34.272250"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 2], ["location_id", 2], ["counter", 3], ["created_at", "2017-07-28 07:36:34.277276"], ["updated_at", "2017-07-28 07:36:34.277276"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Hatity"], ["created_at", "2017-07-28 07:36:34.283725"], ["updated_at", "2017-07-28 07:36:34.283725"], ["local_path", "http://zemlak.io/madyson"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "It"], ["title_ru", "Название3"], ["created_at", "2017-07-28 07:36:34.287651"], ["updated_at", "2017-07-28 07:36:34.287651"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 3[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_3[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 3) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>3, "title"=>"Hatity", "created_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "local_path"=>"http://zemlak.io/madyson"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "home-ing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "home-ing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Home Ing"], ["category_id", 3], ["slug", "home-ing"], ["created_at", "2017-07-28 07:36:34.299032"], ["updated_at", "2017-07-28 07:36:34.299032"], ["layout_id", 3]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "pearline_bergnaum"], ["email", "jannie.dach@monahanmills.info"], ["password", "9uXuCpGvYz2mU2Vr"], ["created_at", "2017-07-28 07:36:34.304363"], ["updated_at", "2017-07-28 07:36:34.304363"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "sed_ducimus"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Temp"], ["phone", "1-733-166-6858"], ["address", "919 Mohr Inlet"], ["url", "http://runolfsdottir.name/alvera.yundt"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://tremblaygreenfelder.io/toney"], ["auth_expiration_time", 900], ["slug", "sed_ducimus"], ["brand_id", 3], ["user_id", 3], ["created_at", "2017-07-28 07:36:34.310276"], ["updated_at", "2017-07-28 07:36:34.310276"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 1], ["location_id", 3], ["counter", 1], ["created_at", "2017-07-28 07:36:34.315004"], ["updated_at", "2017-07-28 07:36:34.315004"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "sonya"], ["email", "amani.hartmann@walter.org"], ["password", "1aVe14XaDeEaH"], ["role_cd", 3], ["created_at", "2017-07-28 07:36:34.319740"], ["updated_at", "2017-07-28 07:36:34.319740"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:34 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"sonya", "email"=>"amani.hartmann@walter.org", "password"=>"1aVe14XaDeEaH", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"sonya", :email=>"amani.hartmann@walter.org", :password=>"1aVe14XaDeEaH", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"amani.hartmann@walter.org", "password"=>"1aVe14XaDeEaH"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "sonya"], ["email", "amani.hartmann@walter.org"], ["password", "1aVe14XaDeEaH"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 4, username: "sonya", email: "amani.hartmann@walter.org", password: "1aVe14XaDeEaH", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:36:34", updated_at: "2017-07-28 07:36:34", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 4[0m
[INFO ] Completed [32m201 Created[0m in 7ms [30m(Views: 0.3ms | ActiveRecord: 1.4ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=updated_at&updated_at=asc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:34 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"updated_at", "updated_at"=>"asc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 4) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>4, "username"=>"sonya", "email"=>"amani.hartmann@walter.org", "password"=>"1aVe14XaDeEaH", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"updated_at", :updated_at=>"asc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (1.2ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>4, :username=>"sonya", :email=>"amani.hartmann@walter.org", :password=>"1aVe14XaDeEaH", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:36:34.319Z", :updated_at=>"2017-07-28T07:36:34.319Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.0ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:36:34.233498') AND "client_counters"."location_id" IN (1, 2, 3) GROUP BY client_id, phone_number ORDER BY updated_at asc, visits desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.9ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (2, 1)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (1.4ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (1, 2)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:36:34.233498') AND "client_counters"."location_id" IN (1, 2, 3) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 100ms [30m(Views: 0.7ms | ActiveRecord: 19.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "715-112-6538"], ["created_at", "2017-07-28 07:36:34.517563"], ["updated_at", "2017-07-28 07:36:34.517563"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Quo Lux"], ["created_at", "2017-07-28 07:36:34.524415"], ["updated_at", "2017-07-28 07:36:34.524415"], ["local_path", "http://osinski.net/alexys"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Tresom"], ["title_ru", "Название4"], ["created_at", "2017-07-28 07:36:34.528258"], ["updated_at", "2017-07-28 07:36:34.528258"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_4[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 4) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>4, "title"=>"Quo Lux", "created_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "local_path"=>"http://osinski.net/alexys"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "pannier"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "pannier"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Pannier"], ["category_id", 4], ["slug", "pannier"], ["created_at", "2017-07-28 07:36:34.539995"], ["updated_at", "2017-07-28 07:36:34.539995"], ["layout_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "genevieve"], ["email", "reie@swift.info"], ["password", "7gK1YcNfAb60C7U"], ["created_at", "2017-07-28 07:36:34.544802"], ["updated_at", "2017-07-28 07:36:34.544802"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "odit_hic"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bigtax"], ["phone", "560.812.9261"], ["address", "9908 Lexi Trail"], ["url", "http://johnsbernier.name/marlene_hartmann"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://leuschke.org/evan"], ["auth_expiration_time", 900], ["slug", "odit_hic"], ["brand_id", 4], ["user_id", 5], ["created_at", "2017-07-28 07:36:34.550616"], ["updated_at", "2017-07-28 07:36:34.550616"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 3], ["location_id", 4], ["counter", 9], ["created_at", "2017-07-28 07:36:34.555437"], ["updated_at", "2017-07-28 07:36:34.555437"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-677-774-9589 x9765"], ["created_at", "2017-07-28 07:36:34.559251"], ["updated_at", "2017-07-28 07:36:34.559251"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Voltsillam"], ["created_at", "2017-07-28 07:36:34.565941"], ["updated_at", "2017-07-28 07:36:34.565941"], ["local_path", "http://macejkovicaufderhar.net/minerva"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Sonair"], ["title_ru", "Название5"], ["created_at", "2017-07-28 07:36:34.569573"], ["updated_at", "2017-07-28 07:36:34.569573"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 5[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_5[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 5) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>5, "title"=>"Voltsillam", "created_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "local_path"=>"http://macejkovicaufderhar.net/minerva"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "redhold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "redhold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Redhold"], ["category_id", 5], ["slug", "redhold"], ["created_at", "2017-07-28 07:36:34.580838"], ["updated_at", "2017-07-28 07:36:34.580838"], ["layout_id", 5]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "dawson"], ["email", "ibrahim.hand@lebsackschumm.net"], ["password", "M5CpU3HnD334B"], ["created_at", "2017-07-28 07:36:34.585591"], ["updated_at", "2017-07-28 07:36:34.585591"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "qui_nemo"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Namfix"], ["phone", "333-253-6952"], ["address", "4535 Margarette Haven"], ["url", "http://rolfson.io/bradly.kertzmann"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kutch.org/ollie_lowe"], ["auth_expiration_time", 900], ["slug", "qui_nemo"], ["brand_id", 5], ["user_id", 6], ["created_at", "2017-07-28 07:36:34.591448"], ["updated_at", "2017-07-28 07:36:34.591448"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 4], ["location_id", 5], ["counter", 1], ["created_at", "2017-07-28 07:36:34.596161"], ["updated_at", "2017-07-28 07:36:34.596161"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Cardify"], ["created_at", "2017-07-28 07:36:34.602666"], ["updated_at", "2017-07-28 07:36:34.602666"], ["local_path", "http://balistrerihegmann.biz/marina_cummings"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Matsoft"], ["title_ru", "Название6"], ["created_at", "2017-07-28 07:36:34.606474"], ["updated_at", "2017-07-28 07:36:34.606474"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 6[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_6[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 6) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>6, "title"=>"Cardify", "created_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "local_path"=>"http://balistrerihegmann.biz/marina_cummings"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "viva"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "viva"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Viva"], ["category_id", 6], ["slug", "viva"], ["created_at", "2017-07-28 07:36:34.617603"], ["updated_at", "2017-07-28 07:36:34.617603"], ["layout_id", 6]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "sierra_fadel"], ["email", "lonie@schadenebert.io"], ["password", "Ek65M3TjCbYuNpZs"], ["created_at", "2017-07-28 07:36:34.622360"], ["updated_at", "2017-07-28 07:36:34.622360"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "illo-dicta"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bigtax"], ["phone", "802-868-1295"], ["address", "4824 Nolan River"], ["url", "http://west.org/eryn"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://reichel.info/amira_wintheiser"], ["auth_expiration_time", 900], ["slug", "illo-dicta"], ["brand_id", 6], ["user_id", 7], ["created_at", "2017-07-28 07:36:34.628315"], ["updated_at", "2017-07-28 07:36:34.628315"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 3], ["location_id", 6], ["counter", 4], ["created_at", "2017-07-28 07:36:34.632839"], ["updated_at", "2017-07-28 07:36:34.632839"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "nikko.mcglynn"], ["email", "dorothy_walker@hand.info"], ["password", "No6dCy3yOb0p86Mn"], ["role_cd", 3], ["created_at", "2017-07-28 07:36:34.637527"], ["updated_at", "2017-07-28 07:36:34.637527"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:34 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"nikko.mcglynn", "email"=>"dorothy_walker@hand.info", "password"=>"No6dCy3yOb0p86Mn", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"nikko.mcglynn", :email=>"dorothy_walker@hand.info", :password=>"No6dCy3yOb0p86Mn", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"dorothy_walker@hand.info", "password"=>"No6dCy3yOb0p86Mn"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "nikko.mcglynn"], ["email", "dorothy_walker@hand.info"], ["password", "No6dCy3yOb0p86Mn"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 8, username: "nikko.mcglynn", email: "dorothy_walker@hand.info", password: "No6dCy3yOb0p86Mn", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:36:34", updated_at: "2017-07-28 07:36:34", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 8[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=regular&loyalty_days=7&page=1&sort_field=visits30&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:34 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"regular", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits30", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 8) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>8, "username"=>"nikko.mcglynn", "email"=>"dorothy_walker@hand.info", "password"=>"No6dCy3yOb0p86Mn", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"regular", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits30", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.7ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>8, :username=>"nikko.mcglynn", :email=>"dorothy_walker@hand.info", :password=>"No6dCy3yOb0p86Mn", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:36:34.637Z", :updated_at=>"2017-07-28T07:36:34.637Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:36:34.555437') AND "client_counters"."location_id" IN (4, 5, 6) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) > 1) ORDER BY visits30 asc, updated_at desc, visits desc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 3[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.7ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 3[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:36:34.555437') AND "client_counters"."location_id" IN (4, 5, 6) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) > 1)[0m
[INFO ] Completed [32m200 OK[0m in 31ms [30m(Views: 0.4ms | ActiveRecord: 8.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "920.505.3657 x3378"], ["created_at", "2017-07-28 07:36:34.688623"], ["updated_at", "2017-07-28 07:36:34.688623"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Konklux"], ["created_at", "2017-07-28 07:36:34.695492"], ["updated_at", "2017-07-28 07:36:34.695492"], ["local_path", "http://hilpert.biz/nola.flatley"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Stringtough"], ["title_ru", "Название7"], ["created_at", "2017-07-28 07:36:34.699282"], ["updated_at", "2017-07-28 07:36:34.699282"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 7[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_7[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 7) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>7, "title"=>"Konklux", "created_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "local_path"=>"http://hilpert.biz/nola.flatley"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "biodex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "biodex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Biodex"], ["category_id", 7], ["slug", "biodex"], ["created_at", "2017-07-28 07:36:34.710682"], ["updated_at", "2017-07-28 07:36:34.710682"], ["layout_id", 7]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "tatum"], ["email", "savannah@barrows.com"], ["password", "2uTdB5WgToYxH"], ["created_at", "2017-07-28 07:36:34.715383"], ["updated_at", "2017-07-28 07:36:34.715383"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "distinctio-dignissimos"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Cardguard"], ["phone", "832-503-9451"], ["address", "3314 Heloise Corner"], ["url", "http://collierquitzon.biz/cornelius"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://rodriguez.com/flavie"], ["auth_expiration_time", 900], ["slug", "distinctio-dignissimos"], ["brand_id", 7], ["user_id", 9], ["created_at", "2017-07-28 07:36:34.721395"], ["updated_at", "2017-07-28 07:36:34.721395"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 5], ["location_id", 7], ["counter", 6], ["created_at", "2017-07-28 07:36:34.726172"], ["updated_at", "2017-07-28 07:36:34.726172"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "608-942-9896 x209"], ["created_at", "2017-07-28 07:36:34.730066"], ["updated_at", "2017-07-28 07:36:34.730066"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Stim"], ["created_at", "2017-07-28 07:36:34.736625"], ["updated_at", "2017-07-28 07:36:34.736625"], ["local_path", "http://schimmel.info/katelin"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fintone"], ["title_ru", "Название8"], ["created_at", "2017-07-28 07:36:34.740397"], ["updated_at", "2017-07-28 07:36:34.740397"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 8) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>8, "title"=>"Stim", "created_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "local_path"=>"http://schimmel.info/katelin"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "domainer"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "domainer"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Domainer"], ["category_id", 8], ["slug", "domainer"], ["created_at", "2017-07-28 07:36:34.751424"], ["updated_at", "2017-07-28 07:36:34.751424"], ["layout_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "howard"], ["email", "izabella@cronaberge.com"], ["password", "UdY6PnZqR7Un00Nr"], ["created_at", "2017-07-28 07:36:34.756209"], ["updated_at", "2017-07-28 07:36:34.756209"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "sequi.omnis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zaam-Dox"], ["phone", "117.674.1078"], ["address", "976 Wunsch Pass"], ["url", "http://mckenzie.name/beryl.kuhn"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://vandervort.com/tito_nader"], ["auth_expiration_time", 900], ["slug", "sequi.omnis"], ["brand_id", 8], ["user_id", 10], ["created_at", "2017-07-28 07:36:34.762351"], ["updated_at", "2017-07-28 07:36:34.762351"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 6], ["location_id", 8], ["counter", 4], ["created_at", "2017-07-28 07:36:34.767215"], ["updated_at", "2017-07-28 07:36:34.767215"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Flowdesk"], ["created_at", "2017-07-28 07:36:34.773750"], ["updated_at", "2017-07-28 07:36:34.773750"], ["local_path", "http://durgan.com/luciano.langosh"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Tempsoft"], ["title_ru", "Название9"], ["created_at", "2017-07-28 07:36:34.777619"], ["updated_at", "2017-07-28 07:36:34.777619"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 9[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_9[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 9) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>9, "title"=>"Flowdesk", "created_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "local_path"=>"http://durgan.com/luciano.langosh"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cardify"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cardify"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Cardify"], ["category_id", 9], ["slug", "cardify"], ["created_at", "2017-07-28 07:36:34.788752"], ["updated_at", "2017-07-28 07:36:34.788752"], ["layout_id", 9]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "harmony_kihn"], ["email", "katelynn@bednarbauch.org"], ["password", "Zl6fI7D6M7Ac"], ["created_at", "2017-07-28 07:36:34.793471"], ["updated_at", "2017-07-28 07:36:34.793471"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "magni-fugiat"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Konklux"], ["phone", "(730) 173-6670"], ["address", "6926 Marquardt Row"], ["url", "http://stokes.com/shane"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://senger.info/diana.hoeger"], ["auth_expiration_time", 900], ["slug", "magni-fugiat"], ["brand_id", 9], ["user_id", 11], ["created_at", "2017-07-28 07:36:34.799335"], ["updated_at", "2017-07-28 07:36:34.799335"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 5], ["location_id", 9], ["counter", 3], ["created_at", "2017-07-28 07:36:34.804167"], ["updated_at", "2017-07-28 07:36:34.804167"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "aileen"], ["email", "ara_kling@feeney.name"], ["password", "B6247hV2"], ["role_cd", 3], ["created_at", "2017-07-28 07:36:34.808907"], ["updated_at", "2017-07-28 07:36:34.808907"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:34 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"aileen", "email"=>"ara_kling@feeney.name", "password"=>"B6247hV2", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"aileen", :email=>"ara_kling@feeney.name", :password=>"B6247hV2", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"ara_kling@feeney.name", "password"=>"B6247hV2"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "aileen"], ["email", "ara_kling@feeney.name"], ["password", "B6247hV2"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 12, username: "aileen", email: "ara_kling@feeney.name", password: "B6247hV2", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:36:34", updated_at: "2017-07-28 07:36:34", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 12[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=passed&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:34 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"passed", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 12) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>12, "username"=>"aileen", "email"=>"ara_kling@feeney.name", "password"=>"B6247hV2", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"passed", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>12, :username=>"aileen", :email=>"ara_kling@feeney.name", :password=>"B6247hV2", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:36:34.808Z", :updated_at=>"2017-07-28T07:36:34.808Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:36:34.840484') AND "client_counters"."location_id" IN (7, 8, 9) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1) ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 6[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.7ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 6[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:36:34.840484') AND "client_counters"."location_id" IN (7, 8, 9) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1)[0m
[INFO ] Completed [32m200 OK[0m in 32ms [30m(Views: 0.4ms | ActiveRecord: 8.3ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "848-094-3400"], ["created_at", "2017-07-28 07:36:34.861001"], ["updated_at", "2017-07-28 07:36:34.861001"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Home Ing"], ["created_at", "2017-07-28 07:36:34.867960"], ["updated_at", "2017-07-28 07:36:34.867960"], ["local_path", "http://gerholdohara.info/wilmer_schulist"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Solarbreeze"], ["title_ru", "Название10"], ["created_at", "2017-07-28 07:36:34.871967"], ["updated_at", "2017-07-28 07:36:34.871967"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 10[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_10[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 10) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>10, "title"=>"Home Ing", "created_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "local_path"=>"http://gerholdohara.info/wilmer_schulist"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "rank"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "rank"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Rank"], ["category_id", 10], ["slug", "rank"], ["created_at", "2017-07-28 07:36:34.883811"], ["updated_at", "2017-07-28 07:36:34.883811"], ["layout_id", 10]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ramiro"], ["email", "candido@rippinromaguera.info"], ["password", "2qJxNfM87g"], ["created_at", "2017-07-28 07:36:34.889096"], ["updated_at", "2017-07-28 07:36:34.889096"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptatibus_alias"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stim"], ["phone", "1-637-250-2395"], ["address", "4545 Vandervort Valleys"], ["url", "http://cremin.info/lucy_block"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kunzewelch.io/juliet_huel"], ["auth_expiration_time", 900], ["slug", "voluptatibus_alias"], ["brand_id", 10], ["user_id", 13], ["created_at", "2017-07-28 07:36:34.895120"], ["updated_at", "2017-07-28 07:36:34.895120"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 7], ["location_id", 10], ["counter", 2], ["created_at", "2017-07-28 07:36:34.899907"], ["updated_at", "2017-07-28 07:36:34.899907"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "908-031-5479"], ["created_at", "2017-07-28 07:36:34.903894"], ["updated_at", "2017-07-28 07:36:34.903894"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Cardguard"], ["created_at", "2017-07-28 07:36:34.910821"], ["updated_at", "2017-07-28 07:36:34.910821"], ["local_path", "http://fritschdurgan.com/floy_rohan"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Aerified"], ["title_ru", "Название11"], ["created_at", "2017-07-28 07:36:34.914779"], ["updated_at", "2017-07-28 07:36:34.914779"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 11[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_11[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 11) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>11, "title"=>"Cardguard", "created_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "local_path"=>"http://fritschdurgan.com/floy_rohan"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "vagram"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "vagram"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Vagram"], ["category_id", 11], ["slug", "vagram"], ["created_at", "2017-07-28 07:36:34.926363"], ["updated_at", "2017-07-28 07:36:34.926363"], ["layout_id", 11]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "abdiel.pollich"], ["email", "leif@watsica.net"], ["password", "HoSrL9Q815"], ["created_at", "2017-07-28 07:36:34.931538"], ["updated_at", "2017-07-28 07:36:34.931538"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "rerum-optio"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Holdlamis"], ["phone", "329.227.9160"], ["address", "7678 Schumm Streets"], ["url", "http://torphyhansen.com/christa.feil"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://goldnerkuhn.info/tyrell"], ["auth_expiration_time", 900], ["slug", "rerum-optio"], ["brand_id", 11], ["user_id", 14], ["created_at", "2017-07-28 07:36:34.938006"], ["updated_at", "2017-07-28 07:36:34.938006"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 8], ["location_id", 11], ["counter", 6], ["created_at", "2017-07-28 07:36:34.943144"], ["updated_at", "2017-07-28 07:36:34.943144"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Job"], ["created_at", "2017-07-28 07:36:34.949658"], ["updated_at", "2017-07-28 07:36:34.949658"], ["local_path", "http://olsonbogisich.biz/cedrick.wisoky"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Greenlam"], ["title_ru", "Название12"], ["created_at", "2017-07-28 07:36:34.953869"], ["updated_at", "2017-07-28 07:36:34.953869"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_12[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 12) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>12, "title"=>"Job", "created_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "local_path"=>"http://olsonbogisich.biz/cedrick.wisoky"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Konklab"], ["category_id", 12], ["slug", "konklab"], ["created_at", "2017-07-28 07:36:34.965733"], ["updated_at", "2017-07-28 07:36:34.965733"], ["layout_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "trycia_kihn"], ["email", "larry@volkmanblick.biz"], ["password", "VwTiBgIwTsP1Pt"], ["created_at", "2017-07-28 07:36:34.971162"], ["updated_at", "2017-07-28 07:36:34.971162"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "tempore-maxime"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Opela"], ["phone", "831-384-5924"], ["address", "1549 Bednar Manors"], ["url", "http://christiansenauer.com/silas"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://howehane.io/magdalena"], ["auth_expiration_time", 900], ["slug", "tempore-maxime"], ["brand_id", 12], ["user_id", 15], ["created_at", "2017-07-28 07:36:34.977209"], ["updated_at", "2017-07-28 07:36:34.977209"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 7], ["location_id", 12], ["counter", 9], ["created_at", "2017-07-28 07:36:34.981934"], ["updated_at", "2017-07-28 07:36:34.981934"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zoolab"], ["created_at", "2017-07-28 07:36:34.988977"], ["updated_at", "2017-07-28 07:36:34.988977"], ["local_path", "http://kertzmann.info/briana.conroy"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fixflex"], ["title_ru", "Название13"], ["created_at", "2017-07-28 07:36:34.992871"], ["updated_at", "2017-07-28 07:36:34.992871"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 13[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_13[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 13) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>13, "title"=>"Zoolab", "created_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:34 UTC +00:00, "local_path"=>"http://kertzmann.info/briana.conroy"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stronghold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stronghold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Stronghold"], ["category_id", 13], ["slug", "stronghold"], ["created_at", "2017-07-28 07:36:35.005062"], ["updated_at", "2017-07-28 07:36:35.005062"], ["layout_id", 13]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "alf"], ["email", "keara_vandervort@hellertrantow.biz"], ["password", "Yz3zNbG9260uMgGq"], ["created_at", "2017-07-28 07:36:35.010962"], ["updated_at", "2017-07-28 07:36:35.010962"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "officia.consequuntur"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Span"], ["phone", "135.208.8305"], ["address", "63641 Bertha Terrace"], ["url", "http://grant.com/adonis"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://goodwin.io/king_king"], ["auth_expiration_time", 900], ["slug", "officia.consequuntur"], ["brand_id", 13], ["user_id", 16], ["created_at", "2017-07-28 07:36:35.017456"], ["updated_at", "2017-07-28 07:36:35.017456"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 8], ["location_id", 13], ["counter", 3], ["created_at", "2017-07-20 07:36:34.984560"], ["updated_at", "2017-07-20 07:36:34.984674"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "avis_strosin"], ["email", "hyman@doyle.com"], ["password", "ItPnUgDz"], ["role_cd", 3], ["created_at", "2017-07-28 07:36:35.026855"], ["updated_at", "2017-07-28 07:36:35.026855"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:35 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"avis_strosin", "email"=>"hyman@doyle.com", "password"=>"ItPnUgDz", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"avis_strosin", :email=>"hyman@doyle.com", :password=>"ItPnUgDz", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"hyman@doyle.com", "password"=>"ItPnUgDz"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "avis_strosin"], ["email", "hyman@doyle.com"], ["password", "ItPnUgDz"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 17, username: "avis_strosin", email: "hyman@doyle.com", password: "ItPnUgDz", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:36:35", updated_at: "2017-07-28 07:36:35", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 17[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=passed&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:35 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"passed", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 17) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>17, "username"=>"avis_strosin", "email"=>"hyman@doyle.com", "password"=>"ItPnUgDz", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"passed", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>17, :username=>"avis_strosin", :email=>"hyman@doyle.com", :password=>"ItPnUgDz", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:36:35.026Z", :updated_at=>"2017-07-28T07:36:35.026Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:36:35.057669') AND "client_counters"."location_id" IN (10, 11, 12, 13) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1) ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.9ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 8[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:36:35.057669') AND "client_counters"."location_id" IN (10, 11, 12, 13) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1)[0m
[INFO ] Completed [32m200 OK[0m in 31ms [30m(Views: 0.5ms | ActiveRecord: 9.0ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "150-364-5118 x655"], ["created_at", "2017-07-28 07:36:35.079238"], ["updated_at", "2017-07-28 07:36:35.079238"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Pannier"], ["created_at", "2017-07-28 07:36:35.086305"], ["updated_at", "2017-07-28 07:36:35.086305"], ["local_path", "http://metz.info/brianne"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Aerified"], ["title_ru", "Название14"], ["created_at", "2017-07-28 07:36:35.090307"], ["updated_at", "2017-07-28 07:36:35.090307"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 14[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_14[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 14) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>14, "title"=>"Pannier", "created_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "local_path"=>"http://metz.info/brianne"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "fixflex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "fixflex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Fixflex"], ["category_id", 14], ["slug", "fixflex"], ["created_at", "2017-07-28 07:36:35.102364"], ["updated_at", "2017-07-28 07:36:35.102364"], ["layout_id", 14]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lacey.huels"], ["email", "lorenzo_kautzer@sauerprosacco.net"], ["password", "GqDzCzRbUhYrT"], ["created_at", "2017-07-28 07:36:35.107629"], ["updated_at", "2017-07-28 07:36:35.107629"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptas.aut"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Biodex"], ["phone", "396-612-7806"], ["address", "125 Salvador Brook"], ["url", "http://haley.co/rhoda"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://bartell.name/beth"], ["auth_expiration_time", 900], ["slug", "voluptas.aut"], ["brand_id", 14], ["user_id", 18], ["created_at", "2017-07-28 07:36:35.113790"], ["updated_at", "2017-07-28 07:36:35.113790"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 9], ["location_id", 14], ["counter", 4], ["created_at", "2017-07-28 07:36:35.118308"], ["updated_at", "2017-07-28 07:36:35.118308"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "378-152-4903 x299"], ["created_at", "2017-07-28 07:36:35.122245"], ["updated_at", "2017-07-28 07:36:35.122245"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Sonsing"], ["created_at", "2017-07-28 07:36:35.128619"], ["updated_at", "2017-07-28 07:36:35.128619"], ["local_path", "http://wehner.biz/jeika_nikolaus"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bigtax"], ["title_ru", "Название15"], ["created_at", "2017-07-28 07:36:35.132055"], ["updated_at", "2017-07-28 07:36:35.132055"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 15[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_15[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 15) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>15, "title"=>"Sonsing", "created_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "local_path"=>"http://wehner.biz/jeika_nikolaus"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "namfix"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "namfix"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Namfix"], ["category_id", 15], ["slug", "namfix"], ["created_at", "2017-07-28 07:36:35.143592"], ["updated_at", "2017-07-28 07:36:35.143592"], ["layout_id", 15]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "freddy.williamson"], ["email", "oren@murphy.info"], ["password", "2mEd6zRf61PzV0"], ["created_at", "2017-07-28 07:36:35.148589"], ["updated_at", "2017-07-28 07:36:35.148589"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptatem_deserunt"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Latlux"], ["phone", "475-723-9996"], ["address", "723 Judah Parks"], ["url", "http://wintheiser.co/lori.rutherford"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://connelly.io/maximilian_tromp"], ["auth_expiration_time", 900], ["slug", "voluptatem_deserunt"], ["brand_id", 15], ["user_id", 19], ["created_at", "2017-07-28 07:36:35.154739"], ["updated_at", "2017-07-28 07:36:35.154739"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 10], ["location_id", 15], ["counter", 2], ["created_at", "2017-07-28 07:36:35.159668"], ["updated_at", "2017-07-28 07:36:35.159668"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Cardguard"], ["created_at", "2017-07-28 07:36:35.166235"], ["updated_at", "2017-07-28 07:36:35.166235"], ["local_path", "http://ebertwalsh.info/jacquelyn"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Ventosanzap"], ["title_ru", "Название16"], ["created_at", "2017-07-28 07:36:35.169936"], ["updated_at", "2017-07-28 07:36:35.169936"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 16[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_16[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 16) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>16, "title"=>"Cardguard", "created_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "local_path"=>"http://ebertwalsh.info/jacquelyn"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "andalax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "andalax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Andalax"], ["category_id", 16], ["slug", "andalax"], ["created_at", "2017-07-28 07:36:35.181431"], ["updated_at", "2017-07-28 07:36:35.181431"], ["layout_id", 16]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "elinore_reilly"], ["email", "chance@parisian.net"], ["password", "Gi6tJxE3CgXe73"], ["created_at", "2017-07-28 07:36:35.186411"], ["updated_at", "2017-07-28 07:36:35.186411"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "eum-neque"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Span"], ["phone", "(767) 551-3045"], ["address", "8182 Reynolds Meadows"], ["url", "http://runolfon.org/noel"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://block.org/kaleigh"], ["auth_expiration_time", 900], ["slug", "eum-neque"], ["brand_id", 16], ["user_id", 20], ["created_at", "2017-07-28 07:36:35.192701"], ["updated_at", "2017-07-28 07:36:35.192701"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 9], ["location_id", 16], ["counter", 1], ["created_at", "2017-07-28 07:36:35.197587"], ["updated_at", "2017-07-28 07:36:35.197587"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "nasir_trantow"], ["email", "abdullah@runolfsdottirmarvin.name"], ["password", "YvBg4a0nEjAn9tRj"], ["role_cd", 3], ["created_at", "2017-07-28 07:36:35.202284"], ["updated_at", "2017-07-28 07:36:35.202284"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:35 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"nasir_trantow", "email"=>"abdullah@runolfsdottirmarvin.name", "password"=>"YvBg4a0nEjAn9tRj", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"nasir_trantow", :email=>"abdullah@runolfsdottirmarvin.name", :password=>"YvBg4a0nEjAn9tRj", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"abdullah@runolfsdottirmarvin.name", "password"=>"YvBg4a0nEjAn9tRj"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "nasir_trantow"], ["email", "abdullah@runolfsdottirmarvin.name"], ["password", "YvBg4a0nEjAn9tRj"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 21, username: "nasir_trantow", email: "abdullah@runolfsdottirmarvin.name", password: "YvBg4a0nEjAn9tRj", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:36:35", updated_at: "2017-07-28 07:36:35", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 21[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:35 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 21) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>21, "username"=>"nasir_trantow", "email"=>"abdullah@runolfsdottirmarvin.name", "password"=>"YvBg4a0nEjAn9tRj", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.9ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>21, :username=>"nasir_trantow", :email=>"abdullah@runolfsdottirmarvin.name", :password=>"YvBg4a0nEjAn9tRj", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:36:35.202Z", :updated_at=>"2017-07-28T07:36:35.202Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:36:35.118308') AND "client_counters"."location_id" IN (14, 15, 16) GROUP BY client_id, phone_number ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (9, 10)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (9, 10)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:36:35.118308') AND "client_counters"."location_id" IN (14, 15, 16) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 33ms [30m(Views: 0.6ms | ActiveRecord: 9.6ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "596-234-2197"], ["created_at", "2017-07-28 07:36:35.255660"], ["updated_at", "2017-07-28 07:36:35.255660"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Rank"], ["created_at", "2017-07-28 07:36:35.262656"], ["updated_at", "2017-07-28 07:36:35.262656"], ["local_path", "http://roberts.org/frederique.schuppe"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Hatity"], ["title_ru", "Название17"], ["created_at", "2017-07-28 07:36:35.266646"], ["updated_at", "2017-07-28 07:36:35.266646"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_17[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 17) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>17, "title"=>"Rank", "created_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "local_path"=>"http://roberts.org/frederique.schuppe"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "transcof"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "transcof"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Transcof"], ["category_id", 17], ["slug", "transcof"], ["created_at", "2017-07-28 07:36:35.278560"], ["updated_at", "2017-07-28 07:36:35.278560"], ["layout_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "luisa.kutch"], ["email", "eloise_hickle@welch.net"], ["password", "9eW2OqA7"], ["created_at", "2017-07-28 07:36:35.283515"], ["updated_at", "2017-07-28 07:36:35.283515"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ullam-est"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Fintone"], ["phone", "(114) 120-8112"], ["address", "95778 Brekke Key"], ["url", "http://herman.io/amie_macejkovic"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://langosh.co/kurt"], ["auth_expiration_time", 900], ["slug", "ullam-est"], ["brand_id", 17], ["user_id", 22], ["created_at", "2017-07-28 07:36:35.289937"], ["updated_at", "2017-07-28 07:36:35.289937"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 11], ["location_id", 17], ["counter", 3], ["created_at", "2017-07-28 07:36:35.294597"], ["updated_at", "2017-07-28 07:36:35.294597"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(366) 339-9473 x702"], ["created_at", "2017-07-28 07:36:35.298474"], ["updated_at", "2017-07-28 07:36:35.298474"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Solarbreeze"], ["created_at", "2017-07-28 07:36:35.305303"], ["updated_at", "2017-07-28 07:36:35.305303"], ["local_path", "http://herzog.co/ken_corkery"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Home Ing"], ["title_ru", "Название18"], ["created_at", "2017-07-28 07:36:35.309151"], ["updated_at", "2017-07-28 07:36:35.309151"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 18[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_18[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 18) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>18, "title"=>"Solarbreeze", "created_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "local_path"=>"http://herzog.co/ken_corkery"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "biodex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "biodex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Biodex"], ["category_id", 18], ["slug", "biodex"], ["created_at", "2017-07-28 07:36:35.320842"], ["updated_at", "2017-07-28 07:36:35.320842"], ["layout_id", 18]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "evans"], ["email", "laurine.klein@bosco.org"], ["password", "1f157u24E"], ["created_at", "2017-07-28 07:36:35.325853"], ["updated_at", "2017-07-28 07:36:35.325853"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "consequatur.vel"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tin"], ["phone", "653.437.9644"], ["address", "5465 Brekke Via"], ["url", "http://spencerfay.org/ocie_muller"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://feeney.org/jedediah_wunsch"], ["auth_expiration_time", 900], ["slug", "consequatur.vel"], ["brand_id", 18], ["user_id", 23], ["created_at", "2017-07-28 07:36:35.332028"], ["updated_at", "2017-07-28 07:36:35.332028"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 12], ["location_id", 18], ["counter", 8], ["created_at", "2017-07-28 07:36:35.336907"], ["updated_at", "2017-07-28 07:36:35.336907"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Otcom"], ["created_at", "2017-07-28 07:36:35.343622"], ["updated_at", "2017-07-28 07:36:35.343622"], ["local_path", "http://marks.biz/heber"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Opela"], ["title_ru", "Название19"], ["created_at", "2017-07-28 07:36:35.347403"], ["updated_at", "2017-07-28 07:36:35.347403"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 19[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_19[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 19) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>19, "title"=>"Otcom", "created_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "local_path"=>"http://marks.biz/heber"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alpha"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alpha"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Alpha"], ["category_id", 19], ["slug", "alpha"], ["created_at", "2017-07-28 07:36:35.358993"], ["updated_at", "2017-07-28 07:36:35.358993"], ["layout_id", 19]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "opal"], ["email", "otilia@collier.net"], ["password", "333tBsIrBlGf81Hs"], ["created_at", "2017-07-28 07:36:35.364091"], ["updated_at", "2017-07-28 07:36:35.364091"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "amet.iste"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Cookley"], ["phone", "1-170-022-9569"], ["address", "64924 Kshlerin Greens"], ["url", "http://block.io/gina_windler"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://heelheidenreich.info/lance.lehner"], ["auth_expiration_time", 900], ["slug", "amet.iste"], ["brand_id", 19], ["user_id", 24], ["created_at", "2017-07-28 07:36:35.370220"], ["updated_at", "2017-07-28 07:36:35.370220"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 11], ["location_id", 19], ["counter", 4], ["created_at", "2017-07-28 07:36:35.375360"], ["updated_at", "2017-07-28 07:36:35.375360"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "jaycee"], ["email", "granville_jacobs@harber.info"], ["password", "4gZ4Be05J46b00U"], ["role_cd", 3], ["created_at", "2017-07-28 07:36:35.380350"], ["updated_at", "2017-07-28 07:36:35.380350"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:35 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"jaycee", "email"=>"granville_jacobs@harber.info", "password"=>"4gZ4Be05J46b00U", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"jaycee", :email=>"granville_jacobs@harber.info", :password=>"4gZ4Be05J46b00U", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"granville_jacobs@harber.info", "password"=>"4gZ4Be05J46b00U"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "jaycee"], ["email", "granville_jacobs@harber.info"], ["password", "4gZ4Be05J46b00U"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 25, username: "jaycee", email: "granville_jacobs@harber.info", password: "4gZ4Be05J46b00U", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:36:35", updated_at: "2017-07-28 07:36:35", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 25[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=updated_at&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:35 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"updated_at", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 25) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>25, "username"=>"jaycee", "email"=>"granville_jacobs@harber.info", "password"=>"4gZ4Be05J46b00U", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"updated_at", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.8ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>25, :username=>"jaycee", :email=>"granville_jacobs@harber.info", :password=>"4gZ4Be05J46b00U", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:36:35.380Z", :updated_at=>"2017-07-28T07:36:35.380Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:36:35.294597') AND "client_counters"."location_id" IN (17, 18, 19) GROUP BY client_id, phone_number ORDER BY updated_at desc, visits desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (11, 12)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (11, 12)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:36:35.294597') AND "client_counters"."location_id" IN (17, 18, 19) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 33ms [30m(Views: 0.6ms | ActiveRecord: 9.3ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-886-032-8584 x733"], ["created_at", "2017-07-28 07:36:35.433600"], ["updated_at", "2017-07-28 07:36:35.433600"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Sonair"], ["created_at", "2017-07-28 07:36:35.440607"], ["updated_at", "2017-07-28 07:36:35.440607"], ["local_path", "http://bahringer.info/shyann"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Asoka"], ["title_ru", "Название20"], ["created_at", "2017-07-28 07:36:35.444494"], ["updated_at", "2017-07-28 07:36:35.444494"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 20[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_20[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 20) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>20, "title"=>"Sonair", "created_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "local_path"=>"http://bahringer.info/shyann"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tin"], ["category_id", 20], ["slug", "tin"], ["created_at", "2017-07-28 07:36:35.455961"], ["updated_at", "2017-07-28 07:36:35.455961"], ["layout_id", 20]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "korey"], ["email", "mortimer@gleasonwolf.io"], ["password", "CxHxWv6sD0"], ["created_at", "2017-07-28 07:36:35.460935"], ["updated_at", "2017-07-28 07:36:35.460935"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ex.quia"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "It"], ["phone", "(947) 335-6482"], ["address", "526 McGlynn Stream"], ["url", "http://lowe.com/hilda_will"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://schiller.net/andreane_harvey"], ["auth_expiration_time", 900], ["slug", "ex.quia"], ["brand_id", 20], ["user_id", 26], ["created_at", "2017-07-28 07:36:35.467136"], ["updated_at", "2017-07-28 07:36:35.467136"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 13], ["location_id", 20], ["counter", 9], ["created_at", "2017-07-28 07:36:35.472186"], ["updated_at", "2017-07-28 07:36:35.472186"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-619-760-4727 x6080"], ["created_at", "2017-07-28 07:36:35.476193"], ["updated_at", "2017-07-28 07:36:35.476193"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tres-Zap"], ["created_at", "2017-07-28 07:36:35.483165"], ["updated_at", "2017-07-28 07:36:35.483165"], ["local_path", "http://shanahan.name/everardo"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Cookley"], ["title_ru", "Название21"], ["created_at", "2017-07-28 07:36:35.486992"], ["updated_at", "2017-07-28 07:36:35.486992"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_21[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 21) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>21, "title"=>"Tres-Zap", "created_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "local_path"=>"http://shanahan.name/everardo"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-solowarm"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-solowarm"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Y-Solowarm"], ["category_id", 21], ["slug", "y-solowarm"], ["created_at", "2017-07-28 07:36:35.498774"], ["updated_at", "2017-07-28 07:36:35.498774"], ["layout_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "isidro_willms"], ["email", "everette@daniel.info"], ["password", "NaHvK9UsEy"], ["created_at", "2017-07-28 07:36:35.503888"], ["updated_at", "2017-07-28 07:36:35.503888"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "iusto_voluptates"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Andalax"], ["phone", "(327) 027-9286"], ["address", "3869 Jacobson Cliff"], ["url", "http://ullrich.name/madalyn.lubowitz"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://jonesmcdermott.info/kianna"], ["auth_expiration_time", 900], ["slug", "iusto_voluptates"], ["brand_id", 21], ["user_id", 27], ["created_at", "2017-07-28 07:36:35.510387"], ["updated_at", "2017-07-28 07:36:35.510387"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 14], ["location_id", 21], ["counter", 4], ["created_at", "2017-07-28 07:36:35.515384"], ["updated_at", "2017-07-28 07:36:35.515384"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Job"], ["created_at", "2017-07-28 07:36:35.522207"], ["updated_at", "2017-07-28 07:36:35.522207"], ["local_path", "http://powlowski.co/carleton"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Konklux"], ["title_ru", "Название22"], ["created_at", "2017-07-28 07:36:35.525882"], ["updated_at", "2017-07-28 07:36:35.525882"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 22[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_22[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 22) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>22, "title"=>"Job", "created_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "local_path"=>"http://powlowski.co/carleton"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "veribet"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "veribet"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Veribet"], ["category_id", 22], ["slug", "veribet"], ["created_at", "2017-07-28 07:36:35.536788"], ["updated_at", "2017-07-28 07:36:35.536788"], ["layout_id", 22]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "brain.ruecker"], ["email", "rogers.okeefe@oreillyharber.com"], ["password", "3nXvMf3aVkBiAt"], ["created_at", "2017-07-28 07:36:35.541359"], ["updated_at", "2017-07-28 07:36:35.541359"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "in-repellendus"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Rank"], ["phone", "(953) 177-8568"], ["address", "49663 Treutel Well"], ["url", "http://beatty.com/ardella"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://jenkins.io/hulda"], ["auth_expiration_time", 900], ["slug", "in-repellendus"], ["brand_id", 22], ["user_id", 28], ["created_at", "2017-07-28 07:36:35.546990"], ["updated_at", "2017-07-28 07:36:35.546990"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 13], ["location_id", 22], ["counter", 8], ["created_at", "2017-07-28 07:36:35.551564"], ["updated_at", "2017-07-28 07:36:35.551564"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "899-194-7903 x10164"], ["created_at", "2017-07-28 07:36:35.555949"], ["updated_at", "2017-07-28 07:36:35.555949"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Alpha"], ["created_at", "2017-07-28 07:36:35.561801"], ["updated_at", "2017-07-28 07:36:35.561801"], ["local_path", "http://marquardtbraun.name/jefferey_collier"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Cardify"], ["title_ru", "Название23"], ["created_at", "2017-07-28 07:36:35.565533"], ["updated_at", "2017-07-28 07:36:35.565533"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 23[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_23[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 23) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>23, "title"=>"Alpha", "created_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "local_path"=>"http://marquardtbraun.name/jefferey_collier"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "duobam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "duobam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Duobam"], ["category_id", 23], ["slug", "duobam"], ["created_at", "2017-07-28 07:36:35.576528"], ["updated_at", "2017-07-28 07:36:35.576528"], ["layout_id", 23]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "gabe"], ["email", "jarod.franecki@bartoletti.org"], ["password", "IoZi0uDdF1"], ["created_at", "2017-07-28 07:36:35.581285"], ["updated_at", "2017-07-28 07:36:35.581285"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "nam-ut"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Transcof"], ["phone", "(335) 932-1415"], ["address", "9177 Daniel Meadow"], ["url", "http://grimes.com/estevan"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://emardmann.co/kaitlin.beahan"], ["auth_expiration_time", 900], ["slug", "nam-ut"], ["brand_id", 23], ["user_id", 29], ["created_at", "2017-07-28 07:36:35.587031"], ["updated_at", "2017-07-28 07:36:35.587031"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 15], ["location_id", 23], ["counter", 8], ["created_at", "2017-06-26 07:36:35.554128"], ["updated_at", "2017-06-26 07:36:35.554241"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "luis.jacobson"], ["email", "kariane@schuppe.biz"], ["password", "HbYoQvQc73BuCmH"], ["role_cd", 3], ["created_at", "2017-07-28 07:36:35.609558"], ["updated_at", "2017-07-28 07:36:35.609558"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:35 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"luis.jacobson", "email"=>"kariane@schuppe.biz", "password"=>"HbYoQvQc73BuCmH", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"luis.jacobson", :email=>"kariane@schuppe.biz", :password=>"HbYoQvQc73BuCmH", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"kariane@schuppe.biz", "password"=>"HbYoQvQc73BuCmH"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "luis.jacobson"], ["email", "kariane@schuppe.biz"], ["password", "HbYoQvQc73BuCmH"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 30, username: "luis.jacobson", email: "kariane@schuppe.biz", password: "HbYoQvQc73BuCmH", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:36:35", updated_at: "2017-07-28 07:36:35", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 30[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=visits30&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:35 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits30", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 30) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>30, "username"=>"luis.jacobson", "email"=>"kariane@schuppe.biz", "password"=>"HbYoQvQc73BuCmH", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits30", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.7ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>30, :username=>"luis.jacobson", :email=>"kariane@schuppe.biz", :password=>"HbYoQvQc73BuCmH", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:36:35.609Z", :updated_at=>"2017-07-28T07:36:35.609Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-06-26 07:36:35.554128') AND "client_counters"."location_id" IN (20, 21, 22, 23) GROUP BY client_id, phone_number ORDER BY visits30 asc, updated_at desc, visits desc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (15, 14, 13)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.9ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (13, 14, 15)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-06-26 07:36:35.554128') AND "client_counters"."location_id" IN (20, 21, 22, 23) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 34ms [30m(Views: 0.9ms | ActiveRecord: 9.2ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "marlin"], ["email", "lola_leannon@stiedemann.com"], ["password", "T67uWdLnVzZnA"], ["created_at", "2017-07-28 07:36:35.665495"], ["updated_at", "2017-07-28 07:36:35.665495"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jerel_kutch"], ["email", "clinton_gusikowski@johnsonhilll.org"], ["password", "VtOz7l87Jw2c9"], ["created_at", "2017-07-28 07:36:35.695972"], ["updated_at", "2017-07-28 07:36:35.695972"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "oren_cronin"], ["email", "audie@gislasonstamm.name"], ["password", "BpI2Jj125jYwS"], ["created_at", "2017-07-28 07:36:35.713975"], ["updated_at", "2017-07-28 07:36:35.713975"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "hector_bartoletti"], ["email", "newton@lueilwitz.biz"], ["password", "5992E9Gf8"], ["created_at", "2017-07-28 07:36:35.725100"], ["updated_at", "2017-07-28 07:36:35.725100"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "henry"], ["email", "andreane_hickle@cremin.co"], ["password", "258mVaWtXv6uG"], ["created_at", "2017-07-28 07:36:35.735283"], ["updated_at", "2017-07-28 07:36:35.735283"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "118-524-8694"], ["created_at", "2017-07-28 07:36:35.769187"], ["updated_at", "2017-07-28 07:36:35.769187"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "claria.satterfield"], ["email", "verla@nienow.co"], ["password", "48TkZpReXcD0T"], ["created_at", "2017-07-28 07:36:35.774962"], ["updated_at", "2017-07-28 07:36:35.774962"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.6ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "418485"], ["username", "domenick_franecki"], ["image", "http://instagram.com/img/domenick_franecki.jpg"], ["profile", "https://instagram.com/domenick_franecki"], ["email", "king.reilly@price.com"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 16], ["user_id", 36], ["created_at", "2017-07-28 07:36:35.780140"], ["updated_at", "2017-07-28 07:36:35.780140"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Fixflex"], ["created_at", "2017-07-28 07:36:35.787948"], ["updated_at", "2017-07-28 07:36:35.787948"], ["local_path", "http://handsmitham.org/dale_brekke"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Trippledex"], ["title_ru", "Название24"], ["created_at", "2017-07-28 07:36:35.791751"], ["updated_at", "2017-07-28 07:36:35.791751"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 24[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_24[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 24) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>24, "title"=>"Fixflex", "created_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "local_path"=>"http://handsmitham.org/dale_brekke"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Konklux"], ["category_id", 24], ["slug", "konklux"], ["created_at", "2017-07-28 07:36:35.803624"], ["updated_at", "2017-07-28 07:36:35.803624"], ["layout_id", 24]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "animi.nihil"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Voyatouch"], ["phone", "303.630.4863"], ["address", "24252 Eden Course"], ["url", "http://haag.org/jillian"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://bayer.co/titus"], ["auth_expiration_time", 900], ["slug", "animi.nihil"], ["brand_id", 24], ["user_id", 36], ["created_at", "2017-07-28 07:36:35.809798"], ["updated_at", "2017-07-28 07:36:35.809798"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Andalax"], ["created_at", "2017-07-28 07:36:35.860163"], ["updated_at", "2017-07-28 07:36:35.860163"], ["local_path", "http://rolfsonhauck.info/nannie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Wrapsafe"], ["title_ru", "Название25"], ["created_at", "2017-07-28 07:36:35.864283"], ["updated_at", "2017-07-28 07:36:35.864283"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_25[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 25) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>25, "title"=>"Andalax", "created_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "local_path"=>"http://rolfsonhauck.info/nannie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stringtough"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stringtough"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Stringtough"], ["category_id", 25], ["slug", "stringtough"], ["created_at", "2017-07-28 07:36:35.875865"], ["updated_at", "2017-07-28 07:36:35.875865"], ["layout_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "clark"], ["email", "percival_wolf@ruel.net"], ["password", "HnRjZzEsQ5Cx9"], ["created_at", "2017-07-28 07:36:35.880549"], ["updated_at", "2017-07-28 07:36:35.880549"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "dolor-ratione"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Fixflex"], ["phone", "591-082-9999"], ["address", "814 Hammes Ferry"], ["url", "http://wuckert.com/esmeralda"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://schinner.name/ivory"], ["auth_expiration_time", 900], ["slug", "dolor-ratione"], ["brand_id", 25], ["user_id", 37], ["created_at", "2017-07-28 07:36:35.886596"], ["updated_at", "2017-07-28 07:36:35.886596"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jeffery"], ["email", "garret@hudsonmills.org"], ["password", "Xn4cLp7i8t4pHv"], ["created_at", "2017-07-28 07:36:35.892025"], ["updated_at", "2017-07-28 07:36:35.892025"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5331"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5331"], ["comment", "comment 11"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "99.88.76.15"], ["router_admin_ip", "92.146.117.189"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "260"], ["status", "t"], ["location_id", 25], ["user_id", 38], ["created_at", "2017-07-28 07:36:35.900762"], ["updated_at", "2017-07-28 07:36:35.900762"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5331"], ["id", 1], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 1], ["serial", "643705CA5E36/5331"], ["comment", "comment 11"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "99.88.76.15"], ["router_admin_ip", "92.146.117.189"], ["admin_password", "511e3083740ecb23"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "1"], ["status", "t"], ["location_id", 25], ["user_id", 38], ["created_at", "2017-07-28 07:36:35.900762"], ["updated_at", "2017-07-28 07:36:35.900762"], ["id", 1]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: b0575f50-11a9-4ed7-9316-a199ad88d0fa) to Async(routers) with arguments: #<GlobalID:0x007f87766ca9a8 @uri=#<URI::GID gid://wifi-management/Router/1>>
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: da290ba2-bd2c-4936-b6a3-9662650135c4) to Async(routers) with arguments: #<GlobalID:0x007f87766ca9a8 @uri=#<URI::GID gid://wifi-management/Router/1>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.6ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 1], ["provider", "instagram"], ["location_id", 24], ["router_id", 1], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:36 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"claria.satterfield", "email"=>"verla@nienow.co", "password"=>"48TkZpReXcD0T", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"claria.satterfield", :email=>"verla@nienow.co", :password=>"48TkZpReXcD0T", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"verla@nienow.co", "password"=>"48TkZpReXcD0T"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "claria.satterfield"], ["email", "verla@nienow.co"], ["password", "48TkZpReXcD0T"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 36, username: "claria.satterfield", email: "verla@nienow.co", password: "48TkZpReXcD0T", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:35", updated_at: "2017-07-28 07:36:35", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 36[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/stats/time_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:36 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#time_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_36[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 36) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>36, "username"=>"claria.satterfield", "email"=>"verla@nienow.co", "password"=>"48TkZpReXcD0T", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:35 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"time_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_36[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_36[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>36, :username=>"claria.satterfield", :email=>"verla@nienow.co", :password=>"48TkZpReXcD0T", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:35.774Z", :updated_at=>"2017-07-28T07:36:35.774Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 36[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(24)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 27ms [30m(Views: 1.2ms | ActiveRecord: 6.2ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(396) 675-2588 x92771"], ["created_at", "2017-07-28 07:36:36.142426"], ["updated_at", "2017-07-28 07:36:36.142426"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "maude"], ["email", "maxine@kiehn.co"], ["password", "Z5Q2CcF0Mv7d9"], ["created_at", "2017-07-28 07:36:36.148072"], ["updated_at", "2017-07-28 07:36:36.148072"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "361674"], ["username", "kaelyn.daugherty"], ["image", "http://instagram.com/img/kaelyn.daugherty.jpg"], ["profile", "https://instagram.com/kaelyn.daugherty"], ["email", "amir.hoppe@fishergreen.biz"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 17], ["user_id", 39], ["created_at", "2017-07-28 07:36:36.152922"], ["updated_at", "2017-07-28 07:36:36.152922"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Keylex"], ["created_at", "2017-07-28 07:36:36.160688"], ["updated_at", "2017-07-28 07:36:36.160688"], ["local_path", "http://kovacek.biz/jovani_nader"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fixflex"], ["title_ru", "Название26"], ["created_at", "2017-07-28 07:36:36.164573"], ["updated_at", "2017-07-28 07:36:36.164573"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 26[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_26[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 26) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>26, "title"=>"Keylex", "created_at"=>Fri, 28 Jul 2017 07:36:36 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:36 UTC +00:00, "local_path"=>"http://kovacek.biz/jovani_nader"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zamit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zamit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zamit"], ["category_id", 26], ["slug", "zamit"], ["created_at", "2017-07-28 07:36:36.177419"], ["updated_at", "2017-07-28 07:36:36.177419"], ["layout_id", 26]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "facere_nostrum"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zamit"], ["phone", "492.961.9400"], ["address", "3963 Corwin Mountains"], ["url", "http://mraz.com/mackenzie"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://bruen.io/parker_dooley"], ["auth_expiration_time", 900], ["slug", "facere_nostrum"], ["brand_id", 26], ["user_id", 39], ["created_at", "2017-07-28 07:36:36.184213"], ["updated_at", "2017-07-28 07:36:36.184213"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bytecard"], ["created_at", "2017-07-28 07:36:36.192713"], ["updated_at", "2017-07-28 07:36:36.192713"], ["local_path", "http://prosacco.com/clay"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Tres-Zap"], ["title_ru", "Название27"], ["created_at", "2017-07-28 07:36:36.196323"], ["updated_at", "2017-07-28 07:36:36.196323"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 27[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_27[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 27) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>27, "title"=>"Bytecard", "created_at"=>Fri, 28 Jul 2017 07:36:36 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:36 UTC +00:00, "local_path"=>"http://prosacco.com/clay"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "andalax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "andalax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Andalax"], ["category_id", 27], ["slug", "andalax"], ["created_at", "2017-07-28 07:36:36.207337"], ["updated_at", "2017-07-28 07:36:36.207337"], ["layout_id", 27]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "virginia.kling"], ["email", "bethany.wuckert@weimann.biz"], ["password", "DwAkE1W48vTw"], ["created_at", "2017-07-28 07:36:36.212155"], ["updated_at", "2017-07-28 07:36:36.212155"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "est.aut"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Toughjoyfax"], ["phone", "(305) 444-1903"], ["address", "898 Garry Springs"], ["url", "http://ondricka.name/lennie"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kemmer.name/nico"], ["auth_expiration_time", 900], ["slug", "est.aut"], ["brand_id", 27], ["user_id", 40], ["created_at", "2017-07-28 07:36:36.218038"], ["updated_at", "2017-07-28 07:36:36.218038"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "reuben_johnston"], ["email", "marco@gleichner.io"], ["password", "5uWcWx9xV2B9Oa"], ["created_at", "2017-07-28 07:36:36.223475"], ["updated_at", "2017-07-28 07:36:36.223475"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5332"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5332"], ["comment", "comment 12"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "118.207.237.116"], ["router_admin_ip", "154.13.52.134"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "943"], ["status", "t"], ["location_id", 27], ["user_id", 41], ["created_at", "2017-07-28 07:36:36.229168"], ["updated_at", "2017-07-28 07:36:36.229168"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5332"], ["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 2], ["serial", "643705CA5E36/5332"], ["comment", "comment 12"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "118.207.237.116"], ["router_admin_ip", "154.13.52.134"], ["admin_password", "5b81c4961951dc16"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "2"], ["status", "t"], ["location_id", 27], ["user_id", 41], ["created_at", "2017-07-28 07:36:36.229168"], ["updated_at", "2017-07-28 07:36:36.229168"], ["id", 2]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: b5daca72-a3a6-4677-9f8f-80a56190bf93) to Async(routers) with arguments: #<GlobalID:0x007f877472d640 @uri=#<URI::GID gid://wifi-management/Router/2>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: e79b283f-2a94-4e36-8494-d99b4ffca1c1) to Async(routers) with arguments: #<GlobalID:0x007f877472d640 @uri=#<URI::GID gid://wifi-management/Router/2>>
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 2], ["provider", "instagram"], ["location_id", 26], ["router_id", 2], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:36 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"maude", "email"=>"maxine@kiehn.co", "password"=>"Z5Q2CcF0Mv7d9", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"maude", :email=>"maxine@kiehn.co", :password=>"Z5Q2CcF0Mv7d9", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"maxine@kiehn.co", "password"=>"Z5Q2CcF0Mv7d9"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "maude"], ["email", "maxine@kiehn.co"], ["password", "Z5Q2CcF0Mv7d9"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 39, username: "maude", email: "maxine@kiehn.co", password: "Z5Q2CcF0Mv7d9", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:36", updated_at: "2017-07-28 07:36:36", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 39[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/stats/authorizations" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:36 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#authorizations[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 39) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>39, "username"=>"maude", "email"=>"maxine@kiehn.co", "password"=>"Z5Q2CcF0Mv7d9", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:36 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:36 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"authorizations"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>39, :username=>"maude", :email=>"maxine@kiehn.co", :password=>"Z5Q2CcF0Mv7d9", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:36.148Z", :updated_at=>"2017-07-28T07:36:36.148Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 39[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[34mSELECT COUNT("social_logs"."id") AS count_id, date_trunc('hour', created_at) AS date_trunc_hour_created_at FROM "social_logs" WHERE "social_logs"."location_id" = 26 AND ("social_logs"."created_at" BETWEEN $1 AND $2) GROUP BY date_trunc('hour', created_at) ORDER BY date_trunc_hour_created_at[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 29ms [30m(Views: 0.2ms | ActiveRecord: 7.4ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(583) 636-5368 x489"], ["created_at", "2017-07-28 07:36:36.545158"], ["updated_at", "2017-07-28 07:36:36.545158"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "johnny"], ["email", "ashlee@auerprosacco.co"], ["password", "TgKy512fFc0rD7"], ["created_at", "2017-07-28 07:36:36.549838"], ["updated_at", "2017-07-28 07:36:36.549838"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "641809"], ["username", "paxton"], ["image", "http://facebook.com/img/paxton.jpg"], ["profile", "https://facebook.com/paxton"], ["email", "caandra_oreilly@turnerbayer.co"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 18], ["user_id", 42], ["created_at", "2017-07-28 07:36:36.553854"], ["updated_at", "2017-07-28 07:36:36.553854"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zontrax"], ["created_at", "2017-07-28 07:36:36.561069"], ["updated_at", "2017-07-28 07:36:36.561069"], ["local_path", "http://rathkreiger.name/carmine"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zontrax"], ["title_ru", "Название28"], ["created_at", "2017-07-28 07:36:36.564831"], ["updated_at", "2017-07-28 07:36:36.564831"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 28[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_28[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 28) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>28, "title"=>"Zontrax", "created_at"=>Fri, 28 Jul 2017 07:36:36 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:36 UTC +00:00, "local_path"=>"http://rathkreiger.name/carmine"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voltsillam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voltsillam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Voltsillam"], ["category_id", 28], ["slug", "voltsillam"], ["created_at", "2017-07-28 07:36:36.576262"], ["updated_at", "2017-07-28 07:36:36.576262"], ["layout_id", 28]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "eos.consequuntur"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Lotlux"], ["phone", "850-750-4410"], ["address", "3155 Carli Ports"], ["url", "http://beatty.com/monserrat.price"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://dickinson.biz/esperanza"], ["auth_expiration_time", 900], ["slug", "eos.consequuntur"], ["brand_id", 28], ["user_id", 42], ["created_at", "2017-07-28 07:36:36.582073"], ["updated_at", "2017-07-28 07:36:36.582073"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Sonsing"], ["created_at", "2017-07-28 07:36:36.590129"], ["updated_at", "2017-07-28 07:36:36.590129"], ["local_path", "http://hansenwisozk.net/kristian.emard"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Sonair"], ["title_ru", "Название29"], ["created_at", "2017-07-28 07:36:36.593764"], ["updated_at", "2017-07-28 07:36:36.593764"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 29[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_29[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 29) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>29, "title"=>"Sonsing", "created_at"=>Fri, 28 Jul 2017 07:36:36 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:36 UTC +00:00, "local_path"=>"http://hansenwisozk.net/kristian.emard"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zaam-dox"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zaam-dox"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zaam-Dox"], ["category_id", 29], ["slug", "zaam-dox"], ["created_at", "2017-07-28 07:36:36.604887"], ["updated_at", "2017-07-28 07:36:36.604887"], ["layout_id", 29]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "carmella"], ["email", "eino.schowalter@rau.info"], ["password", "OlXfWj4j"], ["created_at", "2017-07-28 07:36:36.609565"], ["updated_at", "2017-07-28 07:36:36.609565"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "cumque.officiis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Vagram"], ["phone", "(565) 758-4868"], ["address", "44288 Harris Walks"], ["url", "http://murazik.biz/melyna"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://oreilly.name/leon"], ["auth_expiration_time", 900], ["slug", "cumque.officiis"], ["brand_id", 29], ["user_id", 43], ["created_at", "2017-07-28 07:36:36.615332"], ["updated_at", "2017-07-28 07:36:36.615332"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "oceane_wilkinson"], ["email", "rosalinda@wuckertlarkin.net"], ["password", "OtMlA54rSsQs"], ["created_at", "2017-07-28 07:36:36.620558"], ["updated_at", "2017-07-28 07:36:36.620558"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5333"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5333"], ["comment", "comment 13"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "197.192.232.216"], ["router_admin_ip", "232.218.55.153"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "178"], ["status", "t"], ["location_id", 29], ["user_id", 44], ["created_at", "2017-07-28 07:36:36.626228"], ["updated_at", "2017-07-28 07:36:36.626228"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5333"], ["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 3], ["serial", "643705CA5E36/5333"], ["comment", "comment 13"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "197.192.232.216"], ["router_admin_ip", "232.218.55.153"], ["admin_password", "89302df8b97bef9b"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "3"], ["status", "t"], ["location_id", 29], ["user_id", 44], ["created_at", "2017-07-28 07:36:36.626228"], ["updated_at", "2017-07-28 07:36:36.626228"], ["id", 3]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 436431e4-c433-4d41-928e-5f17b22062bd) to Async(routers) with arguments: #<GlobalID:0x007f877597d0c0 @uri=#<URI::GID gid://wifi-management/Router/3>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: a6cf9e92-4f29-4ea4-a52f-6379ab8fc05b) to Async(routers) with arguments: #<GlobalID:0x007f877597d0c0 @uri=#<URI::GID gid://wifi-management/Router/3>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 3], ["provider", "instagram"], ["location_id", 28], ["router_id", 3], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:36 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"johnny", "email"=>"ashlee@auerprosacco.co", "password"=>"TgKy512fFc0rD7", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"johnny", :email=>"ashlee@auerprosacco.co", :password=>"TgKy512fFc0rD7", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"ashlee@auerprosacco.co", "password"=>"TgKy512fFc0rD7"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "johnny"], ["email", "ashlee@auerprosacco.co"], ["password", "TgKy512fFc0rD7"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 42, username: "johnny", email: "ashlee@auerprosacco.co", password: "TgKy512fFc0rD7", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:36", updated_at: "2017-07-28 07:36:36", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 42[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/social_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:36 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#social_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_42[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 42) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>42, "username"=>"johnny", "email"=>"ashlee@auerprosacco.co", "password"=>"TgKy512fFc0rD7", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:36 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:36 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"social_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_42[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_42[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>42, :username=>"johnny", :email=>"ashlee@auerprosacco.co", :password=>"TgKy512fFc0rD7", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:36.549Z", :updated_at=>"2017-07-28T07:36:36.549Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 42[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" = 28 AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 26ms [30m(Views: 1.4ms | ActiveRecord: 6.6ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "575.681.7216"], ["created_at", "2017-07-28 07:36:36.777057"], ["updated_at", "2017-07-28 07:36:36.777057"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "caesar.waelchi"], ["email", "amira_king@swift.com"], ["password", "DlZbD4Aa40"], ["created_at", "2017-07-28 07:36:36.782610"], ["updated_at", "2017-07-28 07:36:36.782610"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.4ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "669806"], ["username", "miguel.hahn"], ["image", "http://instagram.com/img/miguel.hahn.jpg"], ["profile", "https://instagram.com/miguel.hahn"], ["email", "johnson@kilbackgerhold.co"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 19], ["user_id", 45], ["created_at", "2017-07-28 07:36:36.787569"], ["updated_at", "2017-07-28 07:36:36.787569"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Opela"], ["created_at", "2017-07-28 07:36:36.795708"], ["updated_at", "2017-07-28 07:36:36.795708"], ["local_path", "http://brakus.info/christy"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.9ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Voltsillam"], ["title_ru", "Название30"], ["created_at", "2017-07-28 07:36:36.799759"], ["updated_at", "2017-07-28 07:36:36.799759"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_30[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 30) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>30, "title"=>"Opela", "created_at"=>Fri, 28 Jul 2017 07:36:36 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:36 UTC +00:00, "local_path"=>"http://brakus.info/christy"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "kanlam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "kanlam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Kanlam"], ["category_id", 30], ["slug", "kanlam"], ["created_at", "2017-07-28 07:36:36.814148"], ["updated_at", "2017-07-28 07:36:36.814148"], ["layout_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.5ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "nemo.distinctio"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Prodder"], ["phone", "(239) 782-6383"], ["address", "37627 Watsica Light"], ["url", "http://klein.org/eleanore"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://jenkinsveum.net/joelle.dare"], ["auth_expiration_time", 900], ["slug", "nemo.distinctio"], ["brand_id", 30], ["user_id", 45], ["created_at", "2017-07-28 07:36:36.821176"], ["updated_at", "2017-07-28 07:36:36.821176"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Cookley"], ["created_at", "2017-07-28 07:36:36.829847"], ["updated_at", "2017-07-28 07:36:36.829847"], ["local_path", "http://balistreri.io/orie.orn"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Aerified"], ["title_ru", "Название31"], ["created_at", "2017-07-28 07:36:36.833606"], ["updated_at", "2017-07-28 07:36:36.833606"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 31[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_31[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 31) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>31, "title"=>"Cookley", "created_at"=>Fri, 28 Jul 2017 07:36:36 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:36 UTC +00:00, "local_path"=>"http://balistreri.io/orie.orn"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "kanlam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "kanlam-category0x007f87759101c8"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "kanlam-category0x007f87759101c8"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Kanlam"], ["category_id", 31], ["slug", "kanlam-category0x007f87759101c8"], ["created_at", "2017-07-28 07:36:36.846148"], ["updated_at", "2017-07-28 07:36:36.846148"], ["layout_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "estrella"], ["email", "mylene@barrowsreynolds.io"], ["password", "2xMz4v19OiS"], ["created_at", "2017-07-28 07:36:36.851175"], ["updated_at", "2017-07-28 07:36:36.851175"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "impedit-sint"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Alphazap"], ["phone", "347-624-5101"], ["address", "6964 Ward Glens"], ["url", "http://howellkuvalis.io/daniella.abernathy"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://gleichner.co/jey"], ["auth_expiration_time", 900], ["slug", "impedit-sint"], ["brand_id", 31], ["user_id", 46], ["created_at", "2017-07-28 07:36:36.857704"], ["updated_at", "2017-07-28 07:36:36.857704"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jordan"], ["email", "elmore@oconner.biz"], ["password", "E5ImU0R881BqX9"], ["created_at", "2017-07-28 07:36:36.862995"], ["updated_at", "2017-07-28 07:36:36.862995"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5334"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5334"], ["comment", "comment 14"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "169.50.223.245"], ["router_admin_ip", "179.237.93.87"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "902"], ["status", "t"], ["location_id", 31], ["user_id", 47], ["created_at", "2017-07-28 07:36:36.868882"], ["updated_at", "2017-07-28 07:36:36.868882"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5334"], ["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.5ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 4], ["serial", "643705CA5E36/5334"], ["comment", "comment 14"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "169.50.223.245"], ["router_admin_ip", "179.237.93.87"], ["admin_password", "dc5abe685a5d00ec"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "4"], ["status", "t"], ["location_id", 31], ["user_id", 47], ["created_at", "2017-07-28 07:36:36.868882"], ["updated_at", "2017-07-28 07:36:36.868882"], ["id", 4]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 199624f7-5f00-42da-9a83-6469df75af14) to Async(routers) with arguments: #<GlobalID:0x007f877274f648 @uri=#<URI::GID gid://wifi-management/Router/4>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: e7904fbe-40eb-4569-9fbb-65fdd2b9d38f) to Async(routers) with arguments: #<GlobalID:0x007f877274f648 @uri=#<URI::GID gid://wifi-management/Router/4>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 4], ["provider", "instagram"], ["location_id", 30], ["router_id", 4], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "357.022.3054"], ["created_at", "2017-07-28 07:36:37.229831"], ["updated_at", "2017-07-28 07:36:37.229831"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "helene.paucek"], ["email", "marjory.hane@lakin.biz"], ["password", "TjScBrV3Hc"], ["created_at", "2017-07-28 07:36:37.234713"], ["updated_at", "2017-07-28 07:36:37.234713"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "97717"], ["username", "maxwell.fay"], ["image", "http://facebook.com/img/maxwell.fay.jpg"], ["profile", "https://facebook.com/maxwell.fay"], ["email", "zoe@wehner.com"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 20], ["user_id", 48], ["created_at", "2017-07-28 07:36:37.239113"], ["updated_at", "2017-07-28 07:36:37.239113"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Otcom"], ["created_at", "2017-07-28 07:36:37.246476"], ["updated_at", "2017-07-28 07:36:37.246476"], ["local_path", "http://raynorschiller.com/alec"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Stim"], ["title_ru", "Название32"], ["created_at", "2017-07-28 07:36:37.250271"], ["updated_at", "2017-07-28 07:36:37.250271"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 32[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_32[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 32) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>32, "title"=>"Otcom", "created_at"=>Fri, 28 Jul 2017 07:36:37 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:37 UTC +00:00, "local_path"=>"http://raynorschiller.com/alec"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "aerified"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "aerified"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Aerified"], ["category_id", 32], ["slug", "aerified"], ["created_at", "2017-07-28 07:36:37.262161"], ["updated_at", "2017-07-28 07:36:37.262161"], ["layout_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "aut.dolor"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tres-Zap"], ["phone", "668-050-4045"], ["address", "606 Chase Plains"], ["url", "http://donnelly.name/winona"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://okon.co/carole_muller"], ["auth_expiration_time", 900], ["slug", "aut.dolor"], ["brand_id", 32], ["user_id", 48], ["created_at", "2017-07-28 07:36:37.268560"], ["updated_at", "2017-07-28 07:36:37.268560"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Opela"], ["created_at", "2017-07-28 07:36:37.277134"], ["updated_at", "2017-07-28 07:36:37.277134"], ["local_path", "http://nikolaushamill.io/zelma"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Lotlux"], ["title_ru", "Название33"], ["created_at", "2017-07-28 07:36:37.280918"], ["updated_at", "2017-07-28 07:36:37.280918"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 33[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_33[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 33) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>33, "title"=>"Opela", "created_at"=>Fri, 28 Jul 2017 07:36:37 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:37 UTC +00:00, "local_path"=>"http://nikolaushamill.io/zelma"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zoolab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zoolab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zoolab"], ["category_id", 33], ["slug", "zoolab"], ["created_at", "2017-07-28 07:36:37.292355"], ["updated_at", "2017-07-28 07:36:37.292355"], ["layout_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "tanner"], ["email", "reva@donnelly.name"], ["password", "8zY7AdK68"], ["created_at", "2017-07-28 07:36:37.297291"], ["updated_at", "2017-07-28 07:36:37.297291"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptate.aspernatur"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Viva"], ["phone", "(387) 772-4631"], ["address", "1089 Waelchi Groves"], ["url", "http://balistreri.com/hershel_hahn"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://beahan.org/santino"], ["auth_expiration_time", 900], ["slug", "voluptate.aspernatur"], ["brand_id", 33], ["user_id", 49], ["created_at", "2017-07-28 07:36:37.303747"], ["updated_at", "2017-07-28 07:36:37.303747"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "monte"], ["email", "howard.anderson@mraz.net"], ["password", "YzIoDxPeMk"], ["created_at", "2017-07-28 07:36:37.309527"], ["updated_at", "2017-07-28 07:36:37.309527"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5335"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5335"], ["comment", "comment 15"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "90.254.19.106"], ["router_admin_ip", "80.10.53.76"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "210"], ["status", "t"], ["location_id", 33], ["user_id", 50], ["created_at", "2017-07-28 07:36:37.315487"], ["updated_at", "2017-07-28 07:36:37.315487"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5335"], ["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 5], ["serial", "643705CA5E36/5335"], ["comment", "comment 15"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "90.254.19.106"], ["router_admin_ip", "80.10.53.76"], ["admin_password", "52a7e649f61ce397"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "5"], ["status", "t"], ["location_id", 33], ["user_id", 50], ["created_at", "2017-07-28 07:36:37.315487"], ["updated_at", "2017-07-28 07:36:37.315487"], ["id", 5]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 7c2ef9c1-6d4f-4955-b7a2-f5d125084c1c) to Async(routers) with arguments: #<GlobalID:0x007f8772241520 @uri=#<URI::GID gid://wifi-management/Router/5>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 23378abb-3e67-42b0-bca2-7eacb471752d) to Async(routers) with arguments: #<GlobalID:0x007f8772241520 @uri=#<URI::GID gid://wifi-management/Router/5>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 5], ["provider", "instagram"], ["location_id", 32], ["router_id", 5], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:37 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"helene.paucek", "email"=>"marjory.hane@lakin.biz", "password"=>"TjScBrV3Hc", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"helene.paucek", :email=>"marjory.hane@lakin.biz", :password=>"TjScBrV3Hc", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"marjory.hane@lakin.biz", "password"=>"TjScBrV3Hc"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "helene.paucek"], ["email", "marjory.hane@lakin.biz"], ["password", "TjScBrV3Hc"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 48, username: "helene.paucek", email: "marjory.hane@lakin.biz", password: "TjScBrV3Hc", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:37", updated_at: "2017-07-28 07:36:37", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 48[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/locations_list" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:37 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#locations_list[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_48[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 48) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>48, "username"=>"helene.paucek", "email"=>"marjory.hane@lakin.biz", "password"=>"TjScBrV3Hc", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:37 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:37 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"locations_list"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_48[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_48[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>48, :username=>"helene.paucek", :email=>"marjory.hane@lakin.biz", :password=>"TjScBrV3Hc", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:37.234Z", :updated_at=>"2017-07-28T07:36:37.234Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 48[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Load (0.8ms)[0m  [1m[34mSELECT "locations".* FROM "locations" WHERE "locations"."user_id" = 48[0m
[INFO ] Completed [32m200 OK[0m in 24ms [30m(Views: 0.3ms | ActiveRecord: 5.2ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(815) 916-1928 x8950"], ["created_at", "2017-07-28 07:36:37.615960"], ["updated_at", "2017-07-28 07:36:37.615960"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "kip"], ["email", "kaylie@streichsawayn.co"], ["password", "4pTxYmGkT4Oo0tZ"], ["created_at", "2017-07-28 07:36:37.620696"], ["updated_at", "2017-07-28 07:36:37.620696"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "485341"], ["username", "dorothy"], ["image", "http://instagram.com/img/dorothy.jpg"], ["profile", "https://instagram.com/dorothy"], ["email", "jaquelin.wolff@reichel.com"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 21], ["user_id", 51], ["created_at", "2017-07-28 07:36:37.625108"], ["updated_at", "2017-07-28 07:36:37.625108"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Konklab"], ["created_at", "2017-07-28 07:36:37.632341"], ["updated_at", "2017-07-28 07:36:37.632341"], ["local_path", "http://jakubowski.info/anne"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Duobam"], ["title_ru", "Название34"], ["created_at", "2017-07-28 07:36:37.636114"], ["updated_at", "2017-07-28 07:36:37.636114"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 34[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_34[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 34) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>34, "title"=>"Konklab", "created_at"=>Fri, 28 Jul 2017 07:36:37 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:37 UTC +00:00, "local_path"=>"http://jakubowski.info/anne"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "aerified"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "aerified"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Aerified"], ["category_id", 34], ["slug", "aerified"], ["created_at", "2017-07-28 07:36:37.648163"], ["updated_at", "2017-07-28 07:36:37.648163"], ["layout_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "consequatur-non"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Pannier"], ["phone", "(438) 307-5462"], ["address", "451 Marvin Loop"], ["url", "http://bergnaum.org/lisette"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://lowe.name/rigoberto"], ["auth_expiration_time", 900], ["slug", "consequatur-non"], ["brand_id", 34], ["user_id", 51], ["created_at", "2017-07-28 07:36:37.654210"], ["updated_at", "2017-07-28 07:36:37.654210"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Y-find"], ["created_at", "2017-07-28 07:36:37.662598"], ["updated_at", "2017-07-28 07:36:37.662598"], ["local_path", "http://stokes.co/eriberto_kuhn"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Transcof"], ["title_ru", "Название35"], ["created_at", "2017-07-28 07:36:37.666413"], ["updated_at", "2017-07-28 07:36:37.666413"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 35[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_35[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 35) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>35, "title"=>"Y-find", "created_at"=>Fri, 28 Jul 2017 07:36:37 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:37 UTC +00:00, "local_path"=>"http://stokes.co/eriberto_kuhn"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "solarbreeze"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "solarbreeze"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Solarbreeze"], ["category_id", 35], ["slug", "solarbreeze"], ["created_at", "2017-07-28 07:36:37.677878"], ["updated_at", "2017-07-28 07:36:37.677878"], ["layout_id", 35]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "claudine_fadel"], ["email", "eulah_reichel@lakin.io"], ["password", "KfX92aMeCw6t"], ["created_at", "2017-07-28 07:36:37.682843"], ["updated_at", "2017-07-28 07:36:37.682843"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "inventore_aspernatur"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "It"], ["phone", "1-408-376-0265"], ["address", "9876 Daisy Islands"], ["url", "http://jaskolski.info/zachary"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://sanfordkshlerin.io/terrence.hermiston"], ["auth_expiration_time", 900], ["slug", "inventore_aspernatur"], ["brand_id", 35], ["user_id", 52], ["created_at", "2017-07-28 07:36:37.689333"], ["updated_at", "2017-07-28 07:36:37.689333"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "halle"], ["email", "cyrus@lindgren.info"], ["password", "4m5n1pZjAaHz"], ["created_at", "2017-07-28 07:36:37.694478"], ["updated_at", "2017-07-28 07:36:37.694478"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5336"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5336"], ["comment", "comment 16"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "49.18.135.34"], ["router_admin_ip", "103.51.109.252"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "983"], ["status", "t"], ["location_id", 35], ["user_id", 53], ["created_at", "2017-07-28 07:36:37.700114"], ["updated_at", "2017-07-28 07:36:37.700114"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5336"], ["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 6], ["serial", "643705CA5E36/5336"], ["comment", "comment 16"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "49.18.135.34"], ["router_admin_ip", "103.51.109.252"], ["admin_password", "99bd62300be63298"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "6"], ["status", "t"], ["location_id", 35], ["user_id", 53], ["created_at", "2017-07-28 07:36:37.700114"], ["updated_at", "2017-07-28 07:36:37.700114"], ["id", 6]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 6d184758-9601-43ff-94e1-424c08432911) to Async(routers) with arguments: #<GlobalID:0x007f876ccd3e30 @uri=#<URI::GID gid://wifi-management/Router/6>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: bdc64537-0dd8-49ce-9ec0-0f05d5046968) to Async(routers) with arguments: #<GlobalID:0x007f876ccd3e30 @uri=#<URI::GID gid://wifi-management/Router/6>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.3ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 6], ["provider", "instagram"], ["location_id", 34], ["router_id", 6], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:37 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"kip", "email"=>"kaylie@streichsawayn.co", "password"=>"4pTxYmGkT4Oo0tZ", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"kip", :email=>"kaylie@streichsawayn.co", :password=>"4pTxYmGkT4Oo0tZ", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"kaylie@streichsawayn.co", "password"=>"4pTxYmGkT4Oo0tZ"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "kip"], ["email", "kaylie@streichsawayn.co"], ["password", "4pTxYmGkT4Oo0tZ"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 51, username: "kip", email: "kaylie@streichsawayn.co", password: "4pTxYmGkT4Oo0tZ", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:37", updated_at: "2017-07-28 07:36:37", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 51[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/all_connects" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:37 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#all_connects[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_51[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 51) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>51, "username"=>"kip", "email"=>"kaylie@streichsawayn.co", "password"=>"4pTxYmGkT4Oo0tZ", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:37 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:37 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"all_connects"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_51[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_51[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>51, :username=>"kip", :email=>"kaylie@streichsawayn.co", :password=>"4pTxYmGkT4Oo0tZ", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:37.620Z", :updated_at=>"2017-07-28T07:36:37.620Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 51[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 34[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 34 AND ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-06-28 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 34 AND ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 26ms [30m(Views: 0.2ms | ActiveRecord: 7.6ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(798) 046-1985"], ["created_at", "2017-07-28 07:36:37.948758"], ["updated_at", "2017-07-28 07:36:37.948758"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "keaton"], ["email", "deie.hilll@hilperthowe.com"], ["password", "34Il14Yf8kWy0s6"], ["created_at", "2017-07-28 07:36:37.953873"], ["updated_at", "2017-07-28 07:36:37.953873"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "8574"], ["username", "amir"], ["image", "http://facebook.com/img/amir.jpg"], ["profile", "https://facebook.com/amir"], ["email", "meta_weinat@mosciskiturcotte.com"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 22], ["user_id", 54], ["created_at", "2017-07-28 07:36:37.958560"], ["updated_at", "2017-07-28 07:36:37.958560"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Transcof"], ["created_at", "2017-07-28 07:36:37.966173"], ["updated_at", "2017-07-28 07:36:37.966173"], ["local_path", "http://anderson.io/ruben"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Stronghold"], ["title_ru", "Название36"], ["created_at", "2017-07-28 07:36:37.970214"], ["updated_at", "2017-07-28 07:36:37.970214"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_36[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 36) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>36, "title"=>"Transcof", "created_at"=>Fri, 28 Jul 2017 07:36:37 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:37 UTC +00:00, "local_path"=>"http://anderson.io/ruben"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "otcom"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "otcom"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Otcom"], ["category_id", 36], ["slug", "otcom"], ["created_at", "2017-07-28 07:36:37.982115"], ["updated_at", "2017-07-28 07:36:37.982115"], ["layout_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quos-aut"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bamity"], ["phone", "1-798-892-7320"], ["address", "1224 Florian Mountain"], ["url", "http://haley.com/dale"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kozey.info/harmon"], ["auth_expiration_time", 900], ["slug", "quos-aut"], ["brand_id", 36], ["user_id", 54], ["created_at", "2017-07-28 07:36:37.988257"], ["updated_at", "2017-07-28 07:36:37.988257"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Veribet"], ["created_at", "2017-07-28 07:36:37.996686"], ["updated_at", "2017-07-28 07:36:37.996686"], ["local_path", "http://corwin.co/ernestina_brakus"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Toughjoyfax"], ["title_ru", "Название37"], ["created_at", "2017-07-28 07:36:38.000493"], ["updated_at", "2017-07-28 07:36:38.000493"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 37[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_37[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 37) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>37, "title"=>"Veribet", "created_at"=>Fri, 28 Jul 2017 07:36:37 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:37 UTC +00:00, "local_path"=>"http://corwin.co/ernestina_brakus"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zamit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zamit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zamit"], ["category_id", 37], ["slug", "zamit"], ["created_at", "2017-07-28 07:36:38.012051"], ["updated_at", "2017-07-28 07:36:38.012051"], ["layout_id", 37]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "eileen"], ["email", "meredith@harveyfeil.org"], ["password", "GiFfZa4m"], ["created_at", "2017-07-28 07:36:38.017298"], ["updated_at", "2017-07-28 07:36:38.017298"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "accusamus.voluptates"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Otcom"], ["phone", "(665) 033-8200"], ["address", "494 Beatty Skyway"], ["url", "http://emmerichbraun.io/xavier"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://conroy.com/emilio_spencer"], ["auth_expiration_time", 900], ["slug", "accusamus.voluptates"], ["brand_id", 37], ["user_id", 55], ["created_at", "2017-07-28 07:36:38.023541"], ["updated_at", "2017-07-28 07:36:38.023541"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jordan"], ["email", "wilber.rempel@murphymosciski.com"], ["password", "Wb2iTyI361"], ["created_at", "2017-07-28 07:36:38.029133"], ["updated_at", "2017-07-28 07:36:38.029133"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5337"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5337"], ["comment", "comment 17"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "254.154.189.91"], ["router_admin_ip", "208.69.208.155"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "328"], ["status", "t"], ["location_id", 37], ["user_id", 56], ["created_at", "2017-07-28 07:36:38.035186"], ["updated_at", "2017-07-28 07:36:38.035186"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5337"], ["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 7], ["serial", "643705CA5E36/5337"], ["comment", "comment 17"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "254.154.189.91"], ["router_admin_ip", "208.69.208.155"], ["admin_password", "39dd5f580f4b5595"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "7"], ["status", "t"], ["location_id", 37], ["user_id", 56], ["created_at", "2017-07-28 07:36:38.035186"], ["updated_at", "2017-07-28 07:36:38.035186"], ["id", 7]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 87b62935-6fb2-4774-8018-e53868544e47) to Async(routers) with arguments: #<GlobalID:0x007f876a1f54e8 @uri=#<URI::GID gid://wifi-management/Router/7>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: ec834228-5089-437e-af59-475dcdb62bae) to Async(routers) with arguments: #<GlobalID:0x007f876a1f54e8 @uri=#<URI::GID gid://wifi-management/Router/7>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 7], ["provider", "instagram"], ["location_id", 36], ["router_id", 7], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:38 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"keaton", "email"=>"deie.hilll@hilperthowe.com", "password"=>"34Il14Yf8kWy0s6", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"keaton", :email=>"deie.hilll@hilperthowe.com", :password=>"34Il14Yf8kWy0s6", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"deie.hilll@hilperthowe.com", "password"=>"34Il14Yf8kWy0s6"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "keaton"], ["email", "deie.hilll@hilperthowe.com"], ["password", "34Il14Yf8kWy0s6"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 54, username: "keaton", email: "deie.hilll@hilperthowe.com", password: "34Il14Yf8kWy0s6", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:37", updated_at: "2017-07-28 07:36:37", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 54[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.1ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/new_old_users_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:38 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#new_old_users_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_54[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 54) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>54, "username"=>"keaton", "email"=>"deie.hilll@hilperthowe.com", "password"=>"34Il14Yf8kWy0s6", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:37 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:37 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"new_old_users_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_54[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_54[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>54, :username=>"keaton", :email=>"deie.hilll@hilperthowe.com", :password=>"34Il14Yf8kWy0s6", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:37.953Z", :updated_at=>"2017-07-28T07:36:37.953Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 54[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.5ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" = 36 AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 38ms [30m(Views: 1.4ms | ActiveRecord: 12.2ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(910) 390-7953 x6328"], ["created_at", "2017-07-28 07:36:38.301006"], ["updated_at", "2017-07-28 07:36:38.301006"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "easton.heidenreich"], ["email", "herta@pfannerstill.org"], ["password", "BrE7CpVwO4S62fIe"], ["created_at", "2017-07-28 07:36:38.305769"], ["updated_at", "2017-07-28 07:36:38.305769"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "305697"], ["username", "morgan"], ["image", "http://twitter.com/img/morgan.jpg"], ["profile", "https://twitter.com/morgan"], ["email", "alec_kutch@feest.biz"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 23], ["user_id", 57], ["created_at", "2017-07-28 07:36:38.310235"], ["updated_at", "2017-07-28 07:36:38.310235"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Flowdesk"], ["created_at", "2017-07-28 07:36:38.317265"], ["updated_at", "2017-07-28 07:36:38.317265"], ["local_path", "http://kuvalis.io/jada"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bamity"], ["title_ru", "Название38"], ["created_at", "2017-07-28 07:36:38.320895"], ["updated_at", "2017-07-28 07:36:38.320895"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 38[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_38[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 38) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>38, "title"=>"Flowdesk", "created_at"=>Fri, 28 Jul 2017 07:36:38 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:38 UTC +00:00, "local_path"=>"http://kuvalis.io/jada"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "subin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "subin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Subin"], ["category_id", 38], ["slug", "subin"], ["created_at", "2017-07-28 07:36:38.332350"], ["updated_at", "2017-07-28 07:36:38.332350"], ["layout_id", 38]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptatum-tempora"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stronghold"], ["phone", "(153) 964-7104"], ["address", "830 Elva Port"], ["url", "http://bruen.biz/shanny_christiansen"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://johnston.io/marilyne"], ["auth_expiration_time", 900], ["slug", "voluptatum-tempora"], ["brand_id", 38], ["user_id", 57], ["created_at", "2017-07-28 07:36:38.338320"], ["updated_at", "2017-07-28 07:36:38.338320"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Redhold"], ["created_at", "2017-07-28 07:36:38.346272"], ["updated_at", "2017-07-28 07:36:38.346272"], ["local_path", "http://gleichner.name/justina"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zoolab"], ["title_ru", "Название39"], ["created_at", "2017-07-28 07:36:38.349786"], ["updated_at", "2017-07-28 07:36:38.349786"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_39[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 39) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>39, "title"=>"Redhold", "created_at"=>Fri, 28 Jul 2017 07:36:38 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:38 UTC +00:00, "local_path"=>"http://gleichner.name/justina"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Konklab"], ["category_id", 39], ["slug", "konklab"], ["created_at", "2017-07-28 07:36:38.360818"], ["updated_at", "2017-07-28 07:36:38.360818"], ["layout_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "myrtice"], ["email", "rick.swift@bogan.name"], ["password", "77HnEcEnR6Ks2k8"], ["created_at", "2017-07-28 07:36:38.365543"], ["updated_at", "2017-07-28 07:36:38.365543"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "maxime.ipsum"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Transcof"], ["phone", "1-146-257-8102"], ["address", "2442 Naomi Port"], ["url", "http://wolf.co/imani"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://yundtgreenholt.biz/solon.bogan"], ["auth_expiration_time", 900], ["slug", "maxime.ipsum"], ["brand_id", 39], ["user_id", 58], ["created_at", "2017-07-28 07:36:38.371455"], ["updated_at", "2017-07-28 07:36:38.371455"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "fidel"], ["email", "beryl@mayer.co"], ["password", "Pw5c3tWp"], ["created_at", "2017-07-28 07:36:38.376593"], ["updated_at", "2017-07-28 07:36:38.376593"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5338"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5338"], ["comment", "comment 18"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "115.167.63.113"], ["router_admin_ip", "163.74.84.37"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "737"], ["status", "t"], ["location_id", 39], ["user_id", 59], ["created_at", "2017-07-28 07:36:38.382171"], ["updated_at", "2017-07-28 07:36:38.382171"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5338"], ["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 8], ["serial", "643705CA5E36/5338"], ["comment", "comment 18"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "115.167.63.113"], ["router_admin_ip", "163.74.84.37"], ["admin_password", "4fe62df075c2992b"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "8"], ["status", "t"], ["location_id", 39], ["user_id", 59], ["created_at", "2017-07-28 07:36:38.382171"], ["updated_at", "2017-07-28 07:36:38.382171"], ["id", 8]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 857dd012-0328-45e5-82b0-20464d90171b) to Async(routers) with arguments: #<GlobalID:0x007f8775b83c98 @uri=#<URI::GID gid://wifi-management/Router/8>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 94311062-9b39-47ad-adc2-c0a9064a1976) to Async(routers) with arguments: #<GlobalID:0x007f8775b83c98 @uri=#<URI::GID gid://wifi-management/Router/8>>
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 8], ["provider", "instagram"], ["location_id", 38], ["router_id", 8], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:38 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"easton.heidenreich", "email"=>"herta@pfannerstill.org", "password"=>"BrE7CpVwO4S62fIe", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"easton.heidenreich", :email=>"herta@pfannerstill.org", :password=>"BrE7CpVwO4S62fIe", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"herta@pfannerstill.org", "password"=>"BrE7CpVwO4S62fIe"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "easton.heidenreich"], ["email", "herta@pfannerstill.org"], ["password", "BrE7CpVwO4S62fIe"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 57, username: "easton.heidenreich", email: "herta@pfannerstill.org", password: "BrE7CpVwO4S62fIe", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:38", updated_at: "2017-07-28 07:36:38", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 57[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/visitors_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:38 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#visitors_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_57[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 57) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>57, "username"=>"easton.heidenreich", "email"=>"herta@pfannerstill.org", "password"=>"BrE7CpVwO4S62fIe", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:38 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:38 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"visitors_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_57[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_57[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>57, :username=>"easton.heidenreich", :email=>"herta@pfannerstill.org", :password=>"BrE7CpVwO4S62fIe", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:38.305Z", :updated_at=>"2017-07-28T07:36:38.305Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 57[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.5ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" = 38 AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 24ms [30m(Views: 1.1ms | ActiveRecord: 6.1ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "563-428-6909 x307"], ["created_at", "2017-07-28 07:36:38.598814"], ["updated_at", "2017-07-28 07:36:38.598814"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "halle.treutel"], ["email", "ulises_lindgren@lubowitznicolas.info"], ["password", "CiE3Eh5rQ"], ["created_at", "2017-07-28 07:36:38.603415"], ["updated_at", "2017-07-28 07:36:38.603415"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "51843"], ["username", "kellen_zemlak"], ["image", "http://instagram.com/img/kellen_zemlak.jpg"], ["profile", "https://instagram.com/kellen_zemlak"], ["email", "myrna_deckow@bogan.biz"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 24], ["user_id", 60], ["created_at", "2017-07-28 07:36:38.607542"], ["updated_at", "2017-07-28 07:36:38.607542"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Flowdesk"], ["created_at", "2017-07-28 07:36:38.614607"], ["updated_at", "2017-07-28 07:36:38.614607"], ["local_path", "http://cummeratasenger.com/kenny"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Greenlam"], ["title_ru", "Название40"], ["created_at", "2017-07-28 07:36:38.618182"], ["updated_at", "2017-07-28 07:36:38.618182"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 40[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_40[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 40) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>40, "title"=>"Flowdesk", "created_at"=>Fri, 28 Jul 2017 07:36:38 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:38 UTC +00:00, "local_path"=>"http://cummeratasenger.com/kenny"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stronghold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stronghold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Stronghold"], ["category_id", 40], ["slug", "stronghold"], ["created_at", "2017-07-28 07:36:38.629780"], ["updated_at", "2017-07-28 07:36:38.629780"], ["layout_id", 40]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "numquam.voluptas"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Cookley"], ["phone", "450.667.0293"], ["address", "391 Torp Brook"], ["url", "http://quigley.name/linda_leuschke"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://walker.org/bella.stiedemann"], ["auth_expiration_time", 900], ["slug", "numquam.voluptas"], ["brand_id", 40], ["user_id", 60], ["created_at", "2017-07-28 07:36:38.635463"], ["updated_at", "2017-07-28 07:36:38.635463"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Quo Lux"], ["created_at", "2017-07-28 07:36:38.643812"], ["updated_at", "2017-07-28 07:36:38.643812"], ["local_path", "http://abbott.info/vance.vandervort"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Transcof"], ["title_ru", "Название41"], ["created_at", "2017-07-28 07:36:38.647612"], ["updated_at", "2017-07-28 07:36:38.647612"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 41[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_41[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 41) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>41, "title"=>"Quo Lux", "created_at"=>Fri, 28 Jul 2017 07:36:38 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:38 UTC +00:00, "local_path"=>"http://abbott.info/vance.vandervort"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "fintone"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "fintone"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Fintone"], ["category_id", 41], ["slug", "fintone"], ["created_at", "2017-07-28 07:36:38.658822"], ["updated_at", "2017-07-28 07:36:38.658822"], ["layout_id", 41]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "aniya"], ["email", "frida_treutel@jaskolskikoelpin.biz"], ["password", "ItX9P0BoLxD4MnH"], ["created_at", "2017-07-28 07:36:38.663589"], ["updated_at", "2017-07-28 07:36:38.663589"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "consequatur.debitis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Gembucket"], ["phone", "331-253-9184"], ["address", "472 Sammy Summit"], ["url", "http://senger.net/beau.tillman"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://mosciskicorkery.name/zane"], ["auth_expiration_time", 900], ["slug", "consequatur.debitis"], ["brand_id", 41], ["user_id", 61], ["created_at", "2017-07-28 07:36:38.669734"], ["updated_at", "2017-07-28 07:36:38.669734"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "roman_breitenberg"], ["email", "tamia@hane.name"], ["password", "NxXh8oUkVaU6O"], ["created_at", "2017-07-28 07:36:38.674973"], ["updated_at", "2017-07-28 07:36:38.674973"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5339"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5339"], ["comment", "comment 19"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "70.15.74.13"], ["router_admin_ip", "58.245.73.47"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "16"], ["status", "t"], ["location_id", 41], ["user_id", 62], ["created_at", "2017-07-28 07:36:38.681033"], ["updated_at", "2017-07-28 07:36:38.681033"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5339"], ["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 9], ["serial", "643705CA5E36/5339"], ["comment", "comment 19"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "70.15.74.13"], ["router_admin_ip", "58.245.73.47"], ["admin_password", "6ebcb77462223afb"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "9"], ["status", "t"], ["location_id", 41], ["user_id", 62], ["created_at", "2017-07-28 07:36:38.681033"], ["updated_at", "2017-07-28 07:36:38.681033"], ["id", 9]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 5ee3283d-728c-4f00-8e45-abb8a45975b5) to Async(routers) with arguments: #<GlobalID:0x007f87765db9e8 @uri=#<URI::GID gid://wifi-management/Router/9>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 94d53a2d-69ef-491c-9bcf-4621d5ff9fc3) to Async(routers) with arguments: #<GlobalID:0x007f87765db9e8 @uri=#<URI::GID gid://wifi-management/Router/9>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 9], ["provider", "instagram"], ["location_id", 40], ["router_id", 9], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "243.682.8631 x43242"], ["created_at", "2017-07-28 07:36:38.837098"], ["updated_at", "2017-07-28 07:36:38.837098"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "clemens"], ["email", "jarred_feil@grimes.name"], ["password", "VcXzKgOpXwWtAy"], ["created_at", "2017-07-28 07:36:38.841569"], ["updated_at", "2017-07-28 07:36:38.841569"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "732082"], ["username", "dorcas_armstrong"], ["image", "http://twitter.com/img/dorcas_armstrong.jpg"], ["profile", "https://twitter.com/dorcas_armstrong"], ["email", "electa@vandervortmann.name"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 25], ["user_id", 63], ["created_at", "2017-07-28 07:36:38.845800"], ["updated_at", "2017-07-28 07:36:38.845800"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Stim"], ["created_at", "2017-07-28 07:36:38.852997"], ["updated_at", "2017-07-28 07:36:38.852997"], ["local_path", "http://oreilly.biz/kenya"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Tres-Zap"], ["title_ru", "Название42"], ["created_at", "2017-07-28 07:36:38.856836"], ["updated_at", "2017-07-28 07:36:38.856836"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_42[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 42) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>42, "title"=>"Stim", "created_at"=>Fri, 28 Jul 2017 07:36:38 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:38 UTC +00:00, "local_path"=>"http://oreilly.biz/kenya"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cardify"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cardify"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Cardify"], ["category_id", 42], ["slug", "cardify"], ["created_at", "2017-07-28 07:36:38.868384"], ["updated_at", "2017-07-28 07:36:38.868384"], ["layout_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "omnis-autem"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Alpha"], ["phone", "571-860-0788"], ["address", "1561 Upton Falls"], ["url", "http://kuvalis.name/crawford"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://vandervort.org/ottilie_leannon"], ["auth_expiration_time", 900], ["slug", "omnis-autem"], ["brand_id", 42], ["user_id", 63], ["created_at", "2017-07-28 07:36:38.874760"], ["updated_at", "2017-07-28 07:36:38.874760"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bamity"], ["created_at", "2017-07-28 07:36:38.883250"], ["updated_at", "2017-07-28 07:36:38.883250"], ["local_path", "http://hane.io/raphael.roob"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Cardguard"], ["title_ru", "Название43"], ["created_at", "2017-07-28 07:36:38.887116"], ["updated_at", "2017-07-28 07:36:38.887116"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 43[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_43[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 43) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>43, "title"=>"Bamity", "created_at"=>Fri, 28 Jul 2017 07:36:38 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:38 UTC +00:00, "local_path"=>"http://hane.io/raphael.roob"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zaam-dox"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zaam-dox"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zaam-Dox"], ["category_id", 43], ["slug", "zaam-dox"], ["created_at", "2017-07-28 07:36:38.898463"], ["updated_at", "2017-07-28 07:36:38.898463"], ["layout_id", 43]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "syble_brakus"], ["email", "jaqueline.gusikowski@kuvalis.net"], ["password", "5y8lPg9aPhO3H8"], ["created_at", "2017-07-28 07:36:38.903409"], ["updated_at", "2017-07-28 07:36:38.903409"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptate-eaque"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Cardify"], ["phone", "(944) 562-9344"], ["address", "483 Nikko Ville"], ["url", "http://zulauf.org/kale_muller"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://olsonkozey.info/francisco"], ["auth_expiration_time", 900], ["slug", "voluptate-eaque"], ["brand_id", 43], ["user_id", 64], ["created_at", "2017-07-28 07:36:38.909602"], ["updated_at", "2017-07-28 07:36:38.909602"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "susana"], ["email", "ramon.gleason@oconner.co"], ["password", "GyHrDoE80a8"], ["created_at", "2017-07-28 07:36:38.915016"], ["updated_at", "2017-07-28 07:36:38.915016"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53310"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53310"], ["comment", "comment 110"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "208.121.15.167"], ["router_admin_ip", "104.214.236.55"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "28"], ["status", "t"], ["location_id", 43], ["user_id", 65], ["created_at", "2017-07-28 07:36:38.920639"], ["updated_at", "2017-07-28 07:36:38.920639"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53310"], ["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 10], ["serial", "643705CA5E36/53310"], ["comment", "comment 110"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "208.121.15.167"], ["router_admin_ip", "104.214.236.55"], ["admin_password", "9812d721f3f0b1cc"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "10"], ["status", "t"], ["location_id", 43], ["user_id", 65], ["created_at", "2017-07-28 07:36:38.920639"], ["updated_at", "2017-07-28 07:36:38.920639"], ["id", 10]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 7cf2b662-e085-4f73-9032-495c107fd5c8) to Async(routers) with arguments: #<GlobalID:0x007f8777ac79b0 @uri=#<URI::GID gid://wifi-management/Router/10>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 50599c85-7230-4b9b-94b3-7b13499502a8) to Async(routers) with arguments: #<GlobalID:0x007f8777ac79b0 @uri=#<URI::GID gid://wifi-management/Router/10>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 10], ["provider", "instagram"], ["location_id", 42], ["router_id", 10], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:39 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"clemens", "email"=>"jarred_feil@grimes.name", "password"=>"VcXzKgOpXwWtAy", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"clemens", :email=>"jarred_feil@grimes.name", :password=>"VcXzKgOpXwWtAy", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"jarred_feil@grimes.name", "password"=>"VcXzKgOpXwWtAy"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "clemens"], ["email", "jarred_feil@grimes.name"], ["password", "VcXzKgOpXwWtAy"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 63, username: "clemens", email: "jarred_feil@grimes.name", password: "VcXzKgOpXwWtAy", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:38", updated_at: "2017-07-28 07:36:38", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 63[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/age_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:39 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#age_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 63[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_63[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 63) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>63, "username"=>"clemens", "email"=>"jarred_feil@grimes.name", "password"=>"VcXzKgOpXwWtAy", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:38 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:38 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"age_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 63[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_63[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 63[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_63[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>63, :username=>"clemens", :email=>"jarred_feil@grimes.name", :password=>"VcXzKgOpXwWtAy", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:38.841Z", :updated_at=>"2017-07-28T07:36:38.841Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 63[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.9ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(42) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 23ms [30m(Views: 1.4ms | ActiveRecord: 5.9ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "702.331.1577 x387"], ["created_at", "2017-07-28 07:36:39.200841"], ["updated_at", "2017-07-28 07:36:39.200841"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "raymond.witting"], ["email", "shanel_prosacco@bergstrom.io"], ["password", "XlFhReDa9g2k61D"], ["created_at", "2017-07-28 07:36:39.205725"], ["updated_at", "2017-07-28 07:36:39.205725"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "289830"], ["username", "caroline.beier"], ["image", "http://vk.com/img/caroline.beier.jpg"], ["profile", "https://vk.com/caroline.beier"], ["email", "alivia_ruel@townekovacek.net"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 26], ["user_id", 66], ["created_at", "2017-07-28 07:36:39.209918"], ["updated_at", "2017-07-28 07:36:39.209918"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Y-find"], ["created_at", "2017-07-28 07:36:39.217305"], ["updated_at", "2017-07-28 07:36:39.217305"], ["local_path", "http://tromp.name/dorian.stamm"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bamity"], ["title_ru", "Название44"], ["created_at", "2017-07-28 07:36:39.220865"], ["updated_at", "2017-07-28 07:36:39.220865"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 44[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_44[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 44) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>44, "title"=>"Y-find", "created_at"=>Fri, 28 Jul 2017 07:36:39 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:39 UTC +00:00, "local_path"=>"http://tromp.name/dorian.stamm"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitwolf"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitwolf"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bitwolf"], ["category_id", 44], ["slug", "bitwolf"], ["created_at", "2017-07-28 07:36:39.232358"], ["updated_at", "2017-07-28 07:36:39.232358"], ["layout_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "dolorum-sapiente"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tresom"], ["phone", "133.554.4247"], ["address", "5672 Freddy Locks"], ["url", "http://mrazwolff.biz/mercedes.gorczany"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://gutkowski.net/iliana.spencer"], ["auth_expiration_time", 900], ["slug", "dolorum-sapiente"], ["brand_id", 44], ["user_id", 66], ["created_at", "2017-07-28 07:36:39.238348"], ["updated_at", "2017-07-28 07:36:39.238348"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Fix San"], ["created_at", "2017-07-28 07:36:39.246665"], ["updated_at", "2017-07-28 07:36:39.246665"], ["local_path", "http://welchrolfson.co/bertrand"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bitwolf"], ["title_ru", "Название45"], ["created_at", "2017-07-28 07:36:39.250294"], ["updated_at", "2017-07-28 07:36:39.250294"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 45[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_45[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 45) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>45, "title"=>"Fix San", "created_at"=>Fri, 28 Jul 2017 07:36:39 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:39 UTC +00:00, "local_path"=>"http://welchrolfson.co/bertrand"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Quo Lux"], ["category_id", 45], ["slug", "quo-lux"], ["created_at", "2017-07-28 07:36:39.261245"], ["updated_at", "2017-07-28 07:36:39.261245"], ["layout_id", 45]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "kameron"], ["email", "minerva@quitzon.org"], ["password", "59Wz3aF03p"], ["created_at", "2017-07-28 07:36:39.266061"], ["updated_at", "2017-07-28 07:36:39.266061"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "beatae_voluptatem"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Home Ing"], ["phone", "(100) 644-4528"], ["address", "118 Reinger Crest"], ["url", "http://franecki.co/crystal"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://sporer.org/dovie"], ["auth_expiration_time", 900], ["slug", "beatae_voluptatem"], ["brand_id", 45], ["user_id", 67], ["created_at", "2017-07-28 07:36:39.271924"], ["updated_at", "2017-07-28 07:36:39.271924"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "santina_little"], ["email", "demarcus@mraz.info"], ["password", "D0G5MeZ0HpQlGsP"], ["created_at", "2017-07-28 07:36:39.277412"], ["updated_at", "2017-07-28 07:36:39.277412"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53311"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53311"], ["comment", "comment 111"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "132.117.111.179"], ["router_admin_ip", "34.170.67.19"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "773"], ["status", "t"], ["location_id", 45], ["user_id", 68], ["created_at", "2017-07-28 07:36:39.283120"], ["updated_at", "2017-07-28 07:36:39.283120"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53311"], ["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 11], ["serial", "643705CA5E36/53311"], ["comment", "comment 111"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "132.117.111.179"], ["router_admin_ip", "34.170.67.19"], ["admin_password", "6915a9e703823aae"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "11"], ["status", "t"], ["location_id", 45], ["user_id", 68], ["created_at", "2017-07-28 07:36:39.283120"], ["updated_at", "2017-07-28 07:36:39.283120"], ["id", 11]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: ff0d0218-5b31-4380-9650-1f3c37b63b95) to Async(routers) with arguments: #<GlobalID:0x007f8774bc6350 @uri=#<URI::GID gid://wifi-management/Router/11>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 905b9053-d0a3-41dc-9c1e-fc3c086d86ab) to Async(routers) with arguments: #<GlobalID:0x007f8774bc6350 @uri=#<URI::GID gid://wifi-management/Router/11>>
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 11], ["provider", "instagram"], ["location_id", 44], ["router_id", 11], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:39 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"raymond.witting", "email"=>"shanel_prosacco@bergstrom.io", "password"=>"XlFhReDa9g2k61D", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"raymond.witting", :email=>"shanel_prosacco@bergstrom.io", :password=>"XlFhReDa9g2k61D", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"shanel_prosacco@bergstrom.io", "password"=>"XlFhReDa9g2k61D"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "raymond.witting"], ["email", "shanel_prosacco@bergstrom.io"], ["password", "XlFhReDa9g2k61D"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 66, username: "raymond.witting", email: "shanel_prosacco@bergstrom.io", password: "XlFhReDa9g2k61D", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:39", updated_at: "2017-07-28 07:36:39", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 66[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/gender_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:39 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#gender_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 66[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_66[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 66) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>66, "username"=>"raymond.witting", "email"=>"shanel_prosacco@bergstrom.io", "password"=>"XlFhReDa9g2k61D", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:39 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:39 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"gender_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 66[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_66[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 66[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_66[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>66, :username=>"raymond.witting", :email=>"shanel_prosacco@bergstrom.io", :password=>"XlFhReDa9g2k61D", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:39.205Z", :updated_at=>"2017-07-28T07:36:39.205Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 66[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.6ms)[0m  [1m[34mSELECT DISTINCT COUNT(DISTINCT social_accounts.id) AS count_social_accounts_id, "gender" AS gender FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" = 44 AND ("social_logs"."updated_at" BETWEEN $1 AND $2) GROUP BY "gender"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 24ms [30m(Views: 1.3ms | ActiveRecord: 5.6ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(695) 645-5419 x316"], ["created_at", "2017-07-28 07:36:39.447806"], ["updated_at", "2017-07-28 07:36:39.447806"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "trudie"], ["email", "desmond@hyatt.name"], ["password", "2kDuGb17R67jVn"], ["created_at", "2017-07-28 07:36:39.452693"], ["updated_at", "2017-07-28 07:36:39.452693"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "600329"], ["username", "grady_fahey"], ["image", "http://facebook.com/img/grady_fahey.jpg"], ["profile", "https://facebook.com/grady_fahey"], ["email", "jason.dickens@stehrpfeffer.io"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 27], ["user_id", 69], ["created_at", "2017-07-28 07:36:39.457244"], ["updated_at", "2017-07-28 07:36:39.457244"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tampflex"], ["created_at", "2017-07-28 07:36:39.464680"], ["updated_at", "2017-07-28 07:36:39.464680"], ["local_path", "http://ornschoen.org/vernice"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Cookley"], ["title_ru", "Название46"], ["created_at", "2017-07-28 07:36:39.468540"], ["updated_at", "2017-07-28 07:36:39.468540"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 46[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_46[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 46) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>46, "title"=>"Tampflex", "created_at"=>Fri, 28 Jul 2017 07:36:39 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:39 UTC +00:00, "local_path"=>"http://ornschoen.org/vernice"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sub-ex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sub-ex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Sub-Ex"], ["category_id", 46], ["slug", "sub-ex"], ["created_at", "2017-07-28 07:36:39.480249"], ["updated_at", "2017-07-28 07:36:39.480249"], ["layout_id", 46]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "perspiciatis-aut"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Andalax"], ["phone", "421.868.3284"], ["address", "55498 Paula Drive"], ["url", "http://lefflertremblay.name/hillary"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kleinryan.net/adell"], ["auth_expiration_time", 900], ["slug", "perspiciatis-aut"], ["brand_id", 46], ["user_id", 69], ["created_at", "2017-07-28 07:36:39.486347"], ["updated_at", "2017-07-28 07:36:39.486347"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Treeflex"], ["created_at", "2017-07-28 07:36:39.494677"], ["updated_at", "2017-07-28 07:36:39.494677"], ["local_path", "http://bartell.org/cleveland"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Stronghold"], ["title_ru", "Название47"], ["created_at", "2017-07-28 07:36:39.498268"], ["updated_at", "2017-07-28 07:36:39.498268"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 47[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_47[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 47) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>47, "title"=>"Treeflex", "created_at"=>Fri, 28 Jul 2017 07:36:39 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:39 UTC +00:00, "local_path"=>"http://bartell.org/cleveland"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "mat-lam-tam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "mat-lam-tam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Mat Lam Tam"], ["category_id", 47], ["slug", "mat-lam-tam"], ["created_at", "2017-07-28 07:36:39.509142"], ["updated_at", "2017-07-28 07:36:39.509142"], ["layout_id", 47]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "anahi"], ["email", "jordon_strosin@fadelreichert.org"], ["password", "2sIqTjG5T0ZuSy"], ["created_at", "2017-07-28 07:36:39.514056"], ["updated_at", "2017-07-28 07:36:39.514056"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et.ducimus"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tin"], ["phone", "938-231-9860"], ["address", "532 Mario Forks"], ["url", "http://collinsarmstrong.co/electa"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ratke.org/sebastian.heathcote"], ["auth_expiration_time", 900], ["slug", "et.ducimus"], ["brand_id", 47], ["user_id", 70], ["created_at", "2017-07-28 07:36:39.519776"], ["updated_at", "2017-07-28 07:36:39.519776"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lacey"], ["email", "myrna@hilpertquigley.co"], ["password", "BdLePl9nMxT1R"], ["created_at", "2017-07-28 07:36:39.524885"], ["updated_at", "2017-07-28 07:36:39.524885"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53312"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53312"], ["comment", "comment 112"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "248.71.86.6"], ["router_admin_ip", "8.216.62.160"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "591"], ["status", "t"], ["location_id", 47], ["user_id", 71], ["created_at", "2017-07-28 07:36:39.530564"], ["updated_at", "2017-07-28 07:36:39.530564"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.5ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53312"], ["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 12], ["serial", "643705CA5E36/53312"], ["comment", "comment 112"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "248.71.86.6"], ["router_admin_ip", "8.216.62.160"], ["admin_password", "0961e57cc96117e2"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "12"], ["status", "t"], ["location_id", 47], ["user_id", 71], ["created_at", "2017-07-28 07:36:39.530564"], ["updated_at", "2017-07-28 07:36:39.530564"], ["id", 12]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 553d5b5d-1fef-47ad-90cc-91392dd81def) to Async(routers) with arguments: #<GlobalID:0x007f8776343050 @uri=#<URI::GID gid://wifi-management/Router/12>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: b86b3132-e3fc-49c8-86b9-9ae91b572031) to Async(routers) with arguments: #<GlobalID:0x007f8776343050 @uri=#<URI::GID gid://wifi-management/Router/12>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 12], ["provider", "instagram"], ["location_id", 46], ["router_id", 12], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:39 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"trudie", "email"=>"desmond@hyatt.name", "password"=>"2kDuGb17R67jVn", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"trudie", :email=>"desmond@hyatt.name", :password=>"2kDuGb17R67jVn", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"desmond@hyatt.name", "password"=>"2kDuGb17R67jVn"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "trudie"], ["email", "desmond@hyatt.name"], ["password", "2kDuGb17R67jVn"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 69, username: "trudie", email: "desmond@hyatt.name", password: "2kDuGb17R67jVn", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:39", updated_at: "2017-07-28 07:36:39", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 69[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/new_old_users" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:39 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#new_old_users[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 69[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_69[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 69) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>69, "username"=>"trudie", "email"=>"desmond@hyatt.name", "password"=>"2kDuGb17R67jVn", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:39 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:39 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"new_old_users"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 69[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_69[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 69[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_69[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>69, :username=>"trudie", :email=>"desmond@hyatt.name", :password=>"2kDuGb17R67jVn", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:39.452Z", :updated_at=>"2017-07-28T07:36:39.452Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 69[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.7ms)[0m  [1m[34m
      select
        newusrs.chart_interval,
        ttlusrs.returning as returning_users,
        newusrs.new_users,
        ttlusrs.returning + newusrs.new_users as total
      from (select
          chart_interval,
          count (id) as new_users
        from (select
            distinct cl.id,
            date_trunc('day', dd)::date as chart_interval
          FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
          left outer join social_accounts sa on date_trunc('day', sa.created_at) = date_trunc('day', dd)
          left outer join clients cl on sa.client_id = cl.id
          join social_logs sl on sa.id = sl.social_account_id
            and location_id in(46)
      	  order by chart_interval) as chart
        group by chart_interval
        order by chart_interval
      ) as newusrs join (select
          date_trunc('day', dd):: date as chart_interval,
          count (distinct cl.id) as returning
        FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
        left outer join social_logs sl on date_trunc('day', sl.created_at) = date_trunc('day', dd)
          and location_id in(46)
        join social_accounts sa on sa.id = sl.social_account_id
        left outer join clients cl on date_trunc('day', cl.created_at) < date_trunc('day', dd)
          and sa.client_id = cl.id
        group by chart_interval
        order by chart_interval
      ) as ttlusrs on ttlusrs.chart_interval = newusrs.chart_interval[0m
[INFO ] Completed [32m200 OK[0m in 24ms [30m(Views: 0.5ms | ActiveRecord: 7.1ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "196-609-6942 x228"], ["created_at", "2017-07-28 07:36:39.686231"], ["updated_at", "2017-07-28 07:36:39.686231"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "clinton"], ["email", "georgette@lemke.info"], ["password", "F3OsV7Qr2lZdTx3"], ["created_at", "2017-07-28 07:36:39.691028"], ["updated_at", "2017-07-28 07:36:39.691028"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "494312"], ["username", "giles_gutmann"], ["image", "http://vk.com/img/giles_gutmann.jpg"], ["profile", "https://vk.com/giles_gutmann"], ["email", "kraig_halvorson@ratkewalter.info"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 28], ["user_id", 72], ["created_at", "2017-07-28 07:36:39.695558"], ["updated_at", "2017-07-28 07:36:39.695558"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Alpha"], ["created_at", "2017-07-28 07:36:39.702910"], ["updated_at", "2017-07-28 07:36:39.702910"], ["local_path", "http://rath.net/pinkie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Lotlux"], ["title_ru", "Название48"], ["created_at", "2017-07-28 07:36:39.706585"], ["updated_at", "2017-07-28 07:36:39.706585"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_48[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 48) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>48, "title"=>"Alpha", "created_at"=>Fri, 28 Jul 2017 07:36:39 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:39 UTC +00:00, "local_path"=>"http://rath.net/pinkie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Quo Lux"], ["category_id", 48], ["slug", "quo-lux"], ["created_at", "2017-07-28 07:36:39.717964"], ["updated_at", "2017-07-28 07:36:39.717964"], ["layout_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "aut.aut"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Daltfresh"], ["phone", "1-120-529-4601"], ["address", "3992 Veum Cape"], ["url", "http://renner.co/guy_ullrich"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://champlin.co/zula"], ["auth_expiration_time", 900], ["slug", "aut.aut"], ["brand_id", 48], ["user_id", 72], ["created_at", "2017-07-28 07:36:39.723957"], ["updated_at", "2017-07-28 07:36:39.723957"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Daltfresh"], ["created_at", "2017-07-28 07:36:39.732246"], ["updated_at", "2017-07-28 07:36:39.732246"], ["local_path", "http://abshire.info/rahul"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Treeflex"], ["title_ru", "Название49"], ["created_at", "2017-07-28 07:36:39.735989"], ["updated_at", "2017-07-28 07:36:39.735989"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 49[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_49[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 49) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>49, "title"=>"Daltfresh", "created_at"=>Fri, 28 Jul 2017 07:36:39 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:39 UTC +00:00, "local_path"=>"http://abshire.info/rahul"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "matsoft"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "matsoft"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Matsoft"], ["category_id", 49], ["slug", "matsoft"], ["created_at", "2017-07-28 07:36:39.747149"], ["updated_at", "2017-07-28 07:36:39.747149"], ["layout_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "eino"], ["email", "tyler_pagac@corkery.io"], ["password", "5mC2W967Pl42"], ["created_at", "2017-07-28 07:36:39.751901"], ["updated_at", "2017-07-28 07:36:39.751901"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "aut.dignissimos"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Opela"], ["phone", "585-907-4551"], ["address", "7030 Anastacio Flat"], ["url", "http://strosin.biz/hillary"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://bogan.info/sammy"], ["auth_expiration_time", 900], ["slug", "aut.dignissimos"], ["brand_id", 49], ["user_id", 73], ["created_at", "2017-07-28 07:36:39.757772"], ["updated_at", "2017-07-28 07:36:39.757772"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "kathleen_sporer"], ["email", "bertram@keler.biz"], ["password", "7156KqKvZ8Ry"], ["created_at", "2017-07-28 07:36:39.763135"], ["updated_at", "2017-07-28 07:36:39.763135"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53313"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53313"], ["comment", "comment 113"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "148.114.85.228"], ["router_admin_ip", "139.148.176.6"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "347"], ["status", "t"], ["location_id", 49], ["user_id", 74], ["created_at", "2017-07-28 07:36:39.768793"], ["updated_at", "2017-07-28 07:36:39.768793"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53313"], ["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 13], ["serial", "643705CA5E36/53313"], ["comment", "comment 113"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "148.114.85.228"], ["router_admin_ip", "139.148.176.6"], ["admin_password", "4e48bada8c049524"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "13"], ["status", "t"], ["location_id", 49], ["user_id", 74], ["created_at", "2017-07-28 07:36:39.768793"], ["updated_at", "2017-07-28 07:36:39.768793"], ["id", 13]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 0a0e363f-1dd1-4274-a085-085960756d5c) to Async(routers) with arguments: #<GlobalID:0x007f877458fd60 @uri=#<URI::GID gid://wifi-management/Router/13>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 9fd8c7a8-d46a-4e36-b373-efffc47a717a) to Async(routers) with arguments: #<GlobalID:0x007f877458fd60 @uri=#<URI::GID gid://wifi-management/Router/13>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 13], ["provider", "instagram"], ["location_id", 48], ["router_id", 13], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:40 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"clinton", "email"=>"georgette@lemke.info", "password"=>"F3OsV7Qr2lZdTx3", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"clinton", :email=>"georgette@lemke.info", :password=>"F3OsV7Qr2lZdTx3", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"georgette@lemke.info", "password"=>"F3OsV7Qr2lZdTx3"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "clinton"], ["email", "georgette@lemke.info"], ["password", "F3OsV7Qr2lZdTx3"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 72, username: "clinton", email: "georgette@lemke.info", password: "F3OsV7Qr2lZdTx3", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:36:39", updated_at: "2017-07-28 07:36:39", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 72[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 1.1ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/clients_count" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:40 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#clients_count[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 72[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_72[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 72) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>72, "username"=>"clinton", "email"=>"georgette@lemke.info", "password"=>"F3OsV7Qr2lZdTx3", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:36:39 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:39 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"clients_count"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 72[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_72[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 72[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_72[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>72, :username=>"clinton", :email=>"georgette@lemke.info", :password=>"F3OsV7Qr2lZdTx3", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:36:39.691Z", :updated_at=>"2017-07-28T07:36:39.691Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 72[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 48[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.6ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 48 AND ("client_visits"."updated_at" BETWEEN $1 AND $2)[0m  [["updated_at", "2017-06-28 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 48 AND ("client_visits"."updated_at" BETWEEN $1 AND $2)[0m  [["updated_at", "2017-07-21 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 28ms [30m(Views: 0.2ms | ActiveRecord: 10.1ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-512-769-4822 x170"], ["created_at", "2017-07-28 07:36:40.099017"], ["updated_at", "2017-07-28 07:36:40.099017"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "boris_hermann"], ["email", "carmen@franeckirath.co"], ["password", "HoClK0J3JkSu08"], ["created_at", "2017-07-28 07:36:40.104017"], ["updated_at", "2017-07-28 07:36:40.104017"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "78156"], ["username", "glen"], ["image", "http://twitter.com/img/glen.jpg"], ["profile", "https://twitter.com/glen"], ["email", "imani.wilderman@marquardt.info"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 29], ["user_id", 75], ["created_at", "2017-07-28 07:36:40.108507"], ["updated_at", "2017-07-28 07:36:40.108507"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Matsoft"], ["created_at", "2017-07-28 07:36:40.116237"], ["updated_at", "2017-07-28 07:36:40.116237"], ["local_path", "http://effertz.io/caie_will"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Tres-Zap"], ["title_ru", "Название50"], ["created_at", "2017-07-28 07:36:40.120059"], ["updated_at", "2017-07-28 07:36:40.120059"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 50[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_50[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 50) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>50, "title"=>"Matsoft", "created_at"=>Fri, 28 Jul 2017 07:36:40 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:40 UTC +00:00, "local_path"=>"http://effertz.io/caie_will"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alpha"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alpha"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Alpha"], ["category_id", 50], ["slug", "alpha"], ["created_at", "2017-07-28 07:36:40.132052"], ["updated_at", "2017-07-28 07:36:40.132052"], ["layout_id", 50]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "clifford"], ["email", "jorge@windler.name"], ["password", "Ek998wNmK413OlE"], ["created_at", "2017-07-28 07:36:40.137225"], ["updated_at", "2017-07-28 07:36:40.137225"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "optio-fugiat"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Y-Solowarm"], ["phone", "1-157-258-2916"], ["address", "406 Hazel Vista"], ["url", "http://flatley.co/nola.bogan"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://renner.co/henri_jacobson"], ["auth_expiration_time", 900], ["slug", "optio-fugiat"], ["brand_id", 50], ["user_id", 76], ["created_at", "2017-07-28 07:36:40.143388"], ["updated_at", "2017-07-28 07:36:40.143388"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Ronstring"], ["created_at", "2017-07-28 07:36:40.151215"], ["updated_at", "2017-07-28 07:36:40.151215"], ["local_path", "http://muellercollier.name/arne"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fixflex"], ["title_ru", "Название51"], ["created_at", "2017-07-28 07:36:40.154913"], ["updated_at", "2017-07-28 07:36:40.154913"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_51[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 51) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>51, "title"=>"Ronstring", "created_at"=>Fri, 28 Jul 2017 07:36:40 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:40 UTC +00:00, "local_path"=>"http://muellercollier.name/arne"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "vagram"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "vagram"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Vagram"], ["category_id", 51], ["slug", "vagram"], ["created_at", "2017-07-28 07:36:40.166523"], ["updated_at", "2017-07-28 07:36:40.166523"], ["layout_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jay"], ["email", "kendra@okeefe.biz"], ["password", "9jFnV7X8"], ["created_at", "2017-07-28 07:36:40.171234"], ["updated_at", "2017-07-28 07:36:40.171234"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "est.ad"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zoolab"], ["phone", "(718) 745-3176"], ["address", "57296 Ardith Inlet"], ["url", "http://nader.com/molly.gaylord"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://barrows.net/willy"], ["auth_expiration_time", 900], ["slug", "est.ad"], ["brand_id", 51], ["user_id", 77], ["created_at", "2017-07-28 07:36:40.177297"], ["updated_at", "2017-07-28 07:36:40.177297"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "grace"], ["email", "clemens.doyle@douglas.name"], ["password", "EeIv781b"], ["created_at", "2017-07-28 07:36:40.182810"], ["updated_at", "2017-07-28 07:36:40.182810"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53314"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53314"], ["comment", "comment 114"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "182.226.191.205"], ["router_admin_ip", "181.126.149.242"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "715"], ["status", "t"], ["location_id", 51], ["user_id", 78], ["created_at", "2017-07-28 07:36:40.188589"], ["updated_at", "2017-07-28 07:36:40.188589"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53314"], ["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 14], ["serial", "643705CA5E36/53314"], ["comment", "comment 114"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "182.226.191.205"], ["router_admin_ip", "181.126.149.242"], ["admin_password", "3cc85fe2101501da"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "14"], ["status", "t"], ["location_id", 51], ["user_id", 78], ["created_at", "2017-07-28 07:36:40.188589"], ["updated_at", "2017-07-28 07:36:40.188589"], ["id", 14]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: af29125e-d635-4ab7-b576-5acd25ae58f6) to Async(routers) with arguments: #<GlobalID:0x007f877614d098 @uri=#<URI::GID gid://wifi-management/Router/14>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 205626e2-ef0b-4fc5-a24e-fe8f10c2c5b9) to Async(routers) with arguments: #<GlobalID:0x007f877614d098 @uri=#<URI::GID gid://wifi-management/Router/14>>
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 14], ["provider", "instagram"], ["location_id", 50], ["router_id", 14], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/totals" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:40 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#all_connections[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"all_connections"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-06-28 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(50, 51)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" IN (50, 51) AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(50, 51) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.1ms)[0m  [1m[34m
      select
        newusrs.chart_interval,
        ttlusrs.returning as returning_users,
        newusrs.new_users,
        ttlusrs.returning + newusrs.new_users as total
      from (select
          chart_interval,
          count (id) as new_users
        from (select
            distinct cl.id,
            date_trunc('day', dd)::date as chart_interval
          FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
          left outer join social_accounts sa on date_trunc('day', sa.created_at) = date_trunc('day', dd)
          left outer join clients cl on sa.client_id = cl.id
          join social_logs sl on sa.id = sl.social_account_id
            and location_id in(50, 51)
      	  order by chart_interval) as chart
        group by chart_interval
        order by chart_interval
      ) as newusrs join (select
          date_trunc('day', dd):: date as chart_interval,
          count (distinct cl.id) as returning
        FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
        left outer join social_logs sl on date_trunc('day', sl.created_at) = date_trunc('day', dd)
          and location_id in(50, 51)
        join social_accounts sa on sa.id = sl.social_account_id
        left outer join clients cl on date_trunc('day', cl.created_at) < date_trunc('day', dd)
          and sa.client_id = cl.id
        group by chart_interval
        order by chart_interval
      ) as ttlusrs on ttlusrs.chart_interval = newusrs.chart_interval[0m
[INFO ] Completed [32m200 OK[0m in 25ms [30m(Views: 3.9ms | ActiveRecord: 8.9ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "826.182.9773 x7644"], ["created_at", "2017-07-28 07:36:40.654315"], ["updated_at", "2017-07-28 07:36:40.654315"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "elisa_daniel"], ["email", "rose@corwin.com"], ["password", "Q5Sk0eGnPz9eKy"], ["created_at", "2017-07-28 07:36:40.659361"], ["updated_at", "2017-07-28 07:36:40.659361"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "761448"], ["username", "uriah.robel"], ["image", "http://instagram.com/img/uriah.robel.jpg"], ["profile", "https://instagram.com/uriah.robel"], ["email", "claude@hickle.org"], ["gender", "female"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 30], ["user_id", 79], ["created_at", "2017-07-28 07:36:40.663693"], ["updated_at", "2017-07-28 07:36:40.663693"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Andalax"], ["created_at", "2017-07-28 07:36:40.670683"], ["updated_at", "2017-07-28 07:36:40.670683"], ["local_path", "http://abernathybreitenberg.info/kim.bednar"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fintone"], ["title_ru", "Название52"], ["created_at", "2017-07-28 07:36:40.674398"], ["updated_at", "2017-07-28 07:36:40.674398"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 52[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_52[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 52) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>52, "title"=>"Andalax", "created_at"=>Fri, 28 Jul 2017 07:36:40 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:40 UTC +00:00, "local_path"=>"http://abernathybreitenberg.info/kim.bednar"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "daltfresh"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "daltfresh"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Daltfresh"], ["category_id", 52], ["slug", "daltfresh"], ["created_at", "2017-07-28 07:36:40.686625"], ["updated_at", "2017-07-28 07:36:40.686625"], ["layout_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "deondre"], ["email", "cara@lang.info"], ["password", "CaHc2vJo1n6m6cKn"], ["created_at", "2017-07-28 07:36:40.691488"], ["updated_at", "2017-07-28 07:36:40.691488"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "animi.laboriosam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tres-Zap"], ["phone", "1-973-504-2986"], ["address", "16858 Lucio Forge"], ["url", "http://treutelwindler.com/margot"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://senger.info/jeyca_veum"], ["auth_expiration_time", 900], ["slug", "animi.laboriosam"], ["brand_id", 52], ["user_id", 80], ["created_at", "2017-07-28 07:36:40.698154"], ["updated_at", "2017-07-28 07:36:40.698154"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zontrax"], ["created_at", "2017-07-28 07:36:40.706334"], ["updated_at", "2017-07-28 07:36:40.706334"], ["local_path", "http://schmeler.net/amara.beahan"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bamity"], ["title_ru", "Название53"], ["created_at", "2017-07-28 07:36:40.710522"], ["updated_at", "2017-07-28 07:36:40.710522"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 53[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_53[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 53) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>53, "title"=>"Zontrax", "created_at"=>Fri, 28 Jul 2017 07:36:40 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:40 UTC +00:00, "local_path"=>"http://schmeler.net/amara.beahan"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "fintone"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "fintone"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Fintone"], ["category_id", 53], ["slug", "fintone"], ["created_at", "2017-07-28 07:36:40.722187"], ["updated_at", "2017-07-28 07:36:40.722187"], ["layout_id", 53]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "euna.walker"], ["email", "tyrell_williamson@thompsonpredovic.org"], ["password", "G8Ma070yE8OsX9D8"], ["created_at", "2017-07-28 07:36:40.727083"], ["updated_at", "2017-07-28 07:36:40.727083"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "eius_et"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Overhold"], ["phone", "806-613-3774"], ["address", "753 Jada Well"], ["url", "http://ruel.io/benjamin"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://becker.co/jerod_jacobson"], ["auth_expiration_time", 900], ["slug", "eius_et"], ["brand_id", 53], ["user_id", 81], ["created_at", "2017-07-28 07:36:40.732858"], ["updated_at", "2017-07-28 07:36:40.732858"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "nikki"], ["email", "alysa.upton@friesen.org"], ["password", "5h5n6d8q21Pa6k"], ["created_at", "2017-07-28 07:36:40.738433"], ["updated_at", "2017-07-28 07:36:40.738433"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53315"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53315"], ["comment", "comment 115"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "101.49.254.173"], ["router_admin_ip", "13.61.82.197"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "933"], ["status", "t"], ["location_id", 53], ["user_id", 82], ["created_at", "2017-07-28 07:36:40.744302"], ["updated_at", "2017-07-28 07:36:40.744302"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53315"], ["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 15], ["serial", "643705CA5E36/53315"], ["comment", "comment 115"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "101.49.254.173"], ["router_admin_ip", "13.61.82.197"], ["admin_password", "9e3b0be939cb06fd"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "15"], ["status", "t"], ["location_id", 53], ["user_id", 82], ["created_at", "2017-07-28 07:36:40.744302"], ["updated_at", "2017-07-28 07:36:40.744302"], ["id", 15]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 64cb6fd7-fd67-49e1-88e6-40ee6372eacc) to Async(routers) with arguments: #<GlobalID:0x007f876a4995a0 @uri=#<URI::GID gid://wifi-management/Router/15>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: bf3e577c-a49d-4ff1-82bf-d4db345c91a9) to Async(routers) with arguments: #<GlobalID:0x007f876a4995a0 @uri=#<URI::GID gid://wifi-management/Router/15>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 15], ["provider", "instagram"], ["location_id", 52], ["router_id", 15], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/time" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:40 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#time_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"time_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.0ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(52, 53)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 6ms [30m(Views: 1.2ms | ActiveRecord: 2.7ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "796.823.3734 x9879"], ["created_at", "2017-07-28 07:36:40.885207"], ["updated_at", "2017-07-28 07:36:40.885207"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "keyshawn.ledner"], ["email", "torrey@kozey.com"], ["password", "EcAqRe3nEh0jBzN"], ["created_at", "2017-07-28 07:36:40.890225"], ["updated_at", "2017-07-28 07:36:40.890225"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "172862"], ["username", "laisha"], ["image", "http://facebook.com/img/laisha.jpg"], ["profile", "https://facebook.com/laisha"], ["email", "maxine_towne@stracke.net"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 31], ["user_id", 83], ["created_at", "2017-07-28 07:36:40.894654"], ["updated_at", "2017-07-28 07:36:40.894654"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Solarbreeze"], ["created_at", "2017-07-28 07:36:40.902288"], ["updated_at", "2017-07-28 07:36:40.902288"], ["local_path", "http://okunevastehr.com/adelle"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zamit"], ["title_ru", "Название54"], ["created_at", "2017-07-28 07:36:40.906498"], ["updated_at", "2017-07-28 07:36:40.906498"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_54[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 54) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>54, "title"=>"Solarbreeze", "created_at"=>Fri, 28 Jul 2017 07:36:40 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:40 UTC +00:00, "local_path"=>"http://okunevastehr.com/adelle"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "prodder"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "prodder"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Prodder"], ["category_id", 54], ["slug", "prodder"], ["created_at", "2017-07-28 07:36:40.918539"], ["updated_at", "2017-07-28 07:36:40.918539"], ["layout_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "kaelyn"], ["email", "hailey@rogahn.net"], ["password", "6qCm5d4n"], ["created_at", "2017-07-28 07:36:40.923395"], ["updated_at", "2017-07-28 07:36:40.923395"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ratione_quo"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Cardify"], ["phone", "671.483.4705"], ["address", "215 Schaden Glen"], ["url", "http://treutel.biz/demetris"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://parker.org/bud.mosciski"], ["auth_expiration_time", 900], ["slug", "ratione_quo"], ["brand_id", 54], ["user_id", 84], ["created_at", "2017-07-28 07:36:40.929504"], ["updated_at", "2017-07-28 07:36:40.929504"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Flexidy"], ["created_at", "2017-07-28 07:36:40.937410"], ["updated_at", "2017-07-28 07:36:40.937410"], ["local_path", "http://hickle.name/alexzander"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Y-find"], ["title_ru", "Название55"], ["created_at", "2017-07-28 07:36:40.941128"], ["updated_at", "2017-07-28 07:36:40.941128"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 55[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_55[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 55) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>55, "title"=>"Flexidy", "created_at"=>Fri, 28 Jul 2017 07:36:40 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:40 UTC +00:00, "local_path"=>"http://hickle.name/alexzander"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "otcom"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "otcom"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Otcom"], ["category_id", 55], ["slug", "otcom"], ["created_at", "2017-07-28 07:36:40.952737"], ["updated_at", "2017-07-28 07:36:40.952737"], ["layout_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "gaston"], ["email", "hannah_jaskolski@kihn.biz"], ["password", "15MwDjLd7t2rB3C"], ["created_at", "2017-07-28 07:36:40.957890"], ["updated_at", "2017-07-28 07:36:40.957890"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quaerat_quibusdam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zaam-Dox"], ["phone", "(604) 665-8691"], ["address", "101 Beau Loop"], ["url", "http://hayes.co/isabell.keeling"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://simonis.info/janelle_jakubowski"], ["auth_expiration_time", 900], ["slug", "quaerat_quibusdam"], ["brand_id", 55], ["user_id", 85], ["created_at", "2017-07-28 07:36:40.963966"], ["updated_at", "2017-07-28 07:36:40.963966"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "cale"], ["email", "bertram.cremin@schinner.com"], ["password", "IcGyMfE7DkA3Eu"], ["created_at", "2017-07-28 07:36:40.969562"], ["updated_at", "2017-07-28 07:36:40.969562"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53316"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53316"], ["comment", "comment 116"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "15.120.192.5"], ["router_admin_ip", "114.85.20.13"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "473"], ["status", "t"], ["location_id", 55], ["user_id", 86], ["created_at", "2017-07-28 07:36:40.975432"], ["updated_at", "2017-07-28 07:36:40.975432"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53316"], ["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 16], ["serial", "643705CA5E36/53316"], ["comment", "comment 116"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "15.120.192.5"], ["router_admin_ip", "114.85.20.13"], ["admin_password", "41dd9d67bc9e8cb9"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "16"], ["status", "t"], ["location_id", 55], ["user_id", 86], ["created_at", "2017-07-28 07:36:40.975432"], ["updated_at", "2017-07-28 07:36:40.975432"], ["id", 16]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 1b6c0833-aa0d-47dd-96a1-469804023a23) to Async(routers) with arguments: #<GlobalID:0x007f876a636610 @uri=#<URI::GID gid://wifi-management/Router/16>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 762c07a3-a0bf-4d38-9356-a2a0b6453a40) to Async(routers) with arguments: #<GlobalID:0x007f876a636610 @uri=#<URI::GID gid://wifi-management/Router/16>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 16], ["provider", "instagram"], ["location_id", 54], ["router_id", 16], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/social" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:41 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#social_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"social_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" IN (54, 55) AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 6ms [30m(Views: 1.2ms | ActiveRecord: 1.8ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(265) 254-2342"], ["created_at", "2017-07-28 07:36:41.110357"], ["updated_at", "2017-07-28 07:36:41.110357"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "dino.luettgen"], ["email", "lexi@roob.info"], ["password", "GpVbUsLkFr"], ["created_at", "2017-07-28 07:36:41.115390"], ["updated_at", "2017-07-28 07:36:41.115390"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "937413"], ["username", "janet_douglas"], ["image", "http://instagram.com/img/janet_douglas.jpg"], ["profile", "https://instagram.com/janet_douglas"], ["email", "mackenzie@casper.com"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 32], ["user_id", 87], ["created_at", "2017-07-28 07:36:41.119645"], ["updated_at", "2017-07-28 07:36:41.119645"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Toughjoyfax"], ["created_at", "2017-07-28 07:36:41.126970"], ["updated_at", "2017-07-28 07:36:41.126970"], ["local_path", "http://robertshomenick.biz/angie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Holdlamis"], ["title_ru", "Название56"], ["created_at", "2017-07-28 07:36:41.130772"], ["updated_at", "2017-07-28 07:36:41.130772"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 56[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_56[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 56) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>56, "title"=>"Toughjoyfax", "created_at"=>Fri, 28 Jul 2017 07:36:41 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:41 UTC +00:00, "local_path"=>"http://robertshomenick.biz/angie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "flowdesk"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "flowdesk"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Flowdesk"], ["category_id", 56], ["slug", "flowdesk"], ["created_at", "2017-07-28 07:36:41.142204"], ["updated_at", "2017-07-28 07:36:41.142204"], ["layout_id", 56]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "tyrel"], ["email", "ellie@leffler.info"], ["password", "H9H6N3JzToBo"], ["created_at", "2017-07-28 07:36:41.146942"], ["updated_at", "2017-07-28 07:36:41.146942"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "recusandae-placeat"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.4ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Domainer"], ["phone", "762-584-6540"], ["address", "8536 Abigale Groves"], ["url", "http://windler.biz/margarete"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://johns.org/audreanne"], ["auth_expiration_time", 900], ["slug", "recusandae-placeat"], ["brand_id", 56], ["user_id", 88], ["created_at", "2017-07-28 07:36:41.152771"], ["updated_at", "2017-07-28 07:36:41.152771"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Trippledex"], ["created_at", "2017-07-28 07:36:41.161604"], ["updated_at", "2017-07-28 07:36:41.161604"], ["local_path", "http://breitenberg.com/karine.witting"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Lotlux"], ["title_ru", "Название57"], ["created_at", "2017-07-28 07:36:41.165395"], ["updated_at", "2017-07-28 07:36:41.165395"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_57[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 57) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>57, "title"=>"Trippledex", "created_at"=>Fri, 28 Jul 2017 07:36:41 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:41 UTC +00:00, "local_path"=>"http://breitenberg.com/karine.witting"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alpha"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alpha"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Alpha"], ["category_id", 57], ["slug", "alpha"], ["created_at", "2017-07-28 07:36:41.176693"], ["updated_at", "2017-07-28 07:36:41.176693"], ["layout_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "zion"], ["email", "donnell.marquardt@blockkunze.org"], ["password", "Ed92DjXuT5"], ["created_at", "2017-07-28 07:36:41.181460"], ["updated_at", "2017-07-28 07:36:41.181460"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et_itaque"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stronghold"], ["phone", "179-242-4979"], ["address", "22819 Durgan Camp"], ["url", "http://spinka.name/katarina.heathcote"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://gleasonwilliamson.co/rocio"], ["auth_expiration_time", 900], ["slug", "et_itaque"], ["brand_id", 57], ["user_id", 89], ["created_at", "2017-07-28 07:36:41.187298"], ["updated_at", "2017-07-28 07:36:41.187298"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "sigrid"], ["email", "maia_grant@bailey.io"], ["password", "76HdGkRpJk8"], ["created_at", "2017-07-28 07:36:41.192700"], ["updated_at", "2017-07-28 07:36:41.192700"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53317"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53317"], ["comment", "comment 117"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "88.34.253.100"], ["router_admin_ip", "239.124.13.62"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "189"], ["status", "t"], ["location_id", 57], ["user_id", 90], ["created_at", "2017-07-28 07:36:41.198798"], ["updated_at", "2017-07-28 07:36:41.198798"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53317"], ["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 17], ["serial", "643705CA5E36/53317"], ["comment", "comment 117"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "88.34.253.100"], ["router_admin_ip", "239.124.13.62"], ["admin_password", "f2cf29009c7f8d94"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "17"], ["status", "t"], ["location_id", 57], ["user_id", 90], ["created_at", "2017-07-28 07:36:41.198798"], ["updated_at", "2017-07-28 07:36:41.198798"], ["id", 17]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 128b54b3-5538-41e8-b8fe-e913a533e3df) to Async(routers) with arguments: #<GlobalID:0x007f876cae00d8 @uri=#<URI::GID gid://wifi-management/Router/17>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 476edb26-6e47-43b6-aa7f-a93f0872c672) to Async(routers) with arguments: #<GlobalID:0x007f876cae00d8 @uri=#<URI::GID gid://wifi-management/Router/17>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 17], ["provider", "instagram"], ["location_id", 56], ["router_id", 17], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/age" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:41 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#age_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"age_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(56, 57) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 6ms [30m(Views: 1.4ms | ActiveRecord: 2.0ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "525-297-5006"], ["created_at", "2017-07-28 07:36:41.544864"], ["updated_at", "2017-07-28 07:36:41.544864"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jacky"], ["email", "mae_wolff@schustercarter.biz"], ["password", "Z1I0B8Qt4u"], ["created_at", "2017-07-28 07:36:41.549759"], ["updated_at", "2017-07-28 07:36:41.549759"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "874901"], ["username", "lorna"], ["image", "http://instagram.com/img/lorna.jpg"], ["profile", "https://instagram.com/lorna"], ["email", "ralph.zemlak@littlewaelchi.name"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 33], ["user_id", 91], ["created_at", "2017-07-28 07:36:41.554003"], ["updated_at", "2017-07-28 07:36:41.554003"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Job"], ["created_at", "2017-07-28 07:36:41.561155"], ["updated_at", "2017-07-28 07:36:41.561155"], ["local_path", "http://hoegerheathcote.io/murl.wuckert"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bytecard"], ["title_ru", "Название58"], ["created_at", "2017-07-28 07:36:41.564829"], ["updated_at", "2017-07-28 07:36:41.564829"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 58[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_58[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 58) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>58, "title"=>"Job", "created_at"=>Fri, 28 Jul 2017 07:36:41 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:41 UTC +00:00, "local_path"=>"http://hoegerheathcote.io/murl.wuckert"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitwolf"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitwolf"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bitwolf"], ["category_id", 58], ["slug", "bitwolf"], ["created_at", "2017-07-28 07:36:41.576781"], ["updated_at", "2017-07-28 07:36:41.576781"], ["layout_id", 58]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jaida"], ["email", "terrell.schinner@ratke.biz"], ["password", "BvKsM72nM"], ["created_at", "2017-07-28 07:36:41.581749"], ["updated_at", "2017-07-28 07:36:41.581749"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "facere-saepe"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Temp"], ["phone", "1-748-121-8158"], ["address", "66174 Mosciski Ranch"], ["url", "http://sanfordhyatt.biz/mariane"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ruecker.com/gardner_grant"], ["auth_expiration_time", 900], ["slug", "facere-saepe"], ["brand_id", 58], ["user_id", 92], ["created_at", "2017-07-28 07:36:41.587662"], ["updated_at", "2017-07-28 07:36:41.587662"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Transcof"], ["created_at", "2017-07-28 07:36:41.595357"], ["updated_at", "2017-07-28 07:36:41.595357"], ["local_path", "http://grimespollich.co/lauriane_feil"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fintone"], ["title_ru", "Название59"], ["created_at", "2017-07-28 07:36:41.599080"], ["updated_at", "2017-07-28 07:36:41.599080"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 59[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_59[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 59) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>59, "title"=>"Transcof", "created_at"=>Fri, 28 Jul 2017 07:36:41 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:36:41 UTC +00:00, "local_path"=>"http://grimespollich.co/lauriane_feil"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "ventosanzap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "ventosanzap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Ventosanzap"], ["category_id", 59], ["slug", "ventosanzap"], ["created_at", "2017-07-28 07:36:41.610359"], ["updated_at", "2017-07-28 07:36:41.610359"], ["layout_id", 59]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "dewitt.ward"], ["email", "conor@schneider.io"], ["password", "3zMwI5VrRu"], ["created_at", "2017-07-28 07:36:41.615487"], ["updated_at", "2017-07-28 07:36:41.615487"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "tenetur-est"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Cardify"], ["phone", "1-804-031-5144"], ["address", "3254 Kerluke Light"], ["url", "http://connelly.co/theo"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://swaniawski.com/claudia_wintheiser"], ["auth_expiration_time", 900], ["slug", "tenetur-est"], ["brand_id", 59], ["user_id", 93], ["created_at", "2017-07-28 07:36:41.621548"], ["updated_at", "2017-07-28 07:36:41.621548"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "tyrique.corkery"], ["email", "barney_jakubowski@volkmanjohnson.biz"], ["password", "4jT304L4LdSq"], ["created_at", "2017-07-28 07:36:41.627088"], ["updated_at", "2017-07-28 07:36:41.627088"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53318"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53318"], ["comment", "comment 118"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "125.90.29.68"], ["router_admin_ip", "34.162.43.35"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "289"], ["status", "t"], ["location_id", 59], ["user_id", 94], ["created_at", "2017-07-28 07:36:41.632955"], ["updated_at", "2017-07-28 07:36:41.632955"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53318"], ["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 18], ["serial", "643705CA5E36/53318"], ["comment", "comment 118"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "125.90.29.68"], ["router_admin_ip", "34.162.43.35"], ["admin_password", "23a0a3357b6a2242"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "18"], ["status", "t"], ["location_id", 59], ["user_id", 94], ["created_at", "2017-07-28 07:36:41.632955"], ["updated_at", "2017-07-28 07:36:41.632955"], ["id", 18]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 48050fe1-f8dc-41fb-9ef3-5663fe9098a7) to Async(routers) with arguments: #<GlobalID:0x007f876f15add0 @uri=#<URI::GID gid://wifi-management/Router/18>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 08cfa1d5-cc55-43d9-804b-18177e9f5630) to Async(routers) with arguments: #<GlobalID:0x007f876f15add0 @uri=#<URI::GID gid://wifi-management/Router/18>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 18], ["provider", "instagram"], ["location_id", 58], ["router_id", 18], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/visitors" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:36:41 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#visitors_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"visitors_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" IN (58, 59) AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 7ms [30m(Views: 1.4ms | ActiveRecord: 2.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mActiveRecord::SchemaMigration Load (1.4ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.6ms)[0m  [1m[35mALTER TABLE "answers" DISABLE TRIGGER ALL;ALTER TABLE "social_logs" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "layouts" DISABLE TRIGGER ALL;ALTER TABLE "polls" DISABLE TRIGGER ALL;ALTER TABLE "questions" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL;ALTER TABLE "attempts" DISABLE TRIGGER ALL;ALTER TABLE "auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "bans" DISABLE TRIGGER ALL;ALTER TABLE "brands" DISABLE TRIGGER ALL;ALTER TABLE "categories" DISABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" DISABLE TRIGGER ALL;ALTER TABLE "client_counters" DISABLE TRIGGER ALL;ALTER TABLE "client_devices" DISABLE TRIGGER ALL;ALTER TABLE "clients" DISABLE TRIGGER ALL;ALTER TABLE "social_accounts" DISABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" DISABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" DISABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" DISABLE TRIGGER ALL;ALTER TABLE "locations" DISABLE TRIGGER ALL;ALTER TABLE "notifications" DISABLE TRIGGER ALL;ALTER TABLE "opinions" DISABLE TRIGGER ALL;ALTER TABLE "pages" DISABLE TRIGGER ALL;ALTER TABLE "payments" DISABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "products" DISABLE TRIGGER ALL;ALTER TABLE "routers" DISABLE TRIGGER ALL;ALTER TABLE "sessions" DISABLE TRIGGER ALL;ALTER TABLE "sms_logs" DISABLE TRIGGER ALL;ALTER TABLE "vips" DISABLE TRIGGER ALL;ALTER TABLE "vouchers" DISABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.5ms)[0m  [1m[34m          SELECT schemaname || '.' || tablename
          FROM pg_tables
          WHERE
            tablename !~ '_prt_' AND
            tablename <> 'schema_migrations' AND
            schemaname = ANY (current_schemas(false))
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.9ms)[0m  [1m[34mselect table_name from information_schema.views where table_schema = 'gycwifi_api_test'[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (127.3ms)[0m  [1m[35mTRUNCATE TABLE "public"."answers", "public"."social_logs", "public"."users", "public"."layouts", "public"."polls", "public"."questions", "public"."ar_internal_metadata", "public"."attempts", "public"."auth_logs", "public"."bans", "public"."brands", "public"."categories", "public"."client_accounting_logs", "public"."client_counters", "public"."client_devices", "public"."clients", "public"."social_accounts", "public"."delayed_jobs", "public"."device_auth_pendings", "public"."friendly_id_slugs", "public"."locations", "public"."notifications", "public"."opinions", "public"."pages", "public"."payments", "public"."post_auth_logs", "public"."products", "public"."routers", "public"."sessions", "public"."sms_logs", "public"."vips", "public"."vouchers" RESTART IDENTITY CASCADE;[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[35mALTER TABLE "answers" ENABLE TRIGGER ALL;ALTER TABLE "auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "bans" ENABLE TRIGGER ALL;ALTER TABLE "brands" ENABLE TRIGGER ALL;ALTER TABLE "categories" ENABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" ENABLE TRIGGER ALL;ALTER TABLE "social_logs" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "client_counters" ENABLE TRIGGER ALL;ALTER TABLE "client_devices" ENABLE TRIGGER ALL;ALTER TABLE "layouts" ENABLE TRIGGER ALL;ALTER TABLE "clients" ENABLE TRIGGER ALL;ALTER TABLE "social_accounts" ENABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" ENABLE TRIGGER ALL;ALTER TABLE "polls" ENABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" ENABLE TRIGGER ALL;ALTER TABLE "questions" ENABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "locations" ENABLE TRIGGER ALL;ALTER TABLE "notifications" ENABLE TRIGGER ALL;ALTER TABLE "opinions" ENABLE TRIGGER ALL;ALTER TABLE "pages" ENABLE TRIGGER ALL;ALTER TABLE "payments" ENABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "products" ENABLE TRIGGER ALL;ALTER TABLE "routers" ENABLE TRIGGER ALL;ALTER TABLE "sessions" ENABLE TRIGGER ALL;ALTER TABLE "sms_logs" ENABLE TRIGGER ALL;ALTER TABLE "vips" ENABLE TRIGGER ALL;ALTER TABLE "vouchers" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL;ALTER TABLE "attempts" ENABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.9ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-695-432-0598 x537"], ["created_at", "2017-07-28 07:39:52.731363"], ["updated_at", "2017-07-28 07:39:52.731363"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Stringtough"], ["created_at", "2017-07-28 07:39:52.871367"], ["updated_at", "2017-07-28 07:39:52.871367"], ["local_path", "http://kulasromaguera.info/mae"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Cardguard"], ["title_ru", "Название1"], ["created_at", "2017-07-28 07:39:52.887104"], ["updated_at", "2017-07-28 07:39:52.887104"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 1[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (1.2ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 1) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>1, "title"=>"Stringtough", "created_at"=>Fri, 28 Jul 2017 07:39:52 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:52 UTC +00:00, "local_path"=>"http://kulasromaguera.info/mae"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "overhold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "overhold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Overhold"], ["category_id", 1], ["slug", "overhold"], ["created_at", "2017-07-28 07:39:53.016189"], ["updated_at", "2017-07-28 07:39:53.016189"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "davon"], ["email", "aletha@bode.info"], ["password", "Ed1k7hTpEc4"], ["created_at", "2017-07-28 07:39:53.061792"], ["updated_at", "2017-07-28 07:39:53.061792"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "qui_maxime"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Vagram"], ["phone", "1-988-262-6194"], ["address", "8857 Major Roads"], ["url", "http://schambergerstehr.io/rudy"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://schuster.info/fredy_marks"], ["auth_expiration_time", 900], ["slug", "qui_maxime"], ["brand_id", 1], ["user_id", 1], ["created_at", "2017-07-28 07:39:53.072965"], ["updated_at", "2017-07-28 07:39:53.072965"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 1], ["location_id", 1], ["counter", 2], ["created_at", "2017-07-28 07:39:53.079533"], ["updated_at", "2017-07-28 07:39:53.079533"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "836.391.5571"], ["created_at", "2017-07-28 07:39:53.084497"], ["updated_at", "2017-07-28 07:39:53.084497"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Fixflex"], ["created_at", "2017-07-28 07:39:53.091293"], ["updated_at", "2017-07-28 07:39:53.091293"], ["local_path", "http://hamillstamm.name/viviane"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Tin"], ["title_ru", "Название2"], ["created_at", "2017-07-28 07:39:53.095111"], ["updated_at", "2017-07-28 07:39:53.095111"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 2[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_2[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 2) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>2, "title"=>"Fixflex", "created_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "local_path"=>"http://hamillstamm.name/viviane"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "temp"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "temp"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Temp"], ["category_id", 2], ["slug", "temp"], ["created_at", "2017-07-28 07:39:53.106077"], ["updated_at", "2017-07-28 07:39:53.106077"], ["layout_id", 2]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "freida"], ["email", "berniece@lockmankihn.co"], ["password", "VlUz16ByHxM6"], ["created_at", "2017-07-28 07:39:53.110551"], ["updated_at", "2017-07-28 07:39:53.110551"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "maiores_nobis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tempsoft"], ["phone", "(187) 287-3857"], ["address", "39532 Cicero Plaza"], ["url", "http://kutch.org/ruby_heidenreich"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://grimes.co/nicklaus"], ["auth_expiration_time", 900], ["slug", "maiores_nobis"], ["brand_id", 2], ["user_id", 2], ["created_at", "2017-07-28 07:39:53.116343"], ["updated_at", "2017-07-28 07:39:53.116343"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 2], ["location_id", 2], ["counter", 5], ["created_at", "2017-07-28 07:39:53.121284"], ["updated_at", "2017-07-28 07:39:53.121284"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Temp"], ["created_at", "2017-07-28 07:39:53.127586"], ["updated_at", "2017-07-28 07:39:53.127586"], ["local_path", "http://yost.io/cecil"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Regrant"], ["title_ru", "Название3"], ["created_at", "2017-07-28 07:39:53.131344"], ["updated_at", "2017-07-28 07:39:53.131344"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 3[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_3[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 3) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>3, "title"=>"Temp", "created_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "local_path"=>"http://yost.io/cecil"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "gembucket"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "gembucket"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Gembucket"], ["category_id", 3], ["slug", "gembucket"], ["created_at", "2017-07-28 07:39:53.142401"], ["updated_at", "2017-07-28 07:39:53.142401"], ["layout_id", 3]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "estel"], ["email", "trystan@white.info"], ["password", "1jRmJ6AeOl93HdN"], ["created_at", "2017-07-28 07:39:53.147163"], ["updated_at", "2017-07-28 07:39:53.147163"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et.est"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bigtax"], ["phone", "735.387.3093"], ["address", "23387 Corkery Turnpike"], ["url", "http://konopelski.io/clementina.larkin"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://stroman.info/casimer"], ["auth_expiration_time", 900], ["slug", "et.est"], ["brand_id", 3], ["user_id", 3], ["created_at", "2017-07-28 07:39:53.152970"], ["updated_at", "2017-07-28 07:39:53.152970"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 1], ["location_id", 3], ["counter", 3], ["created_at", "2017-07-28 07:39:53.157820"], ["updated_at", "2017-07-28 07:39:53.157820"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "arturo"], ["email", "brice@rolfson.io"], ["password", "Q83nSeLhOiV3K3"], ["role_cd", 3], ["created_at", "2017-07-28 07:39:53.162668"], ["updated_at", "2017-07-28 07:39:53.162668"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:53 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"arturo", "email"=>"brice@rolfson.io", "password"=>"Q83nSeLhOiV3K3", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"arturo", :email=>"brice@rolfson.io", :password=>"Q83nSeLhOiV3K3", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"brice@rolfson.io", "password"=>"Q83nSeLhOiV3K3"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "arturo"], ["email", "brice@rolfson.io"], ["password", "Q83nSeLhOiV3K3"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 4, username: "arturo", email: "brice@rolfson.io", password: "Q83nSeLhOiV3K3", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:39:53", updated_at: "2017-07-28 07:39:53", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 4[0m
[INFO ] Completed [32m201 Created[0m in 7ms [30m(Views: 0.3ms | ActiveRecord: 1.3ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=updated_at&updated_at=asc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:53 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"updated_at", "updated_at"=>"asc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 4) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>4, "username"=>"arturo", "email"=>"brice@rolfson.io", "password"=>"Q83nSeLhOiV3K3", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"updated_at", :updated_at=>"asc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (1.1ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>4, :username=>"arturo", :email=>"brice@rolfson.io", :password=>"Q83nSeLhOiV3K3", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:39:53.162Z", :updated_at=>"2017-07-28T07:39:53.162Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:39:53.079533') AND "client_counters"."location_id" IN (1, 2, 3) GROUP BY client_id, phone_number ORDER BY updated_at asc, visits desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (2, 1)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (1.2ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (1, 2)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:39:53.079533') AND "client_counters"."location_id" IN (1, 2, 3) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 99ms [30m(Views: 0.6ms | ActiveRecord: 17.9ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "704.548.4801 x662"], ["created_at", "2017-07-28 07:39:53.356217"], ["updated_at", "2017-07-28 07:39:53.356217"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Lotstring"], ["created_at", "2017-07-28 07:39:53.363364"], ["updated_at", "2017-07-28 07:39:53.363364"], ["local_path", "http://bartell.com/geoffrey"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Quo Lux"], ["title_ru", "Название4"], ["created_at", "2017-07-28 07:39:53.367001"], ["updated_at", "2017-07-28 07:39:53.367001"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_4[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 4) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>4, "title"=>"Lotstring", "created_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "local_path"=>"http://bartell.com/geoffrey"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonsing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonsing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Sonsing"], ["category_id", 4], ["slug", "sonsing"], ["created_at", "2017-07-28 07:39:53.378218"], ["updated_at", "2017-07-28 07:39:53.378218"], ["layout_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "berniece.williamson"], ["email", "lucio_streich@zemlakharber.name"], ["password", "9oYyYoKfGy7sVzJ"], ["created_at", "2017-07-28 07:39:53.382838"], ["updated_at", "2017-07-28 07:39:53.382838"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "est-laboriosam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Fintone"], ["phone", "(275) 798-3000"], ["address", "20038 Alta Camp"], ["url", "http://lindgrenrice.name/vella"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://borer.info/hermann"], ["auth_expiration_time", 900], ["slug", "est-laboriosam"], ["brand_id", 4], ["user_id", 5], ["created_at", "2017-07-28 07:39:53.388777"], ["updated_at", "2017-07-28 07:39:53.388777"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 3], ["location_id", 4], ["counter", 10], ["created_at", "2017-07-28 07:39:53.393495"], ["updated_at", "2017-07-28 07:39:53.393495"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "286.314.6332"], ["created_at", "2017-07-28 07:39:53.397419"], ["updated_at", "2017-07-28 07:39:53.397419"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tempsoft"], ["created_at", "2017-07-28 07:39:53.403767"], ["updated_at", "2017-07-28 07:39:53.403767"], ["local_path", "http://runolfon.org/nicholaus.beahan"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Konklux"], ["title_ru", "Название5"], ["created_at", "2017-07-28 07:39:53.407577"], ["updated_at", "2017-07-28 07:39:53.407577"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 5[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_5[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 5) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>5, "title"=>"Tempsoft", "created_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "local_path"=>"http://runolfon.org/nicholaus.beahan"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stronghold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stronghold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Stronghold"], ["category_id", 5], ["slug", "stronghold"], ["created_at", "2017-07-28 07:39:53.418567"], ["updated_at", "2017-07-28 07:39:53.418567"], ["layout_id", 5]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ora"], ["email", "abdiel@ritchie.com"], ["password", "E8WeJsGu"], ["created_at", "2017-07-28 07:39:53.423235"], ["updated_at", "2017-07-28 07:39:53.423235"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ea.nihil"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Voltsillam"], ["phone", "1-179-853-2291"], ["address", "55195 Lori Crossroad"], ["url", "http://raynorko.io/johnny"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://boehmzemlak.org/kathleen"], ["auth_expiration_time", 900], ["slug", "ea.nihil"], ["brand_id", 5], ["user_id", 6], ["created_at", "2017-07-28 07:39:53.429058"], ["updated_at", "2017-07-28 07:39:53.429058"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 4], ["location_id", 5], ["counter", 3], ["created_at", "2017-07-28 07:39:53.433659"], ["updated_at", "2017-07-28 07:39:53.433659"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Fixflex"], ["created_at", "2017-07-28 07:39:53.440115"], ["updated_at", "2017-07-28 07:39:53.440115"], ["local_path", "http://rolfsongottlieb.co/ray"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Alphazap"], ["title_ru", "Название6"], ["created_at", "2017-07-28 07:39:53.443993"], ["updated_at", "2017-07-28 07:39:53.443993"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 6[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_6[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 6) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>6, "title"=>"Fixflex", "created_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "local_path"=>"http://rolfsongottlieb.co/ray"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitchip"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitchip"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bitchip"], ["category_id", 6], ["slug", "bitchip"], ["created_at", "2017-07-28 07:39:53.455073"], ["updated_at", "2017-07-28 07:39:53.455073"], ["layout_id", 6]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "sydney"], ["email", "amya@bosco.co"], ["password", "C87eXv85"], ["created_at", "2017-07-28 07:39:53.459683"], ["updated_at", "2017-07-28 07:39:53.459683"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quibusdam.deserunt"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Y-Solowarm"], ["phone", "1-182-210-9792"], ["address", "50504 Rafaela Overpass"], ["url", "http://leuschkekris.name/glenna"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ko.biz/letha"], ["auth_expiration_time", 900], ["slug", "quibusdam.deserunt"], ["brand_id", 6], ["user_id", 7], ["created_at", "2017-07-28 07:39:53.465612"], ["updated_at", "2017-07-28 07:39:53.465612"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 3], ["location_id", 6], ["counter", 3], ["created_at", "2017-07-28 07:39:53.470550"], ["updated_at", "2017-07-28 07:39:53.470550"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "lon"], ["email", "norene.waelchi@sipesleannon.name"], ["password", "5n63H2OeTv425sRd"], ["role_cd", 3], ["created_at", "2017-07-28 07:39:53.474974"], ["updated_at", "2017-07-28 07:39:53.474974"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:53 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"lon", "email"=>"norene.waelchi@sipesleannon.name", "password"=>"5n63H2OeTv425sRd", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"lon", :email=>"norene.waelchi@sipesleannon.name", :password=>"5n63H2OeTv425sRd", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"norene.waelchi@sipesleannon.name", "password"=>"5n63H2OeTv425sRd"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "lon"], ["email", "norene.waelchi@sipesleannon.name"], ["password", "5n63H2OeTv425sRd"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 8, username: "lon", email: "norene.waelchi@sipesleannon.name", password: "5n63H2OeTv425sRd", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:39:53", updated_at: "2017-07-28 07:39:53", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 8[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=regular&loyalty_days=7&page=1&sort_field=visits30&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:53 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"regular", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits30", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 8) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>8, "username"=>"lon", "email"=>"norene.waelchi@sipesleannon.name", "password"=>"5n63H2OeTv425sRd", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"regular", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits30", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.7ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>8, :username=>"lon", :email=>"norene.waelchi@sipesleannon.name", :password=>"5n63H2OeTv425sRd", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:39:53.474Z", :updated_at=>"2017-07-28T07:39:53.474Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:39:53.393495') AND "client_counters"."location_id" IN (4, 5, 6) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) > 1) ORDER BY visits30 asc, updated_at desc, visits desc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 3[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.7ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 3[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:39:53.393495') AND "client_counters"."location_id" IN (4, 5, 6) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) > 1)[0m
[INFO ] Completed [32m200 OK[0m in 30ms [30m(Views: 0.4ms | ActiveRecord: 8.3ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(713) 225-0416 x930"], ["created_at", "2017-07-28 07:39:53.524808"], ["updated_at", "2017-07-28 07:39:53.524808"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Fixflex"], ["created_at", "2017-07-28 07:39:53.531492"], ["updated_at", "2017-07-28 07:39:53.531492"], ["local_path", "http://romaguera.io/lizeth"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Domainer"], ["title_ru", "Название7"], ["created_at", "2017-07-28 07:39:53.535282"], ["updated_at", "2017-07-28 07:39:53.535282"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 7[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_7[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 7) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>7, "title"=>"Fixflex", "created_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "local_path"=>"http://romaguera.io/lizeth"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "greenlam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "greenlam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Greenlam"], ["category_id", 7], ["slug", "greenlam"], ["created_at", "2017-07-28 07:39:53.546387"], ["updated_at", "2017-07-28 07:39:53.546387"], ["layout_id", 7]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "abigail.prosacco"], ["email", "aisha.oreilly@mcglynn.org"], ["password", "UyU71491Eb"], ["created_at", "2017-07-28 07:39:53.551375"], ["updated_at", "2017-07-28 07:39:53.551375"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quibusdam-incidunt"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Regrant"], ["phone", "922.662.5312"], ["address", "690 Oran Club"], ["url", "http://douglas.name/haley_nicolas"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://cummings.co/leopoldo"], ["auth_expiration_time", 900], ["slug", "quibusdam-incidunt"], ["brand_id", 7], ["user_id", 9], ["created_at", "2017-07-28 07:39:53.557103"], ["updated_at", "2017-07-28 07:39:53.557103"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 5], ["location_id", 7], ["counter", 1], ["created_at", "2017-07-28 07:39:53.561776"], ["updated_at", "2017-07-28 07:39:53.561776"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-304-132-8838 x89101"], ["created_at", "2017-07-28 07:39:53.565517"], ["updated_at", "2017-07-28 07:39:53.565517"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Kanlam"], ["created_at", "2017-07-28 07:39:53.571769"], ["updated_at", "2017-07-28 07:39:53.571769"], ["local_path", "http://hodkiewicz.net/nathaniel"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Veribet"], ["title_ru", "Название8"], ["created_at", "2017-07-28 07:39:53.575429"], ["updated_at", "2017-07-28 07:39:53.575429"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 8) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>8, "title"=>"Kanlam", "created_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "local_path"=>"http://hodkiewicz.net/nathaniel"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "keylex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "keylex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Keylex"], ["category_id", 8], ["slug", "keylex"], ["created_at", "2017-07-28 07:39:53.586446"], ["updated_at", "2017-07-28 07:39:53.586446"], ["layout_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lavern.schmeler"], ["email", "rashawn.feil@sanford.com"], ["password", "BiFiCpYx8bIz"], ["created_at", "2017-07-28 07:39:53.591371"], ["updated_at", "2017-07-28 07:39:53.591371"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "sit_qui"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Transcof"], ["phone", "107-947-1155"], ["address", "915 Dale Glen"], ["url", "http://reichel.name/domenica.upton"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://trantow.io/tia"], ["auth_expiration_time", 900], ["slug", "sit_qui"], ["brand_id", 8], ["user_id", 10], ["created_at", "2017-07-28 07:39:53.597297"], ["updated_at", "2017-07-28 07:39:53.597297"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 6], ["location_id", 8], ["counter", 10], ["created_at", "2017-07-28 07:39:53.601992"], ["updated_at", "2017-07-28 07:39:53.601992"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "It"], ["created_at", "2017-07-28 07:39:53.608367"], ["updated_at", "2017-07-28 07:39:53.608367"], ["local_path", "http://runte.com/jayde"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Konklab"], ["title_ru", "Название9"], ["created_at", "2017-07-28 07:39:53.611988"], ["updated_at", "2017-07-28 07:39:53.611988"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 9[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_9[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 9) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>9, "title"=>"It", "created_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "local_path"=>"http://runte.com/jayde"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sub-ex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sub-ex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Sub-Ex"], ["category_id", 9], ["slug", "sub-ex"], ["created_at", "2017-07-28 07:39:53.622898"], ["updated_at", "2017-07-28 07:39:53.622898"], ["layout_id", 9]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "kristin"], ["email", "allie@oberbrunnerbernhard.net"], ["password", "4fH313R2N284H7S0"], ["created_at", "2017-07-28 07:39:53.627350"], ["updated_at", "2017-07-28 07:39:53.627350"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "omnis_eligendi"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Domainer"], ["phone", "(589) 587-5198"], ["address", "304 Jadyn Coves"], ["url", "http://wildermanadams.com/jaqueline_reinger"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://gleason.org/santos"], ["auth_expiration_time", 900], ["slug", "omnis_eligendi"], ["brand_id", 9], ["user_id", 11], ["created_at", "2017-07-28 07:39:53.633028"], ["updated_at", "2017-07-28 07:39:53.633028"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 5], ["location_id", 9], ["counter", 3], ["created_at", "2017-07-28 07:39:53.637587"], ["updated_at", "2017-07-28 07:39:53.637587"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "loyce"], ["email", "isabelle@nitzsche.biz"], ["password", "BmP9Yd6x7c"], ["role_cd", 3], ["created_at", "2017-07-28 07:39:53.642128"], ["updated_at", "2017-07-28 07:39:53.642128"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:53 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"loyce", "email"=>"isabelle@nitzsche.biz", "password"=>"BmP9Yd6x7c", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"loyce", :email=>"isabelle@nitzsche.biz", :password=>"BmP9Yd6x7c", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"isabelle@nitzsche.biz", "password"=>"BmP9Yd6x7c"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "loyce"], ["email", "isabelle@nitzsche.biz"], ["password", "BmP9Yd6x7c"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 12, username: "loyce", email: "isabelle@nitzsche.biz", password: "BmP9Yd6x7c", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:39:53", updated_at: "2017-07-28 07:39:53", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 12[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.7ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=passed&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:53 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"passed", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 12) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>12, "username"=>"loyce", "email"=>"isabelle@nitzsche.biz", "password"=>"BmP9Yd6x7c", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"passed", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>12, :username=>"loyce", :email=>"isabelle@nitzsche.biz", :password=>"BmP9Yd6x7c", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:39:53.642Z", :updated_at=>"2017-07-28T07:39:53.642Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:39:53.670150') AND "client_counters"."location_id" IN (7, 8, 9) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1) ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 6[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 6[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:39:53.670150') AND "client_counters"."location_id" IN (7, 8, 9) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1)[0m
[INFO ] Completed [32m200 OK[0m in 28ms [30m(Views: 0.4ms | ActiveRecord: 7.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "405.427.1481 x40071"], ["created_at", "2017-07-28 07:39:53.689820"], ["updated_at", "2017-07-28 07:39:53.689820"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Alpha"], ["created_at", "2017-07-28 07:39:53.696792"], ["updated_at", "2017-07-28 07:39:53.696792"], ["local_path", "http://hermiston.net/coralie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Transcof"], ["title_ru", "Название10"], ["created_at", "2017-07-28 07:39:53.700629"], ["updated_at", "2017-07-28 07:39:53.700629"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 10[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_10[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 10) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>10, "title"=>"Alpha", "created_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "local_path"=>"http://hermiston.net/coralie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonsing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonsing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Sonsing"], ["category_id", 10], ["slug", "sonsing"], ["created_at", "2017-07-28 07:39:53.712233"], ["updated_at", "2017-07-28 07:39:53.712233"], ["layout_id", 10]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "roxanne.wiza"], ["email", "damien.hermann@mayert.org"], ["password", "1w5f4qR4DeUsXfIt"], ["created_at", "2017-07-28 07:39:53.716932"], ["updated_at", "2017-07-28 07:39:53.716932"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "consequatur_id"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stringtough"], ["phone", "693-289-9031"], ["address", "9353 Garfield Harbors"], ["url", "http://lakinrobel.info/hoyt"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://lang.com/jared.ruel"], ["auth_expiration_time", 900], ["slug", "consequatur_id"], ["brand_id", 10], ["user_id", 13], ["created_at", "2017-07-28 07:39:53.722875"], ["updated_at", "2017-07-28 07:39:53.722875"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 7], ["location_id", 10], ["counter", 7], ["created_at", "2017-07-28 07:39:53.727790"], ["updated_at", "2017-07-28 07:39:53.727790"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "220.157.2057 x2690"], ["created_at", "2017-07-28 07:39:53.731785"], ["updated_at", "2017-07-28 07:39:53.731785"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Voyatouch"], ["created_at", "2017-07-28 07:39:53.738507"], ["updated_at", "2017-07-28 07:39:53.738507"], ["local_path", "http://pacocha.name/neal_ebert"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zamit"], ["title_ru", "Название11"], ["created_at", "2017-07-28 07:39:53.742261"], ["updated_at", "2017-07-28 07:39:53.742261"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 11[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_11[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 11) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>11, "title"=>"Voyatouch", "created_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "local_path"=>"http://pacocha.name/neal_ebert"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tampflex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tampflex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tampflex"], ["category_id", 11], ["slug", "tampflex"], ["created_at", "2017-07-28 07:39:53.753077"], ["updated_at", "2017-07-28 07:39:53.753077"], ["layout_id", 11]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "marcella"], ["email", "heaven@white.name"], ["password", "9iS7WbI09aF945Z8"], ["created_at", "2017-07-28 07:39:53.757922"], ["updated_at", "2017-07-28 07:39:53.757922"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "accusantium-ab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Domainer"], ["phone", "(512) 289-8399"], ["address", "55337 Simonis Freeway"], ["url", "http://boehmrunolfsdottir.net/gaston"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://aufderharkohler.co/trey.rosenbaum"], ["auth_expiration_time", 900], ["slug", "accusantium-ab"], ["brand_id", 11], ["user_id", 14], ["created_at", "2017-07-28 07:39:53.764003"], ["updated_at", "2017-07-28 07:39:53.764003"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 8], ["location_id", 11], ["counter", 9], ["created_at", "2017-07-28 07:39:53.769037"], ["updated_at", "2017-07-28 07:39:53.769037"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zaam-Dox"], ["created_at", "2017-07-28 07:39:53.776273"], ["updated_at", "2017-07-28 07:39:53.776273"], ["local_path", "http://greenfelderschmitt.org/krystal"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Quo Lux"], ["title_ru", "Название12"], ["created_at", "2017-07-28 07:39:53.780005"], ["updated_at", "2017-07-28 07:39:53.780005"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_12[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 12) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>12, "title"=>"Zaam-Dox", "created_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "local_path"=>"http://greenfelderschmitt.org/krystal"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "asoka"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "asoka"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Asoka"], ["category_id", 12], ["slug", "asoka"], ["created_at", "2017-07-28 07:39:53.791014"], ["updated_at", "2017-07-28 07:39:53.791014"], ["layout_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "libby_ko"], ["email", "eldon_oconner@bechtelar.co"], ["password", "L0Df6bD2LrZyDi9"], ["created_at", "2017-07-28 07:39:53.795739"], ["updated_at", "2017-07-28 07:39:53.795739"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "omnis_sequi"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tresom"], ["phone", "1-396-688-5187"], ["address", "786 Penelope Knoll"], ["url", "http://gusikowski.com/tyrique.dooley"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://schowalter.co/stanley_walker"], ["auth_expiration_time", 900], ["slug", "omnis_sequi"], ["brand_id", 12], ["user_id", 15], ["created_at", "2017-07-28 07:39:53.801407"], ["updated_at", "2017-07-28 07:39:53.801407"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 7], ["location_id", 12], ["counter", 1], ["created_at", "2017-07-28 07:39:53.806191"], ["updated_at", "2017-07-28 07:39:53.806191"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Quo Lux"], ["created_at", "2017-07-28 07:39:53.813626"], ["updated_at", "2017-07-28 07:39:53.813626"], ["local_path", "http://bauch.biz/brock"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Hatity"], ["title_ru", "Название13"], ["created_at", "2017-07-28 07:39:53.817815"], ["updated_at", "2017-07-28 07:39:53.817815"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 13[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_13[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 13) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>13, "title"=>"Quo Lux", "created_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "local_path"=>"http://bauch.biz/brock"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Quo Lux"], ["category_id", 13], ["slug", "quo-lux"], ["created_at", "2017-07-28 07:39:53.829295"], ["updated_at", "2017-07-28 07:39:53.829295"], ["layout_id", 13]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "daphney"], ["email", "rex_braun@johnston.io"], ["password", "75Pt6yTk5rT"], ["created_at", "2017-07-28 07:39:53.834338"], ["updated_at", "2017-07-28 07:39:53.834338"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "mollitia-commodi"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Gembucket"], ["phone", "(462) 810-2581"], ["address", "405 Harber Bypass"], ["url", "http://marvingoodwin.info/marguerite"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://schowalter.biz/tito"], ["auth_expiration_time", 900], ["slug", "mollitia-commodi"], ["brand_id", 13], ["user_id", 16], ["created_at", "2017-07-28 07:39:53.840306"], ["updated_at", "2017-07-28 07:39:53.840306"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 8], ["location_id", 13], ["counter", 3], ["created_at", "2017-07-20 07:39:53.808782"], ["updated_at", "2017-07-20 07:39:53.808892"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "johnny"], ["email", "roie@satterfieldbradtke.biz"], ["password", "TiVrHtLpJ7S1VmM"], ["role_cd", 3], ["created_at", "2017-07-28 07:39:53.849882"], ["updated_at", "2017-07-28 07:39:53.849882"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:53 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"johnny", "email"=>"roie@satterfieldbradtke.biz", "password"=>"TiVrHtLpJ7S1VmM", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"johnny", :email=>"roie@satterfieldbradtke.biz", :password=>"TiVrHtLpJ7S1VmM", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"roie@satterfieldbradtke.biz", "password"=>"TiVrHtLpJ7S1VmM"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "johnny"], ["email", "roie@satterfieldbradtke.biz"], ["password", "TiVrHtLpJ7S1VmM"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 17, username: "johnny", email: "roie@satterfieldbradtke.biz", password: "TiVrHtLpJ7S1VmM", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:39:53", updated_at: "2017-07-28 07:39:53", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 17[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=passed&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:53 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"passed", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 17) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>17, "username"=>"johnny", "email"=>"roie@satterfieldbradtke.biz", "password"=>"TiVrHtLpJ7S1VmM", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"passed", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>17, :username=>"johnny", :email=>"roie@satterfieldbradtke.biz", :password=>"TiVrHtLpJ7S1VmM", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:39:53.849Z", :updated_at=>"2017-07-28T07:39:53.849Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:39:53.879438') AND "client_counters"."location_id" IN (10, 11, 12, 13) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1) ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 8[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:39:53.879438') AND "client_counters"."location_id" IN (10, 11, 12, 13) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1)[0m
[INFO ] Completed [32m200 OK[0m in 30ms [30m(Views: 0.4ms | ActiveRecord: 8.3ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(858) 148-0434 x203"], ["created_at", "2017-07-28 07:39:53.900724"], ["updated_at", "2017-07-28 07:39:53.900724"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bitwolf"], ["created_at", "2017-07-28 07:39:53.907764"], ["updated_at", "2017-07-28 07:39:53.907764"], ["local_path", "http://hayeswelch.net/stephany.hoppe"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fix San"], ["title_ru", "Название14"], ["created_at", "2017-07-28 07:39:53.911728"], ["updated_at", "2017-07-28 07:39:53.911728"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 14[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_14[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 14) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>14, "title"=>"Bitwolf", "created_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "local_path"=>"http://hayeswelch.net/stephany.hoppe"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "fintone"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "fintone"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Fintone"], ["category_id", 14], ["slug", "fintone"], ["created_at", "2017-07-28 07:39:53.923300"], ["updated_at", "2017-07-28 07:39:53.923300"], ["layout_id", 14]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lydia.auer"], ["email", "anibal@grady.org"], ["password", "L6W73tBpFo"], ["created_at", "2017-07-28 07:39:53.928342"], ["updated_at", "2017-07-28 07:39:53.928342"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "cum_sed"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Cookley"], ["phone", "652.960.2689"], ["address", "483 Damaris Spring"], ["url", "http://gislason.info/corbin"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://boehm.co/kayla_braun"], ["auth_expiration_time", 900], ["slug", "cum_sed"], ["brand_id", 14], ["user_id", 18], ["created_at", "2017-07-28 07:39:53.934240"], ["updated_at", "2017-07-28 07:39:53.934240"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 9], ["location_id", 14], ["counter", 3], ["created_at", "2017-07-28 07:39:53.939243"], ["updated_at", "2017-07-28 07:39:53.939243"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "121.608.9475 x43312"], ["created_at", "2017-07-28 07:39:53.943119"], ["updated_at", "2017-07-28 07:39:53.943119"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Opela"], ["created_at", "2017-07-28 07:39:53.949848"], ["updated_at", "2017-07-28 07:39:53.949848"], ["local_path", "http://schumm.biz/dandre_jacobi"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Voltsillam"], ["title_ru", "Название15"], ["created_at", "2017-07-28 07:39:53.953405"], ["updated_at", "2017-07-28 07:39:53.953405"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 15[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_15[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 15) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>15, "title"=>"Opela", "created_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "local_path"=>"http://schumm.biz/dandre_jacobi"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tampflex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tampflex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tampflex"], ["category_id", 15], ["slug", "tampflex"], ["created_at", "2017-07-28 07:39:53.964710"], ["updated_at", "2017-07-28 07:39:53.964710"], ["layout_id", 15]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "wilhelm_rath"], ["email", "jeromy@mitchell.info"], ["password", "Cs9wS6SiTgRgNv"], ["created_at", "2017-07-28 07:39:53.969570"], ["updated_at", "2017-07-28 07:39:53.969570"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "vitae_iste"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Cookley"], ["phone", "186.535.1925"], ["address", "53175 Candido Expressway"], ["url", "http://wuckert.com/rosina_runolfsdottir"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://sanford.co/joshuah_bailey"], ["auth_expiration_time", 900], ["slug", "vitae_iste"], ["brand_id", 15], ["user_id", 19], ["created_at", "2017-07-28 07:39:53.975542"], ["updated_at", "2017-07-28 07:39:53.975542"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 10], ["location_id", 15], ["counter", 4], ["created_at", "2017-07-28 07:39:53.980397"], ["updated_at", "2017-07-28 07:39:53.980397"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Ventosanzap"], ["created_at", "2017-07-28 07:39:53.986785"], ["updated_at", "2017-07-28 07:39:53.986785"], ["local_path", "http://stiedemann.co/tatum_macejkovic"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Stim"], ["title_ru", "Название16"], ["created_at", "2017-07-28 07:39:53.990608"], ["updated_at", "2017-07-28 07:39:53.990608"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 16[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_16[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 16) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>16, "title"=>"Ventosanzap", "created_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:53 UTC +00:00, "local_path"=>"http://stiedemann.co/tatum_macejkovic"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "holdlamis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "holdlamis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Holdlamis"], ["category_id", 16], ["slug", "holdlamis"], ["created_at", "2017-07-28 07:39:54.001673"], ["updated_at", "2017-07-28 07:39:54.001673"], ["layout_id", 16]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "liana.schmidt"], ["email", "icie@kub.co"], ["password", "NxR6V9TvHjDiAyP7"], ["created_at", "2017-07-28 07:39:54.006540"], ["updated_at", "2017-07-28 07:39:54.006540"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "sit-omnis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Keylex"], ["phone", "871-590-9796"], ["address", "9676 Roxanne Mountain"], ["url", "http://cormierstamm.org/etha"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://nitzschemacgyver.info/leie.beer"], ["auth_expiration_time", 900], ["slug", "sit-omnis"], ["brand_id", 16], ["user_id", 20], ["created_at", "2017-07-28 07:39:54.012603"], ["updated_at", "2017-07-28 07:39:54.012603"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 9], ["location_id", 16], ["counter", 5], ["created_at", "2017-07-28 07:39:54.017611"], ["updated_at", "2017-07-28 07:39:54.017611"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "stan_jones"], ["email", "junior.hermann@hillspurdy.org"], ["password", "60Nc270oOlJzIqX"], ["role_cd", 3], ["created_at", "2017-07-28 07:39:54.022272"], ["updated_at", "2017-07-28 07:39:54.022272"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:54 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"stan_jones", "email"=>"junior.hermann@hillspurdy.org", "password"=>"60Nc270oOlJzIqX", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"stan_jones", :email=>"junior.hermann@hillspurdy.org", :password=>"60Nc270oOlJzIqX", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"junior.hermann@hillspurdy.org", "password"=>"60Nc270oOlJzIqX"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "stan_jones"], ["email", "junior.hermann@hillspurdy.org"], ["password", "60Nc270oOlJzIqX"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 21, username: "stan_jones", email: "junior.hermann@hillspurdy.org", password: "60Nc270oOlJzIqX", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:39:54", updated_at: "2017-07-28 07:39:54", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 21[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:54 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 21) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>21, "username"=>"stan_jones", "email"=>"junior.hermann@hillspurdy.org", "password"=>"60Nc270oOlJzIqX", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.8ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>21, :username=>"stan_jones", :email=>"junior.hermann@hillspurdy.org", :password=>"60Nc270oOlJzIqX", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:39:54.022Z", :updated_at=>"2017-07-28T07:39:54.022Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:39:53.939243') AND "client_counters"."location_id" IN (14, 15, 16) GROUP BY client_id, phone_number ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (9, 10)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (9, 10)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:39:53.939243') AND "client_counters"."location_id" IN (14, 15, 16) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 32ms [30m(Views: 0.6ms | ActiveRecord: 9.0ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "548.035.2612"], ["created_at", "2017-07-28 07:39:54.074327"], ["updated_at", "2017-07-28 07:39:54.074327"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Stringtough"], ["created_at", "2017-07-28 07:39:54.081296"], ["updated_at", "2017-07-28 07:39:54.081296"], ["local_path", "http://pollichgutmann.net/danny.kautzer"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Ventosanzap"], ["title_ru", "Название17"], ["created_at", "2017-07-28 07:39:54.085312"], ["updated_at", "2017-07-28 07:39:54.085312"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_17[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 17) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>17, "title"=>"Stringtough", "created_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "local_path"=>"http://pollichgutmann.net/danny.kautzer"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Quo Lux"], ["category_id", 17], ["slug", "quo-lux"], ["created_at", "2017-07-28 07:39:54.096905"], ["updated_at", "2017-07-28 07:39:54.096905"], ["layout_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "rey"], ["email", "alexis.oreilly@conn.biz"], ["password", "FfWjVd52L0JsY"], ["created_at", "2017-07-28 07:39:54.101601"], ["updated_at", "2017-07-28 07:39:54.101601"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "culpa_odit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Fix San"], ["phone", "(809) 743-5527"], ["address", "466 Vella Locks"], ["url", "http://coleheathcote.info/easton.schuppe"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://strackekshlerin.biz/maximillian_daugherty"], ["auth_expiration_time", 900], ["slug", "culpa_odit"], ["brand_id", 17], ["user_id", 22], ["created_at", "2017-07-28 07:39:54.107430"], ["updated_at", "2017-07-28 07:39:54.107430"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 11], ["location_id", 17], ["counter", 2], ["created_at", "2017-07-28 07:39:54.112403"], ["updated_at", "2017-07-28 07:39:54.112403"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "298-945-2647"], ["created_at", "2017-07-28 07:39:54.116119"], ["updated_at", "2017-07-28 07:39:54.116119"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Stronghold"], ["created_at", "2017-07-28 07:39:54.122491"], ["updated_at", "2017-07-28 07:39:54.122491"], ["local_path", "http://eichmann.org/ryley"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Voyatouch"], ["title_ru", "Название18"], ["created_at", "2017-07-28 07:39:54.126094"], ["updated_at", "2017-07-28 07:39:54.126094"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 18[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_18[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 18) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>18, "title"=>"Stronghold", "created_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "local_path"=>"http://eichmann.org/ryley"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zaam-dox"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zaam-dox"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zaam-Dox"], ["category_id", 18], ["slug", "zaam-dox"], ["created_at", "2017-07-28 07:39:54.137051"], ["updated_at", "2017-07-28 07:39:54.137051"], ["layout_id", 18]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "brent"], ["email", "maynard@pollichreichel.org"], ["password", "802q5k3c"], ["created_at", "2017-07-28 07:39:54.141909"], ["updated_at", "2017-07-28 07:39:54.141909"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "aut_qui"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tresom"], ["phone", "870-688-5676"], ["address", "926 Madisen Corner"], ["url", "http://grantdurgan.com/thalia.cain"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://rogahn.io/josefina_hoeger"], ["auth_expiration_time", 900], ["slug", "aut_qui"], ["brand_id", 18], ["user_id", 23], ["created_at", "2017-07-28 07:39:54.147919"], ["updated_at", "2017-07-28 07:39:54.147919"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 12], ["location_id", 18], ["counter", 8], ["created_at", "2017-07-28 07:39:54.152722"], ["updated_at", "2017-07-28 07:39:54.152722"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Prodder"], ["created_at", "2017-07-28 07:39:54.159421"], ["updated_at", "2017-07-28 07:39:54.159421"], ["local_path", "http://johnston.net/emil"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Vagram"], ["title_ru", "Название19"], ["created_at", "2017-07-28 07:39:54.163024"], ["updated_at", "2017-07-28 07:39:54.163024"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 19[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_19[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 19) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>19, "title"=>"Prodder", "created_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "local_path"=>"http://johnston.net/emil"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zamit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zamit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zamit"], ["category_id", 19], ["slug", "zamit"], ["created_at", "2017-07-28 07:39:54.174136"], ["updated_at", "2017-07-28 07:39:54.174136"], ["layout_id", 19]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lorenz.oconner"], ["email", "earnest.botsford@kshlerin.co"], ["password", "95Za8vE5Yh7q9bUk"], ["created_at", "2017-07-28 07:39:54.178970"], ["updated_at", "2017-07-28 07:39:54.178970"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "odio-consequatur"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Holdlamis"], ["phone", "(531) 251-4650"], ["address", "8198 Alda Court"], ["url", "http://buckridgemaggio.co/osbaldo.renner"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://shanahan.biz/maggie_ledner"], ["auth_expiration_time", 900], ["slug", "odio-consequatur"], ["brand_id", 19], ["user_id", 24], ["created_at", "2017-07-28 07:39:54.184755"], ["updated_at", "2017-07-28 07:39:54.184755"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 11], ["location_id", 19], ["counter", 4], ["created_at", "2017-07-28 07:39:54.189428"], ["updated_at", "2017-07-28 07:39:54.189428"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "elmo.collins"], ["email", "delta_wolff@kunzespencer.co"], ["password", "63DkCvEc"], ["role_cd", 3], ["created_at", "2017-07-28 07:39:54.194344"], ["updated_at", "2017-07-28 07:39:54.194344"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:54 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"elmo.collins", "email"=>"delta_wolff@kunzespencer.co", "password"=>"63DkCvEc", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"elmo.collins", :email=>"delta_wolff@kunzespencer.co", :password=>"63DkCvEc", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"delta_wolff@kunzespencer.co", "password"=>"63DkCvEc"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "elmo.collins"], ["email", "delta_wolff@kunzespencer.co"], ["password", "63DkCvEc"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 25, username: "elmo.collins", email: "delta_wolff@kunzespencer.co", password: "63DkCvEc", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:39:54", updated_at: "2017-07-28 07:39:54", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 25[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=updated_at&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:54 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"updated_at", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 25) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>25, "username"=>"elmo.collins", "email"=>"delta_wolff@kunzespencer.co", "password"=>"63DkCvEc", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"updated_at", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.8ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>25, :username=>"elmo.collins", :email=>"delta_wolff@kunzespencer.co", :password=>"63DkCvEc", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:39:54.194Z", :updated_at=>"2017-07-28T07:39:54.194Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:39:54.112403') AND "client_counters"."location_id" IN (17, 18, 19) GROUP BY client_id, phone_number ORDER BY updated_at desc, visits desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (11, 12)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (11, 12)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:39:54.112403') AND "client_counters"."location_id" IN (17, 18, 19) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 32ms [30m(Views: 0.6ms | ActiveRecord: 9.0ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "363-303-1973 x9605"], ["created_at", "2017-07-28 07:39:54.246601"], ["updated_at", "2017-07-28 07:39:54.246601"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Alphazap"], ["created_at", "2017-07-28 07:39:54.253676"], ["updated_at", "2017-07-28 07:39:54.253676"], ["local_path", "http://lowe.name/darrick.wiegand"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Matsoft"], ["title_ru", "Название20"], ["created_at", "2017-07-28 07:39:54.257567"], ["updated_at", "2017-07-28 07:39:54.257567"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 20[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_20[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 20) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>20, "title"=>"Alphazap", "created_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "local_path"=>"http://lowe.name/darrick.wiegand"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tres-zap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tres-zap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tres-Zap"], ["category_id", 20], ["slug", "tres-zap"], ["created_at", "2017-07-28 07:39:54.269638"], ["updated_at", "2017-07-28 07:39:54.269638"], ["layout_id", 20]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "kimberly"], ["email", "esmeralda.kunde@stokes.co"], ["password", "DyOuTyViH7Xh"], ["created_at", "2017-07-28 07:39:54.275028"], ["updated_at", "2017-07-28 07:39:54.275028"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "sit-dolorem"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Cardify"], ["phone", "830.849.8590"], ["address", "1038 Elna Lock"], ["url", "http://ortiz.name/libby_graham"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://fisherflatley.com/harmon.swaniawski"], ["auth_expiration_time", 900], ["slug", "sit-dolorem"], ["brand_id", 20], ["user_id", 26], ["created_at", "2017-07-28 07:39:54.281247"], ["updated_at", "2017-07-28 07:39:54.281247"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 13], ["location_id", 20], ["counter", 2], ["created_at", "2017-07-28 07:39:54.286180"], ["updated_at", "2017-07-28 07:39:54.286180"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(336) 002-8695 x9831"], ["created_at", "2017-07-28 07:39:54.289967"], ["updated_at", "2017-07-28 07:39:54.289967"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Stronghold"], ["created_at", "2017-07-28 07:39:54.296248"], ["updated_at", "2017-07-28 07:39:54.296248"], ["local_path", "http://prohaska.info/jose.rolfson"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Flexidy"], ["title_ru", "Название21"], ["created_at", "2017-07-28 07:39:54.300047"], ["updated_at", "2017-07-28 07:39:54.300047"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_21[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 21) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>21, "title"=>"Stronghold", "created_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "local_path"=>"http://prohaska.info/jose.rolfson"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zathin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zathin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zathin"], ["category_id", 21], ["slug", "zathin"], ["created_at", "2017-07-28 07:39:54.310769"], ["updated_at", "2017-07-28 07:39:54.310769"], ["layout_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jarod"], ["email", "ellis@swiftcarroll.name"], ["password", "IsFxAb7tX4N7F187"], ["created_at", "2017-07-28 07:39:54.315509"], ["updated_at", "2017-07-28 07:39:54.315509"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "alias-aut"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Alpha"], ["phone", "639-834-3146"], ["address", "8859 Flatley Glen"], ["url", "http://harveyoconner.info/werner"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://oreilly.name/eino.hilpert"], ["auth_expiration_time", 900], ["slug", "alias-aut"], ["brand_id", 21], ["user_id", 27], ["created_at", "2017-07-28 07:39:54.321197"], ["updated_at", "2017-07-28 07:39:54.321197"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 14], ["location_id", 21], ["counter", 9], ["created_at", "2017-07-28 07:39:54.325746"], ["updated_at", "2017-07-28 07:39:54.325746"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Mat Lam Tam"], ["created_at", "2017-07-28 07:39:54.331977"], ["updated_at", "2017-07-28 07:39:54.331977"], ["local_path", "http://ankunding.biz/leanna_durgan"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Hatity"], ["title_ru", "Название22"], ["created_at", "2017-07-28 07:39:54.335785"], ["updated_at", "2017-07-28 07:39:54.335785"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 22[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_22[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 22) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>22, "title"=>"Mat Lam Tam", "created_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "local_path"=>"http://ankunding.biz/leanna_durgan"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "redhold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "redhold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Redhold"], ["category_id", 22], ["slug", "redhold"], ["created_at", "2017-07-28 07:39:54.346670"], ["updated_at", "2017-07-28 07:39:54.346670"], ["layout_id", 22]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "bernita_sporer"], ["email", "germaine_macejkovic@hamill.io"], ["password", "Ln292v47"], ["created_at", "2017-07-28 07:39:54.351346"], ["updated_at", "2017-07-28 07:39:54.351346"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "labore_quisquam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bitchip"], ["phone", "(197) 396-3458"], ["address", "6362 Renner Creek"], ["url", "http://cartwright.name/rusty.gorczany"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://steuber.com/julius"], ["auth_expiration_time", 900], ["slug", "labore_quisquam"], ["brand_id", 22], ["user_id", 28], ["created_at", "2017-07-28 07:39:54.357077"], ["updated_at", "2017-07-28 07:39:54.357077"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 13], ["location_id", 22], ["counter", 6], ["created_at", "2017-07-28 07:39:54.361802"], ["updated_at", "2017-07-28 07:39:54.361802"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "996-565-6271 x21004"], ["created_at", "2017-07-28 07:39:54.366004"], ["updated_at", "2017-07-28 07:39:54.366004"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bitwolf"], ["created_at", "2017-07-28 07:39:54.371924"], ["updated_at", "2017-07-28 07:39:54.371924"], ["local_path", "http://green.co/deie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Home Ing"], ["title_ru", "Название23"], ["created_at", "2017-07-28 07:39:54.375568"], ["updated_at", "2017-07-28 07:39:54.375568"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 23[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_23[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 23) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>23, "title"=>"Bitwolf", "created_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "local_path"=>"http://green.co/deie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cardify"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cardify"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Cardify"], ["category_id", 23], ["slug", "cardify"], ["created_at", "2017-07-28 07:39:54.400726"], ["updated_at", "2017-07-28 07:39:54.400726"], ["layout_id", 23]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lorenza"], ["email", "damion@larsongleason.io"], ["password", "Eq9cMjOxTiLh58H"], ["created_at", "2017-07-28 07:39:54.405694"], ["updated_at", "2017-07-28 07:39:54.405694"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et_exercitationem"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Vagram"], ["phone", "(842) 657-4349"], ["address", "572 Verna Crossing"], ["url", "http://littel.net/fleta"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://morar.biz/triston.tillman"], ["auth_expiration_time", 900], ["slug", "et_exercitationem"], ["brand_id", 23], ["user_id", 29], ["created_at", "2017-07-28 07:39:54.411788"], ["updated_at", "2017-07-28 07:39:54.411788"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 15], ["location_id", 23], ["counter", 5], ["created_at", "2017-06-26 07:39:54.364167"], ["updated_at", "2017-06-26 07:39:54.364279"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "ulises"], ["email", "toni@stanton.org"], ["password", "Vl0t1s4mH2Oy7k1"], ["role_cd", 3], ["created_at", "2017-07-28 07:39:54.421757"], ["updated_at", "2017-07-28 07:39:54.421757"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:54 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"ulises", "email"=>"toni@stanton.org", "password"=>"Vl0t1s4mH2Oy7k1", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"ulises", :email=>"toni@stanton.org", :password=>"Vl0t1s4mH2Oy7k1", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"toni@stanton.org", "password"=>"Vl0t1s4mH2Oy7k1"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "ulises"], ["email", "toni@stanton.org"], ["password", "Vl0t1s4mH2Oy7k1"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 30, username: "ulises", email: "toni@stanton.org", password: "Vl0t1s4mH2Oy7k1", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:39:54", updated_at: "2017-07-28 07:39:54", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 30[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=visits30&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:54 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits30", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 30) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>30, "username"=>"ulises", "email"=>"toni@stanton.org", "password"=>"Vl0t1s4mH2Oy7k1", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits30", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.7ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>30, :username=>"ulises", :email=>"toni@stanton.org", :password=>"Vl0t1s4mH2Oy7k1", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:39:54.421Z", :updated_at=>"2017-07-28T07:39:54.421Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-06-26 07:39:54.364167') AND "client_counters"."location_id" IN (20, 21, 22, 23) GROUP BY client_id, phone_number ORDER BY visits30 asc, updated_at desc, visits desc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (15, 14, 13)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (13, 14, 15)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-06-26 07:39:54.364167') AND "client_counters"."location_id" IN (20, 21, 22, 23) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 34ms [30m(Views: 0.9ms | ActiveRecord: 9.0ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "darryl.moore"], ["email", "demario.bins@schaefer.net"], ["password", "RlHpDzRm8oYi6e5"], ["created_at", "2017-07-28 07:39:54.477845"], ["updated_at", "2017-07-28 07:39:54.477845"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "clyde_mosciski"], ["email", "reie@leuschkeprohaska.co"], ["password", "0oJz1o3x35O"], ["created_at", "2017-07-28 07:39:54.506653"], ["updated_at", "2017-07-28 07:39:54.506653"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "autumn.sawayn"], ["email", "jacky@prohaskakuvalis.io"], ["password", "Jk902i6lAcF"], ["created_at", "2017-07-28 07:39:54.524796"], ["updated_at", "2017-07-28 07:39:54.524796"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "adrian.nikolaus"], ["email", "antonina@hills.name"], ["password", "D41i7kUcD"], ["created_at", "2017-07-28 07:39:54.535164"], ["updated_at", "2017-07-28 07:39:54.535164"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "dorothea_nicolas"], ["email", "demetrius@welchgaylord.co"], ["password", "QwEkP93gVrQtG82"], ["created_at", "2017-07-28 07:39:54.545162"], ["updated_at", "2017-07-28 07:39:54.545162"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-947-746-0688"], ["created_at", "2017-07-28 07:39:54.577518"], ["updated_at", "2017-07-28 07:39:54.577518"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "sister_dickens"], ["email", "lorna@oberbrunnerhirthe.biz"], ["password", "F4KrLqM9Tg1"], ["created_at", "2017-07-28 07:39:54.583221"], ["updated_at", "2017-07-28 07:39:54.583221"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "211441"], ["username", "royal"], ["image", "http://facebook.com/img/royal.jpg"], ["profile", "https://facebook.com/royal"], ["email", "cornell.zulauf@hackettturcotte.biz"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 16], ["user_id", 36], ["created_at", "2017-07-28 07:39:54.588376"], ["updated_at", "2017-07-28 07:39:54.588376"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Y-find"], ["created_at", "2017-07-28 07:39:54.596585"], ["updated_at", "2017-07-28 07:39:54.596585"], ["local_path", "http://lubowitz.co/domenic.cummerata"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Y-find"], ["title_ru", "Название24"], ["created_at", "2017-07-28 07:39:54.600704"], ["updated_at", "2017-07-28 07:39:54.600704"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 24[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_24[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 24) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>24, "title"=>"Y-find", "created_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "local_path"=>"http://lubowitz.co/domenic.cummerata"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zamit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zamit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zamit"], ["category_id", 24], ["slug", "zamit"], ["created_at", "2017-07-28 07:39:54.613658"], ["updated_at", "2017-07-28 07:39:54.613658"], ["layout_id", 24]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "sit.placeat"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zontrax"], ["phone", "1-225-446-8443"], ["address", "82748 Prosacco Rest"], ["url", "http://naderpouros.co/alvina"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://corwinboyer.biz/drew"], ["auth_expiration_time", 900], ["slug", "sit.placeat"], ["brand_id", 24], ["user_id", 36], ["created_at", "2017-07-28 07:39:54.619424"], ["updated_at", "2017-07-28 07:39:54.619424"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Treeflex"], ["created_at", "2017-07-28 07:39:54.667964"], ["updated_at", "2017-07-28 07:39:54.667964"], ["local_path", "http://leuschke.net/malika.cain"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Pannier"], ["title_ru", "Название25"], ["created_at", "2017-07-28 07:39:54.672140"], ["updated_at", "2017-07-28 07:39:54.672140"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_25[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 25) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>25, "title"=>"Treeflex", "created_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "local_path"=>"http://leuschke.net/malika.cain"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "temp"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "temp"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Temp"], ["category_id", 25], ["slug", "temp"], ["created_at", "2017-07-28 07:39:54.683600"], ["updated_at", "2017-07-28 07:39:54.683600"], ["layout_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "chester"], ["email", "conner.weber@abshire.co"], ["password", "W54q9eDk5wGh3"], ["created_at", "2017-07-28 07:39:54.688656"], ["updated_at", "2017-07-28 07:39:54.688656"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "enim.laudantium"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bytecard"], ["phone", "(211) 032-6852"], ["address", "5867 Bryana Corner"], ["url", "http://brakus.io/caie"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hoegermoore.com/adam"], ["auth_expiration_time", 900], ["slug", "enim.laudantium"], ["brand_id", 25], ["user_id", 37], ["created_at", "2017-07-28 07:39:54.694415"], ["updated_at", "2017-07-28 07:39:54.694415"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "dianna"], ["email", "dale_stroman@bosco.name"], ["password", "AdWmZs45N79cJoZt"], ["created_at", "2017-07-28 07:39:54.700032"], ["updated_at", "2017-07-28 07:39:54.700032"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5331"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.6ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5331"], ["comment", "comment 11"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "203.187.99.72"], ["router_admin_ip", "44.187.44.179"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "89"], ["status", "t"], ["location_id", 25], ["user_id", 38], ["created_at", "2017-07-28 07:39:54.708562"], ["updated_at", "2017-07-28 07:39:54.708562"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5331"], ["id", 1], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 1], ["serial", "643705CA5E36/5331"], ["comment", "comment 11"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "203.187.99.72"], ["router_admin_ip", "44.187.44.179"], ["admin_password", "0f5db3609009543c"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "1"], ["status", "t"], ["location_id", 25], ["user_id", 38], ["created_at", "2017-07-28 07:39:54.708562"], ["updated_at", "2017-07-28 07:39:54.708562"], ["id", 1]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: bcdb3d4a-415e-4ece-b3d1-5cc64bcc1329) to Async(routers) with arguments: #<GlobalID:0x007fc0e5891310 @uri=#<URI::GID gid://wifi-management/Router/1>>
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 420b61cc-7d1b-46cc-b3b9-fa0e174964df) to Async(routers) with arguments: #<GlobalID:0x007fc0e5891310 @uri=#<URI::GID gid://wifi-management/Router/1>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.4ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (2.1ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 1], ["provider", "instagram"], ["location_id", 24], ["router_id", 1], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:54 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"sister_dickens", "email"=>"lorna@oberbrunnerhirthe.biz", "password"=>"F4KrLqM9Tg1", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"sister_dickens", :email=>"lorna@oberbrunnerhirthe.biz", :password=>"F4KrLqM9Tg1", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"lorna@oberbrunnerhirthe.biz", "password"=>"F4KrLqM9Tg1"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "sister_dickens"], ["email", "lorna@oberbrunnerhirthe.biz"], ["password", "F4KrLqM9Tg1"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 36, username: "sister_dickens", email: "lorna@oberbrunnerhirthe.biz", password: "F4KrLqM9Tg1", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:39:54", updated_at: "2017-07-28 07:39:54", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 36[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/stats/time_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:54 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#time_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_36[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 36) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>36, "username"=>"sister_dickens", "email"=>"lorna@oberbrunnerhirthe.biz", "password"=>"F4KrLqM9Tg1", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"time_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_36[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_36[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>36, :username=>"sister_dickens", :email=>"lorna@oberbrunnerhirthe.biz", :password=>"F4KrLqM9Tg1", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:39:54.583Z", :updated_at=>"2017-07-28T07:39:54.583Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 36[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(24)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 30ms [30m(Views: 1.3ms | ActiveRecord: 6.9ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "972.578.5409"], ["created_at", "2017-07-28 07:39:54.869293"], ["updated_at", "2017-07-28 07:39:54.869293"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "beverly.will"], ["email", "briana@purdy.co"], ["password", "CqP9IxShCyFwQlO0"], ["created_at", "2017-07-28 07:39:54.874771"], ["updated_at", "2017-07-28 07:39:54.874771"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "62459"], ["username", "nathanael"], ["image", "http://instagram.com/img/nathanael.jpg"], ["profile", "https://instagram.com/nathanael"], ["email", "helene.white@sauer.org"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 17], ["user_id", 39], ["created_at", "2017-07-28 07:39:54.879696"], ["updated_at", "2017-07-28 07:39:54.879696"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bamity"], ["created_at", "2017-07-28 07:39:54.887539"], ["updated_at", "2017-07-28 07:39:54.887539"], ["local_path", "http://ondricka.io/abelardo_kuhn"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Quo Lux"], ["title_ru", "Название26"], ["created_at", "2017-07-28 07:39:54.891762"], ["updated_at", "2017-07-28 07:39:54.891762"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 26[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_26[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 26) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>26, "title"=>"Bamity", "created_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "local_path"=>"http://ondricka.io/abelardo_kuhn"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-find"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-find"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Y-find"], ["category_id", 26], ["slug", "y-find"], ["created_at", "2017-07-28 07:39:54.904671"], ["updated_at", "2017-07-28 07:39:54.904671"], ["layout_id", 26]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "adipisci-sit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Fixflex"], ["phone", "796.526.6623"], ["address", "810 Cristian Glen"], ["url", "http://bartoletti.name/alexandro.huel"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://sawayn.io/arnulfo.jerde"], ["auth_expiration_time", 900], ["slug", "adipisci-sit"], ["brand_id", 26], ["user_id", 39], ["created_at", "2017-07-28 07:39:54.911399"], ["updated_at", "2017-07-28 07:39:54.911399"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Cardify"], ["created_at", "2017-07-28 07:39:54.919778"], ["updated_at", "2017-07-28 07:39:54.919778"], ["local_path", "http://wisozk.org/demarcus.dare"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zontrax"], ["title_ru", "Название27"], ["created_at", "2017-07-28 07:39:54.923517"], ["updated_at", "2017-07-28 07:39:54.923517"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 27[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_27[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 27) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>27, "title"=>"Cardify", "created_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "local_path"=>"http://wisozk.org/demarcus.dare"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "overhold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "overhold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Overhold"], ["category_id", 27], ["slug", "overhold"], ["created_at", "2017-07-28 07:39:54.934644"], ["updated_at", "2017-07-28 07:39:54.934644"], ["layout_id", 27]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "orion_wiza"], ["email", "tavares@cruickshankleannon.co"], ["password", "ZoHr3f7s9a6p9a6"], ["created_at", "2017-07-28 07:39:54.939556"], ["updated_at", "2017-07-28 07:39:54.939556"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et-mollitia"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Latlux"], ["phone", "857-829-3950"], ["address", "89992 Waelchi Parks"], ["url", "http://goldner.info/elliott"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://jones.biz/mercedes_will"], ["auth_expiration_time", 900], ["slug", "et-mollitia"], ["brand_id", 27], ["user_id", 40], ["created_at", "2017-07-28 07:39:54.945661"], ["updated_at", "2017-07-28 07:39:54.945661"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "bailey_harber"], ["email", "amina@towne.biz"], ["password", "NsO88iQy1a4n"], ["created_at", "2017-07-28 07:39:54.950827"], ["updated_at", "2017-07-28 07:39:54.950827"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5332"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5332"], ["comment", "comment 12"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "44.181.64.96"], ["router_admin_ip", "66.192.148.212"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "474"], ["status", "t"], ["location_id", 27], ["user_id", 41], ["created_at", "2017-07-28 07:39:54.956641"], ["updated_at", "2017-07-28 07:39:54.956641"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5332"], ["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 2], ["serial", "643705CA5E36/5332"], ["comment", "comment 12"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "44.181.64.96"], ["router_admin_ip", "66.192.148.212"], ["admin_password", "6a24b099aab78936"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "2"], ["status", "t"], ["location_id", 27], ["user_id", 41], ["created_at", "2017-07-28 07:39:54.956641"], ["updated_at", "2017-07-28 07:39:54.956641"], ["id", 2]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 896ff171-e4ee-461a-9484-c971583c6bbf) to Async(routers) with arguments: #<GlobalID:0x007fc0e3457800 @uri=#<URI::GID gid://wifi-management/Router/2>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 67a8a503-54f7-43ec-aa5a-b2abef825130) to Async(routers) with arguments: #<GlobalID:0x007fc0e3457800 @uri=#<URI::GID gid://wifi-management/Router/2>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 2], ["provider", "instagram"], ["location_id", 26], ["router_id", 2], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:55 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"beverly.will", "email"=>"briana@purdy.co", "password"=>"CqP9IxShCyFwQlO0", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"beverly.will", :email=>"briana@purdy.co", :password=>"CqP9IxShCyFwQlO0", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"briana@purdy.co", "password"=>"CqP9IxShCyFwQlO0"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "beverly.will"], ["email", "briana@purdy.co"], ["password", "CqP9IxShCyFwQlO0"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 39, username: "beverly.will", email: "briana@purdy.co", password: "CqP9IxShCyFwQlO0", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:39:54", updated_at: "2017-07-28 07:39:54", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 39[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/stats/authorizations" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:55 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#authorizations[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 39) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>39, "username"=>"beverly.will", "email"=>"briana@purdy.co", "password"=>"CqP9IxShCyFwQlO0", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:54 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"authorizations"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>39, :username=>"beverly.will", :email=>"briana@purdy.co", :password=>"CqP9IxShCyFwQlO0", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:39:54.874Z", :updated_at=>"2017-07-28T07:39:54.874Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 39[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[34mSELECT COUNT("social_logs"."id") AS count_id, date_trunc('hour', created_at) AS date_trunc_hour_created_at FROM "social_logs" WHERE "social_logs"."location_id" = 26 AND ("social_logs"."created_at" BETWEEN $1 AND $2) GROUP BY date_trunc('hour', created_at) ORDER BY date_trunc_hour_created_at[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 26ms [30m(Views: 0.3ms | ActiveRecord: 7.1ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "366-009-2338 x2058"], ["created_at", "2017-07-28 07:39:55.165386"], ["updated_at", "2017-07-28 07:39:55.165386"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "mary"], ["email", "daphne.gerhold@larkin.info"], ["password", "K6H2K6StD"], ["created_at", "2017-07-28 07:39:55.170208"], ["updated_at", "2017-07-28 07:39:55.170208"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "589585"], ["username", "sharon"], ["image", "http://twitter.com/img/sharon.jpg"], ["profile", "https://twitter.com/sharon"], ["email", "diamond@ankunding.info"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 18], ["user_id", 42], ["created_at", "2017-07-28 07:39:55.174313"], ["updated_at", "2017-07-28 07:39:55.174313"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Cardify"], ["created_at", "2017-07-28 07:39:55.181513"], ["updated_at", "2017-07-28 07:39:55.181513"], ["local_path", "http://langosh.org/serena"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Stim"], ["title_ru", "Название28"], ["created_at", "2017-07-28 07:39:55.185252"], ["updated_at", "2017-07-28 07:39:55.185252"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 28[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_28[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 28) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>28, "title"=>"Cardify", "created_at"=>Fri, 28 Jul 2017 07:39:55 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:55 UTC +00:00, "local_path"=>"http://langosh.org/serena"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "vagram"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "vagram"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Vagram"], ["category_id", 28], ["slug", "vagram"], ["created_at", "2017-07-28 07:39:55.196400"], ["updated_at", "2017-07-28 07:39:55.196400"], ["layout_id", 28]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "consequatur.voluptate"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Voltsillam"], ["phone", "1-884-932-6615"], ["address", "37819 Koelpin Extension"], ["url", "http://pfannerstill.net/stephany.howell"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://lindgren.io/raul"], ["auth_expiration_time", 900], ["slug", "consequatur.voluptate"], ["brand_id", 28], ["user_id", 42], ["created_at", "2017-07-28 07:39:55.202113"], ["updated_at", "2017-07-28 07:39:55.202113"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Andalax"], ["created_at", "2017-07-28 07:39:55.210524"], ["updated_at", "2017-07-28 07:39:55.210524"], ["local_path", "http://lefflerrohan.info/philip"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Vagram"], ["title_ru", "Название29"], ["created_at", "2017-07-28 07:39:55.214238"], ["updated_at", "2017-07-28 07:39:55.214238"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 29[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_29[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 29) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>29, "title"=>"Andalax", "created_at"=>Fri, 28 Jul 2017 07:39:55 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:55 UTC +00:00, "local_path"=>"http://lefflerrohan.info/philip"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zathin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zathin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zathin"], ["category_id", 29], ["slug", "zathin"], ["created_at", "2017-07-28 07:39:55.225102"], ["updated_at", "2017-07-28 07:39:55.225102"], ["layout_id", 29]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "gwen_franecki"], ["email", "luis@mcclure.co"], ["password", "Ep4wUvD4AyDbO6Th"], ["created_at", "2017-07-28 07:39:55.229716"], ["updated_at", "2017-07-28 07:39:55.229716"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "velit_minus"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Sonsing"], ["phone", "1-769-305-7189"], ["address", "6122 Price Haven"], ["url", "http://gorczany.biz/geraldine"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hackett.info/phoebe_lehner"], ["auth_expiration_time", 900], ["slug", "velit_minus"], ["brand_id", 29], ["user_id", 43], ["created_at", "2017-07-28 07:39:55.235588"], ["updated_at", "2017-07-28 07:39:55.235588"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lola"], ["email", "wilford.reinger@fisher.co"], ["password", "LjYy7s4dRy997sPp"], ["created_at", "2017-07-28 07:39:55.240930"], ["updated_at", "2017-07-28 07:39:55.240930"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5333"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5333"], ["comment", "comment 13"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "74.167.175.42"], ["router_admin_ip", "178.248.218.16"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "727"], ["status", "t"], ["location_id", 29], ["user_id", 44], ["created_at", "2017-07-28 07:39:55.246899"], ["updated_at", "2017-07-28 07:39:55.246899"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5333"], ["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 3], ["serial", "643705CA5E36/5333"], ["comment", "comment 13"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "74.167.175.42"], ["router_admin_ip", "178.248.218.16"], ["admin_password", "f0b04c62de1784e2"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "3"], ["status", "t"], ["location_id", 29], ["user_id", 44], ["created_at", "2017-07-28 07:39:55.246899"], ["updated_at", "2017-07-28 07:39:55.246899"], ["id", 3]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 460acbb0-ef29-4a35-87f0-2dd3917c252d) to Async(routers) with arguments: #<GlobalID:0x007fc0e4192218 @uri=#<URI::GID gid://wifi-management/Router/3>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: e6ddb219-a5e1-49c7-839a-160db5ae3cfd) to Async(routers) with arguments: #<GlobalID:0x007fc0e4192218 @uri=#<URI::GID gid://wifi-management/Router/3>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 3], ["provider", "instagram"], ["location_id", 28], ["router_id", 3], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:55 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"mary", "email"=>"daphne.gerhold@larkin.info", "password"=>"K6H2K6StD", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"mary", :email=>"daphne.gerhold@larkin.info", :password=>"K6H2K6StD", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"daphne.gerhold@larkin.info", "password"=>"K6H2K6StD"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "mary"], ["email", "daphne.gerhold@larkin.info"], ["password", "K6H2K6StD"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 42, username: "mary", email: "daphne.gerhold@larkin.info", password: "K6H2K6StD", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:39:55", updated_at: "2017-07-28 07:39:55", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 42[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/social_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:55 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#social_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_42[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 42) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>42, "username"=>"mary", "email"=>"daphne.gerhold@larkin.info", "password"=>"K6H2K6StD", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:39:55 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:55 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"social_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_42[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_42[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>42, :username=>"mary", :email=>"daphne.gerhold@larkin.info", :password=>"K6H2K6StD", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:39:55.170Z", :updated_at=>"2017-07-28T07:39:55.170Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 42[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" = 28 AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 25ms [30m(Views: 1.3ms | ActiveRecord: 6.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "850.842.5457"], ["created_at", "2017-07-28 07:39:55.407413"], ["updated_at", "2017-07-28 07:39:55.407413"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "irma.murazik"], ["email", "sammy@sipes.org"], ["password", "PtHbVtLaO5Y3C"], ["created_at", "2017-07-28 07:39:55.412964"], ["updated_at", "2017-07-28 07:39:55.412964"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "413669"], ["username", "leann"], ["image", "http://twitter.com/img/leann.jpg"], ["profile", "https://twitter.com/leann"], ["email", "noemi_haley@macgyver.info"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 19], ["user_id", 45], ["created_at", "2017-07-28 07:39:55.417777"], ["updated_at", "2017-07-28 07:39:55.417777"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Biodex"], ["created_at", "2017-07-28 07:39:55.425598"], ["updated_at", "2017-07-28 07:39:55.425598"], ["local_path", "http://moorehomenick.io/betsy"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bigtax"], ["title_ru", "Название30"], ["created_at", "2017-07-28 07:39:55.429793"], ["updated_at", "2017-07-28 07:39:55.429793"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_30[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 30) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>30, "title"=>"Biodex", "created_at"=>Fri, 28 Jul 2017 07:39:55 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:55 UTC +00:00, "local_path"=>"http://moorehomenick.io/betsy"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "ventosanzap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "ventosanzap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Ventosanzap"], ["category_id", 30], ["slug", "ventosanzap"], ["created_at", "2017-07-28 07:39:55.442657"], ["updated_at", "2017-07-28 07:39:55.442657"], ["layout_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.5ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "eos-sapiente"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Flexidy"], ["phone", "535-013-5272"], ["address", "138 Spencer Branch"], ["url", "http://cummings.org/emelia_roberts"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kuhicschuppe.io/liana_herman"], ["auth_expiration_time", 900], ["slug", "eos-sapiente"], ["brand_id", 30], ["user_id", 45], ["created_at", "2017-07-28 07:39:55.449625"], ["updated_at", "2017-07-28 07:39:55.449625"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Y-Solowarm"], ["created_at", "2017-07-28 07:39:55.458526"], ["updated_at", "2017-07-28 07:39:55.458526"], ["local_path", "http://toy.com/amira"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Sonsing"], ["title_ru", "Название31"], ["created_at", "2017-07-28 07:39:55.462312"], ["updated_at", "2017-07-28 07:39:55.462312"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 31[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_31[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 31) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>31, "title"=>"Y-Solowarm", "created_at"=>Fri, 28 Jul 2017 07:39:55 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:55 UTC +00:00, "local_path"=>"http://toy.com/amira"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonair"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonair"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Sonair"], ["category_id", 31], ["slug", "sonair"], ["created_at", "2017-07-28 07:39:55.473647"], ["updated_at", "2017-07-28 07:39:55.473647"], ["layout_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "nat"], ["email", "isidro@schmidtrice.net"], ["password", "RtEc72Y3HmSyK"], ["created_at", "2017-07-28 07:39:55.478567"], ["updated_at", "2017-07-28 07:39:55.478567"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "occaecati-pariatur"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Rank"], ["phone", "126-190-1482"], ["address", "6575 Gibson Mission"], ["url", "http://reichel.net/peyton.grady"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://littelgottlieb.org/toney.renner"], ["auth_expiration_time", 900], ["slug", "occaecati-pariatur"], ["brand_id", 31], ["user_id", 46], ["created_at", "2017-07-28 07:39:55.484657"], ["updated_at", "2017-07-28 07:39:55.484657"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "bulah.medhurst"], ["email", "adolphus@marvin.biz"], ["password", "JvOhP6YuN5AtBe3m"], ["created_at", "2017-07-28 07:39:55.489952"], ["updated_at", "2017-07-28 07:39:55.489952"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5334"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5334"], ["comment", "comment 14"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "198.185.59.154"], ["router_admin_ip", "62.198.130.149"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "842"], ["status", "t"], ["location_id", 31], ["user_id", 47], ["created_at", "2017-07-28 07:39:55.496044"], ["updated_at", "2017-07-28 07:39:55.496044"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5334"], ["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 4], ["serial", "643705CA5E36/5334"], ["comment", "comment 14"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "198.185.59.154"], ["router_admin_ip", "62.198.130.149"], ["admin_password", "bf417a01bf5d4dad"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "4"], ["status", "t"], ["location_id", 31], ["user_id", 47], ["created_at", "2017-07-28 07:39:55.496044"], ["updated_at", "2017-07-28 07:39:55.496044"], ["id", 4]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: a7a7a148-35aa-47d5-aec0-dbf7a3b19d37) to Async(routers) with arguments: #<GlobalID:0x007fc0e297ac20 @uri=#<URI::GID gid://wifi-management/Router/4>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 8a25388a-dc6d-4707-9e65-597bba341c91) to Async(routers) with arguments: #<GlobalID:0x007fc0e297ac20 @uri=#<URI::GID gid://wifi-management/Router/4>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 4], ["provider", "instagram"], ["location_id", 30], ["router_id", 4], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(942) 595-9058"], ["created_at", "2017-07-28 07:39:55.915651"], ["updated_at", "2017-07-28 07:39:55.915651"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "evan"], ["email", "tod@turner.net"], ["password", "UwW35y7kRx"], ["created_at", "2017-07-28 07:39:55.920630"], ["updated_at", "2017-07-28 07:39:55.920630"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "380373"], ["username", "chaim"], ["image", "http://vk.com/img/chaim.jpg"], ["profile", "https://vk.com/chaim"], ["email", "veronica@lednerohara.name"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 20], ["user_id", 48], ["created_at", "2017-07-28 07:39:55.924858"], ["updated_at", "2017-07-28 07:39:55.924858"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Greenlam"], ["created_at", "2017-07-28 07:39:55.932087"], ["updated_at", "2017-07-28 07:39:55.932087"], ["local_path", "http://bergnaum.net/gus"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Prodder"], ["title_ru", "Название32"], ["created_at", "2017-07-28 07:39:55.936039"], ["updated_at", "2017-07-28 07:39:55.936039"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 32[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_32[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 32) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>32, "title"=>"Greenlam", "created_at"=>Fri, 28 Jul 2017 07:39:55 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:55 UTC +00:00, "local_path"=>"http://bergnaum.net/gus"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cookley"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cookley"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Cookley"], ["category_id", 32], ["slug", "cookley"], ["created_at", "2017-07-28 07:39:55.947533"], ["updated_at", "2017-07-28 07:39:55.947533"], ["layout_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "id-sapiente"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Mat Lam Tam"], ["phone", "(446) 844-7952"], ["address", "67751 Ramiro Highway"], ["url", "http://towne.com/dave_walker"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://dooleyschuster.info/torey_nikolaus"], ["auth_expiration_time", 900], ["slug", "id-sapiente"], ["brand_id", 32], ["user_id", 48], ["created_at", "2017-07-28 07:39:55.953834"], ["updated_at", "2017-07-28 07:39:55.953834"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Otcom"], ["created_at", "2017-07-28 07:39:55.962464"], ["updated_at", "2017-07-28 07:39:55.962464"], ["local_path", "http://tromp.io/una"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Hatity"], ["title_ru", "Название33"], ["created_at", "2017-07-28 07:39:55.966318"], ["updated_at", "2017-07-28 07:39:55.966318"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 33[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_33[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 33) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>33, "title"=>"Otcom", "created_at"=>Fri, 28 Jul 2017 07:39:55 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:55 UTC +00:00, "local_path"=>"http://tromp.io/una"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "asoka"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "asoka"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Asoka"], ["category_id", 33], ["slug", "asoka"], ["created_at", "2017-07-28 07:39:55.977460"], ["updated_at", "2017-07-28 07:39:55.977460"], ["layout_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jolie.hirthe"], ["email", "celine@baumbach.com"], ["password", "Cu3m889790UcT6J"], ["created_at", "2017-07-28 07:39:55.982446"], ["updated_at", "2017-07-28 07:39:55.982446"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quasi_perferendis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Hatity"], ["phone", "1-811-013-9563"], ["address", "41951 Maynard Prairie"], ["url", "http://christiansen.org/queenie"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://johns.biz/sydnie"], ["auth_expiration_time", 900], ["slug", "quasi_perferendis"], ["brand_id", 33], ["user_id", 49], ["created_at", "2017-07-28 07:39:55.988357"], ["updated_at", "2017-07-28 07:39:55.988357"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lorenzo.effertz"], ["email", "nellie@moorejohnston.biz"], ["password", "Rt447bF6Vk67"], ["created_at", "2017-07-28 07:39:55.993907"], ["updated_at", "2017-07-28 07:39:55.993907"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5335"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5335"], ["comment", "comment 15"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "74.203.68.114"], ["router_admin_ip", "94.86.101.56"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "220"], ["status", "t"], ["location_id", 33], ["user_id", 50], ["created_at", "2017-07-28 07:39:55.999613"], ["updated_at", "2017-07-28 07:39:55.999613"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5335"], ["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 5], ["serial", "643705CA5E36/5335"], ["comment", "comment 15"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "74.203.68.114"], ["router_admin_ip", "94.86.101.56"], ["admin_password", "f0e5e87d857039a9"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "5"], ["status", "t"], ["location_id", 33], ["user_id", 50], ["created_at", "2017-07-28 07:39:55.999613"], ["updated_at", "2017-07-28 07:39:55.999613"], ["id", 5]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 0a1e89c5-ea37-48a2-bc65-f4ccc37d4e0e) to Async(routers) with arguments: #<GlobalID:0x007fc0dcb69a28 @uri=#<URI::GID gid://wifi-management/Router/5>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: b04f48a5-3e4e-4b3d-8c59-6a5c66affa86) to Async(routers) with arguments: #<GlobalID:0x007fc0dcb69a28 @uri=#<URI::GID gid://wifi-management/Router/5>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 5], ["provider", "instagram"], ["location_id", 32], ["router_id", 5], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:56 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"evan", "email"=>"tod@turner.net", "password"=>"UwW35y7kRx", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"evan", :email=>"tod@turner.net", :password=>"UwW35y7kRx", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"tod@turner.net", "password"=>"UwW35y7kRx"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "evan"], ["email", "tod@turner.net"], ["password", "UwW35y7kRx"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 48, username: "evan", email: "tod@turner.net", password: "UwW35y7kRx", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:39:55", updated_at: "2017-07-28 07:39:55", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 48[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/locations_list" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:56 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#locations_list[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_48[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 48) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>48, "username"=>"evan", "email"=>"tod@turner.net", "password"=>"UwW35y7kRx", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:39:55 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:55 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"locations_list"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_48[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_48[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>48, :username=>"evan", :email=>"tod@turner.net", :password=>"UwW35y7kRx", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:39:55.920Z", :updated_at=>"2017-07-28T07:39:55.920Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 48[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Load (0.8ms)[0m  [1m[34mSELECT "locations".* FROM "locations" WHERE "locations"."user_id" = 48[0m
[INFO ] Completed [32m200 OK[0m in 23ms [30m(Views: 0.2ms | ActiveRecord: 5.6ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(373) 409-1464 x7185"], ["created_at", "2017-07-28 07:39:56.085052"], ["updated_at", "2017-07-28 07:39:56.085052"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "serena"], ["email", "giuseppe@ornwyman.net"], ["password", "G5LtH0C6X3FoA"], ["created_at", "2017-07-28 07:39:56.089799"], ["updated_at", "2017-07-28 07:39:56.089799"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "826766"], ["username", "boyd_keeling"], ["image", "http://vk.com/img/boyd_keeling.jpg"], ["profile", "https://vk.com/boyd_keeling"], ["email", "arnoldo@beahankuphal.name"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 21], ["user_id", 51], ["created_at", "2017-07-28 07:39:56.094069"], ["updated_at", "2017-07-28 07:39:56.094069"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Solarbreeze"], ["created_at", "2017-07-28 07:39:56.101457"], ["updated_at", "2017-07-28 07:39:56.101457"], ["local_path", "http://rau.name/boyd.ryan"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Voyatouch"], ["title_ru", "Название34"], ["created_at", "2017-07-28 07:39:56.105294"], ["updated_at", "2017-07-28 07:39:56.105294"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 34[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_34[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 34) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>34, "title"=>"Solarbreeze", "created_at"=>Fri, 28 Jul 2017 07:39:56 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:56 UTC +00:00, "local_path"=>"http://rau.name/boyd.ryan"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "namfix"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "namfix"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Namfix"], ["category_id", 34], ["slug", "namfix"], ["created_at", "2017-07-28 07:39:56.116846"], ["updated_at", "2017-07-28 07:39:56.116846"], ["layout_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "delectus.rerum"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Viva"], ["phone", "913-923-9312"], ["address", "9426 Olen Estates"], ["url", "http://waters.net/nickolas"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://osinskibarrows.co/nicholas"], ["auth_expiration_time", 900], ["slug", "delectus.rerum"], ["brand_id", 34], ["user_id", 51], ["created_at", "2017-07-28 07:39:56.122896"], ["updated_at", "2017-07-28 07:39:56.122896"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zamit"], ["created_at", "2017-07-28 07:39:56.131232"], ["updated_at", "2017-07-28 07:39:56.131232"], ["local_path", "http://schoen.org/hal.heathcote"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zontrax"], ["title_ru", "Название35"], ["created_at", "2017-07-28 07:39:56.134985"], ["updated_at", "2017-07-28 07:39:56.134985"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 35[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_35[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 35) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>35, "title"=>"Zamit", "created_at"=>Fri, 28 Jul 2017 07:39:56 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:56 UTC +00:00, "local_path"=>"http://schoen.org/hal.heathcote"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "duobam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "duobam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Duobam"], ["category_id", 35], ["slug", "duobam"], ["created_at", "2017-07-28 07:39:56.146007"], ["updated_at", "2017-07-28 07:39:56.146007"], ["layout_id", 35]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "orlo"], ["email", "claudia_schimmel@flatley.org"], ["password", "B78nNv6wJs8dUsP0"], ["created_at", "2017-07-28 07:39:56.150760"], ["updated_at", "2017-07-28 07:39:56.150760"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "dolor-provident"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bigtax"], ["phone", "417.044.6980"], ["address", "23766 Rath Hollow"], ["url", "http://keler.com/lavonne"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://predovic.info/shanny"], ["auth_expiration_time", 900], ["slug", "dolor-provident"], ["brand_id", 35], ["user_id", 52], ["created_at", "2017-07-28 07:39:56.157234"], ["updated_at", "2017-07-28 07:39:56.157234"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "salma"], ["email", "leonie@bogisich.co"], ["password", "FaTb0xO7LdX3Dr"], ["created_at", "2017-07-28 07:39:56.162746"], ["updated_at", "2017-07-28 07:39:56.162746"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5336"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5336"], ["comment", "comment 16"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "239.241.226.55"], ["router_admin_ip", "15.181.62.13"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "809"], ["status", "t"], ["location_id", 35], ["user_id", 53], ["created_at", "2017-07-28 07:39:56.168501"], ["updated_at", "2017-07-28 07:39:56.168501"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5336"], ["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 6], ["serial", "643705CA5E36/5336"], ["comment", "comment 16"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "239.241.226.55"], ["router_admin_ip", "15.181.62.13"], ["admin_password", "83551acb9e7355d6"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "6"], ["status", "t"], ["location_id", 35], ["user_id", 53], ["created_at", "2017-07-28 07:39:56.168501"], ["updated_at", "2017-07-28 07:39:56.168501"], ["id", 6]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: b2e96b22-aa48-4614-a20a-4ff45d78cc6b) to Async(routers) with arguments: #<GlobalID:0x007fc0df98d5d0 @uri=#<URI::GID gid://wifi-management/Router/6>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 7dc7c720-8368-40ee-90e7-f474c7d6f8cf) to Async(routers) with arguments: #<GlobalID:0x007fc0df98d5d0 @uri=#<URI::GID gid://wifi-management/Router/6>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 6], ["provider", "instagram"], ["location_id", 34], ["router_id", 6], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:56 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"serena", "email"=>"giuseppe@ornwyman.net", "password"=>"G5LtH0C6X3FoA", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"serena", :email=>"giuseppe@ornwyman.net", :password=>"G5LtH0C6X3FoA", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"giuseppe@ornwyman.net", "password"=>"G5LtH0C6X3FoA"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "serena"], ["email", "giuseppe@ornwyman.net"], ["password", "G5LtH0C6X3FoA"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 51, username: "serena", email: "giuseppe@ornwyman.net", password: "G5LtH0C6X3FoA", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:39:56", updated_at: "2017-07-28 07:39:56", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 51[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/all_connects" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:56 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#all_connects[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_51[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 51) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>51, "username"=>"serena", "email"=>"giuseppe@ornwyman.net", "password"=>"G5LtH0C6X3FoA", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:39:56 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:56 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"all_connects"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_51[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_51[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>51, :username=>"serena", :email=>"giuseppe@ornwyman.net", :password=>"G5LtH0C6X3FoA", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:39:56.089Z", :updated_at=>"2017-07-28T07:39:56.089Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 51[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 34[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 34 AND ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-06-28 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 34 AND ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 25ms [30m(Views: 0.2ms | ActiveRecord: 6.7ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "367-423-1221"], ["created_at", "2017-07-28 07:39:56.451944"], ["updated_at", "2017-07-28 07:39:56.451944"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "aurelie.kunde"], ["email", "ru.keebler@gerlachschuppe.com"], ["password", "Ni5i5v01JdXcNiO"], ["created_at", "2017-07-28 07:39:56.456768"], ["updated_at", "2017-07-28 07:39:56.456768"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "604239"], ["username", "arne"], ["image", "http://instagram.com/img/arne.jpg"], ["profile", "https://instagram.com/arne"], ["email", "eliane@crooks.info"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 22], ["user_id", 54], ["created_at", "2017-07-28 07:39:56.461255"], ["updated_at", "2017-07-28 07:39:56.461255"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "It"], ["created_at", "2017-07-28 07:39:56.468650"], ["updated_at", "2017-07-28 07:39:56.468650"], ["local_path", "http://walker.io/ruell.moriette"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Gembucket"], ["title_ru", "Название36"], ["created_at", "2017-07-28 07:39:56.472653"], ["updated_at", "2017-07-28 07:39:56.472653"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_36[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 36) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>36, "title"=>"It", "created_at"=>Fri, 28 Jul 2017 07:39:56 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:56 UTC +00:00, "local_path"=>"http://walker.io/ruell.moriette"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "viva"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "viva"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Viva"], ["category_id", 36], ["slug", "viva"], ["created_at", "2017-07-28 07:39:56.484253"], ["updated_at", "2017-07-28 07:39:56.484253"], ["layout_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ut.sunt"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Lotlux"], ["phone", "826-718-0377"], ["address", "10373 Jacobi Trafficway"], ["url", "http://sanford.biz/ciara.sanford"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://cremin.io/abagail.stracke"], ["auth_expiration_time", 900], ["slug", "ut.sunt"], ["brand_id", 36], ["user_id", 54], ["created_at", "2017-07-28 07:39:56.490026"], ["updated_at", "2017-07-28 07:39:56.490026"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Ronstring"], ["created_at", "2017-07-28 07:39:56.498394"], ["updated_at", "2017-07-28 07:39:56.498394"], ["local_path", "http://abbott.info/jadyn"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Konklab"], ["title_ru", "Название37"], ["created_at", "2017-07-28 07:39:56.502305"], ["updated_at", "2017-07-28 07:39:56.502305"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 37[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_37[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 37) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>37, "title"=>"Ronstring", "created_at"=>Fri, 28 Jul 2017 07:39:56 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:56 UTC +00:00, "local_path"=>"http://abbott.info/jadyn"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitchip"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitchip"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bitchip"], ["category_id", 37], ["slug", "bitchip"], ["created_at", "2017-07-28 07:39:56.513555"], ["updated_at", "2017-07-28 07:39:56.513555"], ["layout_id", 37]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "marcellus_schiller"], ["email", "mona@ohara.biz"], ["password", "3kX6OmS52nX4UxJ1"], ["created_at", "2017-07-28 07:39:56.518461"], ["updated_at", "2017-07-28 07:39:56.518461"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "harum_aliquam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bitwolf"], ["phone", "(405) 104-0440"], ["address", "96684 Danny Knoll"], ["url", "http://purdy.info/kasandra_medhurst"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://carrolllindgren.co/treie"], ["auth_expiration_time", 900], ["slug", "harum_aliquam"], ["brand_id", 37], ["user_id", 55], ["created_at", "2017-07-28 07:39:56.524424"], ["updated_at", "2017-07-28 07:39:56.524424"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "gardner"], ["email", "rhianna.skiles@kunderobel.name"], ["password", "SkNjPuO3Vu70SeK7"], ["created_at", "2017-07-28 07:39:56.529773"], ["updated_at", "2017-07-28 07:39:56.529773"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5337"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5337"], ["comment", "comment 17"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "173.234.174.35"], ["router_admin_ip", "96.216.122.233"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "967"], ["status", "t"], ["location_id", 37], ["user_id", 56], ["created_at", "2017-07-28 07:39:56.535587"], ["updated_at", "2017-07-28 07:39:56.535587"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5337"], ["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 7], ["serial", "643705CA5E36/5337"], ["comment", "comment 17"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "173.234.174.35"], ["router_admin_ip", "96.216.122.233"], ["admin_password", "0883877f34f624fa"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "7"], ["status", "t"], ["location_id", 37], ["user_id", 56], ["created_at", "2017-07-28 07:39:56.535587"], ["updated_at", "2017-07-28 07:39:56.535587"], ["id", 7]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 22458701-c36c-48bc-a244-ad47ca3b7a57) to Async(routers) with arguments: #<GlobalID:0x007fc0d8f28118 @uri=#<URI::GID gid://wifi-management/Router/7>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 8fc0b626-1587-4af2-ab90-650c8aeda98b) to Async(routers) with arguments: #<GlobalID:0x007fc0d8f28118 @uri=#<URI::GID gid://wifi-management/Router/7>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 7], ["provider", "instagram"], ["location_id", 36], ["router_id", 7], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:56 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"aurelie.kunde", "email"=>"ru.keebler@gerlachschuppe.com", "password"=>"Ni5i5v01JdXcNiO", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"aurelie.kunde", :email=>"ru.keebler@gerlachschuppe.com", :password=>"Ni5i5v01JdXcNiO", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"ru.keebler@gerlachschuppe.com", "password"=>"Ni5i5v01JdXcNiO"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "aurelie.kunde"], ["email", "ru.keebler@gerlachschuppe.com"], ["password", "Ni5i5v01JdXcNiO"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 54, username: "aurelie.kunde", email: "ru.keebler@gerlachschuppe.com", password: "Ni5i5v01JdXcNiO", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:39:56", updated_at: "2017-07-28 07:39:56", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 54[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/new_old_users_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:56 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#new_old_users_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_54[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 54) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>54, "username"=>"aurelie.kunde", "email"=>"ru.keebler@gerlachschuppe.com", "password"=>"Ni5i5v01JdXcNiO", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:39:56 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:56 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"new_old_users_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_54[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_54[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>54, :username=>"aurelie.kunde", :email=>"ru.keebler@gerlachschuppe.com", :password=>"Ni5i5v01JdXcNiO", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:39:56.456Z", :updated_at=>"2017-07-28T07:39:56.456Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 54[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.5ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" = 36 AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 35ms [30m(Views: 1.1ms | ActiveRecord: 10.7ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "894-559-3352"], ["created_at", "2017-07-28 07:39:56.703065"], ["updated_at", "2017-07-28 07:39:56.703065"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "crawford_hane"], ["email", "alvera@townegleason.name"], ["password", "2yG1E9LdAqKd0"], ["created_at", "2017-07-28 07:39:56.707627"], ["updated_at", "2017-07-28 07:39:56.707627"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "756184"], ["username", "makenna"], ["image", "http://instagram.com/img/makenna.jpg"], ["profile", "https://instagram.com/makenna"], ["email", "mollie@sengerturcotte.net"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 23], ["user_id", 57], ["created_at", "2017-07-28 07:39:56.711785"], ["updated_at", "2017-07-28 07:39:56.711785"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Veribet"], ["created_at", "2017-07-28 07:39:56.718518"], ["updated_at", "2017-07-28 07:39:56.718518"], ["local_path", "http://windlerolson.co/rowena_hagenes"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bamity"], ["title_ru", "Название38"], ["created_at", "2017-07-28 07:39:56.722156"], ["updated_at", "2017-07-28 07:39:56.722156"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 38[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_38[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 38) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>38, "title"=>"Veribet", "created_at"=>Fri, 28 Jul 2017 07:39:56 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:56 UTC +00:00, "local_path"=>"http://windlerolson.co/rowena_hagenes"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "opela"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "opela"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Opela"], ["category_id", 38], ["slug", "opela"], ["created_at", "2017-07-28 07:39:56.733089"], ["updated_at", "2017-07-28 07:39:56.733089"], ["layout_id", 38]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "labore_consequatur"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zoolab"], ["phone", "(652) 124-4888"], ["address", "749 Hector Parkways"], ["url", "http://howe.io/lenna"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://strackekulas.co/noemy"], ["auth_expiration_time", 900], ["slug", "labore_consequatur"], ["brand_id", 38], ["user_id", 57], ["created_at", "2017-07-28 07:39:56.738862"], ["updated_at", "2017-07-28 07:39:56.738862"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Sonair"], ["created_at", "2017-07-28 07:39:56.746629"], ["updated_at", "2017-07-28 07:39:56.746629"], ["local_path", "http://terry.name/mary_greenholt"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Wrapsafe"], ["title_ru", "Название39"], ["created_at", "2017-07-28 07:39:56.750368"], ["updated_at", "2017-07-28 07:39:56.750368"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_39[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 39) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>39, "title"=>"Sonair", "created_at"=>Fri, 28 Jul 2017 07:39:56 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:56 UTC +00:00, "local_path"=>"http://terry.name/mary_greenholt"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tres-zap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tres-zap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tres-Zap"], ["category_id", 39], ["slug", "tres-zap"], ["created_at", "2017-07-28 07:39:56.760869"], ["updated_at", "2017-07-28 07:39:56.760869"], ["layout_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "wyatt_shanahan"], ["email", "noble_hegmann@morar.com"], ["password", "N194HqYsZjN"], ["created_at", "2017-07-28 07:39:56.765329"], ["updated_at", "2017-07-28 07:39:56.765329"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "non_occaecati"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Vagram"], ["phone", "(163) 595-0308"], ["address", "25365 Maureen Mount"], ["url", "http://upton.org/tad.legros"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hodkiewicz.com/nick_hauck"], ["auth_expiration_time", 900], ["slug", "non_occaecati"], ["brand_id", 39], ["user_id", 58], ["created_at", "2017-07-28 07:39:56.770993"], ["updated_at", "2017-07-28 07:39:56.770993"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "daniella_prosacco"], ["email", "barton@torphy.info"], ["password", "IrDzNkEuS"], ["created_at", "2017-07-28 07:39:56.775952"], ["updated_at", "2017-07-28 07:39:56.775952"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5338"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5338"], ["comment", "comment 18"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "201.233.247.246"], ["router_admin_ip", "67.62.190.216"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "41"], ["status", "t"], ["location_id", 39], ["user_id", 59], ["created_at", "2017-07-28 07:39:56.781588"], ["updated_at", "2017-07-28 07:39:56.781588"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5338"], ["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 8], ["serial", "643705CA5E36/5338"], ["comment", "comment 18"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "201.233.247.246"], ["router_admin_ip", "67.62.190.216"], ["admin_password", "1d997ee5c2fdb6c7"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "8"], ["status", "t"], ["location_id", 39], ["user_id", 59], ["created_at", "2017-07-28 07:39:56.781588"], ["updated_at", "2017-07-28 07:39:56.781588"], ["id", 8]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 3355111c-6781-40f5-a977-adc3ac04e157) to Async(routers) with arguments: #<GlobalID:0x007fc0e2861f50 @uri=#<URI::GID gid://wifi-management/Router/8>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 0a711e48-000f-4dd9-b716-0dc903f4920a) to Async(routers) with arguments: #<GlobalID:0x007fc0e2861f50 @uri=#<URI::GID gid://wifi-management/Router/8>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 8], ["provider", "instagram"], ["location_id", 38], ["router_id", 8], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:57 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"crawford_hane", "email"=>"alvera@townegleason.name", "password"=>"2yG1E9LdAqKd0", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"crawford_hane", :email=>"alvera@townegleason.name", :password=>"2yG1E9LdAqKd0", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"alvera@townegleason.name", "password"=>"2yG1E9LdAqKd0"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "crawford_hane"], ["email", "alvera@townegleason.name"], ["password", "2yG1E9LdAqKd0"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 57, username: "crawford_hane", email: "alvera@townegleason.name", password: "2yG1E9LdAqKd0", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:39:56", updated_at: "2017-07-28 07:39:56", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 57[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 1.1ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/visitors_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:57 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#visitors_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_57[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 57) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>57, "username"=>"crawford_hane", "email"=>"alvera@townegleason.name", "password"=>"2yG1E9LdAqKd0", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:39:56 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:56 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"visitors_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_57[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_57[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>57, :username=>"crawford_hane", :email=>"alvera@townegleason.name", :password=>"2yG1E9LdAqKd0", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:39:56.707Z", :updated_at=>"2017-07-28T07:39:56.707Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 57[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.2ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" = 38 AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 41ms [30m(Views: 1.3ms | ActiveRecord: 8.2ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-281-293-4322"], ["created_at", "2017-07-28 07:39:57.074029"], ["updated_at", "2017-07-28 07:39:57.074029"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "gabrielle"], ["email", "sebastian@uptonsauer.biz"], ["password", "E0KeP3O2X670Q"], ["created_at", "2017-07-28 07:39:57.079066"], ["updated_at", "2017-07-28 07:39:57.079066"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "267786"], ["username", "kirsten"], ["image", "http://instagram.com/img/kirsten.jpg"], ["profile", "https://instagram.com/kirsten"], ["email", "angelica_kub@graham.org"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 24], ["user_id", 60], ["created_at", "2017-07-28 07:39:57.083657"], ["updated_at", "2017-07-28 07:39:57.083657"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Trippledex"], ["created_at", "2017-07-28 07:39:57.090948"], ["updated_at", "2017-07-28 07:39:57.090948"], ["local_path", "http://smithamhowell.name/dorothea_wintheiser"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Pannier"], ["title_ru", "Название40"], ["created_at", "2017-07-28 07:39:57.094836"], ["updated_at", "2017-07-28 07:39:57.094836"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 40[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_40[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 40) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>40, "title"=>"Trippledex", "created_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "local_path"=>"http://smithamhowell.name/dorothea_wintheiser"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "rank"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "rank"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Rank"], ["category_id", 40], ["slug", "rank"], ["created_at", "2017-07-28 07:39:57.106771"], ["updated_at", "2017-07-28 07:39:57.106771"], ["layout_id", 40]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "accusantium-consequuntur"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Veribet"], ["phone", "1-961-592-7000"], ["address", "556 Bernhard Junction"], ["url", "http://stracke.com/vinnie.fahey"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://legros.info/general.howe"], ["auth_expiration_time", 900], ["slug", "accusantium-consequuntur"], ["brand_id", 40], ["user_id", 60], ["created_at", "2017-07-28 07:39:57.112801"], ["updated_at", "2017-07-28 07:39:57.112801"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Veribet"], ["created_at", "2017-07-28 07:39:57.121265"], ["updated_at", "2017-07-28 07:39:57.121265"], ["local_path", "http://larson.net/maci_metz"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Quo Lux"], ["title_ru", "Название41"], ["created_at", "2017-07-28 07:39:57.125053"], ["updated_at", "2017-07-28 07:39:57.125053"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 41[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_41[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 41) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>41, "title"=>"Veribet", "created_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "local_path"=>"http://larson.net/maci_metz"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zamit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zamit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zamit"], ["category_id", 41], ["slug", "zamit"], ["created_at", "2017-07-28 07:39:57.136541"], ["updated_at", "2017-07-28 07:39:57.136541"], ["layout_id", 41]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "terrence.murphy"], ["email", "rasheed.cartwright@kilback.biz"], ["password", "Ff6u7uVgL44wR"], ["created_at", "2017-07-28 07:39:57.141447"], ["updated_at", "2017-07-28 07:39:57.141447"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "vitae_sit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Opela"], ["phone", "(266) 554-9454"], ["address", "65844 Armstrong Trail"], ["url", "http://mills.name/laurine"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://weber.io/carmine.volkman"], ["auth_expiration_time", 900], ["slug", "vitae_sit"], ["brand_id", 41], ["user_id", 61], ["created_at", "2017-07-28 07:39:57.147418"], ["updated_at", "2017-07-28 07:39:57.147418"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "axel_swift"], ["email", "mona@mosciskileffler.org"], ["password", "K38qSiC03xDe0"], ["created_at", "2017-07-28 07:39:57.152794"], ["updated_at", "2017-07-28 07:39:57.152794"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5339"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5339"], ["comment", "comment 19"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "21.138.216.126"], ["router_admin_ip", "201.153.158.105"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "415"], ["status", "t"], ["location_id", 41], ["user_id", 62], ["created_at", "2017-07-28 07:39:57.159002"], ["updated_at", "2017-07-28 07:39:57.159002"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5339"], ["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 9], ["serial", "643705CA5E36/5339"], ["comment", "comment 19"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "21.138.216.126"], ["router_admin_ip", "201.153.158.105"], ["admin_password", "4a98025a7cc7764a"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "9"], ["status", "t"], ["location_id", 41], ["user_id", 62], ["created_at", "2017-07-28 07:39:57.159002"], ["updated_at", "2017-07-28 07:39:57.159002"], ["id", 9]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: fe606e6c-4983-4ced-96b7-fcf2d0b55d65) to Async(routers) with arguments: #<GlobalID:0x007fc0dffc63c0 @uri=#<URI::GID gid://wifi-management/Router/9>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 62c208dc-b1bc-47a1-b725-50466faa63b7) to Async(routers) with arguments: #<GlobalID:0x007fc0dffc63c0 @uri=#<URI::GID gid://wifi-management/Router/9>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 9], ["provider", "instagram"], ["location_id", 40], ["router_id", 9], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(800) 201-7007"], ["created_at", "2017-07-28 07:39:57.321104"], ["updated_at", "2017-07-28 07:39:57.321104"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "troy.nikolaus"], ["email", "keira.franecki@ferryjaskolski.com"], ["password", "PnRk9o6dEa"], ["created_at", "2017-07-28 07:39:57.325923"], ["updated_at", "2017-07-28 07:39:57.325923"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "960615"], ["username", "tito.keeling"], ["image", "http://vk.com/img/tito.keeling.jpg"], ["profile", "https://vk.com/tito.keeling"], ["email", "lyda@krajcik.net"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 25], ["user_id", 63], ["created_at", "2017-07-28 07:39:57.330288"], ["updated_at", "2017-07-28 07:39:57.330288"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Vagram"], ["created_at", "2017-07-28 07:39:57.338005"], ["updated_at", "2017-07-28 07:39:57.338005"], ["local_path", "http://champlin.com/kitty"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Flexidy"], ["title_ru", "Название42"], ["created_at", "2017-07-28 07:39:57.342047"], ["updated_at", "2017-07-28 07:39:57.342047"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_42[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 42) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>42, "title"=>"Vagram", "created_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "local_path"=>"http://champlin.com/kitty"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "trippledex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "trippledex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Trippledex"], ["category_id", 42], ["slug", "trippledex"], ["created_at", "2017-07-28 07:39:57.354193"], ["updated_at", "2017-07-28 07:39:57.354193"], ["layout_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et.aut"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Lotlux"], ["phone", "1-855-969-5205"], ["address", "8135 Legros Ferry"], ["url", "http://bernhard.biz/cleo.price"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://wolff.org/rogelio_littel"], ["auth_expiration_time", 900], ["slug", "et.aut"], ["brand_id", 42], ["user_id", 63], ["created_at", "2017-07-28 07:39:57.360740"], ["updated_at", "2017-07-28 07:39:57.360740"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Otcom"], ["created_at", "2017-07-28 07:39:57.369163"], ["updated_at", "2017-07-28 07:39:57.369163"], ["local_path", "http://herzogwaelchi.co/akeem_bode"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bigtax"], ["title_ru", "Название43"], ["created_at", "2017-07-28 07:39:57.373027"], ["updated_at", "2017-07-28 07:39:57.373027"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 43[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_43[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 43) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>43, "title"=>"Otcom", "created_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "local_path"=>"http://herzogwaelchi.co/akeem_bode"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "gembucket"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "gembucket"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Gembucket"], ["category_id", 43], ["slug", "gembucket"], ["created_at", "2017-07-28 07:39:57.384333"], ["updated_at", "2017-07-28 07:39:57.384333"], ["layout_id", 43]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "rubie"], ["email", "hattie.koepp@schroedergoyette.name"], ["password", "VjKdZ50iQcJ0"], ["created_at", "2017-07-28 07:39:57.389042"], ["updated_at", "2017-07-28 07:39:57.389042"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quia-eos"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Andalax"], ["phone", "774-787-0399"], ["address", "80444 Ernser Mews"], ["url", "http://cartwright.com/valerie.white"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://jacobigrimes.biz/regan.hintz"], ["auth_expiration_time", 900], ["slug", "quia-eos"], ["brand_id", 43], ["user_id", 64], ["created_at", "2017-07-28 07:39:57.394927"], ["updated_at", "2017-07-28 07:39:57.394927"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "enrique"], ["email", "lenora@daregibson.net"], ["password", "Cs27RaD2Dx8zI0"], ["created_at", "2017-07-28 07:39:57.400285"], ["updated_at", "2017-07-28 07:39:57.400285"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53310"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53310"], ["comment", "comment 110"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "90.16.22.21"], ["router_admin_ip", "101.118.241.113"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "681"], ["status", "t"], ["location_id", 43], ["user_id", 65], ["created_at", "2017-07-28 07:39:57.405889"], ["updated_at", "2017-07-28 07:39:57.405889"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53310"], ["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 10], ["serial", "643705CA5E36/53310"], ["comment", "comment 110"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "90.16.22.21"], ["router_admin_ip", "101.118.241.113"], ["admin_password", "9d14b8ccb440e7f0"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "10"], ["status", "t"], ["location_id", 43], ["user_id", 65], ["created_at", "2017-07-28 07:39:57.405889"], ["updated_at", "2017-07-28 07:39:57.405889"], ["id", 10]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 6d4c6cb0-82cc-4177-8534-1319e70cd547) to Async(routers) with arguments: #<GlobalID:0x007fc0e480ad20 @uri=#<URI::GID gid://wifi-management/Router/10>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 2b741ad2-9362-44e4-bccc-18dafeb31275) to Async(routers) with arguments: #<GlobalID:0x007fc0e480ad20 @uri=#<URI::GID gid://wifi-management/Router/10>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 10], ["provider", "instagram"], ["location_id", 42], ["router_id", 10], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:57 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"troy.nikolaus", "email"=>"keira.franecki@ferryjaskolski.com", "password"=>"PnRk9o6dEa", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"troy.nikolaus", :email=>"keira.franecki@ferryjaskolski.com", :password=>"PnRk9o6dEa", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"keira.franecki@ferryjaskolski.com", "password"=>"PnRk9o6dEa"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "troy.nikolaus"], ["email", "keira.franecki@ferryjaskolski.com"], ["password", "PnRk9o6dEa"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 63, username: "troy.nikolaus", email: "keira.franecki@ferryjaskolski.com", password: "PnRk9o6dEa", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:39:57", updated_at: "2017-07-28 07:39:57", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 63[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/age_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:57 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#age_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 63[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_63[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 63) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>63, "username"=>"troy.nikolaus", "email"=>"keira.franecki@ferryjaskolski.com", "password"=>"PnRk9o6dEa", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"age_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 63[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_63[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 63[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_63[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>63, :username=>"troy.nikolaus", :email=>"keira.franecki@ferryjaskolski.com", :password=>"PnRk9o6dEa", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:39:57.325Z", :updated_at=>"2017-07-28T07:39:57.325Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 63[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.5ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(42) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 24ms [30m(Views: 1.3ms | ActiveRecord: 6.9ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "549-234-3868"], ["created_at", "2017-07-28 07:39:57.540652"], ["updated_at", "2017-07-28 07:39:57.540652"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "vivian.pacocha"], ["email", "wellington.donnelly@gerholdbechtelar.net"], ["password", "Z5AeE8GpDePoJx7"], ["created_at", "2017-07-28 07:39:57.545627"], ["updated_at", "2017-07-28 07:39:57.545627"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "500593"], ["username", "felicita.zieme"], ["image", "http://instagram.com/img/felicita.zieme.jpg"], ["profile", "https://instagram.com/felicita.zieme"], ["email", "gavin@green.info"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 26], ["user_id", 66], ["created_at", "2017-07-28 07:39:57.549864"], ["updated_at", "2017-07-28 07:39:57.549864"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Y-find"], ["created_at", "2017-07-28 07:39:57.557017"], ["updated_at", "2017-07-28 07:39:57.557017"], ["local_path", "http://sporer.net/sunny.hauck"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Lotstring"], ["title_ru", "Название44"], ["created_at", "2017-07-28 07:39:57.560891"], ["updated_at", "2017-07-28 07:39:57.560891"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 44[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_44[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 44) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>44, "title"=>"Y-find", "created_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "local_path"=>"http://sporer.net/sunny.hauck"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "trippledex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "trippledex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Trippledex"], ["category_id", 44], ["slug", "trippledex"], ["created_at", "2017-07-28 07:39:57.572684"], ["updated_at", "2017-07-28 07:39:57.572684"], ["layout_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "nisi-sint"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Lotlux"], ["phone", "1-124-818-5566"], ["address", "7815 Nadia Mill"], ["url", "http://emmerich.com/lucie.kohler"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://marvinwalsh.org/antonia_dare"], ["auth_expiration_time", 900], ["slug", "nisi-sint"], ["brand_id", 44], ["user_id", 66], ["created_at", "2017-07-28 07:39:57.578875"], ["updated_at", "2017-07-28 07:39:57.578875"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Namfix"], ["created_at", "2017-07-28 07:39:57.586982"], ["updated_at", "2017-07-28 07:39:57.586982"], ["local_path", "http://konopelskigleichner.org/janelle"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Otcom"], ["title_ru", "Название45"], ["created_at", "2017-07-28 07:39:57.590749"], ["updated_at", "2017-07-28 07:39:57.590749"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 45[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_45[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 45) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>45, "title"=>"Namfix", "created_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "local_path"=>"http://konopelskigleichner.org/janelle"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "span"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "span"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Span"], ["category_id", 45], ["slug", "span"], ["created_at", "2017-07-28 07:39:57.601645"], ["updated_at", "2017-07-28 07:39:57.601645"], ["layout_id", 45]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "aubree.harber"], ["email", "lurline@simonis.biz"], ["password", "OfJ46x3hEmM0Me5m"], ["created_at", "2017-07-28 07:39:57.606489"], ["updated_at", "2017-07-28 07:39:57.606489"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "harum-culpa"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Fix San"], ["phone", "(365) 613-9763"], ["address", "159 Hoeger Meadows"], ["url", "http://schmitt.biz/kelli_fay"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://douglas.org/elmira"], ["auth_expiration_time", 900], ["slug", "harum-culpa"], ["brand_id", 45], ["user_id", 67], ["created_at", "2017-07-28 07:39:57.612389"], ["updated_at", "2017-07-28 07:39:57.612389"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "donato"], ["email", "caleigh@strosin.name"], ["password", "L2EaFxCnQnPuKq"], ["created_at", "2017-07-28 07:39:57.617782"], ["updated_at", "2017-07-28 07:39:57.617782"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53311"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53311"], ["comment", "comment 111"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "218.122.109.220"], ["router_admin_ip", "179.219.147.6"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "831"], ["status", "t"], ["location_id", 45], ["user_id", 68], ["created_at", "2017-07-28 07:39:57.623392"], ["updated_at", "2017-07-28 07:39:57.623392"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53311"], ["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 11], ["serial", "643705CA5E36/53311"], ["comment", "comment 111"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "218.122.109.220"], ["router_admin_ip", "179.219.147.6"], ["admin_password", "2e51b7bd3df439ab"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "11"], ["status", "t"], ["location_id", 45], ["user_id", 68], ["created_at", "2017-07-28 07:39:57.623392"], ["updated_at", "2017-07-28 07:39:57.623392"], ["id", 11]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: e3859576-d377-4edd-afe6-22260628abba) to Async(routers) with arguments: #<GlobalID:0x007fc0e44d4e30 @uri=#<URI::GID gid://wifi-management/Router/11>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 63d20001-0ec0-4059-9275-e4cfbe77d828) to Async(routers) with arguments: #<GlobalID:0x007fc0e44d4e30 @uri=#<URI::GID gid://wifi-management/Router/11>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 11], ["provider", "instagram"], ["location_id", 44], ["router_id", 11], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:57 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"vivian.pacocha", "email"=>"wellington.donnelly@gerholdbechtelar.net", "password"=>"Z5AeE8GpDePoJx7", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"vivian.pacocha", :email=>"wellington.donnelly@gerholdbechtelar.net", :password=>"Z5AeE8GpDePoJx7", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"wellington.donnelly@gerholdbechtelar.net", "password"=>"Z5AeE8GpDePoJx7"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "vivian.pacocha"], ["email", "wellington.donnelly@gerholdbechtelar.net"], ["password", "Z5AeE8GpDePoJx7"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 66, username: "vivian.pacocha", email: "wellington.donnelly@gerholdbechtelar.net", password: "Z5AeE8GpDePoJx7", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:39:57", updated_at: "2017-07-28 07:39:57", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 66[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/gender_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:57 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#gender_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 66[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_66[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 66) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>66, "username"=>"vivian.pacocha", "email"=>"wellington.donnelly@gerholdbechtelar.net", "password"=>"Z5AeE8GpDePoJx7", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"gender_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 66[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_66[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 66[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_66[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>66, :username=>"vivian.pacocha", :email=>"wellington.donnelly@gerholdbechtelar.net", :password=>"Z5AeE8GpDePoJx7", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:39:57.545Z", :updated_at=>"2017-07-28T07:39:57.545Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 66[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.5ms)[0m  [1m[34mSELECT DISTINCT COUNT(DISTINCT social_accounts.id) AS count_social_accounts_id, "gender" AS gender FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" = 44 AND ("social_logs"."updated_at" BETWEEN $1 AND $2) GROUP BY "gender"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 24ms [30m(Views: 1.2ms | ActiveRecord: 5.9ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "943-351-0899 x52241"], ["created_at", "2017-07-28 07:39:57.895207"], ["updated_at", "2017-07-28 07:39:57.895207"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "mable_lakin"], ["email", "sammie_pollich@thompson.net"], ["password", "8fKp1uSq24C"], ["created_at", "2017-07-28 07:39:57.900136"], ["updated_at", "2017-07-28 07:39:57.900136"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "566524"], ["username", "rhianna"], ["image", "http://vk.com/img/rhianna.jpg"], ["profile", "https://vk.com/rhianna"], ["email", "desiree.crist@barrowsconn.net"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 27], ["user_id", 69], ["created_at", "2017-07-28 07:39:57.904464"], ["updated_at", "2017-07-28 07:39:57.904464"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Stronghold"], ["created_at", "2017-07-28 07:39:57.912071"], ["updated_at", "2017-07-28 07:39:57.912071"], ["local_path", "http://zemlakgleason.com/calista_kiehn"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Kanlam"], ["title_ru", "Название46"], ["created_at", "2017-07-28 07:39:57.915887"], ["updated_at", "2017-07-28 07:39:57.915887"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 46[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_46[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 46) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>46, "title"=>"Stronghold", "created_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "local_path"=>"http://zemlakgleason.com/calista_kiehn"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "fix-san"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "fix-san"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Fix San"], ["category_id", 46], ["slug", "fix-san"], ["created_at", "2017-07-28 07:39:57.927784"], ["updated_at", "2017-07-28 07:39:57.927784"], ["layout_id", 46]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et_error"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Y-find"], ["phone", "(383) 356-1008"], ["address", "691 Emmerich Place"], ["url", "http://mcclure.name/eloy"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://maggioherman.com/einar_kutch"], ["auth_expiration_time", 900], ["slug", "et_error"], ["brand_id", 46], ["user_id", 69], ["created_at", "2017-07-28 07:39:57.933841"], ["updated_at", "2017-07-28 07:39:57.933841"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Toughjoyfax"], ["created_at", "2017-07-28 07:39:57.942337"], ["updated_at", "2017-07-28 07:39:57.942337"], ["local_path", "http://gerhold.net/tyra.schoen"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Ventosanzap"], ["title_ru", "Название47"], ["created_at", "2017-07-28 07:39:57.946088"], ["updated_at", "2017-07-28 07:39:57.946088"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 47[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_47[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 47) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>47, "title"=>"Toughjoyfax", "created_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "local_path"=>"http://gerhold.net/tyra.schoen"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "duobam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "duobam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Duobam"], ["category_id", 47], ["slug", "duobam"], ["created_at", "2017-07-28 07:39:57.956935"], ["updated_at", "2017-07-28 07:39:57.956935"], ["layout_id", 47]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "esperanza.botsford"], ["email", "jeffrey@walker.name"], ["password", "8eOi8qHv"], ["created_at", "2017-07-28 07:39:57.961815"], ["updated_at", "2017-07-28 07:39:57.961815"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "dolor.libero"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Gembucket"], ["phone", "232.815.5948"], ["address", "230 Nikolaus Lakes"], ["url", "http://lindgrenchamplin.org/theresa.hahn"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ankunding.io/sheridan_dubuque"], ["auth_expiration_time", 900], ["slug", "dolor.libero"], ["brand_id", 47], ["user_id", 70], ["created_at", "2017-07-28 07:39:57.967647"], ["updated_at", "2017-07-28 07:39:57.967647"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "brandon"], ["email", "vidal@wehner.biz"], ["password", "3yYeRzWa"], ["created_at", "2017-07-28 07:39:57.973003"], ["updated_at", "2017-07-28 07:39:57.973003"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53312"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53312"], ["comment", "comment 112"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "109.146.64.88"], ["router_admin_ip", "113.35.225.229"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "421"], ["status", "t"], ["location_id", 47], ["user_id", 71], ["created_at", "2017-07-28 07:39:57.978628"], ["updated_at", "2017-07-28 07:39:57.978628"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53312"], ["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 12], ["serial", "643705CA5E36/53312"], ["comment", "comment 112"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "109.146.64.88"], ["router_admin_ip", "113.35.225.229"], ["admin_password", "7b20940553aab17c"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "12"], ["status", "t"], ["location_id", 47], ["user_id", 71], ["created_at", "2017-07-28 07:39:57.978628"], ["updated_at", "2017-07-28 07:39:57.978628"], ["id", 12]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 2d59c6c4-0a66-4e82-9333-857c8a24ea96) to Async(routers) with arguments: #<GlobalID:0x007fc0ddfea128 @uri=#<URI::GID gid://wifi-management/Router/12>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: ca603a7e-4d0d-42c2-a43f-924e422e5b59) to Async(routers) with arguments: #<GlobalID:0x007fc0ddfea128 @uri=#<URI::GID gid://wifi-management/Router/12>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 12], ["provider", "instagram"], ["location_id", 46], ["router_id", 12], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:58 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"mable_lakin", "email"=>"sammie_pollich@thompson.net", "password"=>"8fKp1uSq24C", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"mable_lakin", :email=>"sammie_pollich@thompson.net", :password=>"8fKp1uSq24C", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"sammie_pollich@thompson.net", "password"=>"8fKp1uSq24C"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "mable_lakin"], ["email", "sammie_pollich@thompson.net"], ["password", "8fKp1uSq24C"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 69, username: "mable_lakin", email: "sammie_pollich@thompson.net", password: "8fKp1uSq24C", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:39:57", updated_at: "2017-07-28 07:39:57", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 69[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/new_old_users" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:58 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#new_old_users[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 69[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_69[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 69) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>69, "username"=>"mable_lakin", "email"=>"sammie_pollich@thompson.net", "password"=>"8fKp1uSq24C", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:57 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"new_old_users"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 69[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_69[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 69[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_69[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>69, :username=>"mable_lakin", :email=>"sammie_pollich@thompson.net", :password=>"8fKp1uSq24C", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:39:57.900Z", :updated_at=>"2017-07-28T07:39:57.900Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 69[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.4ms)[0m  [1m[34m
      select
        newusrs.chart_interval,
        ttlusrs.returning as returning_users,
        newusrs.new_users,
        ttlusrs.returning + newusrs.new_users as total
      from (select
          chart_interval,
          count (id) as new_users
        from (select
            distinct cl.id,
            date_trunc('day', dd)::date as chart_interval
          FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
          left outer join social_accounts sa on date_trunc('day', sa.created_at) = date_trunc('day', dd)
          left outer join clients cl on sa.client_id = cl.id
          join social_logs sl on sa.id = sl.social_account_id
            and location_id in(46)
      	  order by chart_interval) as chart
        group by chart_interval
        order by chart_interval
      ) as newusrs join (select
          date_trunc('day', dd):: date as chart_interval,
          count (distinct cl.id) as returning
        FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
        left outer join social_logs sl on date_trunc('day', sl.created_at) = date_trunc('day', dd)
          and location_id in(46)
        join social_accounts sa on sa.id = sl.social_account_id
        left outer join clients cl on date_trunc('day', cl.created_at) < date_trunc('day', dd)
          and sa.client_id = cl.id
        group by chart_interval
        order by chart_interval
      ) as ttlusrs on ttlusrs.chart_interval = newusrs.chart_interval[0m
[INFO ] Completed [32m200 OK[0m in 24ms [30m(Views: 0.6ms | ActiveRecord: 8.0ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-411-061-1000 x75045"], ["created_at", "2017-07-28 07:39:58.234727"], ["updated_at", "2017-07-28 07:39:58.234727"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "addie.doyle"], ["email", "lucy.gerlach@padberg.name"], ["password", "1lPgYpU2LiB"], ["created_at", "2017-07-28 07:39:58.239693"], ["updated_at", "2017-07-28 07:39:58.239693"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "647462"], ["username", "terence"], ["image", "http://instagram.com/img/terence.jpg"], ["profile", "https://instagram.com/terence"], ["email", "sherman.bruen@halvorson.co"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 28], ["user_id", 72], ["created_at", "2017-07-28 07:39:58.243979"], ["updated_at", "2017-07-28 07:39:58.243979"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Hatity"], ["created_at", "2017-07-28 07:39:58.251463"], ["updated_at", "2017-07-28 07:39:58.251463"], ["local_path", "http://friesenfay.net/sammy"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Biodex"], ["title_ru", "Название48"], ["created_at", "2017-07-28 07:39:58.255351"], ["updated_at", "2017-07-28 07:39:58.255351"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_48[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 48) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>48, "title"=>"Hatity", "created_at"=>Fri, 28 Jul 2017 07:39:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:58 UTC +00:00, "local_path"=>"http://friesenfay.net/sammy"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tempsoft"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tempsoft"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tempsoft"], ["category_id", 48], ["slug", "tempsoft"], ["created_at", "2017-07-28 07:39:58.267045"], ["updated_at", "2017-07-28 07:39:58.267045"], ["layout_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "eum.ad"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Greenlam"], ["phone", "975-409-1847"], ["address", "5270 Roob Parkway"], ["url", "http://framistark.net/shayna.douglas"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://waters.info/lee_cruickshank"], ["auth_expiration_time", 900], ["slug", "eum.ad"], ["brand_id", 48], ["user_id", 72], ["created_at", "2017-07-28 07:39:58.272985"], ["updated_at", "2017-07-28 07:39:58.272985"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Biodex"], ["created_at", "2017-07-28 07:39:58.281259"], ["updated_at", "2017-07-28 07:39:58.281259"], ["local_path", "http://cormier.co/zackary.crooks"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Cardguard"], ["title_ru", "Название49"], ["created_at", "2017-07-28 07:39:58.285211"], ["updated_at", "2017-07-28 07:39:58.285211"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 49[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_49[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 49) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>49, "title"=>"Biodex", "created_at"=>Fri, 28 Jul 2017 07:39:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:58 UTC +00:00, "local_path"=>"http://cormier.co/zackary.crooks"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zaam-dox"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zaam-dox"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zaam-Dox"], ["category_id", 49], ["slug", "zaam-dox"], ["created_at", "2017-07-28 07:39:58.296397"], ["updated_at", "2017-07-28 07:39:58.296397"], ["layout_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "roxane.goyette"], ["email", "zora.lockman@davis.name"], ["password", "Mo02Ul61"], ["created_at", "2017-07-28 07:39:58.301425"], ["updated_at", "2017-07-28 07:39:58.301425"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "minus.esse"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Flowdesk"], ["phone", "703-679-9378"], ["address", "1234 Chanelle Mall"], ["url", "http://bartell.org/ruby_fahey"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://jones.co/diana"], ["auth_expiration_time", 900], ["slug", "minus.esse"], ["brand_id", 49], ["user_id", 73], ["created_at", "2017-07-28 07:39:58.307374"], ["updated_at", "2017-07-28 07:39:58.307374"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "bailey"], ["email", "conner@bins.net"], ["password", "NaLpS1Vl769bE"], ["created_at", "2017-07-28 07:39:58.312711"], ["updated_at", "2017-07-28 07:39:58.312711"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53313"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53313"], ["comment", "comment 113"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "235.85.8.219"], ["router_admin_ip", "210.214.181.30"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "59"], ["status", "t"], ["location_id", 49], ["user_id", 74], ["created_at", "2017-07-28 07:39:58.318676"], ["updated_at", "2017-07-28 07:39:58.318676"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53313"], ["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 13], ["serial", "643705CA5E36/53313"], ["comment", "comment 113"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "235.85.8.219"], ["router_admin_ip", "210.214.181.30"], ["admin_password", "5af5c49527972838"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "13"], ["status", "t"], ["location_id", 49], ["user_id", 74], ["created_at", "2017-07-28 07:39:58.318676"], ["updated_at", "2017-07-28 07:39:58.318676"], ["id", 13]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 53341786-a0cd-4e0d-bd50-aeb451c750a8) to Async(routers) with arguments: #<GlobalID:0x007fc0e32bf8a8 @uri=#<URI::GID gid://wifi-management/Router/13>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 543e1e07-3291-41bd-8d37-960676881d72) to Async(routers) with arguments: #<GlobalID:0x007fc0e32bf8a8 @uri=#<URI::GID gid://wifi-management/Router/13>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 13], ["provider", "instagram"], ["location_id", 48], ["router_id", 13], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:58 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"addie.doyle", "email"=>"lucy.gerlach@padberg.name", "password"=>"1lPgYpU2LiB", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"addie.doyle", :email=>"lucy.gerlach@padberg.name", :password=>"1lPgYpU2LiB", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"lucy.gerlach@padberg.name", "password"=>"1lPgYpU2LiB"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "addie.doyle"], ["email", "lucy.gerlach@padberg.name"], ["password", "1lPgYpU2LiB"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 72, username: "addie.doyle", email: "lucy.gerlach@padberg.name", password: "1lPgYpU2LiB", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:39:58", updated_at: "2017-07-28 07:39:58", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 72[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/clients_count" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:58 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#clients_count[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 72[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_72[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 72) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>72, "username"=>"addie.doyle", "email"=>"lucy.gerlach@padberg.name", "password"=>"1lPgYpU2LiB", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:39:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:58 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"clients_count"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 72[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_72[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 72[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_72[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>72, :username=>"addie.doyle", :email=>"lucy.gerlach@padberg.name", :password=>"1lPgYpU2LiB", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:39:58.239Z", :updated_at=>"2017-07-28T07:39:58.239Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 72[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 48[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 48 AND ("client_visits"."updated_at" BETWEEN $1 AND $2)[0m  [["updated_at", "2017-06-28 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 48 AND ("client_visits"."updated_at" BETWEEN $1 AND $2)[0m  [["updated_at", "2017-07-21 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 27ms [30m(Views: 0.3ms | ActiveRecord: 8.8ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "198-067-2026 x605"], ["created_at", "2017-07-28 07:39:58.538577"], ["updated_at", "2017-07-28 07:39:58.538577"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lexie_mueller"], ["email", "darien@quitzon.io"], ["password", "PuC91xK8HkS7"], ["created_at", "2017-07-28 07:39:58.543505"], ["updated_at", "2017-07-28 07:39:58.543505"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "731445"], ["username", "loma_corkery"], ["image", "http://instagram.com/img/loma_corkery.jpg"], ["profile", "https://instagram.com/loma_corkery"], ["email", "alisa_grant@parker.name"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 29], ["user_id", 75], ["created_at", "2017-07-28 07:39:58.547684"], ["updated_at", "2017-07-28 07:39:58.547684"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bigtax"], ["created_at", "2017-07-28 07:39:58.555348"], ["updated_at", "2017-07-28 07:39:58.555348"], ["local_path", "http://ruecker.info/rudy_schmeler"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bitwolf"], ["title_ru", "Название50"], ["created_at", "2017-07-28 07:39:58.559079"], ["updated_at", "2017-07-28 07:39:58.559079"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 50[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_50[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 50) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>50, "title"=>"Bigtax", "created_at"=>Fri, 28 Jul 2017 07:39:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:58 UTC +00:00, "local_path"=>"http://ruecker.info/rudy_schmeler"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "gembucket"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "gembucket"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Gembucket"], ["category_id", 50], ["slug", "gembucket"], ["created_at", "2017-07-28 07:39:58.570703"], ["updated_at", "2017-07-28 07:39:58.570703"], ["layout_id", 50]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "art"], ["email", "jakayla@schadenhirthe.net"], ["password", "0vRnRa3yT9M3Mm"], ["created_at", "2017-07-28 07:39:58.575594"], ["updated_at", "2017-07-28 07:39:58.575594"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "laudantium.eos"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Kanlam"], ["phone", "978.195.1576"], ["address", "9305 Thompson Summit"], ["url", "http://dach.org/evie"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://rathconroy.info/elmo"], ["auth_expiration_time", 900], ["slug", "laudantium.eos"], ["brand_id", 50], ["user_id", 76], ["created_at", "2017-07-28 07:39:58.581508"], ["updated_at", "2017-07-28 07:39:58.581508"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Fintone"], ["created_at", "2017-07-28 07:39:58.589316"], ["updated_at", "2017-07-28 07:39:58.589316"], ["local_path", "http://murray.co/zella"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Quo Lux"], ["title_ru", "Название51"], ["created_at", "2017-07-28 07:39:58.593179"], ["updated_at", "2017-07-28 07:39:58.593179"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_51[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 51) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>51, "title"=>"Fintone", "created_at"=>Fri, 28 Jul 2017 07:39:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:58 UTC +00:00, "local_path"=>"http://murray.co/zella"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voyatouch"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voyatouch"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Voyatouch"], ["category_id", 51], ["slug", "voyatouch"], ["created_at", "2017-07-28 07:39:58.604472"], ["updated_at", "2017-07-28 07:39:58.604472"], ["layout_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "deion"], ["email", "christine.connelly@heathcotegoldner.info"], ["password", "Xx64KzQoI2"], ["created_at", "2017-07-28 07:39:58.609312"], ["updated_at", "2017-07-28 07:39:58.609312"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "nemo-et"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tampflex"], ["phone", "967-807-5618"], ["address", "9951 Fay Junction"], ["url", "http://boscoschuppe.name/finn"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://medhurst.info/hyman_fritsch"], ["auth_expiration_time", 900], ["slug", "nemo-et"], ["brand_id", 51], ["user_id", 77], ["created_at", "2017-07-28 07:39:58.614921"], ["updated_at", "2017-07-28 07:39:58.614921"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "evelyn"], ["email", "lenora_murazik@funk.io"], ["password", "T8H3Iq6wYo8"], ["created_at", "2017-07-28 07:39:58.619972"], ["updated_at", "2017-07-28 07:39:58.619972"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53314"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53314"], ["comment", "comment 114"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "228.138.135.74"], ["router_admin_ip", "184.218.51.42"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "532"], ["status", "t"], ["location_id", 51], ["user_id", 78], ["created_at", "2017-07-28 07:39:58.625532"], ["updated_at", "2017-07-28 07:39:58.625532"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53314"], ["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 14], ["serial", "643705CA5E36/53314"], ["comment", "comment 114"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "228.138.135.74"], ["router_admin_ip", "184.218.51.42"], ["admin_password", "db2eb92858149fb0"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "14"], ["status", "t"], ["location_id", 51], ["user_id", 78], ["created_at", "2017-07-28 07:39:58.625532"], ["updated_at", "2017-07-28 07:39:58.625532"], ["id", 14]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: b523245a-2983-4832-8e37-b30d775d4df9) to Async(routers) with arguments: #<GlobalID:0x007fc0e4014580 @uri=#<URI::GID gid://wifi-management/Router/14>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 77e56e1b-6320-4216-ab6a-6cdb7192a0f1) to Async(routers) with arguments: #<GlobalID:0x007fc0e4014580 @uri=#<URI::GID gid://wifi-management/Router/14>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.4ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 14], ["provider", "instagram"], ["location_id", 50], ["router_id", 14], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/totals" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:58 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#all_connections[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"all_connections"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-06-28 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(50, 51)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" IN (50, 51) AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.2ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(50, 51) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.7ms)[0m  [1m[34m
      select
        newusrs.chart_interval,
        ttlusrs.returning as returning_users,
        newusrs.new_users,
        ttlusrs.returning + newusrs.new_users as total
      from (select
          chart_interval,
          count (id) as new_users
        from (select
            distinct cl.id,
            date_trunc('day', dd)::date as chart_interval
          FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
          left outer join social_accounts sa on date_trunc('day', sa.created_at) = date_trunc('day', dd)
          left outer join clients cl on sa.client_id = cl.id
          join social_logs sl on sa.id = sl.social_account_id
            and location_id in(50, 51)
      	  order by chart_interval) as chart
        group by chart_interval
        order by chart_interval
      ) as newusrs join (select
          date_trunc('day', dd):: date as chart_interval,
          count (distinct cl.id) as returning
        FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
        left outer join social_logs sl on date_trunc('day', sl.created_at) = date_trunc('day', dd)
          and location_id in(50, 51)
        join social_accounts sa on sa.id = sl.social_account_id
        left outer join clients cl on date_trunc('day', cl.created_at) < date_trunc('day', dd)
          and sa.client_id = cl.id
        group by chart_interval
        order by chart_interval
      ) as ttlusrs on ttlusrs.chart_interval = newusrs.chart_interval[0m
[INFO ] Completed [32m200 OK[0m in 26ms [30m(Views: 3.8ms | ActiveRecord: 10.3ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(478) 761-8515"], ["created_at", "2017-07-28 07:39:58.726931"], ["updated_at", "2017-07-28 07:39:58.726931"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "granville.oberbrunner"], ["email", "orpha.hartmann@mcclureabshire.io"], ["password", "IpY68f0wYe9v3"], ["created_at", "2017-07-28 07:39:58.731734"], ["updated_at", "2017-07-28 07:39:58.731734"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "250660"], ["username", "anita_moriette"], ["image", "http://instagram.com/img/anita_moriette.jpg"], ["profile", "https://instagram.com/anita_moriette"], ["email", "columbus@bergstrom.biz"], ["gender", "female"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 30], ["user_id", 79], ["created_at", "2017-07-28 07:39:58.735930"], ["updated_at", "2017-07-28 07:39:58.735930"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Y-Solowarm"], ["created_at", "2017-07-28 07:39:58.743050"], ["updated_at", "2017-07-28 07:39:58.743050"], ["local_path", "http://emard.com/nikki_beer"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Ventosanzap"], ["title_ru", "Название52"], ["created_at", "2017-07-28 07:39:58.746821"], ["updated_at", "2017-07-28 07:39:58.746821"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 52[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_52[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 52) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>52, "title"=>"Y-Solowarm", "created_at"=>Fri, 28 Jul 2017 07:39:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:58 UTC +00:00, "local_path"=>"http://emard.com/nikki_beer"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "home-ing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "home-ing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Home Ing"], ["category_id", 52], ["slug", "home-ing"], ["created_at", "2017-07-28 07:39:58.758112"], ["updated_at", "2017-07-28 07:39:58.758112"], ["layout_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "carrie.oconner"], ["email", "katelin_gerhold@stoltenberg.io"], ["password", "Ry653o502"], ["created_at", "2017-07-28 07:39:58.762981"], ["updated_at", "2017-07-28 07:39:58.762981"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "dolorum_consequuntur"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Lotlux"], ["phone", "862.000.4660"], ["address", "6054 Jacobs Passage"], ["url", "http://brown.io/terence_murazik"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://fisherfay.net/zion.mosciski"], ["auth_expiration_time", 900], ["slug", "dolorum_consequuntur"], ["brand_id", 52], ["user_id", 80], ["created_at", "2017-07-28 07:39:58.769124"], ["updated_at", "2017-07-28 07:39:58.769124"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Latlux"], ["created_at", "2017-07-28 07:39:58.776858"], ["updated_at", "2017-07-28 07:39:58.776858"], ["local_path", "http://jakubowski.org/laney_satterfield"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zamit"], ["title_ru", "Название53"], ["created_at", "2017-07-28 07:39:58.780593"], ["updated_at", "2017-07-28 07:39:58.780593"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 53[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_53[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 53) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>53, "title"=>"Latlux", "created_at"=>Fri, 28 Jul 2017 07:39:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:58 UTC +00:00, "local_path"=>"http://jakubowski.org/laney_satterfield"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-solowarm"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-solowarm"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Y-Solowarm"], ["category_id", 53], ["slug", "y-solowarm"], ["created_at", "2017-07-28 07:39:58.791712"], ["updated_at", "2017-07-28 07:39:58.791712"], ["layout_id", 53]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "kenneth"], ["email", "berniece@torpspencer.io"], ["password", "HbDmQvQ7YcPp0uMz"], ["created_at", "2017-07-28 07:39:58.796553"], ["updated_at", "2017-07-28 07:39:58.796553"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "in-ipsam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stronghold"], ["phone", "425.333.8646"], ["address", "406 Volkman Mills"], ["url", "http://murazik.name/julio"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kohlerhuels.info/abdul.skiles"], ["auth_expiration_time", 900], ["slug", "in-ipsam"], ["brand_id", 53], ["user_id", 81], ["created_at", "2017-07-28 07:39:58.802306"], ["updated_at", "2017-07-28 07:39:58.802306"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lexus.okeefe"], ["email", "david@kreigerdaugherty.name"], ["password", "4x1926IhCnZ1"], ["created_at", "2017-07-28 07:39:58.807636"], ["updated_at", "2017-07-28 07:39:58.807636"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53315"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53315"], ["comment", "comment 115"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "191.49.8.149"], ["router_admin_ip", "104.193.75.226"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "924"], ["status", "t"], ["location_id", 53], ["user_id", 82], ["created_at", "2017-07-28 07:39:58.813351"], ["updated_at", "2017-07-28 07:39:58.813351"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53315"], ["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 15], ["serial", "643705CA5E36/53315"], ["comment", "comment 115"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "191.49.8.149"], ["router_admin_ip", "104.193.75.226"], ["admin_password", "5af2ebe6acce4ec8"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "15"], ["status", "t"], ["location_id", 53], ["user_id", 82], ["created_at", "2017-07-28 07:39:58.813351"], ["updated_at", "2017-07-28 07:39:58.813351"], ["id", 15]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 604d55e3-587d-47c9-952c-e8e7d99b8763) to Async(routers) with arguments: #<GlobalID:0x007fc0dcdb8860 @uri=#<URI::GID gid://wifi-management/Router/15>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: c3069e51-8fd8-4ffe-b6c5-13a1f29be9e3) to Async(routers) with arguments: #<GlobalID:0x007fc0dcdb8860 @uri=#<URI::GID gid://wifi-management/Router/15>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 15], ["provider", "instagram"], ["location_id", 52], ["router_id", 15], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/time" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:59 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#time_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"time_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(52, 53)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 5ms [30m(Views: 1.2ms | ActiveRecord: 2.4ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-316-507-5443"], ["created_at", "2017-07-28 07:39:59.142258"], ["updated_at", "2017-07-28 07:39:59.142258"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "adella"], ["email", "cary_monahan@ko.org"], ["password", "SyMl7eDqFcYsS30i"], ["created_at", "2017-07-28 07:39:59.146959"], ["updated_at", "2017-07-28 07:39:59.146959"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "394873"], ["username", "stanford.vonrueden"], ["image", "http://facebook.com/img/stanford.vonrueden.jpg"], ["profile", "https://facebook.com/stanford.vonrueden"], ["email", "deangelo.volkman@connritchie.co"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 31], ["user_id", 83], ["created_at", "2017-07-28 07:39:59.151200"], ["updated_at", "2017-07-28 07:39:59.151200"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Voltsillam"], ["created_at", "2017-07-28 07:39:59.158799"], ["updated_at", "2017-07-28 07:39:59.158799"], ["local_path", "http://funk.com/helmer.muller"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bitchip"], ["title_ru", "Название54"], ["created_at", "2017-07-28 07:39:59.162729"], ["updated_at", "2017-07-28 07:39:59.162729"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_54[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 54) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>54, "title"=>"Voltsillam", "created_at"=>Fri, 28 Jul 2017 07:39:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:59 UTC +00:00, "local_path"=>"http://funk.com/helmer.muller"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "solarbreeze"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "solarbreeze"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Solarbreeze"], ["category_id", 54], ["slug", "solarbreeze"], ["created_at", "2017-07-28 07:39:59.174642"], ["updated_at", "2017-07-28 07:39:59.174642"], ["layout_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jacey"], ["email", "guadalupe@lockman.net"], ["password", "HhYmAlJx478g1mGp"], ["created_at", "2017-07-28 07:39:59.179592"], ["updated_at", "2017-07-28 07:39:59.179592"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quisquam.temporibus"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Y-Solowarm"], ["phone", "(675) 586-5111"], ["address", "6232 Fanny Ford"], ["url", "http://murphy.io/shanie"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://wardrau.co/tad"], ["auth_expiration_time", 900], ["slug", "quisquam.temporibus"], ["brand_id", 54], ["user_id", 84], ["created_at", "2017-07-28 07:39:59.185420"], ["updated_at", "2017-07-28 07:39:59.185420"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Regrant"], ["created_at", "2017-07-28 07:39:59.193200"], ["updated_at", "2017-07-28 07:39:59.193200"], ["local_path", "http://bins.info/cynthia"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Regrant"], ["title_ru", "Название55"], ["created_at", "2017-07-28 07:39:59.196784"], ["updated_at", "2017-07-28 07:39:59.196784"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 55[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_55[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 55) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>55, "title"=>"Regrant", "created_at"=>Fri, 28 Jul 2017 07:39:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:59 UTC +00:00, "local_path"=>"http://bins.info/cynthia"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "hatity"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "hatity"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Hatity"], ["category_id", 55], ["slug", "hatity"], ["created_at", "2017-07-28 07:39:59.207850"], ["updated_at", "2017-07-28 07:39:59.207850"], ["layout_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jacky.morar"], ["email", "karlie_conroy@vonruedenhegmann.io"], ["password", "1rZu71Q4H2HvIrZt"], ["created_at", "2017-07-28 07:39:59.212535"], ["updated_at", "2017-07-28 07:39:59.212535"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "nesciunt.et"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Greenlam"], ["phone", "(259) 120-8006"], ["address", "9865 Hegmann Tunnel"], ["url", "http://armstrong.co/wiley"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://rath.net/cheyanne_barrows"], ["auth_expiration_time", 900], ["slug", "nesciunt.et"], ["brand_id", 55], ["user_id", 85], ["created_at", "2017-07-28 07:39:59.218629"], ["updated_at", "2017-07-28 07:39:59.218629"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "susan.torp"], ["email", "gunner@goodwinbosco.co"], ["password", "ReNjEyEpP5Li"], ["created_at", "2017-07-28 07:39:59.223904"], ["updated_at", "2017-07-28 07:39:59.223904"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53316"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53316"], ["comment", "comment 116"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "216.205.44.201"], ["router_admin_ip", "23.202.154.83"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "382"], ["status", "t"], ["location_id", 55], ["user_id", 86], ["created_at", "2017-07-28 07:39:59.229606"], ["updated_at", "2017-07-28 07:39:59.229606"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53316"], ["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 16], ["serial", "643705CA5E36/53316"], ["comment", "comment 116"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "216.205.44.201"], ["router_admin_ip", "23.202.154.83"], ["admin_password", "db8adbca66a6457b"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "16"], ["status", "t"], ["location_id", 55], ["user_id", 86], ["created_at", "2017-07-28 07:39:59.229606"], ["updated_at", "2017-07-28 07:39:59.229606"], ["id", 16]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 040f3f9c-ad08-49db-8423-d9b6c60302dd) to Async(routers) with arguments: #<GlobalID:0x007fc0dfdd6d08 @uri=#<URI::GID gid://wifi-management/Router/16>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 7b1ac5ce-db6b-48aa-879a-dd70055bee6c) to Async(routers) with arguments: #<GlobalID:0x007fc0dfdd6d08 @uri=#<URI::GID gid://wifi-management/Router/16>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 16], ["provider", "instagram"], ["location_id", 54], ["router_id", 16], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/social" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:59 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#social_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"social_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" IN (54, 55) AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 6ms [30m(Views: 1.3ms | ActiveRecord: 2.0ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-284-406-9003 x487"], ["created_at", "2017-07-28 07:39:59.382231"], ["updated_at", "2017-07-28 07:39:59.382231"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "antonina"], ["email", "delilah@corkery.name"], ["password", "0xOoVh37La15"], ["created_at", "2017-07-28 07:39:59.387060"], ["updated_at", "2017-07-28 07:39:59.387060"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "998927"], ["username", "marquis_bins"], ["image", "http://vk.com/img/marquis_bins.jpg"], ["profile", "https://vk.com/marquis_bins"], ["email", "jerald_pouros@thompson.org"], ["gender", "female"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 32], ["user_id", 87], ["created_at", "2017-07-28 07:39:59.391347"], ["updated_at", "2017-07-28 07:39:59.391347"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zontrax"], ["created_at", "2017-07-28 07:39:59.398642"], ["updated_at", "2017-07-28 07:39:59.398642"], ["local_path", "http://kaulke.biz/grover"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Kanlam"], ["title_ru", "Название56"], ["created_at", "2017-07-28 07:39:59.402530"], ["updated_at", "2017-07-28 07:39:59.402530"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 56[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_56[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 56) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>56, "title"=>"Zontrax", "created_at"=>Fri, 28 Jul 2017 07:39:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:59 UTC +00:00, "local_path"=>"http://kaulke.biz/grover"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "wrapsafe"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "wrapsafe"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Wrapsafe"], ["category_id", 56], ["slug", "wrapsafe"], ["created_at", "2017-07-28 07:39:59.414071"], ["updated_at", "2017-07-28 07:39:59.414071"], ["layout_id", 56]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "thad"], ["email", "letha@thielnienow.org"], ["password", "ElPzYvJ5Eh"], ["created_at", "2017-07-28 07:39:59.419108"], ["updated_at", "2017-07-28 07:39:59.419108"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "dolorem-at"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Asoka"], ["phone", "750-422-4525"], ["address", "20442 Barbara Union"], ["url", "http://mckenziehudson.net/buford"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://stroman.net/yazmin_kuvalis"], ["auth_expiration_time", 900], ["slug", "dolorem-at"], ["brand_id", 56], ["user_id", 88], ["created_at", "2017-07-28 07:39:59.424891"], ["updated_at", "2017-07-28 07:39:59.424891"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Konklab"], ["created_at", "2017-07-28 07:39:59.432799"], ["updated_at", "2017-07-28 07:39:59.432799"], ["local_path", "http://schumm.net/kim"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Rank"], ["title_ru", "Название57"], ["created_at", "2017-07-28 07:39:59.436424"], ["updated_at", "2017-07-28 07:39:59.436424"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_57[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 57) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>57, "title"=>"Konklab", "created_at"=>Fri, 28 Jul 2017 07:39:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:59 UTC +00:00, "local_path"=>"http://schumm.net/kim"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "latlux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "latlux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Latlux"], ["category_id", 57], ["slug", "latlux"], ["created_at", "2017-07-28 07:39:59.447395"], ["updated_at", "2017-07-28 07:39:59.447395"], ["layout_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "amiya.skiles"], ["email", "chelsie_fahey@hansen.com"], ["password", "Qo63S6K2Jh0pSaCq"], ["created_at", "2017-07-28 07:39:59.452009"], ["updated_at", "2017-07-28 07:39:59.452009"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "dolore_ab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Fintone"], ["phone", "1-405-705-8705"], ["address", "524 Craig Turnpike"], ["url", "http://hammesgoyette.com/eliza_hane"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://beer.name/dayne_champlin"], ["auth_expiration_time", 900], ["slug", "dolore_ab"], ["brand_id", 57], ["user_id", 89], ["created_at", "2017-07-28 07:39:59.457809"], ["updated_at", "2017-07-28 07:39:59.457809"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "christian_cain"], ["email", "evelyn@schumm.biz"], ["password", "25FlDy7jSk1lK"], ["created_at", "2017-07-28 07:39:59.463217"], ["updated_at", "2017-07-28 07:39:59.463217"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53317"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53317"], ["comment", "comment 117"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "115.249.3.217"], ["router_admin_ip", "113.20.23.205"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "774"], ["status", "t"], ["location_id", 57], ["user_id", 90], ["created_at", "2017-07-28 07:39:59.468790"], ["updated_at", "2017-07-28 07:39:59.468790"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53317"], ["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 17], ["serial", "643705CA5E36/53317"], ["comment", "comment 117"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "115.249.3.217"], ["router_admin_ip", "113.20.23.205"], ["admin_password", "2904d320a68ebabc"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "17"], ["status", "t"], ["location_id", 57], ["user_id", 90], ["created_at", "2017-07-28 07:39:59.468790"], ["updated_at", "2017-07-28 07:39:59.468790"], ["id", 17]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 9614b887-c1c2-4d99-9593-5550c9a0fea4) to Async(routers) with arguments: #<GlobalID:0x007fc0d97b5038 @uri=#<URI::GID gid://wifi-management/Router/17>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: d66b2e07-e17f-4227-9825-2bebf50c68fa) to Async(routers) with arguments: #<GlobalID:0x007fc0d97b5038 @uri=#<URI::GID gid://wifi-management/Router/17>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 17], ["provider", "instagram"], ["location_id", 56], ["router_id", 17], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/age" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:39:59 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#age_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"age_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.5ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(56, 57) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 5ms [30m(Views: 1.3ms | ActiveRecord: 2.2ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "926.121.8213"], ["created_at", "2017-07-28 07:39:59.736418"], ["updated_at", "2017-07-28 07:39:59.736418"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "clement"], ["email", "jack_lind@homenickgrady.info"], ["password", "6nH1BaOyRrP6"], ["created_at", "2017-07-28 07:39:59.741444"], ["updated_at", "2017-07-28 07:39:59.741444"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "84908"], ["username", "shaylee"], ["image", "http://vk.com/img/shaylee.jpg"], ["profile", "https://vk.com/shaylee"], ["email", "cortney@bashirianbogisich.info"], ["gender", "female"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 33], ["user_id", 91], ["created_at", "2017-07-28 07:39:59.745763"], ["updated_at", "2017-07-28 07:39:59.745763"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tempsoft"], ["created_at", "2017-07-28 07:39:59.753218"], ["updated_at", "2017-07-28 07:39:59.753218"], ["local_path", "http://considine.org/stephania.volkman"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Alpha"], ["title_ru", "Название58"], ["created_at", "2017-07-28 07:39:59.757271"], ["updated_at", "2017-07-28 07:39:59.757271"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 58[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_58[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 58) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>58, "title"=>"Tempsoft", "created_at"=>Fri, 28 Jul 2017 07:39:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:59 UTC +00:00, "local_path"=>"http://considine.org/stephania.volkman"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zontrax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zontrax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zontrax"], ["category_id", 58], ["slug", "zontrax"], ["created_at", "2017-07-28 07:39:59.769362"], ["updated_at", "2017-07-28 07:39:59.769362"], ["layout_id", 58]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "kyleigh.pouros"], ["email", "trey@marquardtbalistreri.name"], ["password", "WyOoWzTg86Q"], ["created_at", "2017-07-28 07:39:59.774252"], ["updated_at", "2017-07-28 07:39:59.774252"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quo.voluptatem"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Prodder"], ["phone", "1-187-559-6522"], ["address", "676 Stehr Skyway"], ["url", "http://beer.org/kelly"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://cain.co/pamela_wehner"], ["auth_expiration_time", 900], ["slug", "quo.voluptatem"], ["brand_id", 58], ["user_id", 92], ["created_at", "2017-07-28 07:39:59.780362"], ["updated_at", "2017-07-28 07:39:59.780362"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Lotlux"], ["created_at", "2017-07-28 07:39:59.788498"], ["updated_at", "2017-07-28 07:39:59.788498"], ["local_path", "http://white.biz/rosa"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Home Ing"], ["title_ru", "Название59"], ["created_at", "2017-07-28 07:39:59.792502"], ["updated_at", "2017-07-28 07:39:59.792502"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 59[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_59[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 59) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>59, "title"=>"Lotlux", "created_at"=>Fri, 28 Jul 2017 07:39:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:39:59 UTC +00:00, "local_path"=>"http://white.biz/rosa"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "temp"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "temp"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Temp"], ["category_id", 59], ["slug", "temp"], ["created_at", "2017-07-28 07:39:59.803913"], ["updated_at", "2017-07-28 07:39:59.803913"], ["layout_id", 59]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "tyra"], ["email", "anita@mraz.biz"], ["password", "Ug1o88Mx"], ["created_at", "2017-07-28 07:39:59.808865"], ["updated_at", "2017-07-28 07:39:59.808865"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "recusandae-rem"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zamit"], ["phone", "611-147-4844"], ["address", "38489 Hilton Forest"], ["url", "http://bernier.com/tia_raynor"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://gerhold.io/carmen_howell"], ["auth_expiration_time", 900], ["slug", "recusandae-rem"], ["brand_id", 59], ["user_id", 93], ["created_at", "2017-07-28 07:39:59.815271"], ["updated_at", "2017-07-28 07:39:59.815271"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "eleonore"], ["email", "shany_littel@schaden.co"], ["password", "AvE5A7HtT"], ["created_at", "2017-07-28 07:39:59.820863"], ["updated_at", "2017-07-28 07:39:59.820863"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53318"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53318"], ["comment", "comment 118"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "156.223.175.96"], ["router_admin_ip", "183.167.186.140"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "320"], ["status", "t"], ["location_id", 59], ["user_id", 94], ["created_at", "2017-07-28 07:39:59.826770"], ["updated_at", "2017-07-28 07:39:59.826770"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53318"], ["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 18], ["serial", "643705CA5E36/53318"], ["comment", "comment 118"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "156.223.175.96"], ["router_admin_ip", "183.167.186.140"], ["admin_password", "4b9d7e85cb18ce6a"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "18"], ["status", "t"], ["location_id", 59], ["user_id", 94], ["created_at", "2017-07-28 07:39:59.826770"], ["updated_at", "2017-07-28 07:39:59.826770"], ["id", 18]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 929aa7a2-3276-446d-96ec-b9038d405552) to Async(routers) with arguments: #<GlobalID:0x007fc0d94efec0 @uri=#<URI::GID gid://wifi-management/Router/18>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 3e573de1-3d33-4758-b2f0-dc7d7f13527a) to Async(routers) with arguments: #<GlobalID:0x007fc0d94efec0 @uri=#<URI::GID gid://wifi-management/Router/18>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 18], ["provider", "instagram"], ["location_id", 58], ["router_id", 18], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/visitors" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:40:00 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#visitors_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"visitors_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" IN (58, 59) AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 7ms [30m(Views: 1.3ms | ActiveRecord: 2.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mActiveRecord::SchemaMigration Load (1.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (4.2ms)[0m  [1m[35mALTER TABLE "answers" DISABLE TRIGGER ALL;ALTER TABLE "auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "bans" DISABLE TRIGGER ALL;ALTER TABLE "brands" DISABLE TRIGGER ALL;ALTER TABLE "categories" DISABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" DISABLE TRIGGER ALL;ALTER TABLE "social_logs" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "client_counters" DISABLE TRIGGER ALL;ALTER TABLE "client_devices" DISABLE TRIGGER ALL;ALTER TABLE "layouts" DISABLE TRIGGER ALL;ALTER TABLE "clients" DISABLE TRIGGER ALL;ALTER TABLE "social_accounts" DISABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" DISABLE TRIGGER ALL;ALTER TABLE "polls" DISABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" DISABLE TRIGGER ALL;ALTER TABLE "questions" DISABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "locations" DISABLE TRIGGER ALL;ALTER TABLE "notifications" DISABLE TRIGGER ALL;ALTER TABLE "opinions" DISABLE TRIGGER ALL;ALTER TABLE "pages" DISABLE TRIGGER ALL;ALTER TABLE "payments" DISABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "products" DISABLE TRIGGER ALL;ALTER TABLE "routers" DISABLE TRIGGER ALL;ALTER TABLE "sessions" DISABLE TRIGGER ALL;ALTER TABLE "sms_logs" DISABLE TRIGGER ALL;ALTER TABLE "vips" DISABLE TRIGGER ALL;ALTER TABLE "vouchers" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL;ALTER TABLE "attempts" DISABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.3ms)[0m  [1m[34m          SELECT schemaname || '.' || tablename
          FROM pg_tables
          WHERE
            tablename !~ '_prt_' AND
            tablename <> 'schema_migrations' AND
            schemaname = ANY (current_schemas(false))
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.5ms)[0m  [1m[34mselect table_name from information_schema.views where table_schema = 'gycwifi_api_test'[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (149.8ms)[0m  [1m[35mTRUNCATE TABLE "public"."answers", "public"."auth_logs", "public"."bans", "public"."brands", "public"."categories", "public"."client_accounting_logs", "public"."social_logs", "public"."users", "public"."client_counters", "public"."client_devices", "public"."layouts", "public"."clients", "public"."social_accounts", "public"."delayed_jobs", "public"."polls", "public"."device_auth_pendings", "public"."questions", "public"."friendly_id_slugs", "public"."locations", "public"."notifications", "public"."opinions", "public"."pages", "public"."payments", "public"."post_auth_logs", "public"."products", "public"."routers", "public"."sessions", "public"."sms_logs", "public"."vips", "public"."vouchers", "public"."ar_internal_metadata", "public"."attempts" RESTART IDENTITY CASCADE;[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.9ms)[0m  [1m[35mALTER TABLE "answers" ENABLE TRIGGER ALL;ALTER TABLE "auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "bans" ENABLE TRIGGER ALL;ALTER TABLE "brands" ENABLE TRIGGER ALL;ALTER TABLE "categories" ENABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" ENABLE TRIGGER ALL;ALTER TABLE "social_logs" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "client_counters" ENABLE TRIGGER ALL;ALTER TABLE "client_devices" ENABLE TRIGGER ALL;ALTER TABLE "layouts" ENABLE TRIGGER ALL;ALTER TABLE "clients" ENABLE TRIGGER ALL;ALTER TABLE "social_accounts" ENABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" ENABLE TRIGGER ALL;ALTER TABLE "polls" ENABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" ENABLE TRIGGER ALL;ALTER TABLE "questions" ENABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" ENABLE TRIGGER ALL;ALTER TABLE "locations" ENABLE TRIGGER ALL;ALTER TABLE "notifications" ENABLE TRIGGER ALL;ALTER TABLE "opinions" ENABLE TRIGGER ALL;ALTER TABLE "pages" ENABLE TRIGGER ALL;ALTER TABLE "payments" ENABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "products" ENABLE TRIGGER ALL;ALTER TABLE "routers" ENABLE TRIGGER ALL;ALTER TABLE "sessions" ENABLE TRIGGER ALL;ALTER TABLE "sms_logs" ENABLE TRIGGER ALL;ALTER TABLE "vips" ENABLE TRIGGER ALL;ALTER TABLE "vouchers" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL;ALTER TABLE "attempts" ENABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.9ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(626) 305-0372"], ["created_at", "2017-07-28 07:41:49.047200"], ["updated_at", "2017-07-28 07:41:49.047200"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zoolab"], ["created_at", "2017-07-28 07:41:49.182160"], ["updated_at", "2017-07-28 07:41:49.182160"], ["local_path", "http://baileyswaniawski.com/justine_moriette"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Asoka"], ["title_ru", "Название1"], ["created_at", "2017-07-28 07:41:49.197704"], ["updated_at", "2017-07-28 07:41:49.197704"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 1[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (1.2ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 1) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>1, "title"=>"Zoolab", "created_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "local_path"=>"http://baileyswaniawski.com/justine_moriette"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.9ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "greenlam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "greenlam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Greenlam"], ["category_id", 1], ["slug", "greenlam"], ["created_at", "2017-07-28 07:41:49.342436"], ["updated_at", "2017-07-28 07:41:49.342436"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "carmel.crona"], ["email", "hubert@walterwuckert.co"], ["password", "0y4mVw6f"], ["created_at", "2017-07-28 07:41:49.390845"], ["updated_at", "2017-07-28 07:41:49.390845"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "corrupti.sit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Rank"], ["phone", "(547) 793-5952"], ["address", "8183 Steuber Freeway"], ["url", "http://mayertko.co/michele"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://volkmanhomenick.net/greta.leffler"], ["auth_expiration_time", 900], ["slug", "corrupti.sit"], ["brand_id", 1], ["user_id", 1], ["created_at", "2017-07-28 07:41:49.403298"], ["updated_at", "2017-07-28 07:41:49.403298"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 1], ["location_id", 1], ["counter", 2], ["created_at", "2017-07-28 07:41:49.410353"], ["updated_at", "2017-07-28 07:41:49.410353"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(139) 541-7539"], ["created_at", "2017-07-28 07:41:49.415660"], ["updated_at", "2017-07-28 07:41:49.415660"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Opela"], ["created_at", "2017-07-28 07:41:49.422434"], ["updated_at", "2017-07-28 07:41:49.422434"], ["local_path", "http://spencer.co/dorris.douglas"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Temp"], ["title_ru", "Название2"], ["created_at", "2017-07-28 07:41:49.426453"], ["updated_at", "2017-07-28 07:41:49.426453"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 2[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_2[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 2) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>2, "title"=>"Opela", "created_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "local_path"=>"http://spencer.co/dorris.douglas"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "subin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "subin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Subin"], ["category_id", 2], ["slug", "subin"], ["created_at", "2017-07-28 07:41:49.437903"], ["updated_at", "2017-07-28 07:41:49.437903"], ["layout_id", 2]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ursula.senger"], ["email", "jedediah@ward.net"], ["password", "99HtKoDlV4Z"], ["created_at", "2017-07-28 07:41:49.443154"], ["updated_at", "2017-07-28 07:41:49.443154"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "eveniet_soluta"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Rank"], ["phone", "949.379.4382"], ["address", "8567 O'Reilly Rapids"], ["url", "http://will.biz/elva"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://murphybalistreri.org/vidal"], ["auth_expiration_time", 900], ["slug", "eveniet_soluta"], ["brand_id", 2], ["user_id", 2], ["created_at", "2017-07-28 07:41:49.449290"], ["updated_at", "2017-07-28 07:41:49.449290"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 2], ["location_id", 2], ["counter", 8], ["created_at", "2017-07-28 07:41:49.454089"], ["updated_at", "2017-07-28 07:41:49.454089"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Konklab"], ["created_at", "2017-07-28 07:41:49.460656"], ["updated_at", "2017-07-28 07:41:49.460656"], ["local_path", "http://trantow.com/alia.hansen"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Cardguard"], ["title_ru", "Название3"], ["created_at", "2017-07-28 07:41:49.464732"], ["updated_at", "2017-07-28 07:41:49.464732"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 3[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_3[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 3) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>3, "title"=>"Konklab", "created_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "local_path"=>"http://trantow.com/alia.hansen"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tempsoft"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tempsoft"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tempsoft"], ["category_id", 3], ["slug", "tempsoft"], ["created_at", "2017-07-28 07:41:49.476179"], ["updated_at", "2017-07-28 07:41:49.476179"], ["layout_id", 3]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "amir_gutmann"], ["email", "mitchel@hegmann.org"], ["password", "3xXtMsAoHc2kS"], ["created_at", "2017-07-28 07:41:49.481229"], ["updated_at", "2017-07-28 07:41:49.481229"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ut.nemo"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Span"], ["phone", "1-276-091-9992"], ["address", "46628 Lorenz Station"], ["url", "http://pagac.org/marilie.welch"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://huel.org/rick_kihn"], ["auth_expiration_time", 900], ["slug", "ut.nemo"], ["brand_id", 3], ["user_id", 3], ["created_at", "2017-07-28 07:41:49.487361"], ["updated_at", "2017-07-28 07:41:49.487361"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 1], ["location_id", 3], ["counter", 10], ["created_at", "2017-07-28 07:41:49.492075"], ["updated_at", "2017-07-28 07:41:49.492075"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "bernard"], ["email", "melisa_renner@baumbach.org"], ["password", "FpZg18W2W7Pj3hR"], ["role_cd", 3], ["created_at", "2017-07-28 07:41:49.496803"], ["updated_at", "2017-07-28 07:41:49.496803"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:49 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"bernard", "email"=>"melisa_renner@baumbach.org", "password"=>"FpZg18W2W7Pj3hR", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"bernard", :email=>"melisa_renner@baumbach.org", :password=>"FpZg18W2W7Pj3hR", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"melisa_renner@baumbach.org", "password"=>"FpZg18W2W7Pj3hR"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "bernard"], ["email", "melisa_renner@baumbach.org"], ["password", "FpZg18W2W7Pj3hR"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 4, username: "bernard", email: "melisa_renner@baumbach.org", password: "FpZg18W2W7Pj3hR", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:41:49", updated_at: "2017-07-28 07:41:49", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 4[0m
[INFO ] Completed [32m201 Created[0m in 7ms [30m(Views: 0.3ms | ActiveRecord: 1.3ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=updated_at&updated_at=asc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:49 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"updated_at", "updated_at"=>"asc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 4) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>4, "username"=>"bernard", "email"=>"melisa_renner@baumbach.org", "password"=>"FpZg18W2W7Pj3hR", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"updated_at", :updated_at=>"asc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (1.3ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>4, :username=>"bernard", :email=>"melisa_renner@baumbach.org", :password=>"FpZg18W2W7Pj3hR", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:41:49.496Z", :updated_at=>"2017-07-28T07:41:49.496Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.9ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:41:49.410353') AND "client_counters"."location_id" IN (1, 2, 3) GROUP BY client_id, phone_number ORDER BY updated_at asc, visits desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (2, 1)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (1.5ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (1, 2)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:41:49.410353') AND "client_counters"."location_id" IN (1, 2, 3) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 104ms [30m(Views: 0.7ms | ActiveRecord: 18.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(748) 613-5454"], ["created_at", "2017-07-28 07:41:49.696453"], ["updated_at", "2017-07-28 07:41:49.696453"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Flexidy"], ["created_at", "2017-07-28 07:41:49.703991"], ["updated_at", "2017-07-28 07:41:49.703991"], ["local_path", "http://baumbach.name/creola.fisher"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Sonsing"], ["title_ru", "Название4"], ["created_at", "2017-07-28 07:41:49.707881"], ["updated_at", "2017-07-28 07:41:49.707881"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_4[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 4) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>4, "title"=>"Flexidy", "created_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "local_path"=>"http://baumbach.name/creola.fisher"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "hatity"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "hatity"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Hatity"], ["category_id", 4], ["slug", "hatity"], ["created_at", "2017-07-28 07:41:49.719361"], ["updated_at", "2017-07-28 07:41:49.719361"], ["layout_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "makenzie_hoppe"], ["email", "maximo@blick.net"], ["password", "U3FrIuNxRcO"], ["created_at", "2017-07-28 07:41:49.724272"], ["updated_at", "2017-07-28 07:41:49.724272"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "nesciunt-fugit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Aerified"], ["phone", "786-702-3860"], ["address", "4190 Makayla Parkway"], ["url", "http://blick.org/consuelo"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://funk.info/dawson"], ["auth_expiration_time", 900], ["slug", "nesciunt-fugit"], ["brand_id", 4], ["user_id", 5], ["created_at", "2017-07-28 07:41:49.730299"], ["updated_at", "2017-07-28 07:41:49.730299"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 3], ["location_id", 4], ["counter", 6], ["created_at", "2017-07-28 07:41:49.735210"], ["updated_at", "2017-07-28 07:41:49.735210"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "244-129-1306 x838"], ["created_at", "2017-07-28 07:41:49.738968"], ["updated_at", "2017-07-28 07:41:49.738968"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Keylex"], ["created_at", "2017-07-28 07:41:49.745569"], ["updated_at", "2017-07-28 07:41:49.745569"], ["local_path", "http://bechtelar.io/king.bechtelar"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Namfix"], ["title_ru", "Название5"], ["created_at", "2017-07-28 07:41:49.749438"], ["updated_at", "2017-07-28 07:41:49.749438"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 5[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_5[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 5) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>5, "title"=>"Keylex", "created_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "local_path"=>"http://bechtelar.io/king.bechtelar"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "keylex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "keylex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Keylex"], ["category_id", 5], ["slug", "keylex"], ["created_at", "2017-07-28 07:41:49.760648"], ["updated_at", "2017-07-28 07:41:49.760648"], ["layout_id", 5]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "madaline"], ["email", "shanelle@becker.co"], ["password", "F4MtAb7c0w7p"], ["created_at", "2017-07-28 07:41:49.765525"], ["updated_at", "2017-07-28 07:41:49.765525"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptas.qui"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Konklux"], ["phone", "1-225-692-4159"], ["address", "59730 Stroman Knolls"], ["url", "http://bergedietrich.co/alexandrine.fisher"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://haag.info/kadin"], ["auth_expiration_time", 900], ["slug", "voluptas.qui"], ["brand_id", 5], ["user_id", 6], ["created_at", "2017-07-28 07:41:49.771259"], ["updated_at", "2017-07-28 07:41:49.771259"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 4], ["location_id", 5], ["counter", 10], ["created_at", "2017-07-28 07:41:49.776173"], ["updated_at", "2017-07-28 07:41:49.776173"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zathin"], ["created_at", "2017-07-28 07:41:49.782684"], ["updated_at", "2017-07-28 07:41:49.782684"], ["local_path", "http://abernathy.name/bernie.schroeder"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Biodex"], ["title_ru", "Название6"], ["created_at", "2017-07-28 07:41:49.786486"], ["updated_at", "2017-07-28 07:41:49.786486"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 6[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_6[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 6) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>6, "title"=>"Zathin", "created_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "local_path"=>"http://abernathy.name/bernie.schroeder"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alphazap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alphazap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Alphazap"], ["category_id", 6], ["slug", "alphazap"], ["created_at", "2017-07-28 07:41:49.798063"], ["updated_at", "2017-07-28 07:41:49.798063"], ["layout_id", 6]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "maurine"], ["email", "anastacio_hills@wittingweinat.info"], ["password", "NhThQr6qBuR33"], ["created_at", "2017-07-28 07:41:49.802896"], ["updated_at", "2017-07-28 07:41:49.802896"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "magnam-nisi"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Vagram"], ["phone", "(548) 022-0651"], ["address", "99786 Schultz Drive"], ["url", "http://robel.org/dagmar"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://mueller.org/lemuel"], ["auth_expiration_time", 900], ["slug", "magnam-nisi"], ["brand_id", 6], ["user_id", 7], ["created_at", "2017-07-28 07:41:49.808861"], ["updated_at", "2017-07-28 07:41:49.808861"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 3], ["location_id", 6], ["counter", 5], ["created_at", "2017-07-28 07:41:49.813763"], ["updated_at", "2017-07-28 07:41:49.813763"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "else"], ["email", "isac@prohaska.info"], ["password", "Lp9qI0JeU5C"], ["role_cd", 3], ["created_at", "2017-07-28 07:41:49.818589"], ["updated_at", "2017-07-28 07:41:49.818589"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:49 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"else", "email"=>"isac@prohaska.info", "password"=>"Lp9qI0JeU5C", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"else", :email=>"isac@prohaska.info", :password=>"Lp9qI0JeU5C", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"isac@prohaska.info", "password"=>"Lp9qI0JeU5C"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "else"], ["email", "isac@prohaska.info"], ["password", "Lp9qI0JeU5C"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 8, username: "else", email: "isac@prohaska.info", password: "Lp9qI0JeU5C", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:41:49", updated_at: "2017-07-28 07:41:49", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 8[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=regular&loyalty_days=7&page=1&sort_field=visits30&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:49 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"regular", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits30", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 8) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>8, "username"=>"else", "email"=>"isac@prohaska.info", "password"=>"Lp9qI0JeU5C", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"regular", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits30", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.7ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>8, :username=>"else", :email=>"isac@prohaska.info", :password=>"Lp9qI0JeU5C", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:41:49.818Z", :updated_at=>"2017-07-28T07:41:49.818Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:41:49.735210') AND "client_counters"."location_id" IN (4, 5, 6) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) > 1) ORDER BY visits30 asc, updated_at desc, visits desc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 3[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 3[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:41:49.735210') AND "client_counters"."location_id" IN (4, 5, 6) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) > 1)[0m
[INFO ] Completed [32m200 OK[0m in 34ms [30m(Views: 0.5ms | ActiveRecord: 8.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(918) 521-5541"], ["created_at", "2017-07-28 07:41:49.872571"], ["updated_at", "2017-07-28 07:41:49.872571"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Y-find"], ["created_at", "2017-07-28 07:41:49.879734"], ["updated_at", "2017-07-28 07:41:49.879734"], ["local_path", "http://fahey.co/demond.bergnaum"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Ronstring"], ["title_ru", "Название7"], ["created_at", "2017-07-28 07:41:49.883596"], ["updated_at", "2017-07-28 07:41:49.883596"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 7[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_7[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 7) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>7, "title"=>"Y-find", "created_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "local_path"=>"http://fahey.co/demond.bergnaum"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-solowarm"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-solowarm"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Y-Solowarm"], ["category_id", 7], ["slug", "y-solowarm"], ["created_at", "2017-07-28 07:41:49.894973"], ["updated_at", "2017-07-28 07:41:49.894973"], ["layout_id", 7]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "armando"], ["email", "alfonzo@runolfsdottir.co"], ["password", "Vd57Md80WbNh3e3"], ["created_at", "2017-07-28 07:41:49.900046"], ["updated_at", "2017-07-28 07:41:49.900046"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et.consequatur"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bamity"], ["phone", "987-813-1512"], ["address", "27759 Mertie Prairie"], ["url", "http://gleichner.info/raphael.steuber"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://skiles.org/jammie"], ["auth_expiration_time", 900], ["slug", "et.consequatur"], ["brand_id", 7], ["user_id", 9], ["created_at", "2017-07-28 07:41:49.905988"], ["updated_at", "2017-07-28 07:41:49.905988"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 5], ["location_id", 7], ["counter", 10], ["created_at", "2017-07-28 07:41:49.910752"], ["updated_at", "2017-07-28 07:41:49.910752"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-641-780-8484"], ["created_at", "2017-07-28 07:41:49.914574"], ["updated_at", "2017-07-28 07:41:49.914574"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bamity"], ["created_at", "2017-07-28 07:41:49.921091"], ["updated_at", "2017-07-28 07:41:49.921091"], ["local_path", "http://friesenlehner.org/angelica_okuneva"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fintone"], ["title_ru", "Название8"], ["created_at", "2017-07-28 07:41:49.924855"], ["updated_at", "2017-07-28 07:41:49.924855"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 8) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>8, "title"=>"Bamity", "created_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "local_path"=>"http://friesenlehner.org/angelica_okuneva"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "asoka"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "asoka"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Asoka"], ["category_id", 8], ["slug", "asoka"], ["created_at", "2017-07-28 07:41:49.936043"], ["updated_at", "2017-07-28 07:41:49.936043"], ["layout_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lula"], ["email", "stanford_heathcote@brownblanda.com"], ["password", "2uKrWw4dSwUcAk8j"], ["created_at", "2017-07-28 07:41:49.941005"], ["updated_at", "2017-07-28 07:41:49.941005"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptatem-laborum"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stim"], ["phone", "1-686-860-2350"], ["address", "982 Deckow Squares"], ["url", "http://jenkins.name/ines.bogan"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://grantbuckridge.name/antonio"], ["auth_expiration_time", 900], ["slug", "voluptatem-laborum"], ["brand_id", 8], ["user_id", 10], ["created_at", "2017-07-28 07:41:49.947002"], ["updated_at", "2017-07-28 07:41:49.947002"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 6], ["location_id", 8], ["counter", 2], ["created_at", "2017-07-28 07:41:49.951943"], ["updated_at", "2017-07-28 07:41:49.951943"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Opela"], ["created_at", "2017-07-28 07:41:49.958620"], ["updated_at", "2017-07-28 07:41:49.958620"], ["local_path", "http://mills.biz/julian_macejkovic"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Daltfresh"], ["title_ru", "Название9"], ["created_at", "2017-07-28 07:41:49.962413"], ["updated_at", "2017-07-28 07:41:49.962413"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 9[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_9[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 9) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>9, "title"=>"Opela", "created_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "local_path"=>"http://mills.biz/julian_macejkovic"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "rank"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "rank"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Rank"], ["category_id", 9], ["slug", "rank"], ["created_at", "2017-07-28 07:41:49.973655"], ["updated_at", "2017-07-28 07:41:49.973655"], ["layout_id", 9]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jazmyn"], ["email", "grayson_block@kirlin.com"], ["password", "FbXq3t8lLv6rUkR"], ["created_at", "2017-07-28 07:41:49.978503"], ["updated_at", "2017-07-28 07:41:49.978503"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quod-ad"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Asoka"], ["phone", "1-610-681-0069"], ["address", "90422 Celia Grove"], ["url", "http://sporerleffler.com/merl.leuschke"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://zboncaklesch.io/amy.ledner"], ["auth_expiration_time", 900], ["slug", "quod-ad"], ["brand_id", 9], ["user_id", 11], ["created_at", "2017-07-28 07:41:49.984716"], ["updated_at", "2017-07-28 07:41:49.984716"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 5], ["location_id", 9], ["counter", 9], ["created_at", "2017-07-28 07:41:49.989405"], ["updated_at", "2017-07-28 07:41:49.989405"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "aracely"], ["email", "wilburn@wymandouglas.co"], ["password", "X428HwPqS74l"], ["role_cd", 3], ["created_at", "2017-07-28 07:41:49.994373"], ["updated_at", "2017-07-28 07:41:49.994373"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:49 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"aracely", "email"=>"wilburn@wymandouglas.co", "password"=>"X428HwPqS74l", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"aracely", :email=>"wilburn@wymandouglas.co", :password=>"X428HwPqS74l", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"wilburn@wymandouglas.co", "password"=>"X428HwPqS74l"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "aracely"], ["email", "wilburn@wymandouglas.co"], ["password", "X428HwPqS74l"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 12, username: "aracely", email: "wilburn@wymandouglas.co", password: "X428HwPqS74l", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:41:49", updated_at: "2017-07-28 07:41:49", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 12[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=passed&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:50 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"passed", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 12) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>12, "username"=>"aracely", "email"=>"wilburn@wymandouglas.co", "password"=>"X428HwPqS74l", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:49 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"passed", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>12, :username=>"aracely", :email=>"wilburn@wymandouglas.co", :password=>"X428HwPqS74l", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:41:49.994Z", :updated_at=>"2017-07-28T07:41:49.994Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:41:50.024596') AND "client_counters"."location_id" IN (7, 8, 9) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1) ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 6[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 6[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:41:50.024596') AND "client_counters"."location_id" IN (7, 8, 9) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1)[0m
[INFO ] Completed [32m200 OK[0m in 30ms [30m(Views: 0.5ms | ActiveRecord: 8.3ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "206-653-9103 x3281"], ["created_at", "2017-07-28 07:41:50.046062"], ["updated_at", "2017-07-28 07:41:50.046062"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Toughjoyfax"], ["created_at", "2017-07-28 07:41:50.054261"], ["updated_at", "2017-07-28 07:41:50.054261"], ["local_path", "http://weber.biz/ricky.ruecker"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Redhold"], ["title_ru", "Название10"], ["created_at", "2017-07-28 07:41:50.058117"], ["updated_at", "2017-07-28 07:41:50.058117"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 10[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_10[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 10) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>10, "title"=>"Toughjoyfax", "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "local_path"=>"http://weber.biz/ricky.ruecker"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "keylex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "keylex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Keylex"], ["category_id", 10], ["slug", "keylex"], ["created_at", "2017-07-28 07:41:50.069977"], ["updated_at", "2017-07-28 07:41:50.069977"], ["layout_id", 10]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "earline"], ["email", "guy@champlin.org"], ["password", "3yY6FyC2J3QnR0O"], ["created_at", "2017-07-28 07:41:50.075281"], ["updated_at", "2017-07-28 07:41:50.075281"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "id-in"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Overhold"], ["phone", "648-574-6331"], ["address", "270 Abshire Streets"], ["url", "http://bartoletti.biz/mallory_cummings"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hamill.io/linnea"], ["auth_expiration_time", 900], ["slug", "id-in"], ["brand_id", 10], ["user_id", 13], ["created_at", "2017-07-28 07:41:50.081538"], ["updated_at", "2017-07-28 07:41:50.081538"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 7], ["location_id", 10], ["counter", 4], ["created_at", "2017-07-28 07:41:50.086460"], ["updated_at", "2017-07-28 07:41:50.086460"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-440-077-3554"], ["created_at", "2017-07-28 07:41:50.090309"], ["updated_at", "2017-07-28 07:41:50.090309"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zontrax"], ["created_at", "2017-07-28 07:41:50.097373"], ["updated_at", "2017-07-28 07:41:50.097373"], ["local_path", "http://carterdietrich.name/brigitte"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Pannier"], ["title_ru", "Название11"], ["created_at", "2017-07-28 07:41:50.100984"], ["updated_at", "2017-07-28 07:41:50.100984"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 11[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_11[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 11) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>11, "title"=>"Zontrax", "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "local_path"=>"http://carterdietrich.name/brigitte"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Quo Lux"], ["category_id", 11], ["slug", "quo-lux"], ["created_at", "2017-07-28 07:41:50.112662"], ["updated_at", "2017-07-28 07:41:50.112662"], ["layout_id", 11]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "nelle"], ["email", "emelia@rohanrosenbaum.biz"], ["password", "Aj38C1XsFx"], ["created_at", "2017-07-28 07:41:50.117858"], ["updated_at", "2017-07-28 07:41:50.117858"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "blanditiis_enim"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Hatity"], ["phone", "1-789-333-2490"], ["address", "42460 Dooley Club"], ["url", "http://balistreri.org/cale.lesch"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://shields.io/dan"], ["auth_expiration_time", 900], ["slug", "blanditiis_enim"], ["brand_id", 11], ["user_id", 14], ["created_at", "2017-07-28 07:41:50.124023"], ["updated_at", "2017-07-28 07:41:50.124023"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 8], ["location_id", 11], ["counter", 10], ["created_at", "2017-07-28 07:41:50.128848"], ["updated_at", "2017-07-28 07:41:50.128848"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Veribet"], ["created_at", "2017-07-28 07:41:50.135806"], ["updated_at", "2017-07-28 07:41:50.135806"], ["local_path", "http://volkmanemmerich.org/lambert"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "It"], ["title_ru", "Название12"], ["created_at", "2017-07-28 07:41:50.139518"], ["updated_at", "2017-07-28 07:41:50.139518"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_12[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 12) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>12, "title"=>"Veribet", "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "local_path"=>"http://volkmanemmerich.org/lambert"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tres-zap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tres-zap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tres-Zap"], ["category_id", 12], ["slug", "tres-zap"], ["created_at", "2017-07-28 07:41:50.150683"], ["updated_at", "2017-07-28 07:41:50.150683"], ["layout_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ova_stark"], ["email", "darius@oberbrunner.net"], ["password", "YfM4HtMmMuBq29Lz"], ["created_at", "2017-07-28 07:41:50.155631"], ["updated_at", "2017-07-28 07:41:50.155631"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "unde.voluptates"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Y-Solowarm"], ["phone", "216-419-3891"], ["address", "4600 Emely Springs"], ["url", "http://rice.io/lavern_mcglynn"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://wiegand.com/delfina"], ["auth_expiration_time", 900], ["slug", "unde.voluptates"], ["brand_id", 12], ["user_id", 15], ["created_at", "2017-07-28 07:41:50.161585"], ["updated_at", "2017-07-28 07:41:50.161585"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 7], ["location_id", 12], ["counter", 5], ["created_at", "2017-07-28 07:41:50.166492"], ["updated_at", "2017-07-28 07:41:50.166492"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "It"], ["created_at", "2017-07-28 07:41:50.173558"], ["updated_at", "2017-07-28 07:41:50.173558"], ["local_path", "http://schoen.net/river_lowe"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Sonair"], ["title_ru", "Название13"], ["created_at", "2017-07-28 07:41:50.177631"], ["updated_at", "2017-07-28 07:41:50.177631"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 13[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_13[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 13) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>13, "title"=>"It", "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "local_path"=>"http://schoen.net/river_lowe"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tin"], ["category_id", 13], ["slug", "tin"], ["created_at", "2017-07-28 07:41:50.188920"], ["updated_at", "2017-07-28 07:41:50.188920"], ["layout_id", 13]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jaqueline"], ["email", "lauretta@fritsch.info"], ["password", "527x7uZzL"], ["created_at", "2017-07-28 07:41:50.194329"], ["updated_at", "2017-07-28 07:41:50.194329"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "distinctio_suscipit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bigtax"], ["phone", "498.466.2604"], ["address", "75750 Feil Crest"], ["url", "http://bartell.io/johnathan.wisoky"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://cummerata.co/carmen"], ["auth_expiration_time", 900], ["slug", "distinctio_suscipit"], ["brand_id", 13], ["user_id", 16], ["created_at", "2017-07-28 07:41:50.200087"], ["updated_at", "2017-07-28 07:41:50.200087"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 8], ["location_id", 13], ["counter", 8], ["created_at", "2017-07-20 07:41:50.169049"], ["updated_at", "2017-07-20 07:41:50.169162"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "marcelina_prosacco"], ["email", "kaleigh@ziemannschaden.com"], ["password", "S5VfSnLeYpB3J1Y"], ["role_cd", 3], ["created_at", "2017-07-28 07:41:50.209545"], ["updated_at", "2017-07-28 07:41:50.209545"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:50 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"marcelina_prosacco", "email"=>"kaleigh@ziemannschaden.com", "password"=>"S5VfSnLeYpB3J1Y", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"marcelina_prosacco", :email=>"kaleigh@ziemannschaden.com", :password=>"S5VfSnLeYpB3J1Y", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"kaleigh@ziemannschaden.com", "password"=>"S5VfSnLeYpB3J1Y"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "marcelina_prosacco"], ["email", "kaleigh@ziemannschaden.com"], ["password", "S5VfSnLeYpB3J1Y"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 17, username: "marcelina_prosacco", email: "kaleigh@ziemannschaden.com", password: "S5VfSnLeYpB3J1Y", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:41:50", updated_at: "2017-07-28 07:41:50", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 17[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=passed&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:50 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"passed", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 17) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>17, "username"=>"marcelina_prosacco", "email"=>"kaleigh@ziemannschaden.com", "password"=>"S5VfSnLeYpB3J1Y", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"passed", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>17, :username=>"marcelina_prosacco", :email=>"kaleigh@ziemannschaden.com", :password=>"S5VfSnLeYpB3J1Y", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:41:50.209Z", :updated_at=>"2017-07-28T07:41:50.209Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:41:50.238424') AND "client_counters"."location_id" IN (10, 11, 12, 13) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1) ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 8[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:41:50.238424') AND "client_counters"."location_id" IN (10, 11, 12, 13) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1)[0m
[INFO ] Completed [32m200 OK[0m in 29ms [30m(Views: 0.4ms | ActiveRecord: 7.9ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-302-276-2613 x678"], ["created_at", "2017-07-28 07:41:50.258583"], ["updated_at", "2017-07-28 07:41:50.258583"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Keylex"], ["created_at", "2017-07-28 07:41:50.265633"], ["updated_at", "2017-07-28 07:41:50.265633"], ["local_path", "http://hills.co/keon"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fixflex"], ["title_ru", "Название14"], ["created_at", "2017-07-28 07:41:50.269350"], ["updated_at", "2017-07-28 07:41:50.269350"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 14[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_14[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 14) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>14, "title"=>"Keylex", "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "local_path"=>"http://hills.co/keon"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "gembucket"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "gembucket"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Gembucket"], ["category_id", 14], ["slug", "gembucket"], ["created_at", "2017-07-28 07:41:50.281023"], ["updated_at", "2017-07-28 07:41:50.281023"], ["layout_id", 14]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lucious_pagac"], ["email", "dawson.robel@feilgleichner.biz"], ["password", "9xAo7lFy0vG6FuQ"], ["created_at", "2017-07-28 07:41:50.286018"], ["updated_at", "2017-07-28 07:41:50.286018"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptatum-est"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Flowdesk"], ["phone", "(855) 288-6314"], ["address", "102 Triston Union"], ["url", "http://roberts.io/barton"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://mcglynn.com/fredrick"], ["auth_expiration_time", 900], ["slug", "voluptatum-est"], ["brand_id", 14], ["user_id", 18], ["created_at", "2017-07-28 07:41:50.292051"], ["updated_at", "2017-07-28 07:41:50.292051"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 9], ["location_id", 14], ["counter", 5], ["created_at", "2017-07-28 07:41:50.296772"], ["updated_at", "2017-07-28 07:41:50.296772"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-597-863-6326 x973"], ["created_at", "2017-07-28 07:41:50.300794"], ["updated_at", "2017-07-28 07:41:50.300794"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Kanlam"], ["created_at", "2017-07-28 07:41:50.307462"], ["updated_at", "2017-07-28 07:41:50.307462"], ["local_path", "http://haley.co/ophelia"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Y-find"], ["title_ru", "Название15"], ["created_at", "2017-07-28 07:41:50.311164"], ["updated_at", "2017-07-28 07:41:50.311164"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 15[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_15[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 15) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>15, "title"=>"Kanlam", "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "local_path"=>"http://haley.co/ophelia"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "daltfresh"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "daltfresh"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Daltfresh"], ["category_id", 15], ["slug", "daltfresh"], ["created_at", "2017-07-28 07:41:50.322338"], ["updated_at", "2017-07-28 07:41:50.322338"], ["layout_id", 15]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "freida"], ["email", "golden.schuppe@littel.name"], ["password", "Cq9aDgMgB39yFeMy"], ["created_at", "2017-07-28 07:41:50.327527"], ["updated_at", "2017-07-28 07:41:50.327527"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "neque.quas"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Lotlux"], ["phone", "(113) 092-2535"], ["address", "186 Reina Square"], ["url", "http://abbottchamplin.org/eduardo"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://torp.biz/giovanna"], ["auth_expiration_time", 900], ["slug", "neque.quas"], ["brand_id", 15], ["user_id", 19], ["created_at", "2017-07-28 07:41:50.333456"], ["updated_at", "2017-07-28 07:41:50.333456"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 10], ["location_id", 15], ["counter", 5], ["created_at", "2017-07-28 07:41:50.338123"], ["updated_at", "2017-07-28 07:41:50.338123"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Holdlamis"], ["created_at", "2017-07-28 07:41:50.344865"], ["updated_at", "2017-07-28 07:41:50.344865"], ["local_path", "http://haagbalistreri.net/celestine.ernser"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Stringtough"], ["title_ru", "Название16"], ["created_at", "2017-07-28 07:41:50.348709"], ["updated_at", "2017-07-28 07:41:50.348709"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 16[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_16[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 16) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>16, "title"=>"Holdlamis", "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "local_path"=>"http://haagbalistreri.net/celestine.ernser"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "it"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "it"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "It"], ["category_id", 16], ["slug", "it"], ["created_at", "2017-07-28 07:41:50.359820"], ["updated_at", "2017-07-28 07:41:50.359820"], ["layout_id", 16]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "margarett_kuhic"], ["email", "brionna@hills.io"], ["password", "Un9dKhI7K59o5bRb"], ["created_at", "2017-07-28 07:41:50.364932"], ["updated_at", "2017-07-28 07:41:50.364932"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "aut-est"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Wrapsafe"], ["phone", "612.435.5162"], ["address", "985 Janis Burgs"], ["url", "http://kertzmannmccullough.biz/kiana"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://schuster.com/moie"], ["auth_expiration_time", 900], ["slug", "aut-est"], ["brand_id", 16], ["user_id", 20], ["created_at", "2017-07-28 07:41:50.371009"], ["updated_at", "2017-07-28 07:41:50.371009"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 9], ["location_id", 16], ["counter", 1], ["created_at", "2017-07-28 07:41:50.375743"], ["updated_at", "2017-07-28 07:41:50.375743"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "dorris_zboncak"], ["email", "angeline@stoltenberg.info"], ["password", "FqQtHnQhJdH"], ["role_cd", 3], ["created_at", "2017-07-28 07:41:50.380472"], ["updated_at", "2017-07-28 07:41:50.380472"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:50 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"dorris_zboncak", "email"=>"angeline@stoltenberg.info", "password"=>"FqQtHnQhJdH", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"dorris_zboncak", :email=>"angeline@stoltenberg.info", :password=>"FqQtHnQhJdH", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"angeline@stoltenberg.info", "password"=>"FqQtHnQhJdH"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "dorris_zboncak"], ["email", "angeline@stoltenberg.info"], ["password", "FqQtHnQhJdH"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 21, username: "dorris_zboncak", email: "angeline@stoltenberg.info", password: "FqQtHnQhJdH", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:41:50", updated_at: "2017-07-28 07:41:50", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 21[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:50 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 21) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>21, "username"=>"dorris_zboncak", "email"=>"angeline@stoltenberg.info", "password"=>"FqQtHnQhJdH", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.7ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>21, :username=>"dorris_zboncak", :email=>"angeline@stoltenberg.info", :password=>"FqQtHnQhJdH", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:41:50.380Z", :updated_at=>"2017-07-28T07:41:50.380Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:41:50.296772') AND "client_counters"."location_id" IN (14, 15, 16) GROUP BY client_id, phone_number ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (9, 10)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.9ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (9, 10)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:41:50.296772') AND "client_counters"."location_id" IN (14, 15, 16) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 32ms [30m(Views: 0.6ms | ActiveRecord: 8.6ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-767-968-9777"], ["created_at", "2017-07-28 07:41:50.432669"], ["updated_at", "2017-07-28 07:41:50.432669"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Fixflex"], ["created_at", "2017-07-28 07:41:50.439885"], ["updated_at", "2017-07-28 07:41:50.439885"], ["local_path", "http://gerhold.org/roscoe"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Konklab"], ["title_ru", "Название17"], ["created_at", "2017-07-28 07:41:50.444043"], ["updated_at", "2017-07-28 07:41:50.444043"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_17[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 17) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>17, "title"=>"Fixflex", "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "local_path"=>"http://gerhold.org/roscoe"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "veribet"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "veribet"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Veribet"], ["category_id", 17], ["slug", "veribet"], ["created_at", "2017-07-28 07:41:50.455716"], ["updated_at", "2017-07-28 07:41:50.455716"], ["layout_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "mayra_torp"], ["email", "constance@mckenzie.io"], ["password", "1aN1QiBk3iZ1130g"], ["created_at", "2017-07-28 07:41:50.460842"], ["updated_at", "2017-07-28 07:41:50.460842"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "aut-facere"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Pannier"], ["phone", "526.131.9528"], ["address", "8990 Hudson Mission"], ["url", "http://schinnerwelch.io/archibald"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://mraz.net/kaandra"], ["auth_expiration_time", 900], ["slug", "aut-facere"], ["brand_id", 17], ["user_id", 22], ["created_at", "2017-07-28 07:41:50.466912"], ["updated_at", "2017-07-28 07:41:50.466912"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 11], ["location_id", 17], ["counter", 8], ["created_at", "2017-07-28 07:41:50.471642"], ["updated_at", "2017-07-28 07:41:50.471642"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "396-380-1955 x54066"], ["created_at", "2017-07-28 07:41:50.475663"], ["updated_at", "2017-07-28 07:41:50.475663"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Voyatouch"], ["created_at", "2017-07-28 07:41:50.482505"], ["updated_at", "2017-07-28 07:41:50.482505"], ["local_path", "http://dubuquefritsch.name/dustin"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Cardify"], ["title_ru", "Название18"], ["created_at", "2017-07-28 07:41:50.486475"], ["updated_at", "2017-07-28 07:41:50.486475"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 18[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_18[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 18) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>18, "title"=>"Voyatouch", "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "local_path"=>"http://dubuquefritsch.name/dustin"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "regrant"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "regrant"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Regrant"], ["category_id", 18], ["slug", "regrant"], ["created_at", "2017-07-28 07:41:50.498173"], ["updated_at", "2017-07-28 07:41:50.498173"], ["layout_id", 18]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "torrance.goodwin"], ["email", "gracie.rogahn@renner.com"], ["password", "4gJ5GoUg70H"], ["created_at", "2017-07-28 07:41:50.503112"], ["updated_at", "2017-07-28 07:41:50.503112"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "vel.velit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Y-find"], ["phone", "937.456.1205"], ["address", "54968 Cruickshank Valleys"], ["url", "http://ankundingprosacco.io/london"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://townerogahn.com/clementine_wiza"], ["auth_expiration_time", 900], ["slug", "vel.velit"], ["brand_id", 18], ["user_id", 23], ["created_at", "2017-07-28 07:41:50.509516"], ["updated_at", "2017-07-28 07:41:50.509516"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 12], ["location_id", 18], ["counter", 2], ["created_at", "2017-07-28 07:41:50.514279"], ["updated_at", "2017-07-28 07:41:50.514279"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tin"], ["created_at", "2017-07-28 07:41:50.521141"], ["updated_at", "2017-07-28 07:41:50.521141"], ["local_path", "http://kiehn.name/penelope"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Otcom"], ["title_ru", "Название19"], ["created_at", "2017-07-28 07:41:50.525039"], ["updated_at", "2017-07-28 07:41:50.525039"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 19[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_19[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 19) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>19, "title"=>"Tin", "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "local_path"=>"http://kiehn.name/penelope"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "home-ing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "home-ing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Home Ing"], ["category_id", 19], ["slug", "home-ing"], ["created_at", "2017-07-28 07:41:50.536279"], ["updated_at", "2017-07-28 07:41:50.536279"], ["layout_id", 19]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "dillon"], ["email", "toni_oconner@swiftbogan.name"], ["password", "Or7eOyXqDy"], ["created_at", "2017-07-28 07:41:50.541200"], ["updated_at", "2017-07-28 07:41:50.541200"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "velit-esse"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Andalax"], ["phone", "(163) 277-3614"], ["address", "39334 Jewel Freeway"], ["url", "http://mills.co/jacey"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://cummerata.info/arden"], ["auth_expiration_time", 900], ["slug", "velit-esse"], ["brand_id", 19], ["user_id", 24], ["created_at", "2017-07-28 07:41:50.547479"], ["updated_at", "2017-07-28 07:41:50.547479"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 11], ["location_id", 19], ["counter", 8], ["created_at", "2017-07-28 07:41:50.552327"], ["updated_at", "2017-07-28 07:41:50.552327"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "pablo"], ["email", "montana.roberts@okon.com"], ["password", "H8Tp7yZ8KcZj"], ["role_cd", 3], ["created_at", "2017-07-28 07:41:50.556721"], ["updated_at", "2017-07-28 07:41:50.556721"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:50 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"pablo", "email"=>"montana.roberts@okon.com", "password"=>"H8Tp7yZ8KcZj", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"pablo", :email=>"montana.roberts@okon.com", :password=>"H8Tp7yZ8KcZj", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"montana.roberts@okon.com", "password"=>"H8Tp7yZ8KcZj"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "pablo"], ["email", "montana.roberts@okon.com"], ["password", "H8Tp7yZ8KcZj"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 25, username: "pablo", email: "montana.roberts@okon.com", password: "H8Tp7yZ8KcZj", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:41:50", updated_at: "2017-07-28 07:41:50", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 25[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=updated_at&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:50 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"updated_at", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 25) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>25, "username"=>"pablo", "email"=>"montana.roberts@okon.com", "password"=>"H8Tp7yZ8KcZj", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"updated_at", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.7ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>25, :username=>"pablo", :email=>"montana.roberts@okon.com", :password=>"H8Tp7yZ8KcZj", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:41:50.556Z", :updated_at=>"2017-07-28T07:41:50.556Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:41:50.471642') AND "client_counters"."location_id" IN (17, 18, 19) GROUP BY client_id, phone_number ORDER BY updated_at desc, visits desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (11, 12)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (11, 12)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:41:50.471642') AND "client_counters"."location_id" IN (17, 18, 19) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 30ms [30m(Views: 0.5ms | ActiveRecord: 9.4ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "350.548.5067"], ["created_at", "2017-07-28 07:41:50.605764"], ["updated_at", "2017-07-28 07:41:50.605764"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Cardify"], ["created_at", "2017-07-28 07:41:50.612561"], ["updated_at", "2017-07-28 07:41:50.612561"], ["local_path", "http://baumbach.biz/ernestina_turner"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zamit"], ["title_ru", "Название20"], ["created_at", "2017-07-28 07:41:50.616143"], ["updated_at", "2017-07-28 07:41:50.616143"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 20[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_20[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 20) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>20, "title"=>"Cardify", "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "local_path"=>"http://baumbach.biz/ernestina_turner"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bytecard"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bytecard"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bytecard"], ["category_id", 20], ["slug", "bytecard"], ["created_at", "2017-07-28 07:41:50.627288"], ["updated_at", "2017-07-28 07:41:50.627288"], ["layout_id", 20]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "norwood.orn"], ["email", "abel@leuschke.name"], ["password", "1e5e9n8kKi9710"], ["created_at", "2017-07-28 07:41:50.632133"], ["updated_at", "2017-07-28 07:41:50.632133"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "qui_vero"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stronghold"], ["phone", "(575) 872-4395"], ["address", "43201 Gusikowski Plains"], ["url", "http://gleasonkulas.co/shany"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://bernier.com/howell"], ["auth_expiration_time", 900], ["slug", "qui_vero"], ["brand_id", 20], ["user_id", 26], ["created_at", "2017-07-28 07:41:50.637956"], ["updated_at", "2017-07-28 07:41:50.637956"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 13], ["location_id", 20], ["counter", 2], ["created_at", "2017-07-28 07:41:50.642788"], ["updated_at", "2017-07-28 07:41:50.642788"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-159-709-9925"], ["created_at", "2017-07-28 07:41:50.646499"], ["updated_at", "2017-07-28 07:41:50.646499"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bytecard"], ["created_at", "2017-07-28 07:41:50.652763"], ["updated_at", "2017-07-28 07:41:50.652763"], ["local_path", "http://dare.name/gerson.dickinson"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Tempsoft"], ["title_ru", "Название21"], ["created_at", "2017-07-28 07:41:50.656335"], ["updated_at", "2017-07-28 07:41:50.656335"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_21[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (1.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 21) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>21, "title"=>"Bytecard", "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "local_path"=>"http://dare.name/gerson.dickinson"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "andalax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "andalax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Andalax"], ["category_id", 21], ["slug", "andalax"], ["created_at", "2017-07-28 07:41:50.682215"], ["updated_at", "2017-07-28 07:41:50.682215"], ["layout_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "vada"], ["email", "stacey_mcdermott@ortiz.net"], ["password", "H6XuZyD70xDjU3"], ["created_at", "2017-07-28 07:41:50.687983"], ["updated_at", "2017-07-28 07:41:50.687983"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "cumque-error"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Sonair"], ["phone", "643-836-3018"], ["address", "90629 Littel Locks"], ["url", "http://bode.co/maxwell.schamberger"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://farrell.net/graciela_langosh"], ["auth_expiration_time", 900], ["slug", "cumque-error"], ["brand_id", 21], ["user_id", 27], ["created_at", "2017-07-28 07:41:50.693997"], ["updated_at", "2017-07-28 07:41:50.693997"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 14], ["location_id", 21], ["counter", 1], ["created_at", "2017-07-28 07:41:50.698868"], ["updated_at", "2017-07-28 07:41:50.698868"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Flowdesk"], ["created_at", "2017-07-28 07:41:50.705818"], ["updated_at", "2017-07-28 07:41:50.705818"], ["local_path", "http://miller.org/abigail.bayer"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Ronstring"], ["title_ru", "Название22"], ["created_at", "2017-07-28 07:41:50.709631"], ["updated_at", "2017-07-28 07:41:50.709631"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 22[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_22[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 22) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>22, "title"=>"Flowdesk", "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "local_path"=>"http://miller.org/abigail.bayer"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonair"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonair"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Sonair"], ["category_id", 22], ["slug", "sonair"], ["created_at", "2017-07-28 07:41:50.721326"], ["updated_at", "2017-07-28 07:41:50.721326"], ["layout_id", 22]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "durward"], ["email", "adrien@lowe.org"], ["password", "4r6fLn8vJl"], ["created_at", "2017-07-28 07:41:50.726762"], ["updated_at", "2017-07-28 07:41:50.726762"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "eaque.eos"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Otcom"], ["phone", "1-787-830-9409"], ["address", "8668 Helen Place"], ["url", "http://kozeyshanahan.biz/miles"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://andersonabshire.org/eden"], ["auth_expiration_time", 900], ["slug", "eaque.eos"], ["brand_id", 22], ["user_id", 28], ["created_at", "2017-07-28 07:41:50.733102"], ["updated_at", "2017-07-28 07:41:50.733102"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 13], ["location_id", 22], ["counter", 10], ["created_at", "2017-07-28 07:41:50.738155"], ["updated_at", "2017-07-28 07:41:50.738155"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-900-349-3127 x46182"], ["created_at", "2017-07-28 07:41:50.742484"], ["updated_at", "2017-07-28 07:41:50.742484"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Voyatouch"], ["created_at", "2017-07-28 07:41:50.748712"], ["updated_at", "2017-07-28 07:41:50.748712"], ["local_path", "http://stiedemann.biz/sherwood_rempel"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Ventosanzap"], ["title_ru", "Название23"], ["created_at", "2017-07-28 07:41:50.752357"], ["updated_at", "2017-07-28 07:41:50.752357"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 23[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_23[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 23) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>23, "title"=>"Voyatouch", "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "local_path"=>"http://stiedemann.biz/sherwood_rempel"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cardify"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cardify"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Cardify"], ["category_id", 23], ["slug", "cardify"], ["created_at", "2017-07-28 07:41:50.763513"], ["updated_at", "2017-07-28 07:41:50.763513"], ["layout_id", 23]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "tyreek.sporer"], ["email", "hans.harvey@bechtelar.co"], ["password", "H3BzXx0nFv1"], ["created_at", "2017-07-28 07:41:50.768190"], ["updated_at", "2017-07-28 07:41:50.768190"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "eum-nulla"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zoolab"], ["phone", "803-978-6155"], ["address", "7790 Steuber Pines"], ["url", "http://ferry.io/addie"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://nikolaus.info/lambert_dach"], ["auth_expiration_time", 900], ["slug", "eum-nulla"], ["brand_id", 23], ["user_id", 29], ["created_at", "2017-07-28 07:41:50.774067"], ["updated_at", "2017-07-28 07:41:50.774067"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 15], ["location_id", 23], ["counter", 5], ["created_at", "2017-06-26 07:41:50.740528"], ["updated_at", "2017-06-26 07:41:50.740644"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "queen"], ["email", "lydia_oreilly@doylebayer.io"], ["password", "9qNvQfNeXiOv"], ["role_cd", 3], ["created_at", "2017-07-28 07:41:50.783620"], ["updated_at", "2017-07-28 07:41:50.783620"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:50 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"queen", "email"=>"lydia_oreilly@doylebayer.io", "password"=>"9qNvQfNeXiOv", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"queen", :email=>"lydia_oreilly@doylebayer.io", :password=>"9qNvQfNeXiOv", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"lydia_oreilly@doylebayer.io", "password"=>"9qNvQfNeXiOv"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "queen"], ["email", "lydia_oreilly@doylebayer.io"], ["password", "9qNvQfNeXiOv"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 30, username: "queen", email: "lydia_oreilly@doylebayer.io", password: "9qNvQfNeXiOv", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:41:50", updated_at: "2017-07-28 07:41:50", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 30[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=visits30&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:50 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits30", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 30) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>30, "username"=>"queen", "email"=>"lydia_oreilly@doylebayer.io", "password"=>"9qNvQfNeXiOv", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits30", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.7ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>30, :username=>"queen", :email=>"lydia_oreilly@doylebayer.io", :password=>"9qNvQfNeXiOv", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:41:50.783Z", :updated_at=>"2017-07-28T07:41:50.783Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-06-26 07:41:50.740528') AND "client_counters"."location_id" IN (20, 21, 22, 23) GROUP BY client_id, phone_number ORDER BY visits30 asc, updated_at desc, visits desc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (15, 14, 13)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (13, 14, 15)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-06-26 07:41:50.740528') AND "client_counters"."location_id" IN (20, 21, 22, 23) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 32ms [30m(Views: 0.7ms | ActiveRecord: 9.1ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "hertha"], ["email", "ole@effertz.name"], ["password", "MxOySb9xAhDn7"], ["created_at", "2017-07-28 07:41:50.836619"], ["updated_at", "2017-07-28 07:41:50.836619"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "opinions" ("style", "message", "location", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["style", "positive"], ["message", "Now I may be an idiot, but there’s one thing I am not sir, and that sir, is an idiot."], ["location", "localhost"], ["user_id", 31], ["created_at", "2017-07-28 07:41:50.855270"], ["updated_at", "2017-07-28 07:41:50.855270"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:50 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"hertha", "email"=>"ole@effertz.name", "password"=>"MxOySb9xAhDn7", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"hertha", :email=>"ole@effertz.name", :password=>"MxOySb9xAhDn7", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"ole@effertz.name", "password"=>"MxOySb9xAhDn7"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "hertha"], ["email", "ole@effertz.name"], ["password", "MxOySb9xAhDn7"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 31, username: "hertha", email: "ole@effertz.name", password: "MxOySb9xAhDn7", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:41:50", updated_at: "2017-07-28 07:41:50", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 31[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//opinions" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:50 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::OpinionsController#index[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 31[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_31[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 31) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 31]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>31, "username"=>"hertha", "email"=>"ole@effertz.name", "password"=>"MxOySb9xAhDn7", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/opinions", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 31[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_31[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 31[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_31[0m
[[1m[30mDEBUG[0m[0m] [1m[36mauthorize index Opinion for user 31[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "opinions" WHERE "opinions"."user_id" = 31[0m
[[1m[30mDEBUG[0m[0m] [1m[36muser {:id=>31, :username=>"hertha", :email=>"ole@effertz.name", :password=>"MxOySb9xAhDn7", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:41:50.836Z", :updated_at=>"2017-07-28T07:41:50.836Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false} can access resource Opinion(id: integer, style: string, message: text, location: string, user_id: integer, created_at: datetime, updated_at: datetime)[0m[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 31[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_31[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 31[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_31[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Opinion for user {:id=>31, :username=>"hertha", :email=>"ole@effertz.name", :password=>"MxOySb9xAhDn7", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:41:50.836Z", :updated_at=>"2017-07-28T07:41:50.836Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mOpinion Load (0.8ms)[0m  [1m[34mSELECT "opinions".* FROM "opinions" WHERE "opinions"."user_id" = 31[0m
[INFO ] Completed [32m200 OK[0m in 28ms [30m(Views: 0.4ms | ActiveRecord: 7.2ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "reyna"], ["email", "maude@feil.name"], ["password", "6vW8AqOb0sA"], ["created_at", "2017-07-28 07:41:50.912844"], ["updated_at", "2017-07-28 07:41:50.912844"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:50 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"reyna", "email"=>"maude@feil.name", "password"=>"6vW8AqOb0sA", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"reyna", :email=>"maude@feil.name", :password=>"6vW8AqOb0sA", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"maude@feil.name", "password"=>"6vW8AqOb0sA"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "reyna"], ["email", "maude@feil.name"], ["password", "6vW8AqOb0sA"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 32, username: "reyna", email: "maude@feil.name", password: "6vW8AqOb0sA", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:41:50", updated_at: "2017-07-28 07:41:50", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 32[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "//opinions" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:50 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::OpinionsController#create[0m as [33mJSON[0m
[INFO ]   Parameters: {"style"=>"positive", "message"=>"Isn’t ‘bribe’ just another word for ‘love’?", "location"=>"localhost"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 32[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_32[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 32) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 32]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>32, "username"=>"reyna", "email"=>"maude@feil.name", "password"=>"6vW8AqOb0sA", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:style=>"positive", :message=>"Isn’t ‘bribe’ just another word for ‘love’?", :location=>"localhost", :format=>"json", :controller=>"dashboard/opinions", :action=>"create"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 32[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_32[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 32[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_32[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "opinions" ("user_id", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["user_id", 32], ["created_at", "2017-07-28 07:41:50.945012"], ["updated_at", "2017-07-28 07:41:50.945012"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] Completed [32m200 OK[0m in 24ms [30m(Views: 0.3ms | ActiveRecord: 5.8ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "opinions"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "concepcion"], ["email", "jennyfer@dickinson.biz"], ["password", "GtMuXeS7KpY09u"], ["created_at", "2017-07-28 07:41:50.957219"], ["updated_at", "2017-07-28 07:41:50.957219"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "polls" ("title", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "People in love can overcome anything."], ["user_id", 33], ["created_at", "2017-07-28 07:41:50.970983"], ["updated_at", "2017-07-28 07:41:50.970983"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.4ms)[0m  [1m[32mINSERT INTO "questions" ("title", "poll_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Amazing. One second of a stranger's voice on a phone, and you've got full Bollywood."], ["poll_id", 1], ["created_at", "2017-07-28 07:41:50.992519"], ["updated_at", "2017-07-28 07:41:50.992519"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:50 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"concepcion", "email"=>"jennyfer@dickinson.biz", "password"=>"GtMuXeS7KpY09u", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"concepcion", :email=>"jennyfer@dickinson.biz", :password=>"GtMuXeS7KpY09u", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"jennyfer@dickinson.biz", "password"=>"GtMuXeS7KpY09u"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "concepcion"], ["email", "jennyfer@dickinson.biz"], ["password", "GtMuXeS7KpY09u"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 33, username: "concepcion", email: "jennyfer@dickinson.biz", password: "GtMuXeS7KpY09u", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:41:50", updated_at: "2017-07-28 07:41:50", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 33[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//polls/1/export_to_xlsx" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:51 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::Surveys::PollsController#export_to_xlsx[0m as [33mJSON[0m
[INFO ]   Parameters: {"poll_id"=>"1"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 33[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_33[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 33) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 33]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>33, "username"=>"concepcion", "email"=>"jennyfer@dickinson.biz", "password"=>"GtMuXeS7KpY09u", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:50 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>1, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/surveys/polls", :action=>"export_to_xlsx", :poll_id=>"1"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mPoll Load (0.7ms)[0m  [1m[34mSELECT  "polls".* FROM "polls" WHERE "polls"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mQuestion Load (0.7ms)[0m  [1m[34mSELECT "questions".* FROM "questions" WHERE (poll_id = 1)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mAnswer Load (1.0ms)[0m  [1m[34mSELECT "answers".* FROM "answers" WHERE "answers"."question_id" = 1 ORDER BY "answers"."id" ASC[0m
[INFO ] Completed [31m500 Internal Server Error[0m in 51ms [30m(ActiveRecord: 9.2ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "emelie"], ["email", "imani_ebert@ankunding.org"], ["password", "HfX8Rh4xFa"], ["created_at", "2017-07-28 07:41:51.073267"], ["updated_at", "2017-07-28 07:41:51.073267"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "polls" ("title", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "People in love can overcome anything."], ["user_id", 34], ["created_at", "2016-07-28 07:41:51.076534"], ["updated_at", "2017-07-28 07:41:51.078648"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "questions" ("title", "poll_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Amazing. One second of a stranger's voice on a phone, and you've got full Bollywood."], ["poll_id", 2], ["created_at", "2017-07-28 07:41:51.082963"], ["updated_at", "2017-07-28 07:41:51.082963"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "answers" ("title", "question_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Hey, don't try to take this away from me. This is the only thing I've ever been good at. Well, this and timing my farts to a thunderstorm."], ["question_id", 2], ["created_at", "2017-07-28 07:41:51.096039"], ["updated_at", "2017-07-28 07:41:51.096039"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "381-760-1975"], ["created_at", "2017-07-28 07:41:51.112186"], ["updated_at", "2017-07-28 07:41:51.112186"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "attempts" ("client_id", "answer_id", "created_at", "updated_at", "interview_uuid") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 16], ["answer_id", 1], ["created_at", "2017-07-28 07:41:51.117971"], ["updated_at", "2017-07-28 07:41:51.117971"], ["interview_uuid", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Konklux"], ["created_at", "2017-07-28 07:41:51.125144"], ["updated_at", "2017-07-28 07:41:51.125144"], ["local_path", "http://schaefermante.biz/karli"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Tampflex"], ["title_ru", "Название24"], ["created_at", "2017-07-28 07:41:51.128785"], ["updated_at", "2017-07-28 07:41:51.128785"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 24[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_24[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 24) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>24, "title"=>"Konklux", "created_at"=>Fri, 28 Jul 2017 07:41:51 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:51 UTC +00:00, "local_path"=>"http://schaefermante.biz/karli"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "aerified"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "aerified"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Aerified"], ["category_id", 24], ["slug", "aerified"], ["created_at", "2017-07-28 07:41:51.139963"], ["updated_at", "2017-07-28 07:41:51.139963"], ["layout_id", 24]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "kristin"], ["email", "dorris_bernhard@barrows.name"], ["password", "P9MlVdJzYdNrV"], ["created_at", "2017-07-28 07:41:51.144876"], ["updated_at", "2017-07-28 07:41:51.144876"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "assumenda_reprehenderit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "poll_id", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17) RETURNING "id"[0m  [["title", "Kanlam"], ["phone", "1-774-215-4112"], ["address", "876 Oberbrunner Ford"], ["url", "http://denesikroob.org/connie"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://harris.name/horace"], ["auth_expiration_time", 900], ["slug", "assumenda_reprehenderit"], ["brand_id", 24], ["user_id", 35], ["created_at", "2017-07-28 07:41:51.151612"], ["updated_at", "2017-07-28 07:41:51.151612"], ["poll_id", 2], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(423) 817-8976 x851"], ["created_at", "2017-07-28 07:41:51.189000"], ["updated_at", "2017-07-28 07:41:51.189000"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "darrin_carter"], ["email", "dominique@lind.org"], ["password", "VxEu63TtH7Q"], ["created_at", "2017-07-28 07:41:51.194648"], ["updated_at", "2017-07-28 07:41:51.194648"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.6ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "982104"], ["username", "ethyl_lueilwitz"], ["image", "http://instagram.com/img/ethyl_lueilwitz.jpg"], ["profile", "https://instagram.com/ethyl_lueilwitz"], ["email", "brando@wizajerde.biz"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 23], ["bdate_month", 12], ["bdate_year", 1962], ["client_id", 17], ["user_id", 36], ["created_at", "2017-07-28 07:41:51.199945"], ["updated_at", "2017-07-28 07:41:51.199945"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tempsoft"], ["created_at", "2017-07-28 07:41:51.234635"], ["updated_at", "2017-07-28 07:41:51.234635"], ["local_path", "http://wintheiser.net/elena_dicki"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Tres-Zap"], ["title_ru", "Название25"], ["created_at", "2017-07-28 07:41:51.238763"], ["updated_at", "2017-07-28 07:41:51.238763"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_25[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 25) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>25, "title"=>"Tempsoft", "created_at"=>Fri, 28 Jul 2017 07:41:51 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:51 UTC +00:00, "local_path"=>"http://wintheiser.net/elena_dicki"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cookley"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cookley"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Cookley"], ["category_id", 25], ["slug", "cookley"], ["created_at", "2017-07-28 07:41:51.250590"], ["updated_at", "2017-07-28 07:41:51.250590"], ["layout_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "adrianna"], ["email", "cecil@bogan.name"], ["password", "Tr2dVuDkJsFf"], ["created_at", "2017-07-28 07:41:51.255697"], ["updated_at", "2017-07-28 07:41:51.255697"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "explicabo-quos"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Temp"], ["phone", "950.128.9749"], ["address", "17741 Lyla Port"], ["url", "http://kreiger.io/louie_littel"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kreigerflatley.info/lyla.grady"], ["auth_expiration_time", 900], ["slug", "explicabo-quos"], ["brand_id", 25], ["user_id", 37], ["created_at", "2017-07-28 07:41:51.261750"], ["updated_at", "2017-07-28 07:41:51.261750"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "avis_deckow"], ["email", "naomie_kulas@lueilwitz.biz"], ["password", "P3QcOl8qKkG"], ["created_at", "2017-07-28 07:41:51.267165"], ["updated_at", "2017-07-28 07:41:51.267165"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5331"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.6ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5331"], ["comment", "comment 11"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "15.15.232.253"], ["router_admin_ip", "217.120.166.174"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "29"], ["status", "t"], ["location_id", 25], ["user_id", 38], ["created_at", "2017-07-28 07:41:51.275955"], ["updated_at", "2017-07-28 07:41:51.275955"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5331"], ["id", 1], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 1], ["serial", "643705CA5E36/5331"], ["comment", "comment 11"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "15.15.232.253"], ["router_admin_ip", "217.120.166.174"], ["admin_password", "461289006c88dda8"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "1"], ["status", "t"], ["location_id", 25], ["user_id", 38], ["created_at", "2017-07-28 07:41:51.275955"], ["updated_at", "2017-07-28 07:41:51.275955"], ["id", 1]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: c30deefa-5e60-41be-afb1-1b143dff66b5) to Async(routers) with arguments: #<GlobalID:0x007fe2e345e778 @uri=#<URI::GID gid://wifi-management/Router/1>>
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: c95d06d1-8b12-471f-961e-a993e2a213e9) to Async(routers) with arguments: #<GlobalID:0x007fe2e345e778 @uri=#<URI::GID gid://wifi-management/Router/1>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (2.0ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 1], ["provider", "instagram"], ["location_id", 24], ["router_id", 1], ["created_at", "2017-07-28 07:41:51.414827"], ["updated_at", "2017-07-28 07:41:51.414827"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mQuestion Load (0.7ms)[0m  [1m[34mSELECT  "questions".* FROM "questions" WHERE "questions"."poll_id" = $1 ORDER BY "questions"."id" ASC LIMIT $2[0m  [["poll_id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mAnswer Load (0.7ms)[0m  [1m[34mSELECT  "answers".* FROM "answers" WHERE "answers"."question_id" = $1 ORDER BY "answers"."id" ASC LIMIT $2[0m  [["question_id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(757) 769-3840"], ["created_at", "2017-07-28 07:41:51.428516"], ["updated_at", "2017-07-28 07:41:51.428516"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "attempts" ("client_id", "answer_id", "created_at", "updated_at", "interview_uuid") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 18], ["answer_id", 1], ["created_at", "2017-03-28 07:41:51.426491"], ["updated_at", "2017-07-28 07:41:51.432368"], ["interview_uuid", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:51 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"emelie", "email"=>"imani_ebert@ankunding.org", "password"=>"HfX8Rh4xFa", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"emelie", :email=>"imani_ebert@ankunding.org", :password=>"HfX8Rh4xFa", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"imani_ebert@ankunding.org", "password"=>"HfX8Rh4xFa"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "emelie"], ["email", "imani_ebert@ankunding.org"], ["password", "HfX8Rh4xFa"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 34, username: "emelie", email: "imani_ebert@ankunding.org", password: "HfX8Rh4xFa", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:41:51", updated_at: "2017-07-28 07:41:51", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 34[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/stats/poll_activity?id=2" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:51 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#poll_activity[0m as [33mJSON[0m
[INFO ]   Parameters: {"id"=>"2"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 34[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_34[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 34) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 34]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>34, "username"=>"emelie", "email"=>"imani_ebert@ankunding.org", "password"=>"HfX8Rh4xFa", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:51 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:51 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>1, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:id=>"2", :format=>"json", :controller=>"dashboard/stats", :action=>"poll_activity"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 34[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_34[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 34[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_34[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>34, :username=>"emelie", :email=>"imani_ebert@ankunding.org", :password=>"HfX8Rh4xFa", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:41:51.073Z", :updated_at=>"2017-07-28T07:41:51.073Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>1, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 34[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mPoll Load (0.7ms)[0m  [1m[34mSELECT  "polls".* FROM "polls" WHERE "polls"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mAttempt Load (1.2ms)[0m  [1m[34mSELECT  "attempts".* FROM "attempts" INNER JOIN "answers" ON "attempts"."answer_id" = "answers"."id" INNER JOIN "questions" ON "answers"."question_id" = "questions"."id" WHERE "questions"."poll_id" = $1 ORDER BY "answers"."id" ASC, "attempts"."created_at" ASC LIMIT $2[0m  [["poll_id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "questions"."id" FROM "questions" WHERE "questions"."poll_id" = $1[0m  [["poll_id", 2]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[35mWITH attempts_amount AS
        (
          SELECT
              count(id) AS amount,
              date_trunc('month', attempts.created_at) AS PERIOD
          FROM attempts
          WHERE attempts.answer_id in (SELECT id FROM answers where question_id = 2)
          GROUP BY PERIOD
        )
        SELECT period,
               CASE
                  WHEN attempts_amount.amount is NULL THEN 0
                  ELSE attempts_amount.amount
               END as amount
        FROM
            (SELECT generate_series(min(period), max(period), '1 month') AS PERIOD
            FROM attempts_amount) x
        LEFT JOIN attempts_amount
        USING (period)
        ORDER BY period;[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" IN (SELECT "locations"."id" FROM "locations" WHERE "locations"."poll_id" = $1) AND (created_at > '2017-03-28 07:41:51.426491')[0m  [["poll_id", 2]]
[[1m[30mDEBUG[0m[0m]   [1m[36mQuestion Load (0.6ms)[0m  [1m[34mSELECT "questions".* FROM "questions" WHERE (poll_id = 2)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mAnswer Load (0.8ms)[0m  [1m[34mSELECT "answers".* FROM "answers" WHERE "answers"."question_id" = 2 ORDER BY "answers"."id" ASC[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mAttempt Load (0.7ms)[0m  [1m[34mSELECT "attempts".* FROM "attempts" WHERE "attempts"."answer_id" = 1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.9ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (16, 18)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.7ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (16, 18)[0m
[INFO ] Completed [32m200 OK[0m in 62ms [30m(Views: 0.7ms | ActiveRecord: 13.4ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "attempts" WHERE "attempts"."answer_id" = $1[0m  [["answer_id", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mAttempt Load (0.6ms)[0m  [1m[34mSELECT  "attempts".* FROM "attempts" WHERE "attempts"."answer_id" = $1 ORDER BY "attempts"."id" ASC LIMIT $2[0m  [["answer_id", 1], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "nadia_rempel"], ["email", "neil.gaylord@watsicalarson.name"], ["password", "7eXcTcK40jFpPl9"], ["created_at", "2017-07-28 07:41:51.530815"], ["updated_at", "2017-07-28 07:41:51.530815"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "polls" ("title", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Now I may be an idiot, but there’s one thing I am not sir, and that sir, is an idiot."], ["user_id", 39], ["created_at", "2016-07-28 07:41:51.534443"], ["updated_at", "2017-07-28 07:41:51.536480"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "questions" ("title", "poll_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "You know, this is great guys. Drinking and eating garbage. I'm glad we all took a mental health day."], ["poll_id", 3], ["created_at", "2017-07-28 07:41:51.540929"], ["updated_at", "2017-07-28 07:41:51.540929"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "answers" ("title", "question_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Now I may be an idiot, but there’s one thing I am not sir, and that sir, is an idiot."], ["question_id", 3], ["created_at", "2017-07-28 07:41:51.545370"], ["updated_at", "2017-07-28 07:41:51.545370"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-574-508-6258 x591"], ["created_at", "2017-07-28 07:41:51.549710"], ["updated_at", "2017-07-28 07:41:51.549710"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "attempts" ("client_id", "answer_id", "created_at", "updated_at", "interview_uuid") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 19], ["answer_id", 2], ["created_at", "2017-07-28 07:41:51.553797"], ["updated_at", "2017-07-28 07:41:51.553797"], ["interview_uuid", 3320]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Otcom"], ["created_at", "2017-07-28 07:41:51.560720"], ["updated_at", "2017-07-28 07:41:51.560720"], ["local_path", "http://pollich.biz/sydnee_heaney"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Redhold"], ["title_ru", "Название26"], ["created_at", "2017-07-28 07:41:51.564969"], ["updated_at", "2017-07-28 07:41:51.564969"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 26[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_26[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 26) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>26, "title"=>"Otcom", "created_at"=>Fri, 28 Jul 2017 07:41:51 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:51 UTC +00:00, "local_path"=>"http://pollich.biz/sydnee_heaney"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "temp"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "temp"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Temp"], ["category_id", 26], ["slug", "temp"], ["created_at", "2017-07-28 07:41:51.577558"], ["updated_at", "2017-07-28 07:41:51.577558"], ["layout_id", 26]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "maurine.hirthe"], ["email", "grady@powlowski.info"], ["password", "RdO3DnB0Ap"], ["created_at", "2017-07-28 07:41:51.582685"], ["updated_at", "2017-07-28 07:41:51.582685"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "eum-ut"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "poll_id", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17) RETURNING "id"[0m  [["title", "Aerified"], ["phone", "1-895-016-4564"], ["address", "17863 Kshlerin Isle"], ["url", "http://armstrong.com/shad.langworth"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://witting.info/adrain"], ["auth_expiration_time", 900], ["slug", "eum-ut"], ["brand_id", 26], ["user_id", 40], ["created_at", "2017-07-28 07:41:51.589526"], ["updated_at", "2017-07-28 07:41:51.589526"], ["poll_id", 3], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(613) 933-9888 x77126"], ["created_at", "2017-07-28 07:41:51.595919"], ["updated_at", "2017-07-28 07:41:51.595919"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jaycee"], ["email", "deborah.johns@bechtelargaylord.net"], ["password", "1xEbPt6f18A7R8V"], ["created_at", "2017-07-28 07:41:51.600198"], ["updated_at", "2017-07-28 07:41:51.600198"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.4ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "553832"], ["username", "rickey"], ["image", "http://instagram.com/img/rickey.jpg"], ["profile", "https://instagram.com/rickey"], ["email", "unique@schmitt.info"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 30], ["bdate_month", 2], ["bdate_year", 1968], ["client_id", 20], ["user_id", 41], ["created_at", "2017-07-28 07:41:51.604299"], ["updated_at", "2017-07-28 07:41:51.604299"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Trippledex"], ["created_at", "2017-07-28 07:41:51.612499"], ["updated_at", "2017-07-28 07:41:51.612499"], ["local_path", "http://lang.net/annamarie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Redhold"], ["title_ru", "Название27"], ["created_at", "2017-07-28 07:41:51.616222"], ["updated_at", "2017-07-28 07:41:51.616222"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 27[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_27[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 27) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>27, "title"=>"Trippledex", "created_at"=>Fri, 28 Jul 2017 07:41:51 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:51 UTC +00:00, "local_path"=>"http://lang.net/annamarie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "opela"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "opela"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Opela"], ["category_id", 27], ["slug", "opela"], ["created_at", "2017-07-28 07:41:51.627099"], ["updated_at", "2017-07-28 07:41:51.627099"], ["layout_id", 27]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "kattie.kautzer"], ["email", "javonte_stiedemann@oconner.info"], ["password", "Q34eV8Ze"], ["created_at", "2017-07-28 07:41:51.631966"], ["updated_at", "2017-07-28 07:41:51.631966"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "eligendi_voluptatem"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Namfix"], ["phone", "1-502-284-3960"], ["address", "57127 Wehner Islands"], ["url", "http://kuhic.co/timothy.gulgowski"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://bashirianprohaska.co/doug"], ["auth_expiration_time", 900], ["slug", "eligendi_voluptatem"], ["brand_id", 27], ["user_id", 42], ["created_at", "2017-07-28 07:41:51.637671"], ["updated_at", "2017-07-28 07:41:51.637671"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "anita"], ["email", "justice_huel@sauer.info"], ["password", "5h9mZaLxS6EtQz"], ["created_at", "2017-07-28 07:41:51.643016"], ["updated_at", "2017-07-28 07:41:51.643016"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5332"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5332"], ["comment", "comment 12"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "222.198.101.40"], ["router_admin_ip", "140.66.179.229"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "904"], ["status", "t"], ["location_id", 27], ["user_id", 43], ["created_at", "2017-07-28 07:41:51.648801"], ["updated_at", "2017-07-28 07:41:51.648801"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5332"], ["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 2], ["serial", "643705CA5E36/5332"], ["comment", "comment 12"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "222.198.101.40"], ["router_admin_ip", "140.66.179.229"], ["admin_password", "e280c34113bd8b3e"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "2"], ["status", "t"], ["location_id", 27], ["user_id", 43], ["created_at", "2017-07-28 07:41:51.648801"], ["updated_at", "2017-07-28 07:41:51.648801"], ["id", 2]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: c181b4d8-f668-424a-9465-22470674e4b2) to Async(routers) with arguments: #<GlobalID:0x007fe2e0c9a688 @uri=#<URI::GID gid://wifi-management/Router/2>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 4ed09921-4d5c-479f-9b7b-01dcd2400ec7) to Async(routers) with arguments: #<GlobalID:0x007fe2e0c9a688 @uri=#<URI::GID gid://wifi-management/Router/2>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 2], ["provider", "instagram"], ["location_id", 26], ["router_id", 2], ["created_at", "2017-07-28 07:41:51.837321"], ["updated_at", "2017-07-28 07:41:51.837321"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mQuestion Load (1.0ms)[0m  [1m[34mSELECT  "questions".* FROM "questions" WHERE "questions"."poll_id" = $1 ORDER BY "questions"."id" ASC LIMIT $2[0m  [["poll_id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mAnswer Load (0.8ms)[0m  [1m[34mSELECT  "answers".* FROM "answers" WHERE "answers"."question_id" = $1 ORDER BY "answers"."id" ASC LIMIT $2[0m  [["question_id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(361) 563-4788 x828"], ["created_at", "2017-07-28 07:41:51.850986"], ["updated_at", "2017-07-28 07:41:51.850986"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "attempts" ("client_id", "answer_id", "created_at", "updated_at", "interview_uuid") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 21], ["answer_id", 2], ["created_at", "2017-04-29 07:41:51.848779"], ["updated_at", "2017-07-28 07:41:51.856740"], ["interview_uuid", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:51 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"nadia_rempel", "email"=>"neil.gaylord@watsicalarson.name", "password"=>"7eXcTcK40jFpPl9", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.4ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
[INFO ] [36mnormalized params {:username=>"nadia_rempel", :email=>"neil.gaylord@watsicalarson.name", :password=>"7eXcTcK40jFpPl9", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"neil.gaylord@watsicalarson.name", "password"=>"7eXcTcK40jFpPl9"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "nadia_rempel"], ["email", "neil.gaylord@watsicalarson.name"], ["password", "7eXcTcK40jFpPl9"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 39, username: "nadia_rempel", email: "neil.gaylord@watsicalarson.name", password: "7eXcTcK40jFpPl9", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:41:51", updated_at: "2017-07-28 07:41:51", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 39[0m
[INFO ] Completed [32m201 Created[0m in 6ms [30m(Views: 0.3ms | ActiveRecord: 1.1ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/stats/poll_activity?id=3" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:51 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#poll_activity[0m as [33mJSON[0m
[INFO ]   Parameters: {"id"=>"3"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 39) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>39, "username"=>"nadia_rempel", "email"=>"neil.gaylord@watsicalarson.name", "password"=>"7eXcTcK40jFpPl9", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:51 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:51 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>1, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:id=>"3", :format=>"json", :controller=>"dashboard/stats", :action=>"poll_activity"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>39, :username=>"nadia_rempel", :email=>"neil.gaylord@watsicalarson.name", :password=>"7eXcTcK40jFpPl9", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:41:51.530Z", :updated_at=>"2017-07-28T07:41:51.530Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>1, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 39[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mPoll Load (0.6ms)[0m  [1m[34mSELECT  "polls".* FROM "polls" WHERE "polls"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mAttempt Load (1.7ms)[0m  [1m[34mSELECT  "attempts".* FROM "attempts" INNER JOIN "answers" ON "attempts"."answer_id" = "answers"."id" INNER JOIN "questions" ON "answers"."question_id" = "questions"."id" WHERE "questions"."poll_id" = $1 ORDER BY "answers"."id" ASC, "attempts"."created_at" ASC LIMIT $2[0m  [["poll_id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "questions"."id" FROM "questions" WHERE "questions"."poll_id" = $1[0m  [["poll_id", 3]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[35mWITH attempts_amount AS
        (
          SELECT
              count(id) AS amount,
              date_trunc('week', attempts.created_at) AS PERIOD
          FROM attempts
          WHERE attempts.answer_id in (SELECT id FROM answers where question_id = 3)
          GROUP BY PERIOD
        )
        SELECT period,
               CASE
                  WHEN attempts_amount.amount is NULL THEN 0
                  ELSE attempts_amount.amount
               END as amount
        FROM
            (SELECT generate_series(min(period), max(period), '1 week') AS PERIOD
            FROM attempts_amount) x
        LEFT JOIN attempts_amount
        USING (period)
        ORDER BY period;[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" IN (SELECT "locations"."id" FROM "locations" WHERE "locations"."poll_id" = $1) AND (created_at > '2017-04-29 07:41:51.848779')[0m  [["poll_id", 3]]
[[1m[30mDEBUG[0m[0m]   [1m[36mQuestion Load (0.7ms)[0m  [1m[34mSELECT "questions".* FROM "questions" WHERE (poll_id = 3)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mAnswer Load (0.7ms)[0m  [1m[34mSELECT "answers".* FROM "answers" WHERE "answers"."question_id" = 3 ORDER BY "answers"."id" ASC[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mAttempt Load (0.7ms)[0m  [1m[34mSELECT "attempts".* FROM "attempts" WHERE "attempts"."answer_id" = 2[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.9ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (19, 21)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (1.0ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (19, 21)[0m
[INFO ] Completed [32m200 OK[0m in 54ms [30m(Views: 0.7ms | ActiveRecord: 17.6ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "attempts" WHERE "attempts"."answer_id" = $1[0m  [["answer_id", 2]]
[[1m[30mDEBUG[0m[0m]   [1m[36mAttempt Load (0.8ms)[0m  [1m[34mSELECT  "attempts".* FROM "attempts" WHERE "attempts"."answer_id" = $1 ORDER BY "attempts"."id" ASC LIMIT $2[0m  [["answer_id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."id" = $1 LIMIT $2[0m  [["id", 19], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "carmel.keler"], ["email", "te@mcculloughhowe.net"], ["password", "8sClVl2gTdUqUt"], ["created_at", "2017-07-28 07:41:51.940372"], ["updated_at", "2017-07-28 07:41:51.940372"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "polls" ("title", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Now I may be an idiot, but there’s one thing I am not sir, and that sir, is an idiot."], ["user_id", 44], ["created_at", "2016-07-28 07:41:51.943776"], ["updated_at", "2017-07-28 07:41:51.945863"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "questions" ("title", "poll_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "I’ve got an idea–an idea so smart that my head would explode if I even began to know what I’m talking about."], ["poll_id", 4], ["created_at", "2017-07-28 07:41:51.950123"], ["updated_at", "2017-07-28 07:41:51.950123"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "answers" ("title", "question_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "It’s Peanut Butter Jelly Time."], ["question_id", 4], ["created_at", "2017-07-28 07:41:51.954260"], ["updated_at", "2017-07-28 07:41:51.954260"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "924-363-3145 x92604"], ["created_at", "2017-07-28 07:41:51.958476"], ["updated_at", "2017-07-28 07:41:51.958476"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "attempts" ("client_id", "answer_id", "created_at", "updated_at", "interview_uuid") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 22], ["answer_id", 3], ["created_at", "2017-07-28 07:41:51.962337"], ["updated_at", "2017-07-28 07:41:51.962337"], ["interview_uuid", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Quo Lux"], ["created_at", "2017-07-28 07:41:51.969168"], ["updated_at", "2017-07-28 07:41:51.969168"], ["local_path", "http://windlerklein.co/libbie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Andalax"], ["title_ru", "Название28"], ["created_at", "2017-07-28 07:41:51.973018"], ["updated_at", "2017-07-28 07:41:51.973018"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 28[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_28[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 28) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>28, "title"=>"Quo Lux", "created_at"=>Fri, 28 Jul 2017 07:41:51 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:51 UTC +00:00, "local_path"=>"http://windlerklein.co/libbie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitchip"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitchip"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bitchip"], ["category_id", 28], ["slug", "bitchip"], ["created_at", "2017-07-28 07:41:51.984829"], ["updated_at", "2017-07-28 07:41:51.984829"], ["layout_id", 28]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "kay_kreiger"], ["email", "roie.wolf@cummerata.org"], ["password", "X5Ie4vNc1aPl8h3"], ["created_at", "2017-07-28 07:41:51.989629"], ["updated_at", "2017-07-28 07:41:51.989629"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "assumenda_nam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "poll_id", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17) RETURNING "id"[0m  [["title", "Lotlux"], ["phone", "(947) 780-7065"], ["address", "861 Nader Fall"], ["url", "http://oconnelltremblay.biz/fausto.ryan"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://satterfield.info/marvin"], ["auth_expiration_time", 900], ["slug", "assumenda_nam"], ["brand_id", 28], ["user_id", 45], ["created_at", "2017-07-28 07:41:51.996063"], ["updated_at", "2017-07-28 07:41:51.996063"], ["poll_id", 4], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-750-402-9055 x793"], ["created_at", "2017-07-28 07:41:52.002557"], ["updated_at", "2017-07-28 07:41:52.002557"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "elouise"], ["email", "sydnee.leannon@okuneva.biz"], ["password", "LhEoV84wFlWr"], ["created_at", "2017-07-28 07:41:52.007264"], ["updated_at", "2017-07-28 07:41:52.007264"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "307509"], ["username", "nathanial"], ["image", "http://vk.com/img/nathanial.jpg"], ["profile", "https://vk.com/nathanial"], ["email", "annetta@greenholt.org"], ["gender", "female"], ["location", "Москва, Россия"], ["bdate_day", 26], ["bdate_month", 2], ["bdate_year", 1965], ["client_id", 23], ["user_id", 46], ["created_at", "2017-07-28 07:41:52.011451"], ["updated_at", "2017-07-28 07:41:52.011451"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Biodex"], ["created_at", "2017-07-28 07:41:52.019280"], ["updated_at", "2017-07-28 07:41:52.019280"], ["local_path", "http://smithmitchell.io/floy"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fixflex"], ["title_ru", "Название29"], ["created_at", "2017-07-28 07:41:52.023147"], ["updated_at", "2017-07-28 07:41:52.023147"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 29[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_29[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 29) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>29, "title"=>"Biodex", "created_at"=>Fri, 28 Jul 2017 07:41:52 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:52 UTC +00:00, "local_path"=>"http://smithmitchell.io/floy"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bamity"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bamity"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bamity"], ["category_id", 29], ["slug", "bamity"], ["created_at", "2017-07-28 07:41:52.034560"], ["updated_at", "2017-07-28 07:41:52.034560"], ["layout_id", 29]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "arlene.hudson"], ["email", "julien@will.co"], ["password", "Jp5g3i7oQnD"], ["created_at", "2017-07-28 07:41:52.039559"], ["updated_at", "2017-07-28 07:41:52.039559"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptate-nulla"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Hatity"], ["phone", "111.688.6673"], ["address", "90393 Bradley Unions"], ["url", "http://kaulkefeeney.io/joseph_robel"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://lind.biz/kaley_schulist"], ["auth_expiration_time", 900], ["slug", "voluptate-nulla"], ["brand_id", 29], ["user_id", 47], ["created_at", "2017-07-28 07:41:52.045567"], ["updated_at", "2017-07-28 07:41:52.045567"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "harmon"], ["email", "antonette@windlerdavis.io"], ["password", "48186lD8S6HjDfQ"], ["created_at", "2017-07-28 07:41:52.051120"], ["updated_at", "2017-07-28 07:41:52.051120"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5333"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5333"], ["comment", "comment 13"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "173.236.207.185"], ["router_admin_ip", "81.186.113.85"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "208"], ["status", "t"], ["location_id", 29], ["user_id", 48], ["created_at", "2017-07-28 07:41:52.056944"], ["updated_at", "2017-07-28 07:41:52.056944"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5333"], ["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 3], ["serial", "643705CA5E36/5333"], ["comment", "comment 13"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "173.236.207.185"], ["router_admin_ip", "81.186.113.85"], ["admin_password", "02701e8ae11081ab"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "3"], ["status", "t"], ["location_id", 29], ["user_id", 48], ["created_at", "2017-07-28 07:41:52.056944"], ["updated_at", "2017-07-28 07:41:52.056944"], ["id", 3]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 7eb276b8-fd12-4673-b26e-67987bed6c12) to Async(routers) with arguments: #<GlobalID:0x007fe2de01baa8 @uri=#<URI::GID gid://wifi-management/Router/3>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 42c889bb-1edc-4795-bc20-6d42ffcfe57d) to Async(routers) with arguments: #<GlobalID:0x007fe2de01baa8 @uri=#<URI::GID gid://wifi-management/Router/3>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.3ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 3], ["provider", "vk"], ["location_id", 28], ["router_id", 3], ["created_at", "2017-07-28 07:41:52.238973"], ["updated_at", "2017-07-28 07:41:52.238973"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mQuestion Load (0.6ms)[0m  [1m[34mSELECT  "questions".* FROM "questions" WHERE "questions"."poll_id" = $1 ORDER BY "questions"."id" ASC LIMIT $2[0m  [["poll_id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mAnswer Load (0.6ms)[0m  [1m[34mSELECT  "answers".* FROM "answers" WHERE "answers"."question_id" = $1 ORDER BY "answers"."id" ASC LIMIT $2[0m  [["question_id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(473) 732-9852 x66906"], ["created_at", "2017-07-28 07:41:52.248943"], ["updated_at", "2017-07-28 07:41:52.248943"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "attempts" ("client_id", "answer_id", "created_at", "updated_at", "interview_uuid") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 24], ["answer_id", 3], ["created_at", "2017-06-28 07:41:53.246812"], ["updated_at", "2017-07-28 07:41:52.252872"], ["interview_uuid", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:52 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"carmel.keler", "email"=>"te@mcculloughhowe.net", "password"=>"8sClVl2gTdUqUt", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"carmel.keler", :email=>"te@mcculloughhowe.net", :password=>"8sClVl2gTdUqUt", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"te@mcculloughhowe.net", "password"=>"8sClVl2gTdUqUt"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "carmel.keler"], ["email", "te@mcculloughhowe.net"], ["password", "8sClVl2gTdUqUt"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 44, username: "carmel.keler", email: "te@mcculloughhowe.net", password: "8sClVl2gTdUqUt", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:41:51", updated_at: "2017-07-28 07:41:51", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 44[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/stats/poll_activity?id=4" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:52 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#poll_activity[0m as [33mJSON[0m
[INFO ]   Parameters: {"id"=>"4"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 44[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_44[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 44) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 44]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>44, "username"=>"carmel.keler", "email"=>"te@mcculloughhowe.net", "password"=>"8sClVl2gTdUqUt", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:51 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:51 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>1, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:id=>"4", :format=>"json", :controller=>"dashboard/stats", :action=>"poll_activity"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 44[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_44[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 44[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_44[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>44, :username=>"carmel.keler", :email=>"te@mcculloughhowe.net", :password=>"8sClVl2gTdUqUt", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:41:51.940Z", :updated_at=>"2017-07-28T07:41:51.940Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>1, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 44[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mPoll Load (0.5ms)[0m  [1m[34mSELECT  "polls".* FROM "polls" WHERE "polls"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mAttempt Load (1.0ms)[0m  [1m[34mSELECT  "attempts".* FROM "attempts" INNER JOIN "answers" ON "attempts"."answer_id" = "answers"."id" INNER JOIN "questions" ON "answers"."question_id" = "questions"."id" WHERE "questions"."poll_id" = $1 ORDER BY "answers"."id" ASC, "attempts"."created_at" ASC LIMIT $2[0m  [["poll_id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "questions"."id" FROM "questions" WHERE "questions"."poll_id" = $1[0m  [["poll_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[35mWITH attempts_amount AS
        (
          SELECT
              count(id) AS amount,
              date_trunc('day', attempts.created_at) AS PERIOD
          FROM attempts
          WHERE attempts.answer_id in (SELECT id FROM answers where question_id = 4)
          GROUP BY PERIOD
        )
        SELECT period,
               CASE
                  WHEN attempts_amount.amount is NULL THEN 0
                  ELSE attempts_amount.amount
               END as amount
        FROM
            (SELECT generate_series(min(period), max(period), '1 day') AS PERIOD
            FROM attempts_amount) x
        LEFT JOIN attempts_amount
        USING (period)
        ORDER BY period;[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" IN (SELECT "locations"."id" FROM "locations" WHERE "locations"."poll_id" = $1) AND (created_at > '2017-06-28 07:41:53.246812')[0m  [["poll_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mQuestion Load (0.7ms)[0m  [1m[34mSELECT "questions".* FROM "questions" WHERE (poll_id = 4)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mAnswer Load (0.6ms)[0m  [1m[34mSELECT "answers".* FROM "answers" WHERE "answers"."question_id" = 4 ORDER BY "answers"."id" ASC[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mAttempt Load (0.7ms)[0m  [1m[34mSELECT "attempts".* FROM "attempts" WHERE "attempts"."answer_id" = 3[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (22, 24)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.7ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (22, 24)[0m
[INFO ] Completed [32m200 OK[0m in 49ms [30m(Views: 0.9ms | ActiveRecord: 11.8ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "attempts" WHERE "attempts"."answer_id" = $1[0m  [["answer_id", 3]]
[[1m[30mDEBUG[0m[0m]   [1m[36mAttempt Load (0.7ms)[0m  [1m[34mSELECT  "attempts".* FROM "attempts" WHERE "attempts"."answer_id" = $1 ORDER BY "attempts"."id" ASC LIMIT $2[0m  [["answer_id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."id" = $1 LIMIT $2[0m  [["id", 22], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-799-021-2737 x103"], ["created_at", "2017-07-28 07:41:52.331504"], ["updated_at", "2017-07-28 07:41:52.331504"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "gene_harber"], ["email", "linda@wunschwitting.net"], ["password", "I1IvXh4p"], ["created_at", "2017-07-28 07:41:52.336670"], ["updated_at", "2017-07-28 07:41:52.336670"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "311570"], ["username", "ciara.streich"], ["image", "http://instagram.com/img/ciara.streich.jpg"], ["profile", "https://instagram.com/ciara.streich"], ["email", "deion_cronin@schoenhane.co"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 25], ["user_id", 49], ["created_at", "2017-07-28 07:41:52.341308"], ["updated_at", "2017-07-28 07:41:52.341308"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Veribet"], ["created_at", "2017-07-28 07:41:52.348858"], ["updated_at", "2017-07-28 07:41:52.348858"], ["local_path", "http://kling.info/adriel"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Sub-Ex"], ["title_ru", "Название30"], ["created_at", "2017-07-28 07:41:52.352708"], ["updated_at", "2017-07-28 07:41:52.352708"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_30[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 30) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>30, "title"=>"Veribet", "created_at"=>Fri, 28 Jul 2017 07:41:52 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:52 UTC +00:00, "local_path"=>"http://kling.info/adriel"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "flowdesk"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "flowdesk"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Flowdesk"], ["category_id", 30], ["slug", "flowdesk"], ["created_at", "2017-07-28 07:41:52.365149"], ["updated_at", "2017-07-28 07:41:52.365149"], ["layout_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "veritatis-culpa"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Sub-Ex"], ["phone", "263-174-2163"], ["address", "2870 Rau Parks"], ["url", "http://gislason.net/josefa.kuphal"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://durgandenesik.net/christop_kiehn"], ["auth_expiration_time", 900], ["slug", "veritatis-culpa"], ["brand_id", 30], ["user_id", 49], ["created_at", "2017-07-28 07:41:52.371582"], ["updated_at", "2017-07-28 07:41:52.371582"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Hatity"], ["created_at", "2017-07-28 07:41:52.379912"], ["updated_at", "2017-07-28 07:41:52.379912"], ["local_path", "http://jenkins.io/moses"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Home Ing"], ["title_ru", "Название31"], ["created_at", "2017-07-28 07:41:52.383666"], ["updated_at", "2017-07-28 07:41:52.383666"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 31[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_31[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.9ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 31) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>31, "title"=>"Hatity", "created_at"=>Fri, 28 Jul 2017 07:41:52 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:52 UTC +00:00, "local_path"=>"http://jenkins.io/moses"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "flowdesk"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "flowdesk-category0x007fe2e3c08ca8"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "flowdesk-category0x007fe2e3c08ca8"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Flowdesk"], ["category_id", 31], ["slug", "flowdesk-category0x007fe2e3c08ca8"], ["created_at", "2017-07-28 07:41:52.395730"], ["updated_at", "2017-07-28 07:41:52.395730"], ["layout_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "maxine"], ["email", "letha@cronin.biz"], ["password", "To1qH9LeEtEwPyD"], ["created_at", "2017-07-28 07:41:52.400420"], ["updated_at", "2017-07-28 07:41:52.400420"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "consequatur-itaque"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stronghold"], ["phone", "(168) 674-3452"], ["address", "6638 Reinger Valleys"], ["url", "http://ricepouros.net/libbie"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://waelchi.net/clarabelle.stokes"], ["auth_expiration_time", 900], ["slug", "consequatur-itaque"], ["brand_id", 31], ["user_id", 50], ["created_at", "2017-07-28 07:41:52.406079"], ["updated_at", "2017-07-28 07:41:52.406079"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "vidal"], ["email", "marisa@wiegandkihn.net"], ["password", "V1Rc374011"], ["created_at", "2017-07-28 07:41:52.411347"], ["updated_at", "2017-07-28 07:41:52.411347"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5334"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5334"], ["comment", "comment 14"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "135.239.171.42"], ["router_admin_ip", "248.77.118.101"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "160"], ["status", "t"], ["location_id", 31], ["user_id", 51], ["created_at", "2017-07-28 07:41:52.417013"], ["updated_at", "2017-07-28 07:41:52.417013"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5334"], ["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 4], ["serial", "643705CA5E36/5334"], ["comment", "comment 14"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "135.239.171.42"], ["router_admin_ip", "248.77.118.101"], ["admin_password", "b02bbdff6687d3fb"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "4"], ["status", "t"], ["location_id", 31], ["user_id", 51], ["created_at", "2017-07-28 07:41:52.417013"], ["updated_at", "2017-07-28 07:41:52.417013"], ["id", 4]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: b7fa0302-1554-43e2-b3a9-652c68ad7ddc) to Async(routers) with arguments: #<GlobalID:0x007fe2e3ab6918 @uri=#<URI::GID gid://wifi-management/Router/4>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: e28a42de-169d-40ae-82bb-db063caf9985) to Async(routers) with arguments: #<GlobalID:0x007fe2e3ab6918 @uri=#<URI::GID gid://wifi-management/Router/4>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.4ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 4], ["provider", "instagram"], ["location_id", 30], ["router_id", 4], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:52 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"gene_harber", "email"=>"linda@wunschwitting.net", "password"=>"I1IvXh4p", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"gene_harber", :email=>"linda@wunschwitting.net", :password=>"I1IvXh4p", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"linda@wunschwitting.net", "password"=>"I1IvXh4p"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "gene_harber"], ["email", "linda@wunschwitting.net"], ["password", "I1IvXh4p"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 49, username: "gene_harber", email: "linda@wunschwitting.net", password: "I1IvXh4p", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:41:52", updated_at: "2017-07-28 07:41:52", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 49[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/stats/time_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:52 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#time_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 49[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_49[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 49) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 49]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>49, "username"=>"gene_harber", "email"=>"linda@wunschwitting.net", "password"=>"I1IvXh4p", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:52 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:52 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"time_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 49[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_49[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 49[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_49[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>49, :username=>"gene_harber", :email=>"linda@wunschwitting.net", :password=>"I1IvXh4p", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:41:52.336Z", :updated_at=>"2017-07-28T07:41:52.336Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 49[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.3ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(30)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 39ms [30m(Views: 1.2ms | ActiveRecord: 7.4ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "476-924-0972"], ["created_at", "2017-07-28 07:41:52.568249"], ["updated_at", "2017-07-28 07:41:52.568249"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jeffery"], ["email", "connor@kuhlman.org"], ["password", "H0FxW2V8F1"], ["created_at", "2017-07-28 07:41:52.573317"], ["updated_at", "2017-07-28 07:41:52.573317"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "669032"], ["username", "jodie"], ["image", "http://vk.com/img/jodie.jpg"], ["profile", "https://vk.com/jodie"], ["email", "lourdes_parisian@dickens.org"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 26], ["user_id", 52], ["created_at", "2017-07-28 07:41:52.578515"], ["updated_at", "2017-07-28 07:41:52.578515"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Gembucket"], ["created_at", "2017-07-28 07:41:52.585820"], ["updated_at", "2017-07-28 07:41:52.585820"], ["local_path", "http://smitham.name/mable"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zontrax"], ["title_ru", "Название32"], ["created_at", "2017-07-28 07:41:52.589615"], ["updated_at", "2017-07-28 07:41:52.589615"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 32[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_32[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 32) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>32, "title"=>"Gembucket", "created_at"=>Fri, 28 Jul 2017 07:41:52 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:52 UTC +00:00, "local_path"=>"http://smitham.name/mable"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "duobam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "duobam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Duobam"], ["category_id", 32], ["slug", "duobam"], ["created_at", "2017-07-28 07:41:52.601235"], ["updated_at", "2017-07-28 07:41:52.601235"], ["layout_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "sed_aut"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zontrax"], ["phone", "1-320-291-9677"], ["address", "589 Deckow Isle"], ["url", "http://damore.net/dayana_torphy"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://streichwintheiser.info/austin"], ["auth_expiration_time", 900], ["slug", "sed_aut"], ["brand_id", 32], ["user_id", 52], ["created_at", "2017-07-28 07:41:52.607569"], ["updated_at", "2017-07-28 07:41:52.607569"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Y-find"], ["created_at", "2017-07-28 07:41:52.615972"], ["updated_at", "2017-07-28 07:41:52.615972"], ["local_path", "http://rennerraynor.org/beryl.powlowski"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Stringtough"], ["title_ru", "Название33"], ["created_at", "2017-07-28 07:41:52.619607"], ["updated_at", "2017-07-28 07:41:52.619607"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 33[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_33[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 33) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>33, "title"=>"Y-find", "created_at"=>Fri, 28 Jul 2017 07:41:52 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:52 UTC +00:00, "local_path"=>"http://rennerraynor.org/beryl.powlowski"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cookley"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cookley"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Cookley"], ["category_id", 33], ["slug", "cookley"], ["created_at", "2017-07-28 07:41:52.630410"], ["updated_at", "2017-07-28 07:41:52.630410"], ["layout_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "derek"], ["email", "kariane_metz@ritchieorn.info"], ["password", "Op4lSmTnBdR"], ["created_at", "2017-07-28 07:41:52.635186"], ["updated_at", "2017-07-28 07:41:52.635186"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "consequatur.et"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stringtough"], ["phone", "999.472.9663"], ["address", "570 Morgan Parkway"], ["url", "http://weimann.com/alba"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hagenesziemann.biz/sammie"], ["auth_expiration_time", 900], ["slug", "consequatur.et"], ["brand_id", 33], ["user_id", 53], ["created_at", "2017-07-28 07:41:52.640965"], ["updated_at", "2017-07-28 07:41:52.640965"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "chyna"], ["email", "allene@hilpertjakubowski.net"], ["password", "WnT54pS5IhEkYi0e"], ["created_at", "2017-07-28 07:41:52.646454"], ["updated_at", "2017-07-28 07:41:52.646454"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5335"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5335"], ["comment", "comment 15"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "250.170.47.17"], ["router_admin_ip", "164.35.81.3"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "438"], ["status", "t"], ["location_id", 33], ["user_id", 54], ["created_at", "2017-07-28 07:41:52.651877"], ["updated_at", "2017-07-28 07:41:52.651877"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5335"], ["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 5], ["serial", "643705CA5E36/5335"], ["comment", "comment 15"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "250.170.47.17"], ["router_admin_ip", "164.35.81.3"], ["admin_password", "7bab5bb1b21479cb"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "5"], ["status", "t"], ["location_id", 33], ["user_id", 54], ["created_at", "2017-07-28 07:41:52.651877"], ["updated_at", "2017-07-28 07:41:52.651877"], ["id", 5]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: e5ad7763-48e5-48b5-95c2-b7468ff7158f) to Async(routers) with arguments: #<GlobalID:0x007fe2e3344428 @uri=#<URI::GID gid://wifi-management/Router/5>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 3d8c50e3-b2c8-4fe3-b55a-129ed791969f) to Async(routers) with arguments: #<GlobalID:0x007fe2e3344428 @uri=#<URI::GID gid://wifi-management/Router/5>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 5], ["provider", "instagram"], ["location_id", 32], ["router_id", 5], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:52 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"jeffery", "email"=>"connor@kuhlman.org", "password"=>"H0FxW2V8F1", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"jeffery", :email=>"connor@kuhlman.org", :password=>"H0FxW2V8F1", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"connor@kuhlman.org", "password"=>"H0FxW2V8F1"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "jeffery"], ["email", "connor@kuhlman.org"], ["password", "H0FxW2V8F1"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 52, username: "jeffery", email: "connor@kuhlman.org", password: "H0FxW2V8F1", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:41:52", updated_at: "2017-07-28 07:41:52", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 52[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/stats/authorizations" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:52 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#authorizations[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 52[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_52[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 52) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 52]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>52, "username"=>"jeffery", "email"=>"connor@kuhlman.org", "password"=>"H0FxW2V8F1", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:52 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:52 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"authorizations"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 52[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_52[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 52[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_52[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>52, :username=>"jeffery", :email=>"connor@kuhlman.org", :password=>"H0FxW2V8F1", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:41:52.573Z", :updated_at=>"2017-07-28T07:41:52.573Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 52[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT("social_logs"."id") AS count_id, date_trunc('hour', created_at) AS date_trunc_hour_created_at FROM "social_logs" WHERE "social_logs"."location_id" = 32 AND ("social_logs"."created_at" BETWEEN $1 AND $2) GROUP BY date_trunc('hour', created_at) ORDER BY date_trunc_hour_created_at[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 26ms [30m(Views: 0.2ms | ActiveRecord: 6.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "623.223.5485 x5253"], ["created_at", "2017-07-28 07:41:52.923974"], ["updated_at", "2017-07-28 07:41:52.923974"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "alf"], ["email", "ona@collins.info"], ["password", "1aSsS57a"], ["created_at", "2017-07-28 07:41:52.929002"], ["updated_at", "2017-07-28 07:41:52.929002"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "277606"], ["username", "madisen"], ["image", "http://instagram.com/img/madisen.jpg"], ["profile", "https://instagram.com/madisen"], ["email", "eugenia@schimmelschroeder.co"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 27], ["user_id", 55], ["created_at", "2017-07-28 07:41:52.933279"], ["updated_at", "2017-07-28 07:41:52.933279"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Hatity"], ["created_at", "2017-07-28 07:41:52.940362"], ["updated_at", "2017-07-28 07:41:52.940362"], ["local_path", "http://frami.info/curtis"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Cookley"], ["title_ru", "Название34"], ["created_at", "2017-07-28 07:41:52.944147"], ["updated_at", "2017-07-28 07:41:52.944147"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 34[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_34[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 34) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>34, "title"=>"Hatity", "created_at"=>Fri, 28 Jul 2017 07:41:52 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:52 UTC +00:00, "local_path"=>"http://frami.info/curtis"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "transcof"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "transcof"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Transcof"], ["category_id", 34], ["slug", "transcof"], ["created_at", "2017-07-28 07:41:52.955484"], ["updated_at", "2017-07-28 07:41:52.955484"], ["layout_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ut_officia"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Otcom"], ["phone", "1-725-279-5475"], ["address", "6259 Walker Station"], ["url", "http://schneiderbraun.net/juliana"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ledner.co/litzy"], ["auth_expiration_time", 900], ["slug", "ut_officia"], ["brand_id", 34], ["user_id", 55], ["created_at", "2017-07-28 07:41:52.961191"], ["updated_at", "2017-07-28 07:41:52.961191"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Kanlam"], ["created_at", "2017-07-28 07:41:52.969533"], ["updated_at", "2017-07-28 07:41:52.969533"], ["local_path", "http://sawayn.biz/liana"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Prodder"], ["title_ru", "Название35"], ["created_at", "2017-07-28 07:41:52.973429"], ["updated_at", "2017-07-28 07:41:52.973429"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 35[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_35[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 35) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>35, "title"=>"Kanlam", "created_at"=>Fri, 28 Jul 2017 07:41:52 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:52 UTC +00:00, "local_path"=>"http://sawayn.biz/liana"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "span"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "span"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Span"], ["category_id", 35], ["slug", "span"], ["created_at", "2017-07-28 07:41:52.984120"], ["updated_at", "2017-07-28 07:41:52.984120"], ["layout_id", 35]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "noel"], ["email", "chaim.heidenreich@roberts.biz"], ["password", "4iAyJmE7"], ["created_at", "2017-07-28 07:41:52.989050"], ["updated_at", "2017-07-28 07:41:52.989050"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "velit-cumque"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Cardguard"], ["phone", "1-987-291-4745"], ["address", "4201 Mekhi Ramp"], ["url", "http://gusikowski.io/lavon.hickle"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hillseichmann.info/shana.denesik"], ["auth_expiration_time", 900], ["slug", "velit-cumque"], ["brand_id", 35], ["user_id", 56], ["created_at", "2017-07-28 07:41:52.994765"], ["updated_at", "2017-07-28 07:41:52.994765"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "nasir"], ["email", "mckayla.grimes@mraz.co"], ["password", "5sB0Hd52UnG"], ["created_at", "2017-07-28 07:41:52.999961"], ["updated_at", "2017-07-28 07:41:52.999961"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5336"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5336"], ["comment", "comment 16"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "223.4.32.33"], ["router_admin_ip", "194.125.251.86"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "694"], ["status", "t"], ["location_id", 35], ["user_id", 57], ["created_at", "2017-07-28 07:41:53.005495"], ["updated_at", "2017-07-28 07:41:53.005495"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5336"], ["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 6], ["serial", "643705CA5E36/5336"], ["comment", "comment 16"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "223.4.32.33"], ["router_admin_ip", "194.125.251.86"], ["admin_password", "f2c1c33ad009c829"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "6"], ["status", "t"], ["location_id", 35], ["user_id", 57], ["created_at", "2017-07-28 07:41:53.005495"], ["updated_at", "2017-07-28 07:41:53.005495"], ["id", 6]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 5565f051-5b63-48d5-b712-60701e7ff704) to Async(routers) with arguments: #<GlobalID:0x007fe2e6956430 @uri=#<URI::GID gid://wifi-management/Router/6>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 49b60b18-4e99-4006-a300-cd04b1c2573a) to Async(routers) with arguments: #<GlobalID:0x007fe2e6956430 @uri=#<URI::GID gid://wifi-management/Router/6>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 6], ["provider", "instagram"], ["location_id", 34], ["router_id", 6], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:53 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"alf", "email"=>"ona@collins.info", "password"=>"1aSsS57a", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"alf", :email=>"ona@collins.info", :password=>"1aSsS57a", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"ona@collins.info", "password"=>"1aSsS57a"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "alf"], ["email", "ona@collins.info"], ["password", "1aSsS57a"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 55, username: "alf", email: "ona@collins.info", password: "1aSsS57a", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:41:52", updated_at: "2017-07-28 07:41:52", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 55[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.7ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/social_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:53 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#social_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 55[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_55[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 55) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 55]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>55, "username"=>"alf", "email"=>"ona@collins.info", "password"=>"1aSsS57a", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:52 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:52 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"social_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 55[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_55[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 55[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_55[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>55, :username=>"alf", :email=>"ona@collins.info", :password=>"1aSsS57a", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:41:52.929Z", :updated_at=>"2017-07-28T07:41:52.929Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 55[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" = 34 AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 24ms [30m(Views: 1.3ms | ActiveRecord: 5.0ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "794.127.3386 x90649"], ["created_at", "2017-07-28 07:41:53.218836"], ["updated_at", "2017-07-28 07:41:53.218836"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lisa"], ["email", "maximillian_bartoletti@crooks.name"], ["password", "3d8sOsHgE"], ["created_at", "2017-07-28 07:41:53.223335"], ["updated_at", "2017-07-28 07:41:53.223335"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "790155"], ["username", "cale"], ["image", "http://facebook.com/img/cale.jpg"], ["profile", "https://facebook.com/cale"], ["email", "rupert@vandervort.co"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 28], ["user_id", 58], ["created_at", "2017-07-28 07:41:53.227390"], ["updated_at", "2017-07-28 07:41:53.227390"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Home Ing"], ["created_at", "2017-07-28 07:41:53.234764"], ["updated_at", "2017-07-28 07:41:53.234764"], ["local_path", "http://schowalter.info/julio"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.4ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Opela"], ["title_ru", "Название36"], ["created_at", "2017-07-28 07:41:53.238312"], ["updated_at", "2017-07-28 07:41:53.238312"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_36[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 36) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>36, "title"=>"Home Ing", "created_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "local_path"=>"http://schowalter.info/julio"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "domainer"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "domainer"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Domainer"], ["category_id", 36], ["slug", "domainer"], ["created_at", "2017-07-28 07:41:53.249117"], ["updated_at", "2017-07-28 07:41:53.249117"], ["layout_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ut_atque"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Sonsing"], ["phone", "(590) 213-7659"], ["address", "259 Kemmer Mews"], ["url", "http://leffler.biz/elmer"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://stark.co/margarita.windler"], ["auth_expiration_time", 900], ["slug", "ut_atque"], ["brand_id", 36], ["user_id", 58], ["created_at", "2017-07-28 07:41:53.254579"], ["updated_at", "2017-07-28 07:41:53.254579"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Home Ing"], ["created_at", "2017-07-28 07:41:53.262860"], ["updated_at", "2017-07-28 07:41:53.262860"], ["local_path", "http://cartwright.name/frances"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.4ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Greenlam"], ["title_ru", "Название37"], ["created_at", "2017-07-28 07:41:53.266380"], ["updated_at", "2017-07-28 07:41:53.266380"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 37[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_37[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.5ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 37) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>37, "title"=>"Home Ing", "created_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "local_path"=>"http://cartwright.name/frances"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "asoka"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "asoka"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Asoka"], ["category_id", 37], ["slug", "asoka"], ["created_at", "2017-07-28 07:41:53.277018"], ["updated_at", "2017-07-28 07:41:53.277018"], ["layout_id", 37]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "chloe_waters"], ["email", "titus_hudson@gaylord.org"], ["password", "Dh7oI9SgB4MdV"], ["created_at", "2017-07-28 07:41:53.281850"], ["updated_at", "2017-07-28 07:41:53.281850"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "vel-error"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tres-Zap"], ["phone", "402-894-5443"], ["address", "580 Price Walks"], ["url", "http://romaguera.io/claud"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ebert.info/jeramy"], ["auth_expiration_time", 900], ["slug", "vel-error"], ["brand_id", 37], ["user_id", 59], ["created_at", "2017-07-28 07:41:53.287656"], ["updated_at", "2017-07-28 07:41:53.287656"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "oceane"], ["email", "karl.effertz@terry.info"], ["password", "Sg5mThD8NbW4S4Rs"], ["created_at", "2017-07-28 07:41:53.292724"], ["updated_at", "2017-07-28 07:41:53.292724"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5337"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5337"], ["comment", "comment 17"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "112.21.37.65"], ["router_admin_ip", "187.233.44.145"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "218"], ["status", "t"], ["location_id", 37], ["user_id", 60], ["created_at", "2017-07-28 07:41:53.298221"], ["updated_at", "2017-07-28 07:41:53.298221"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5337"], ["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 7], ["serial", "643705CA5E36/5337"], ["comment", "comment 17"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "112.21.37.65"], ["router_admin_ip", "187.233.44.145"], ["admin_password", "3d6497ebaa0483ab"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "7"], ["status", "t"], ["location_id", 37], ["user_id", 60], ["created_at", "2017-07-28 07:41:53.298221"], ["updated_at", "2017-07-28 07:41:53.298221"], ["id", 7]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 77356616-9448-491b-862d-d68f80edcfd2) to Async(routers) with arguments: #<GlobalID:0x007fe2e6046b10 @uri=#<URI::GID gid://wifi-management/Router/7>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: e64d0b9f-c7c1-4717-8de3-5fe2c122c658) to Async(routers) with arguments: #<GlobalID:0x007fe2e6046b10 @uri=#<URI::GID gid://wifi-management/Router/7>>
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 7], ["provider", "instagram"], ["location_id", 36], ["router_id", 7], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "630.065.5065 x075"], ["created_at", "2017-07-28 07:41:53.397138"], ["updated_at", "2017-07-28 07:41:53.397138"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "agustina_schoen"], ["email", "ayla@corkery.co"], ["password", "El1m8hD31x1s8v"], ["created_at", "2017-07-28 07:41:53.401515"], ["updated_at", "2017-07-28 07:41:53.401515"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "839950"], ["username", "carroll.schaden"], ["image", "http://twitter.com/img/carroll.schaden.jpg"], ["profile", "https://twitter.com/carroll.schaden"], ["email", "llewellyn.wilderman@padbergrempel.info"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 29], ["user_id", 61], ["created_at", "2017-07-28 07:41:53.405353"], ["updated_at", "2017-07-28 07:41:53.405353"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Alpha"], ["created_at", "2017-07-28 07:41:53.412367"], ["updated_at", "2017-07-28 07:41:53.412367"], ["local_path", "http://smitham.name/georgette"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fix San"], ["title_ru", "Название38"], ["created_at", "2017-07-28 07:41:53.415901"], ["updated_at", "2017-07-28 07:41:53.415901"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 38[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_38[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.5ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 38) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>38, "title"=>"Alpha", "created_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "local_path"=>"http://smitham.name/georgette"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "namfix"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "namfix"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Namfix"], ["category_id", 38], ["slug", "namfix"], ["created_at", "2017-07-28 07:41:53.426495"], ["updated_at", "2017-07-28 07:41:53.426495"], ["layout_id", 38]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "distinctio_mollitia"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stronghold"], ["phone", "326-325-0125"], ["address", "60745 Hessel River"], ["url", "http://gaylord.net/erna.stehr"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://stiedemann.name/maxwell_oberbrunner"], ["auth_expiration_time", 900], ["slug", "distinctio_mollitia"], ["brand_id", 38], ["user_id", 61], ["created_at", "2017-07-28 07:41:53.431767"], ["updated_at", "2017-07-28 07:41:53.431767"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Redhold"], ["created_at", "2017-07-28 07:41:53.439848"], ["updated_at", "2017-07-28 07:41:53.439848"], ["local_path", "http://moriette.info/drew"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Voltsillam"], ["title_ru", "Название39"], ["created_at", "2017-07-28 07:41:53.443561"], ["updated_at", "2017-07-28 07:41:53.443561"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_39[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.5ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 39) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>39, "title"=>"Redhold", "created_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "local_path"=>"http://moriette.info/drew"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sub-ex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sub-ex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Sub-Ex"], ["category_id", 39], ["slug", "sub-ex"], ["created_at", "2017-07-28 07:41:53.453939"], ["updated_at", "2017-07-28 07:41:53.453939"], ["layout_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "stevie"], ["email", "delia@rowe.co"], ["password", "GpPdDaWb2"], ["created_at", "2017-07-28 07:41:53.458457"], ["updated_at", "2017-07-28 07:41:53.458457"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "officia_excepturi"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Overhold"], ["phone", "1-740-709-2204"], ["address", "1332 Abernathy Light"], ["url", "http://lednerhirthe.org/domenic"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://prosaccokrajcik.io/marlen"], ["auth_expiration_time", 900], ["slug", "officia_excepturi"], ["brand_id", 39], ["user_id", 62], ["created_at", "2017-07-28 07:41:53.463803"], ["updated_at", "2017-07-28 07:41:53.463803"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ashlee"], ["email", "vidal@townemertz.biz"], ["password", "Qq2nD1De7hHdHbGu"], ["created_at", "2017-07-28 07:41:53.468835"], ["updated_at", "2017-07-28 07:41:53.468835"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5338"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5338"], ["comment", "comment 18"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "191.17.50.252"], ["router_admin_ip", "144.153.23.89"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "612"], ["status", "t"], ["location_id", 39], ["user_id", 63], ["created_at", "2017-07-28 07:41:53.473912"], ["updated_at", "2017-07-28 07:41:53.473912"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5338"], ["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 8], ["serial", "643705CA5E36/5338"], ["comment", "comment 18"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "191.17.50.252"], ["router_admin_ip", "144.153.23.89"], ["admin_password", "8aab43d25352ad2e"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "8"], ["status", "t"], ["location_id", 39], ["user_id", 63], ["created_at", "2017-07-28 07:41:53.473912"], ["updated_at", "2017-07-28 07:41:53.473912"], ["id", 8]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 86e12213-b315-4760-8d91-da1a34b07a64) to Async(routers) with arguments: #<GlobalID:0x007fe2e52fb960 @uri=#<URI::GID gid://wifi-management/Router/8>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 6b798c91-38b7-4773-a1dd-7d040b4ac115) to Async(routers) with arguments: #<GlobalID:0x007fe2e52fb960 @uri=#<URI::GID gid://wifi-management/Router/8>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 8], ["provider", "instagram"], ["location_id", 38], ["router_id", 8], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:53 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"agustina_schoen", "email"=>"ayla@corkery.co", "password"=>"El1m8hD31x1s8v", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"agustina_schoen", :email=>"ayla@corkery.co", :password=>"El1m8hD31x1s8v", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"ayla@corkery.co", "password"=>"El1m8hD31x1s8v"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "agustina_schoen"], ["email", "ayla@corkery.co"], ["password", "El1m8hD31x1s8v"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 61, username: "agustina_schoen", email: "ayla@corkery.co", password: "El1m8hD31x1s8v", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:41:53", updated_at: "2017-07-28 07:41:53", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 61[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.7ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/locations_list" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:53 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#locations_list[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 61[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_61[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 61) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 61]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 61]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 61]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 61]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 61]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 61]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 61]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 61]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>61, "username"=>"agustina_schoen", "email"=>"ayla@corkery.co", "password"=>"El1m8hD31x1s8v", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"locations_list"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 61[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_61[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 61[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_61[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>61, :username=>"agustina_schoen", :email=>"ayla@corkery.co", :password=>"El1m8hD31x1s8v", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:41:53.401Z", :updated_at=>"2017-07-28T07:41:53.401Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 61[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Load (0.8ms)[0m  [1m[34mSELECT "locations".* FROM "locations" WHERE "locations"."user_id" = 61[0m
[INFO ] Completed [32m200 OK[0m in 23ms [30m(Views: 0.3ms | ActiveRecord: 5.2ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(202) 053-7131 x9041"], ["created_at", "2017-07-28 07:41:53.733259"], ["updated_at", "2017-07-28 07:41:53.733259"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "nathan_walsh"], ["email", "rowena.waelchi@schamberger.info"], ["password", "ZgAfBl4z"], ["created_at", "2017-07-28 07:41:53.738143"], ["updated_at", "2017-07-28 07:41:53.738143"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "372739"], ["username", "ted"], ["image", "http://vk.com/img/ted.jpg"], ["profile", "https://vk.com/ted"], ["email", "shawna@marvin.net"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 30], ["user_id", 64], ["created_at", "2017-07-28 07:41:53.742332"], ["updated_at", "2017-07-28 07:41:53.742332"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Asoka"], ["created_at", "2017-07-28 07:41:53.749691"], ["updated_at", "2017-07-28 07:41:53.749691"], ["local_path", "http://keeblerkuphal.co/akeem"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Daltfresh"], ["title_ru", "Название40"], ["created_at", "2017-07-28 07:41:53.753669"], ["updated_at", "2017-07-28 07:41:53.753669"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 40[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_40[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 40) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>40, "title"=>"Asoka", "created_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "local_path"=>"http://keeblerkuphal.co/akeem"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "matsoft"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "matsoft"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Matsoft"], ["category_id", 40], ["slug", "matsoft"], ["created_at", "2017-07-28 07:41:53.765173"], ["updated_at", "2017-07-28 07:41:53.765173"], ["layout_id", 40]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ducimus.odit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Konklab"], ["phone", "636.869.8793"], ["address", "80626 Hagenes Green"], ["url", "http://grahambatz.co/barrett_jenkins"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://mannstoltenberg.name/art"], ["auth_expiration_time", 900], ["slug", "ducimus.odit"], ["brand_id", 40], ["user_id", 64], ["created_at", "2017-07-28 07:41:53.771085"], ["updated_at", "2017-07-28 07:41:53.771085"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Solarbreeze"], ["created_at", "2017-07-28 07:41:53.779504"], ["updated_at", "2017-07-28 07:41:53.779504"], ["local_path", "http://johnshuels.info/juvenal_ebert"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Sonsing"], ["title_ru", "Название41"], ["created_at", "2017-07-28 07:41:53.783384"], ["updated_at", "2017-07-28 07:41:53.783384"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 41[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_41[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 41) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>41, "title"=>"Solarbreeze", "created_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "local_path"=>"http://johnshuels.info/juvenal_ebert"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "duobam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "duobam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Duobam"], ["category_id", 41], ["slug", "duobam"], ["created_at", "2017-07-28 07:41:53.794367"], ["updated_at", "2017-07-28 07:41:53.794367"], ["layout_id", 41]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "alford"], ["email", "bridget@rodriguezankunding.io"], ["password", "Nv4uV9Em4jVfV"], ["created_at", "2017-07-28 07:41:53.799252"], ["updated_at", "2017-07-28 07:41:53.799252"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "optio-perferendis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Flowdesk"], ["phone", "(505) 386-2934"], ["address", "13065 Borer Locks"], ["url", "http://price.biz/malvina"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hagenes.info/karina"], ["auth_expiration_time", 900], ["slug", "optio-perferendis"], ["brand_id", 41], ["user_id", 65], ["created_at", "2017-07-28 07:41:53.805155"], ["updated_at", "2017-07-28 07:41:53.805155"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "destiney"], ["email", "talon@powlowskiruecker.co"], ["password", "7vGtYiJz942"], ["created_at", "2017-07-28 07:41:53.810612"], ["updated_at", "2017-07-28 07:41:53.810612"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5339"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5339"], ["comment", "comment 19"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "206.90.219.43"], ["router_admin_ip", "134.84.190.12"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "436"], ["status", "t"], ["location_id", 41], ["user_id", 66], ["created_at", "2017-07-28 07:41:53.816283"], ["updated_at", "2017-07-28 07:41:53.816283"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5339"], ["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 9], ["serial", "643705CA5E36/5339"], ["comment", "comment 19"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "206.90.219.43"], ["router_admin_ip", "134.84.190.12"], ["admin_password", "ab4b5db7390414de"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "9"], ["status", "t"], ["location_id", 41], ["user_id", 66], ["created_at", "2017-07-28 07:41:53.816283"], ["updated_at", "2017-07-28 07:41:53.816283"], ["id", 9]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 5aa3c4f9-9968-461c-b486-0f1a12dc9735) to Async(routers) with arguments: #<GlobalID:0x007fe2e37cec00 @uri=#<URI::GID gid://wifi-management/Router/9>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 73990c34-dd39-4d1b-8378-8420c3b09dd4) to Async(routers) with arguments: #<GlobalID:0x007fe2e37cec00 @uri=#<URI::GID gid://wifi-management/Router/9>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 9], ["provider", "instagram"], ["location_id", 40], ["router_id", 9], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:53 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"nathan_walsh", "email"=>"rowena.waelchi@schamberger.info", "password"=>"ZgAfBl4z", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"nathan_walsh", :email=>"rowena.waelchi@schamberger.info", :password=>"ZgAfBl4z", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"rowena.waelchi@schamberger.info", "password"=>"ZgAfBl4z"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "nathan_walsh"], ["email", "rowena.waelchi@schamberger.info"], ["password", "ZgAfBl4z"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 64, username: "nathan_walsh", email: "rowena.waelchi@schamberger.info", password: "ZgAfBl4z", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:41:53", updated_at: "2017-07-28 07:41:53", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 64[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/all_connects" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:53 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#all_connects[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 64[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_64[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 64) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 64]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 64]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 64]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 64]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 64]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 64]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 64]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 64]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>64, "username"=>"nathan_walsh", "email"=>"rowena.waelchi@schamberger.info", "password"=>"ZgAfBl4z", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"all_connects"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 64[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_64[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 64[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_64[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>64, :username=>"nathan_walsh", :email=>"rowena.waelchi@schamberger.info", :password=>"ZgAfBl4z", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:41:53.738Z", :updated_at=>"2017-07-28T07:41:53.738Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 64[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 40[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 40 AND ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-06-28 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 40 AND ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 26ms [30m(Views: 0.2ms | ActiveRecord: 7.2ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "292-839-2410 x85762"], ["created_at", "2017-07-28 07:41:53.950211"], ["updated_at", "2017-07-28 07:41:53.950211"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "neil"], ["email", "bridie.hills@braunbashirian.info"], ["password", "5mTjZ9RdKlAj876"], ["created_at", "2017-07-28 07:41:53.955198"], ["updated_at", "2017-07-28 07:41:53.955198"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "472631"], ["username", "antonetta_ryan"], ["image", "http://vk.com/img/antonetta_ryan.jpg"], ["profile", "https://vk.com/antonetta_ryan"], ["email", "giovanny.mclaughlin@hackett.info"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 31], ["user_id", 67], ["created_at", "2017-07-28 07:41:53.959519"], ["updated_at", "2017-07-28 07:41:53.959519"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Treeflex"], ["created_at", "2017-07-28 07:41:53.966803"], ["updated_at", "2017-07-28 07:41:53.966803"], ["local_path", "http://leffler.name/llewellyn"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Home Ing"], ["title_ru", "Название42"], ["created_at", "2017-07-28 07:41:53.971013"], ["updated_at", "2017-07-28 07:41:53.971013"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_42[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 42) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>42, "title"=>"Treeflex", "created_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "local_path"=>"http://leffler.name/llewellyn"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "veribet"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "veribet"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Veribet"], ["category_id", 42], ["slug", "veribet"], ["created_at", "2017-07-28 07:41:53.982554"], ["updated_at", "2017-07-28 07:41:53.982554"], ["layout_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quo_et"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Sub-Ex"], ["phone", "553.030.2297"], ["address", "6643 Schuster Stream"], ["url", "http://armstrongbernier.net/caden_lesch"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://schneidervolkman.io/ella.becker"], ["auth_expiration_time", 900], ["slug", "quo_et"], ["brand_id", 42], ["user_id", 67], ["created_at", "2017-07-28 07:41:53.988975"], ["updated_at", "2017-07-28 07:41:53.988975"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Asoka"], ["created_at", "2017-07-28 07:41:53.997566"], ["updated_at", "2017-07-28 07:41:53.997566"], ["local_path", "http://reynolds.io/ethelyn_hettinger"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Domainer"], ["title_ru", "Название43"], ["created_at", "2017-07-28 07:41:54.001482"], ["updated_at", "2017-07-28 07:41:54.001482"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 43[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_43[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 43) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>43, "title"=>"Asoka", "created_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "local_path"=>"http://reynolds.io/ethelyn_hettinger"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonsing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonsing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Sonsing"], ["category_id", 43], ["slug", "sonsing"], ["created_at", "2017-07-28 07:41:54.012648"], ["updated_at", "2017-07-28 07:41:54.012648"], ["layout_id", 43]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "imelda_feil"], ["email", "hilda@mertz.io"], ["password", "BgF12bEm"], ["created_at", "2017-07-28 07:41:54.017469"], ["updated_at", "2017-07-28 07:41:54.017469"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "cum.dolores"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Quo Lux"], ["phone", "(760) 520-9077"], ["address", "29524 Vance Plaza"], ["url", "http://wilderman.biz/ines_fadel"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://fadelkaulke.org/yoshiko"], ["auth_expiration_time", 900], ["slug", "cum.dolores"], ["brand_id", 43], ["user_id", 68], ["created_at", "2017-07-28 07:41:54.023200"], ["updated_at", "2017-07-28 07:41:54.023200"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jakob.ziemann"], ["email", "jasmin@gutmann.org"], ["password", "40IqJeBiI0Z"], ["created_at", "2017-07-28 07:41:54.028519"], ["updated_at", "2017-07-28 07:41:54.028519"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53310"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53310"], ["comment", "comment 110"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "14.199.218.115"], ["router_admin_ip", "178.24.162.83"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "400"], ["status", "t"], ["location_id", 43], ["user_id", 69], ["created_at", "2017-07-28 07:41:54.034059"], ["updated_at", "2017-07-28 07:41:54.034059"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53310"], ["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 10], ["serial", "643705CA5E36/53310"], ["comment", "comment 110"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "14.199.218.115"], ["router_admin_ip", "178.24.162.83"], ["admin_password", "0bac0dc93986d7bd"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "10"], ["status", "t"], ["location_id", 43], ["user_id", 69], ["created_at", "2017-07-28 07:41:54.034059"], ["updated_at", "2017-07-28 07:41:54.034059"], ["id", 10]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: f90a6a0c-4fcc-48ca-ac41-a0a33f5cdb8e) to Async(routers) with arguments: #<GlobalID:0x007fe2e3097360 @uri=#<URI::GID gid://wifi-management/Router/10>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 3b479e36-a1b8-4927-8bb1-087664dfc42f) to Async(routers) with arguments: #<GlobalID:0x007fe2e3097360 @uri=#<URI::GID gid://wifi-management/Router/10>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 10], ["provider", "instagram"], ["location_id", 42], ["router_id", 10], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:54 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"neil", "email"=>"bridie.hills@braunbashirian.info", "password"=>"5mTjZ9RdKlAj876", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"neil", :email=>"bridie.hills@braunbashirian.info", :password=>"5mTjZ9RdKlAj876", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"bridie.hills@braunbashirian.info", "password"=>"5mTjZ9RdKlAj876"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "neil"], ["email", "bridie.hills@braunbashirian.info"], ["password", "5mTjZ9RdKlAj876"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 67, username: "neil", email: "bridie.hills@braunbashirian.info", password: "5mTjZ9RdKlAj876", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:41:53", updated_at: "2017-07-28 07:41:53", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 67[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/new_old_users_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:54 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#new_old_users_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 67[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_67[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 67) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 67]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 67]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 67]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 67]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 67]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 67]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 67]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 67]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>67, "username"=>"neil", "email"=>"bridie.hills@braunbashirian.info", "password"=>"5mTjZ9RdKlAj876", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:53 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"new_old_users_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 67[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_67[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 67[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_67[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>67, :username=>"neil", :email=>"bridie.hills@braunbashirian.info", :password=>"5mTjZ9RdKlAj876", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:41:53.955Z", :updated_at=>"2017-07-28T07:41:53.955Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 67[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" = 42 AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 31ms [30m(Views: 1.2ms | ActiveRecord: 7.3ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "466-372-0201 x4841"], ["created_at", "2017-07-28 07:41:54.251608"], ["updated_at", "2017-07-28 07:41:54.251608"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "nils_romaguera"], ["email", "arthur.cummings@hartmann.co"], ["password", "K7XhTaZx1"], ["created_at", "2017-07-28 07:41:54.256671"], ["updated_at", "2017-07-28 07:41:54.256671"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "547631"], ["username", "liam.mccullough"], ["image", "http://twitter.com/img/liam.mccullough.jpg"], ["profile", "https://twitter.com/liam.mccullough"], ["email", "shanon@von.biz"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 32], ["user_id", 70], ["created_at", "2017-07-28 07:41:54.261013"], ["updated_at", "2017-07-28 07:41:54.261013"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Duobam"], ["created_at", "2017-07-28 07:41:54.268313"], ["updated_at", "2017-07-28 07:41:54.268313"], ["local_path", "http://gislason.net/lou"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Sub-Ex"], ["title_ru", "Название44"], ["created_at", "2017-07-28 07:41:54.271947"], ["updated_at", "2017-07-28 07:41:54.271947"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 44[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_44[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 44) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>44, "title"=>"Duobam", "created_at"=>Fri, 28 Jul 2017 07:41:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:54 UTC +00:00, "local_path"=>"http://gislason.net/lou"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bigtax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bigtax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bigtax"], ["category_id", 44], ["slug", "bigtax"], ["created_at", "2017-07-28 07:41:54.284597"], ["updated_at", "2017-07-28 07:41:54.284597"], ["layout_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quia_quidem"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Alphazap"], ["phone", "889-495-5861"], ["address", "8906 Leuschke Mills"], ["url", "http://bergnaum.biz/jerad_satterfield"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://smithamgrady.name/eriberto"], ["auth_expiration_time", 900], ["slug", "quia_quidem"], ["brand_id", 44], ["user_id", 70], ["created_at", "2017-07-28 07:41:54.291616"], ["updated_at", "2017-07-28 07:41:54.291616"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Konklux"], ["created_at", "2017-07-28 07:41:54.300306"], ["updated_at", "2017-07-28 07:41:54.300306"], ["local_path", "http://mills.org/mariana"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Opela"], ["title_ru", "Название45"], ["created_at", "2017-07-28 07:41:54.304142"], ["updated_at", "2017-07-28 07:41:54.304142"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 45[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_45[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 45) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>45, "title"=>"Konklux", "created_at"=>Fri, 28 Jul 2017 07:41:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:54 UTC +00:00, "local_path"=>"http://mills.org/mariana"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bigtax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bigtax-category0x007fe2e391f460"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bigtax-category0x007fe2e391f460"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bigtax"], ["category_id", 45], ["slug", "bigtax-category0x007fe2e391f460"], ["created_at", "2017-07-28 07:41:54.316648"], ["updated_at", "2017-07-28 07:41:54.316648"], ["layout_id", 45]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "palma_borer"], ["email", "julianne.kemmer@blanda.org"], ["password", "NyMaT1U6M0H7L"], ["created_at", "2017-07-28 07:41:54.321650"], ["updated_at", "2017-07-28 07:41:54.321650"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "saepe_ipsam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Viva"], ["phone", "(372) 354-7541"], ["address", "12941 Juliet Hills"], ["url", "http://toy.biz/newell.jenkins"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://gislasonwilliamson.co/mariam_hirthe"], ["auth_expiration_time", 900], ["slug", "saepe_ipsam"], ["brand_id", 45], ["user_id", 71], ["created_at", "2017-07-28 07:41:54.327573"], ["updated_at", "2017-07-28 07:41:54.327573"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "deron.hintz"], ["email", "mollie_bradtke@terry.io"], ["password", "1r7gGeR9BkOf"], ["created_at", "2017-07-28 07:41:54.332885"], ["updated_at", "2017-07-28 07:41:54.332885"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53311"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53311"], ["comment", "comment 111"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "66.147.167.38"], ["router_admin_ip", "74.11.99.126"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "621"], ["status", "t"], ["location_id", 45], ["user_id", 72], ["created_at", "2017-07-28 07:41:54.338432"], ["updated_at", "2017-07-28 07:41:54.338432"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53311"], ["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 11], ["serial", "643705CA5E36/53311"], ["comment", "comment 111"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "66.147.167.38"], ["router_admin_ip", "74.11.99.126"], ["admin_password", "d4a9e76aa4b42342"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "11"], ["status", "t"], ["location_id", 45], ["user_id", 72], ["created_at", "2017-07-28 07:41:54.338432"], ["updated_at", "2017-07-28 07:41:54.338432"], ["id", 11]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 21c21ebf-8143-4b99-a10d-37d811fdde62) to Async(routers) with arguments: #<GlobalID:0x007fe2e0f2da58 @uri=#<URI::GID gid://wifi-management/Router/11>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 22c5181e-942b-49c4-a084-77a8ae02c826) to Async(routers) with arguments: #<GlobalID:0x007fe2e0f2da58 @uri=#<URI::GID gid://wifi-management/Router/11>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.4ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 11], ["provider", "instagram"], ["location_id", 44], ["router_id", 11], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:54 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"nils_romaguera", "email"=>"arthur.cummings@hartmann.co", "password"=>"K7XhTaZx1", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"nils_romaguera", :email=>"arthur.cummings@hartmann.co", :password=>"K7XhTaZx1", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"arthur.cummings@hartmann.co", "password"=>"K7XhTaZx1"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "nils_romaguera"], ["email", "arthur.cummings@hartmann.co"], ["password", "K7XhTaZx1"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 70, username: "nils_romaguera", email: "arthur.cummings@hartmann.co", password: "K7XhTaZx1", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:41:54", updated_at: "2017-07-28 07:41:54", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 70[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.1ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/visitors_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:54 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#visitors_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 70[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_70[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 70) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 70]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 70]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 70]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 70]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 70]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 70]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 70]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 70]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>70, "username"=>"nils_romaguera", "email"=>"arthur.cummings@hartmann.co", "password"=>"K7XhTaZx1", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:54 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"visitors_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 70[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_70[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 70[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_70[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>70, :username=>"nils_romaguera", :email=>"arthur.cummings@hartmann.co", :password=>"K7XhTaZx1", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:41:54.256Z", :updated_at=>"2017-07-28T07:41:54.256Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 70[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.2ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" = 44 AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 26ms [30m(Views: 1.3ms | ActiveRecord: 7.1ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(634) 236-1293 x89577"], ["created_at", "2017-07-28 07:41:54.496606"], ["updated_at", "2017-07-28 07:41:54.496606"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "hardy.haag"], ["email", "betsy@haag.info"], ["password", "T8OzXs66"], ["created_at", "2017-07-28 07:41:54.502072"], ["updated_at", "2017-07-28 07:41:54.502072"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "580564"], ["username", "gene.klocko"], ["image", "http://instagram.com/img/gene.klocko.jpg"], ["profile", "https://instagram.com/gene.klocko"], ["email", "alfredo_schmitt@senger.biz"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 33], ["user_id", 73], ["created_at", "2017-07-28 07:41:54.506553"], ["updated_at", "2017-07-28 07:41:54.506553"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tempsoft"], ["created_at", "2017-07-28 07:41:54.514045"], ["updated_at", "2017-07-28 07:41:54.514045"], ["local_path", "http://murazik.biz/rudy"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fix San"], ["title_ru", "Название46"], ["created_at", "2017-07-28 07:41:54.517902"], ["updated_at", "2017-07-28 07:41:54.517902"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 46[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_46[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 46) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>46, "title"=>"Tempsoft", "created_at"=>Fri, 28 Jul 2017 07:41:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:54 UTC +00:00, "local_path"=>"http://murazik.biz/rudy"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "pannier"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "pannier"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Pannier"], ["category_id", 46], ["slug", "pannier"], ["created_at", "2017-07-28 07:41:54.529503"], ["updated_at", "2017-07-28 07:41:54.529503"], ["layout_id", 46]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "repellat_nesciunt"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bamity"], ["phone", "(860) 861-2330"], ["address", "8983 Gleichner Common"], ["url", "http://bodehilll.name/jaycee.hagenes"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://schultz.net/jeie_kuphal"], ["auth_expiration_time", 900], ["slug", "repellat_nesciunt"], ["brand_id", 46], ["user_id", 73], ["created_at", "2017-07-28 07:41:54.535487"], ["updated_at", "2017-07-28 07:41:54.535487"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Flexidy"], ["created_at", "2017-07-28 07:41:54.544305"], ["updated_at", "2017-07-28 07:41:54.544305"], ["local_path", "http://zemlak.com/kameron"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Toughjoyfax"], ["title_ru", "Название47"], ["created_at", "2017-07-28 07:41:54.548088"], ["updated_at", "2017-07-28 07:41:54.548088"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 47[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_47[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 47) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>47, "title"=>"Flexidy", "created_at"=>Fri, 28 Jul 2017 07:41:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:54 UTC +00:00, "local_path"=>"http://zemlak.com/kameron"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "it"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "it"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "It"], ["category_id", 47], ["slug", "it"], ["created_at", "2017-07-28 07:41:54.559106"], ["updated_at", "2017-07-28 07:41:54.559106"], ["layout_id", 47]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "mya"], ["email", "rodger_schuppe@friesen.com"], ["password", "8qUbKpWiKkMj5eP"], ["created_at", "2017-07-28 07:41:54.564196"], ["updated_at", "2017-07-28 07:41:54.564196"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "numquam_est"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Latlux"], ["phone", "780-336-1967"], ["address", "3256 Eli Manor"], ["url", "http://okeefedicki.info/adriel"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://jaskolskinader.name/kelton"], ["auth_expiration_time", 900], ["slug", "numquam_est"], ["brand_id", 47], ["user_id", 74], ["created_at", "2017-07-28 07:41:54.570307"], ["updated_at", "2017-07-28 07:41:54.570307"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "brisa.streich"], ["email", "orion@brakusheel.io"], ["password", "8w1bWl01IpLwCgM"], ["created_at", "2017-07-28 07:41:54.575606"], ["updated_at", "2017-07-28 07:41:54.575606"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53312"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53312"], ["comment", "comment 112"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "161.127.189.221"], ["router_admin_ip", "56.149.87.207"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "464"], ["status", "t"], ["location_id", 47], ["user_id", 75], ["created_at", "2017-07-28 07:41:54.581343"], ["updated_at", "2017-07-28 07:41:54.581343"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53312"], ["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 12], ["serial", "643705CA5E36/53312"], ["comment", "comment 112"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "161.127.189.221"], ["router_admin_ip", "56.149.87.207"], ["admin_password", "ecb2f7309295339b"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "12"], ["status", "t"], ["location_id", 47], ["user_id", 75], ["created_at", "2017-07-28 07:41:54.581343"], ["updated_at", "2017-07-28 07:41:54.581343"], ["id", 12]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: b4e33355-76ad-40c0-8329-ba040fd6b666) to Async(routers) with arguments: #<GlobalID:0x007fe2d9798240 @uri=#<URI::GID gid://wifi-management/Router/12>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 675b4886-02c1-4ffc-9973-8cd2ed7f366f) to Async(routers) with arguments: #<GlobalID:0x007fe2d9798240 @uri=#<URI::GID gid://wifi-management/Router/12>>
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 12], ["provider", "instagram"], ["location_id", 46], ["router_id", 12], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "654-691-6552"], ["created_at", "2017-07-28 07:41:54.666246"], ["updated_at", "2017-07-28 07:41:54.666246"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "carey.stokes"], ["email", "edmund.little@kuhlman.name"], ["password", "ZmZ7N6B8Ot"], ["created_at", "2017-07-28 07:41:54.671032"], ["updated_at", "2017-07-28 07:41:54.671032"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "304938"], ["username", "thaddeus_rolfson"], ["image", "http://instagram.com/img/thaddeus_rolfson.jpg"], ["profile", "https://instagram.com/thaddeus_rolfson"], ["email", "stanley@toy.co"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 34], ["user_id", 76], ["created_at", "2017-07-28 07:41:54.674945"], ["updated_at", "2017-07-28 07:41:54.674945"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Cardify"], ["created_at", "2017-07-28 07:41:54.682029"], ["updated_at", "2017-07-28 07:41:54.682029"], ["local_path", "http://lowe.co/theresa"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Konklux"], ["title_ru", "Название48"], ["created_at", "2017-07-28 07:41:54.685467"], ["updated_at", "2017-07-28 07:41:54.685467"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_48[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 48) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>48, "title"=>"Cardify", "created_at"=>Fri, 28 Jul 2017 07:41:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:54 UTC +00:00, "local_path"=>"http://lowe.co/theresa"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "mat-lam-tam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "mat-lam-tam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Mat Lam Tam"], ["category_id", 48], ["slug", "mat-lam-tam"], ["created_at", "2017-07-28 07:41:54.696338"], ["updated_at", "2017-07-28 07:41:54.696338"], ["layout_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "facere_molestiae"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Pannier"], ["phone", "1-726-055-1824"], ["address", "40120 Brittany Circles"], ["url", "http://connkub.name/edythe_pacocha"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://cartwrightconroy.com/susanna"], ["auth_expiration_time", 900], ["slug", "facere_molestiae"], ["brand_id", 48], ["user_id", 76], ["created_at", "2017-07-28 07:41:54.701878"], ["updated_at", "2017-07-28 07:41:54.701878"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Flexidy"], ["created_at", "2017-07-28 07:41:54.710190"], ["updated_at", "2017-07-28 07:41:54.710190"], ["local_path", "http://pollichweber.info/grayson.johnston"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Pannier"], ["title_ru", "Название49"], ["created_at", "2017-07-28 07:41:54.713576"], ["updated_at", "2017-07-28 07:41:54.713576"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 49[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_49[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.5ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 49) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>49, "title"=>"Flexidy", "created_at"=>Fri, 28 Jul 2017 07:41:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:54 UTC +00:00, "local_path"=>"http://pollichweber.info/grayson.johnston"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "domainer"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "domainer"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Domainer"], ["category_id", 49], ["slug", "domainer"], ["created_at", "2017-07-28 07:41:54.724028"], ["updated_at", "2017-07-28 07:41:54.724028"], ["layout_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "trea.roob"], ["email", "ayana@kozey.net"], ["password", "S2QaNf1eJ65p"], ["created_at", "2017-07-28 07:41:54.728742"], ["updated_at", "2017-07-28 07:41:54.728742"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "est.quo"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Domainer"], ["phone", "967-300-6838"], ["address", "159 Deontae Fork"], ["url", "http://lynch.info/zackery"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://grady.name/asha_denesik"], ["auth_expiration_time", 900], ["slug", "est.quo"], ["brand_id", 49], ["user_id", 77], ["created_at", "2017-07-28 07:41:54.734260"], ["updated_at", "2017-07-28 07:41:54.734260"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "annamarie_hudson"], ["email", "raegan@reichert.org"], ["password", "ZzS0H942OpIeBrJd"], ["created_at", "2017-07-28 07:41:54.739375"], ["updated_at", "2017-07-28 07:41:54.739375"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53313"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53313"], ["comment", "comment 113"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "119.122.28.51"], ["router_admin_ip", "194.131.17.112"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "479"], ["status", "t"], ["location_id", 49], ["user_id", 78], ["created_at", "2017-07-28 07:41:54.744617"], ["updated_at", "2017-07-28 07:41:54.744617"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53313"], ["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 13], ["serial", "643705CA5E36/53313"], ["comment", "comment 113"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "119.122.28.51"], ["router_admin_ip", "194.131.17.112"], ["admin_password", "6faea2dc43e3e63b"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "13"], ["status", "t"], ["location_id", 49], ["user_id", 78], ["created_at", "2017-07-28 07:41:54.744617"], ["updated_at", "2017-07-28 07:41:54.744617"], ["id", 13]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 848bf344-1a2d-41e1-afd6-6db23bf4a96b) to Async(routers) with arguments: #<GlobalID:0x007fe2db742258 @uri=#<URI::GID gid://wifi-management/Router/13>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 333ee143-2ab9-46b9-89d0-c27a349b17aa) to Async(routers) with arguments: #<GlobalID:0x007fe2db742258 @uri=#<URI::GID gid://wifi-management/Router/13>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 13], ["provider", "instagram"], ["location_id", 48], ["router_id", 13], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:55 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"carey.stokes", "email"=>"edmund.little@kuhlman.name", "password"=>"ZmZ7N6B8Ot", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"carey.stokes", :email=>"edmund.little@kuhlman.name", :password=>"ZmZ7N6B8Ot", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"edmund.little@kuhlman.name", "password"=>"ZmZ7N6B8Ot"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "carey.stokes"], ["email", "edmund.little@kuhlman.name"], ["password", "ZmZ7N6B8Ot"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 76, username: "carey.stokes", email: "edmund.little@kuhlman.name", password: "ZmZ7N6B8Ot", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:41:54", updated_at: "2017-07-28 07:41:54", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 76[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/age_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:55 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#age_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 76[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_76[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 76) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 76]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 76]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 76]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 76]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 76]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 76]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 76]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 76]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>76, "username"=>"carey.stokes", "email"=>"edmund.little@kuhlman.name", "password"=>"ZmZ7N6B8Ot", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:54 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:54 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"age_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 76[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_76[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 76[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_76[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>76, :username=>"carey.stokes", :email=>"edmund.little@kuhlman.name", :password=>"ZmZ7N6B8Ot", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:41:54.671Z", :updated_at=>"2017-07-28T07:41:54.671Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 76[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.0ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(48) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 26ms [30m(Views: 1.3ms | ActiveRecord: 8.3ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(958) 907-3954"], ["created_at", "2017-07-28 07:41:55.046018"], ["updated_at", "2017-07-28 07:41:55.046018"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "leonora"], ["email", "misael_quitzon@oconner.info"], ["password", "H2GeHhAmRtQcS"], ["created_at", "2017-07-28 07:41:55.051339"], ["updated_at", "2017-07-28 07:41:55.051339"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "248175"], ["username", "akeem"], ["image", "http://instagram.com/img/akeem.jpg"], ["profile", "https://instagram.com/akeem"], ["email", "makenna.leuschke@greenholt.info"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 35], ["user_id", 79], ["created_at", "2017-07-28 07:41:55.056103"], ["updated_at", "2017-07-28 07:41:55.056103"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bamity"], ["created_at", "2017-07-28 07:41:55.063929"], ["updated_at", "2017-07-28 07:41:55.063929"], ["local_path", "http://bergnaum.biz/romaine"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Duobam"], ["title_ru", "Название50"], ["created_at", "2017-07-28 07:41:55.068139"], ["updated_at", "2017-07-28 07:41:55.068139"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 50[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_50[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 50) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>50, "title"=>"Bamity", "created_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "local_path"=>"http://bergnaum.biz/romaine"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tin"], ["category_id", 50], ["slug", "tin"], ["created_at", "2017-07-28 07:41:55.079944"], ["updated_at", "2017-07-28 07:41:55.079944"], ["layout_id", 50]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "eos.dolores"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Andalax"], ["phone", "586.795.0048"], ["address", "3607 Maggio Haven"], ["url", "http://hintzstanton.com/morton"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://rath.com/hayley"], ["auth_expiration_time", 900], ["slug", "eos.dolores"], ["brand_id", 50], ["user_id", 79], ["created_at", "2017-07-28 07:41:55.085906"], ["updated_at", "2017-07-28 07:41:55.085906"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Otcom"], ["created_at", "2017-07-28 07:41:55.094504"], ["updated_at", "2017-07-28 07:41:55.094504"], ["local_path", "http://schmidtcorwin.biz/rico"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bamity"], ["title_ru", "Название51"], ["created_at", "2017-07-28 07:41:55.098121"], ["updated_at", "2017-07-28 07:41:55.098121"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_51[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 51) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>51, "title"=>"Otcom", "created_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "local_path"=>"http://schmidtcorwin.biz/rico"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bamity"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bamity"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bamity"], ["category_id", 51], ["slug", "bamity"], ["created_at", "2017-07-28 07:41:55.109302"], ["updated_at", "2017-07-28 07:41:55.109302"], ["layout_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "reinhold_bogisich"], ["email", "hunter@gottliebtreutel.name"], ["password", "FwH04tXfF6IbO0"], ["created_at", "2017-07-28 07:41:55.114094"], ["updated_at", "2017-07-28 07:41:55.114094"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "dolor.provident"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tin"], ["phone", "501-037-0666"], ["address", "766 Jaylan Walks"], ["url", "http://priceadams.com/jesus"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://roob.org/vita_kub"], ["auth_expiration_time", 900], ["slug", "dolor.provident"], ["brand_id", 51], ["user_id", 80], ["created_at", "2017-07-28 07:41:55.120103"], ["updated_at", "2017-07-28 07:41:55.120103"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "bernadine.tillman"], ["email", "aidan@damore.name"], ["password", "DzAdBwIlS9U4"], ["created_at", "2017-07-28 07:41:55.125159"], ["updated_at", "2017-07-28 07:41:55.125159"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53314"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53314"], ["comment", "comment 114"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "228.84.99.44"], ["router_admin_ip", "86.171.164.45"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "204"], ["status", "t"], ["location_id", 51], ["user_id", 81], ["created_at", "2017-07-28 07:41:55.130500"], ["updated_at", "2017-07-28 07:41:55.130500"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53314"], ["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 14], ["serial", "643705CA5E36/53314"], ["comment", "comment 114"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "228.84.99.44"], ["router_admin_ip", "86.171.164.45"], ["admin_password", "7986355fe96943f2"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "14"], ["status", "t"], ["location_id", 51], ["user_id", 81], ["created_at", "2017-07-28 07:41:55.130500"], ["updated_at", "2017-07-28 07:41:55.130500"], ["id", 14]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: aad1ed59-706a-455d-a78c-30c7bca0a5db) to Async(routers) with arguments: #<GlobalID:0x007fe2e314c0f8 @uri=#<URI::GID gid://wifi-management/Router/14>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 370b82ba-7e75-45d3-9770-41e642667503) to Async(routers) with arguments: #<GlobalID:0x007fe2e314c0f8 @uri=#<URI::GID gid://wifi-management/Router/14>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 14], ["provider", "instagram"], ["location_id", 50], ["router_id", 14], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:55 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"leonora", "email"=>"misael_quitzon@oconner.info", "password"=>"H2GeHhAmRtQcS", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"leonora", :email=>"misael_quitzon@oconner.info", :password=>"H2GeHhAmRtQcS", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"misael_quitzon@oconner.info", "password"=>"H2GeHhAmRtQcS"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "leonora"], ["email", "misael_quitzon@oconner.info"], ["password", "H2GeHhAmRtQcS"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 79, username: "leonora", email: "misael_quitzon@oconner.info", password: "H2GeHhAmRtQcS", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:41:55", updated_at: "2017-07-28 07:41:55", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 79[0m
[INFO ] Completed [32m201 Created[0m in 15ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/gender_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:55 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#gender_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 79[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_79[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 79) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 79]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 79]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 79]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 79]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 79]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 79]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 79]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 79]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>79, "username"=>"leonora", "email"=>"misael_quitzon@oconner.info", "password"=>"H2GeHhAmRtQcS", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"gender_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 79[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_79[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 79[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_79[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>79, :username=>"leonora", :email=>"misael_quitzon@oconner.info", :password=>"H2GeHhAmRtQcS", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:41:55.051Z", :updated_at=>"2017-07-28T07:41:55.051Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 79[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT DISTINCT COUNT(DISTINCT social_accounts.id) AS count_social_accounts_id, "gender" AS gender FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" = 50 AND ("social_logs"."updated_at" BETWEEN $1 AND $2) GROUP BY "gender"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 24ms [30m(Views: 1.1ms | ActiveRecord: 5.6ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-768-820-5508 x9795"], ["created_at", "2017-07-28 07:41:55.265644"], ["updated_at", "2017-07-28 07:41:55.265644"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "arlo_smith"], ["email", "ruby.dubuque@boyle.biz"], ["password", "57HeA3NrAjGzQz"], ["created_at", "2017-07-28 07:41:55.270587"], ["updated_at", "2017-07-28 07:41:55.270587"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "41669"], ["username", "maybell.konopelski"], ["image", "http://facebook.com/img/maybell.konopelski.jpg"], ["profile", "https://facebook.com/maybell.konopelski"], ["email", "lorine_quitzon@koelpin.biz"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 36], ["user_id", 82], ["created_at", "2017-07-28 07:41:55.274891"], ["updated_at", "2017-07-28 07:41:55.274891"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Andalax"], ["created_at", "2017-07-28 07:41:55.282240"], ["updated_at", "2017-07-28 07:41:55.282240"], ["local_path", "http://parisian.name/einar.steuber"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Asoka"], ["title_ru", "Название52"], ["created_at", "2017-07-28 07:41:55.286087"], ["updated_at", "2017-07-28 07:41:55.286087"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 52[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_52[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 52) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>52, "title"=>"Andalax", "created_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "local_path"=>"http://parisian.name/einar.steuber"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "namfix"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "namfix"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Namfix"], ["category_id", 52], ["slug", "namfix"], ["created_at", "2017-07-28 07:41:55.297916"], ["updated_at", "2017-07-28 07:41:55.297916"], ["layout_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "beatae_culpa"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bamity"], ["phone", "(309) 696-2769"], ["address", "421 Cooper Mission"], ["url", "http://macejkoviccarroll.co/riley_schamberger"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://gislasonquitzon.name/efrain_herman"], ["auth_expiration_time", 900], ["slug", "beatae_culpa"], ["brand_id", 52], ["user_id", 82], ["created_at", "2017-07-28 07:41:55.303953"], ["updated_at", "2017-07-28 07:41:55.303953"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tempsoft"], ["created_at", "2017-07-28 07:41:55.312373"], ["updated_at", "2017-07-28 07:41:55.312373"], ["local_path", "http://nikolausheller.name/rahul.hauck"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Rank"], ["title_ru", "Название53"], ["created_at", "2017-07-28 07:41:55.316293"], ["updated_at", "2017-07-28 07:41:55.316293"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 53[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_53[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 53) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>53, "title"=>"Tempsoft", "created_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "local_path"=>"http://nikolausheller.name/rahul.hauck"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "prodder"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "prodder"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Prodder"], ["category_id", 53], ["slug", "prodder"], ["created_at", "2017-07-28 07:41:55.327251"], ["updated_at", "2017-07-28 07:41:55.327251"], ["layout_id", 53]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "dwight_franecki"], ["email", "cordia.conroy@champlin.net"], ["password", "7iGlBdSuM"], ["created_at", "2017-07-28 07:41:55.332041"], ["updated_at", "2017-07-28 07:41:55.332041"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quia-molestias"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Aerified"], ["phone", "447-483-5759"], ["address", "19993 Bernhard Grove"], ["url", "http://rempelferry.net/isobel"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://corwin.io/vicenta_hoeger"], ["auth_expiration_time", 900], ["slug", "quia-molestias"], ["brand_id", 53], ["user_id", 83], ["created_at", "2017-07-28 07:41:55.337909"], ["updated_at", "2017-07-28 07:41:55.337909"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "gwen"], ["email", "adeline_kulas@vandervort.name"], ["password", "DgF28pDrCt"], ["created_at", "2017-07-28 07:41:55.343350"], ["updated_at", "2017-07-28 07:41:55.343350"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53315"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53315"], ["comment", "comment 115"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "216.206.120.142"], ["router_admin_ip", "169.136.184.76"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "820"], ["status", "t"], ["location_id", 53], ["user_id", 84], ["created_at", "2017-07-28 07:41:55.348920"], ["updated_at", "2017-07-28 07:41:55.348920"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53315"], ["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 15], ["serial", "643705CA5E36/53315"], ["comment", "comment 115"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "216.206.120.142"], ["router_admin_ip", "169.136.184.76"], ["admin_password", "c1a7fae57e52a382"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "15"], ["status", "t"], ["location_id", 53], ["user_id", 84], ["created_at", "2017-07-28 07:41:55.348920"], ["updated_at", "2017-07-28 07:41:55.348920"], ["id", 15]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 018a0a68-3dd2-4b0a-be10-8d0ca17f4be9) to Async(routers) with arguments: #<GlobalID:0x007fe2e07792f8 @uri=#<URI::GID gid://wifi-management/Router/15>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 3e48e0fd-e231-4c63-87d0-07942ad31f00) to Async(routers) with arguments: #<GlobalID:0x007fe2e07792f8 @uri=#<URI::GID gid://wifi-management/Router/15>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.4ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 15], ["provider", "instagram"], ["location_id", 52], ["router_id", 15], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:55 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"arlo_smith", "email"=>"ruby.dubuque@boyle.biz", "password"=>"57HeA3NrAjGzQz", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"arlo_smith", :email=>"ruby.dubuque@boyle.biz", :password=>"57HeA3NrAjGzQz", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"ruby.dubuque@boyle.biz", "password"=>"57HeA3NrAjGzQz"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "arlo_smith"], ["email", "ruby.dubuque@boyle.biz"], ["password", "57HeA3NrAjGzQz"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 82, username: "arlo_smith", email: "ruby.dubuque@boyle.biz", password: "57HeA3NrAjGzQz", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:41:55", updated_at: "2017-07-28 07:41:55", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 82[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/new_old_users" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:55 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#new_old_users[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 82[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_82[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 82) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 82]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 82]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 82]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 82]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 82]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 82]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 82]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 82]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>82, "username"=>"arlo_smith", "email"=>"ruby.dubuque@boyle.biz", "password"=>"57HeA3NrAjGzQz", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"new_old_users"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 82[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_82[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 82[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_82[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>82, :username=>"arlo_smith", :email=>"ruby.dubuque@boyle.biz", :password=>"57HeA3NrAjGzQz", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:41:55.270Z", :updated_at=>"2017-07-28T07:41:55.270Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 82[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.0ms)[0m  [1m[34m
      select
        newusrs.chart_interval,
        ttlusrs.returning as returning_users,
        newusrs.new_users,
        ttlusrs.returning + newusrs.new_users as total
      from (select
          chart_interval,
          count (id) as new_users
        from (select
            distinct cl.id,
            date_trunc('day', dd)::date as chart_interval
          FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
          left outer join social_accounts sa on date_trunc('day', sa.created_at) = date_trunc('day', dd)
          left outer join clients cl on sa.client_id = cl.id
          join social_logs sl on sa.id = sl.social_account_id
            and location_id in(52)
      	  order by chart_interval) as chart
        group by chart_interval
        order by chart_interval
      ) as newusrs join (select
          date_trunc('day', dd):: date as chart_interval,
          count (distinct cl.id) as returning
        FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
        left outer join social_logs sl on date_trunc('day', sl.created_at) = date_trunc('day', dd)
          and location_id in(52)
        join social_accounts sa on sa.id = sl.social_account_id
        left outer join clients cl on date_trunc('day', cl.created_at) < date_trunc('day', dd)
          and sa.client_id = cl.id
        group by chart_interval
        order by chart_interval
      ) as ttlusrs on ttlusrs.chart_interval = newusrs.chart_interval[0m
[INFO ] Completed [32m200 OK[0m in 24ms [30m(Views: 0.6ms | ActiveRecord: 7.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(563) 931-2296 x2003"], ["created_at", "2017-07-28 07:41:55.503702"], ["updated_at", "2017-07-28 07:41:55.503702"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "rocky"], ["email", "gwendolyn.hickle@krisleannon.io"], ["password", "TxNrJ24qI"], ["created_at", "2017-07-28 07:41:55.508949"], ["updated_at", "2017-07-28 07:41:55.508949"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "545184"], ["username", "leie"], ["image", "http://instagram.com/img/leie.jpg"], ["profile", "https://instagram.com/leie"], ["email", "dovie_leannon@homenickhoeger.name"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 37], ["user_id", 85], ["created_at", "2017-07-28 07:41:55.513243"], ["updated_at", "2017-07-28 07:41:55.513243"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Lotstring"], ["created_at", "2017-07-28 07:41:55.520530"], ["updated_at", "2017-07-28 07:41:55.520530"], ["local_path", "http://hickle.net/delphia_rowe"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bytecard"], ["title_ru", "Название54"], ["created_at", "2017-07-28 07:41:55.524113"], ["updated_at", "2017-07-28 07:41:55.524113"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_54[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 54) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>54, "title"=>"Lotstring", "created_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "local_path"=>"http://hickle.net/delphia_rowe"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "keylex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "keylex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Keylex"], ["category_id", 54], ["slug", "keylex"], ["created_at", "2017-07-28 07:41:55.535567"], ["updated_at", "2017-07-28 07:41:55.535567"], ["layout_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ipsam_quam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bitchip"], ["phone", "1-916-065-2888"], ["address", "8246 Gibson Center"], ["url", "http://hagenes.com/rae.welch"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://rempelcorkery.info/ania.schoen"], ["auth_expiration_time", 900], ["slug", "ipsam_quam"], ["brand_id", 54], ["user_id", 85], ["created_at", "2017-07-28 07:41:55.541651"], ["updated_at", "2017-07-28 07:41:55.541651"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Vagram"], ["created_at", "2017-07-28 07:41:55.550159"], ["updated_at", "2017-07-28 07:41:55.550159"], ["local_path", "http://muller.name/odea_bailey"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Andalax"], ["title_ru", "Название55"], ["created_at", "2017-07-28 07:41:55.553810"], ["updated_at", "2017-07-28 07:41:55.553810"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 55[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_55[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 55) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>55, "title"=>"Vagram", "created_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "local_path"=>"http://muller.name/odea_bailey"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bamity"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bamity"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bamity"], ["category_id", 55], ["slug", "bamity"], ["created_at", "2017-07-28 07:41:55.564864"], ["updated_at", "2017-07-28 07:41:55.564864"], ["layout_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "samanta"], ["email", "darren@little.com"], ["password", "Dz02WrOzHz"], ["created_at", "2017-07-28 07:41:55.569801"], ["updated_at", "2017-07-28 07:41:55.569801"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "dolorem_voluptate"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Biodex"], ["phone", "1-732-227-5733"], ["address", "554 Dietrich Terrace"], ["url", "http://sporerprosacco.co/eliseo_emmerich"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://renner.name/josh_heller"], ["auth_expiration_time", 900], ["slug", "dolorem_voluptate"], ["brand_id", 55], ["user_id", 86], ["created_at", "2017-07-28 07:41:55.575529"], ["updated_at", "2017-07-28 07:41:55.575529"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "amparo.heathcote"], ["email", "autumn@heidenreich.io"], ["password", "Pw80H52wIaXiOeI4"], ["created_at", "2017-07-28 07:41:55.580930"], ["updated_at", "2017-07-28 07:41:55.580930"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53316"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53316"], ["comment", "comment 116"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "162.106.8.108"], ["router_admin_ip", "12.223.253.235"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "925"], ["status", "t"], ["location_id", 55], ["user_id", 87], ["created_at", "2017-07-28 07:41:55.586846"], ["updated_at", "2017-07-28 07:41:55.586846"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53316"], ["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 16], ["serial", "643705CA5E36/53316"], ["comment", "comment 116"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "162.106.8.108"], ["router_admin_ip", "12.223.253.235"], ["admin_password", "1b622395bbd54eac"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "16"], ["status", "t"], ["location_id", 55], ["user_id", 87], ["created_at", "2017-07-28 07:41:55.586846"], ["updated_at", "2017-07-28 07:41:55.586846"], ["id", 16]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: fbf265bf-f9b6-443b-866a-a7ee3f36b32b) to Async(routers) with arguments: #<GlobalID:0x007fe2e69271f8 @uri=#<URI::GID gid://wifi-management/Router/16>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 1375643d-d3ef-4344-8066-b3c1b4dbac2e) to Async(routers) with arguments: #<GlobalID:0x007fe2e69271f8 @uri=#<URI::GID gid://wifi-management/Router/16>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 16], ["provider", "instagram"], ["location_id", 54], ["router_id", 16], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:55 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"rocky", "email"=>"gwendolyn.hickle@krisleannon.io", "password"=>"TxNrJ24qI", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"rocky", :email=>"gwendolyn.hickle@krisleannon.io", :password=>"TxNrJ24qI", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"gwendolyn.hickle@krisleannon.io", "password"=>"TxNrJ24qI"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "rocky"], ["email", "gwendolyn.hickle@krisleannon.io"], ["password", "TxNrJ24qI"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 85, username: "rocky", email: "gwendolyn.hickle@krisleannon.io", password: "TxNrJ24qI", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:41:55", updated_at: "2017-07-28 07:41:55", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 85[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/clients_count" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:55 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#clients_count[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 85[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_85[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 85) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 85]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 85]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 85]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 85]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 85]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 85]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 85]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 85]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>85, "username"=>"rocky", "email"=>"gwendolyn.hickle@krisleannon.io", "password"=>"TxNrJ24qI", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"clients_count"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 85[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_85[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 85[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_85[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>85, :username=>"rocky", :email=>"gwendolyn.hickle@krisleannon.io", :password=>"TxNrJ24qI", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:41:55.508Z", :updated_at=>"2017-07-28T07:41:55.508Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 85[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.1ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 54[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.5ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 54 AND ("client_visits"."updated_at" BETWEEN $1 AND $2)[0m  [["updated_at", "2017-06-28 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 54 AND ("client_visits"."updated_at" BETWEEN $1 AND $2)[0m  [["updated_at", "2017-07-21 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 28ms [30m(Views: 0.2ms | ActiveRecord: 10.1ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "296-502-6511 x9902"], ["created_at", "2017-07-28 07:41:55.704330"], ["updated_at", "2017-07-28 07:41:55.704330"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "tatum"], ["email", "mercedes@gislason.io"], ["password", "K9Yf8nEnKb"], ["created_at", "2017-07-28 07:41:55.709278"], ["updated_at", "2017-07-28 07:41:55.709278"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "469981"], ["username", "green"], ["image", "http://instagram.com/img/green.jpg"], ["profile", "https://instagram.com/green"], ["email", "jaron_howell@faheyschultz.net"], ["gender", "female"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 38], ["user_id", 88], ["created_at", "2017-07-28 07:41:55.713450"], ["updated_at", "2017-07-28 07:41:55.713450"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Matsoft"], ["created_at", "2017-07-28 07:41:55.720568"], ["updated_at", "2017-07-28 07:41:55.720568"], ["local_path", "http://christiansen.co/dee_sauer"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Flexidy"], ["title_ru", "Название56"], ["created_at", "2017-07-28 07:41:55.724533"], ["updated_at", "2017-07-28 07:41:55.724533"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 56[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_56[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 56) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>56, "title"=>"Matsoft", "created_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "local_path"=>"http://christiansen.co/dee_sauer"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "biodex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "biodex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Biodex"], ["category_id", 56], ["slug", "biodex"], ["created_at", "2017-07-28 07:41:55.735678"], ["updated_at", "2017-07-28 07:41:55.735678"], ["layout_id", 56]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ernesto"], ["email", "peter@considinerosenbaum.io"], ["password", "FcO604WyH8G4"], ["created_at", "2017-07-28 07:41:55.740460"], ["updated_at", "2017-07-28 07:41:55.740460"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "atque.earum"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Home Ing"], ["phone", "750.444.3309"], ["address", "39052 Reta Parkways"], ["url", "http://naderwiza.info/tyson"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://prosaccopfeffer.io/elmira_mcdermott"], ["auth_expiration_time", 900], ["slug", "atque.earum"], ["brand_id", 56], ["user_id", 89], ["created_at", "2017-07-28 07:41:55.746287"], ["updated_at", "2017-07-28 07:41:55.746287"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Duobam"], ["created_at", "2017-07-28 07:41:55.754216"], ["updated_at", "2017-07-28 07:41:55.754216"], ["local_path", "http://haleykertzmann.com/john"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Greenlam"], ["title_ru", "Название57"], ["created_at", "2017-07-28 07:41:55.757886"], ["updated_at", "2017-07-28 07:41:55.757886"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_57[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 57) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>57, "title"=>"Duobam", "created_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:55 UTC +00:00, "local_path"=>"http://haleykertzmann.com/john"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "asoka"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "asoka"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Asoka"], ["category_id", 57], ["slug", "asoka"], ["created_at", "2017-07-28 07:41:55.768944"], ["updated_at", "2017-07-28 07:41:55.768944"], ["layout_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "myrtle_walter"], ["email", "audra@rowe.io"], ["password", "EjYhF63u6x4eH"], ["created_at", "2017-07-28 07:41:55.773661"], ["updated_at", "2017-07-28 07:41:55.773661"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "iure-est"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Cardguard"], ["phone", "(643) 698-4232"], ["address", "284 Abbott Glen"], ["url", "http://ruel.org/adam_hilpert"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://watsica.io/cullen_adams"], ["auth_expiration_time", 900], ["slug", "iure-est"], ["brand_id", 57], ["user_id", 90], ["created_at", "2017-07-28 07:41:55.779605"], ["updated_at", "2017-07-28 07:41:55.779605"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "nikko_terry"], ["email", "emile@ward.name"], ["password", "K05aQm6a36F5"], ["created_at", "2017-07-28 07:41:55.785106"], ["updated_at", "2017-07-28 07:41:55.785106"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53317"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53317"], ["comment", "comment 117"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "86.37.58.38"], ["router_admin_ip", "86.244.226.174"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "284"], ["status", "t"], ["location_id", 57], ["user_id", 91], ["created_at", "2017-07-28 07:41:55.790961"], ["updated_at", "2017-07-28 07:41:55.790961"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53317"], ["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 17], ["serial", "643705CA5E36/53317"], ["comment", "comment 117"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "86.37.58.38"], ["router_admin_ip", "86.244.226.174"], ["admin_password", "28eca47baf16c730"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "17"], ["status", "t"], ["location_id", 57], ["user_id", 91], ["created_at", "2017-07-28 07:41:55.790961"], ["updated_at", "2017-07-28 07:41:55.790961"], ["id", 17]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 3f2957ca-cc47-4481-a765-2e1acf939ae3) to Async(routers) with arguments: #<GlobalID:0x007fe2de7f1e58 @uri=#<URI::GID gid://wifi-management/Router/17>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 295ca03c-c5a5-4d7c-9983-394a5e73afe1) to Async(routers) with arguments: #<GlobalID:0x007fe2de7f1e58 @uri=#<URI::GID gid://wifi-management/Router/17>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.3ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 17], ["provider", "instagram"], ["location_id", 56], ["router_id", 17], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/totals" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:55 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#all_connections[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"all_connections"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-06-28 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.6ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(56, 57)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" IN (56, 57) AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.6ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(56, 57) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.8ms)[0m  [1m[34m
      select
        newusrs.chart_interval,
        ttlusrs.returning as returning_users,
        newusrs.new_users,
        ttlusrs.returning + newusrs.new_users as total
      from (select
          chart_interval,
          count (id) as new_users
        from (select
            distinct cl.id,
            date_trunc('day', dd)::date as chart_interval
          FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
          left outer join social_accounts sa on date_trunc('day', sa.created_at) = date_trunc('day', dd)
          left outer join clients cl on sa.client_id = cl.id
          join social_logs sl on sa.id = sl.social_account_id
            and location_id in(56, 57)
      	  order by chart_interval) as chart
        group by chart_interval
        order by chart_interval
      ) as newusrs join (select
          date_trunc('day', dd):: date as chart_interval,
          count (distinct cl.id) as returning
        FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
        left outer join social_logs sl on date_trunc('day', sl.created_at) = date_trunc('day', dd)
          and location_id in(56, 57)
        join social_accounts sa on sa.id = sl.social_account_id
        left outer join clients cl on date_trunc('day', cl.created_at) < date_trunc('day', dd)
          and sa.client_id = cl.id
        group by chart_interval
        order by chart_interval
      ) as ttlusrs on ttlusrs.chart_interval = newusrs.chart_interval[0m
[INFO ] Completed [32m200 OK[0m in 28ms [30m(Views: 4.0ms | ActiveRecord: 11.3ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-978-345-2573 x63569"], ["created_at", "2017-07-28 07:41:55.982730"], ["updated_at", "2017-07-28 07:41:55.982730"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "gia_botsford"], ["email", "derrick.pagac@larkinklein.info"], ["password", "SlFcCxOr"], ["created_at", "2017-07-28 07:41:55.987892"], ["updated_at", "2017-07-28 07:41:55.987892"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "119061"], ["username", "willis"], ["image", "http://instagram.com/img/willis.jpg"], ["profile", "https://instagram.com/willis"], ["email", "nakia@hauck.org"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 39], ["user_id", 92], ["created_at", "2017-07-28 07:41:55.992294"], ["updated_at", "2017-07-28 07:41:55.992294"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Regrant"], ["created_at", "2017-07-28 07:41:56.000271"], ["updated_at", "2017-07-28 07:41:56.000271"], ["local_path", "http://hagenes.info/kelsi.jenkins"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Domainer"], ["title_ru", "Название58"], ["created_at", "2017-07-28 07:41:56.004286"], ["updated_at", "2017-07-28 07:41:56.004286"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 58[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_58[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 58) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>58, "title"=>"Regrant", "created_at"=>Fri, 28 Jul 2017 07:41:56 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:56 UTC +00:00, "local_path"=>"http://hagenes.info/kelsi.jenkins"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "overhold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "overhold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Overhold"], ["category_id", 58], ["slug", "overhold"], ["created_at", "2017-07-28 07:41:56.016004"], ["updated_at", "2017-07-28 07:41:56.016004"], ["layout_id", 58]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "unique"], ["email", "rachel.schinner@champlin.org"], ["password", "T2X8M9IeA"], ["created_at", "2017-07-28 07:41:56.021098"], ["updated_at", "2017-07-28 07:41:56.021098"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "enim.debitis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stronghold"], ["phone", "(285) 221-7404"], ["address", "470 Steuber Row"], ["url", "http://ullrichyost.com/earline"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://grahamturcotte.net/ashly_brekke"], ["auth_expiration_time", 900], ["slug", "enim.debitis"], ["brand_id", 58], ["user_id", 93], ["created_at", "2017-07-28 07:41:56.027132"], ["updated_at", "2017-07-28 07:41:56.027132"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Cookley"], ["created_at", "2017-07-28 07:41:56.035113"], ["updated_at", "2017-07-28 07:41:56.035113"], ["local_path", "http://koelpin.org/ryleigh"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Stim"], ["title_ru", "Название59"], ["created_at", "2017-07-28 07:41:56.038917"], ["updated_at", "2017-07-28 07:41:56.038917"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 59[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_59[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 59) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>59, "title"=>"Cookley", "created_at"=>Fri, 28 Jul 2017 07:41:56 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:56 UTC +00:00, "local_path"=>"http://koelpin.org/ryleigh"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "fintone"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "fintone"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Fintone"], ["category_id", 59], ["slug", "fintone"], ["created_at", "2017-07-28 07:41:56.050224"], ["updated_at", "2017-07-28 07:41:56.050224"], ["layout_id", 59]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "pink"], ["email", "dale_homenick@denesik.biz"], ["password", "B2C57jHaX"], ["created_at", "2017-07-28 07:41:56.055195"], ["updated_at", "2017-07-28 07:41:56.055195"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "magnam.libero"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Lotlux"], ["phone", "997-686-1996"], ["address", "1203 Kreiger Trail"], ["url", "http://hellergaylord.net/hattie.haag"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://flatleypollich.info/ronaldo_larkin"], ["auth_expiration_time", 900], ["slug", "magnam.libero"], ["brand_id", 59], ["user_id", 94], ["created_at", "2017-07-28 07:41:56.061175"], ["updated_at", "2017-07-28 07:41:56.061175"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "abbigail"], ["email", "haylee@watsica.name"], ["password", "0tS6RpN2IoL4Z"], ["created_at", "2017-07-28 07:41:56.066797"], ["updated_at", "2017-07-28 07:41:56.066797"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53318"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53318"], ["comment", "comment 118"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "79.38.98.170"], ["router_admin_ip", "54.143.239.33"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "188"], ["status", "t"], ["location_id", 59], ["user_id", 95], ["created_at", "2017-07-28 07:41:56.072644"], ["updated_at", "2017-07-28 07:41:56.072644"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53318"], ["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 18], ["serial", "643705CA5E36/53318"], ["comment", "comment 118"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "79.38.98.170"], ["router_admin_ip", "54.143.239.33"], ["admin_password", "ddadde85548c843f"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "18"], ["status", "t"], ["location_id", 59], ["user_id", 95], ["created_at", "2017-07-28 07:41:56.072644"], ["updated_at", "2017-07-28 07:41:56.072644"], ["id", 18]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 2d09a7bb-2b18-4c73-b0aa-ee6d8b0c3bf8) to Async(routers) with arguments: #<GlobalID:0x007fe2e5207c98 @uri=#<URI::GID gid://wifi-management/Router/18>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 055aebc3-0f31-4f9e-a842-fc861750883b) to Async(routers) with arguments: #<GlobalID:0x007fe2e5207c98 @uri=#<URI::GID gid://wifi-management/Router/18>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 18], ["provider", "instagram"], ["location_id", 58], ["router_id", 18], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/time" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:56 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#time_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"time_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(58, 59)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 5ms [30m(Views: 1.2ms | ActiveRecord: 2.4ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-416-750-3147 x830"], ["created_at", "2017-07-28 07:41:56.205534"], ["updated_at", "2017-07-28 07:41:56.205534"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "retta"], ["email", "forrest_padberg@schneider.co"], ["password", "V36kF3Q0H2X1EuWk"], ["created_at", "2017-07-28 07:41:56.210685"], ["updated_at", "2017-07-28 07:41:56.210685"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "278534"], ["username", "stevie.medhurst"], ["image", "http://instagram.com/img/stevie.medhurst.jpg"], ["profile", "https://instagram.com/stevie.medhurst"], ["email", "dagmar@heaney.org"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 40], ["user_id", 96], ["created_at", "2017-07-28 07:41:56.215024"], ["updated_at", "2017-07-28 07:41:56.215024"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Wrapsafe"], ["created_at", "2017-07-28 07:41:56.222558"], ["updated_at", "2017-07-28 07:41:56.222558"], ["local_path", "http://lind.io/barry_zboncak"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Stringtough"], ["title_ru", "Название60"], ["created_at", "2017-07-28 07:41:56.226421"], ["updated_at", "2017-07-28 07:41:56.226421"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 60[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_60[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 60) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>60, "title"=>"Wrapsafe", "created_at"=>Fri, 28 Jul 2017 07:41:56 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:56 UTC +00:00, "local_path"=>"http://lind.io/barry_zboncak"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "temp"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "temp"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Temp"], ["category_id", 60], ["slug", "temp"], ["created_at", "2017-07-28 07:41:56.238082"], ["updated_at", "2017-07-28 07:41:56.238082"], ["layout_id", 60]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "thelma.hartmann"], ["email", "gaston_price@marquardt.org"], ["password", "2pC0GfH74g0sCv"], ["created_at", "2017-07-28 07:41:56.242940"], ["updated_at", "2017-07-28 07:41:56.242940"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "qui.libero"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zathin"], ["phone", "1-971-885-0709"], ["address", "83277 Elinore Gardens"], ["url", "http://brown.biz/kameron_fahey"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kerlukelehner.org/marlen_block"], ["auth_expiration_time", 900], ["slug", "qui.libero"], ["brand_id", 60], ["user_id", 97], ["created_at", "2017-07-28 07:41:56.249247"], ["updated_at", "2017-07-28 07:41:56.249247"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zathin"], ["created_at", "2017-07-28 07:41:56.257187"], ["updated_at", "2017-07-28 07:41:56.257187"], ["local_path", "http://kshlerin.co/maddison"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Y-find"], ["title_ru", "Название61"], ["created_at", "2017-07-28 07:41:56.260784"], ["updated_at", "2017-07-28 07:41:56.260784"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 61[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_61[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 61) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>61, "title"=>"Zathin", "created_at"=>Fri, 28 Jul 2017 07:41:56 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:56 UTC +00:00, "local_path"=>"http://kshlerin.co/maddison"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-find"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-find"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Y-find"], ["category_id", 61], ["slug", "y-find"], ["created_at", "2017-07-28 07:41:56.271704"], ["updated_at", "2017-07-28 07:41:56.271704"], ["layout_id", 61]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "florencio_bayer"], ["email", "nedra_streich@weimann.biz"], ["password", "E835SbBgKnXoXa8f"], ["created_at", "2017-07-28 07:41:56.276456"], ["updated_at", "2017-07-28 07:41:56.276456"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "qui_voluptatem"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Opela"], ["phone", "1-197-369-9883"], ["address", "5421 Ernesto Ports"], ["url", "http://reichertstroman.biz/eino_waters"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kiehn.net/kenyatta_gleason"], ["auth_expiration_time", 900], ["slug", "qui_voluptatem"], ["brand_id", 61], ["user_id", 98], ["created_at", "2017-07-28 07:41:56.282601"], ["updated_at", "2017-07-28 07:41:56.282601"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "frida_kuphal"], ["email", "lexi.bernier@powlowski.com"], ["password", "KeRtGmWq4"], ["created_at", "2017-07-28 07:41:56.288069"], ["updated_at", "2017-07-28 07:41:56.288069"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53319"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53319"], ["comment", "comment 119"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "23.254.181.146"], ["router_admin_ip", "189.130.131.144"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "438"], ["status", "t"], ["location_id", 61], ["user_id", 99], ["created_at", "2017-07-28 07:41:56.293621"], ["updated_at", "2017-07-28 07:41:56.293621"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53319"], ["id", 19], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 19], ["serial", "643705CA5E36/53319"], ["comment", "comment 119"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "23.254.181.146"], ["router_admin_ip", "189.130.131.144"], ["admin_password", "63c21465849141d9"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "19"], ["status", "t"], ["location_id", 61], ["user_id", 99], ["created_at", "2017-07-28 07:41:56.293621"], ["updated_at", "2017-07-28 07:41:56.293621"], ["id", 19]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: b1edcc58-71a3-4e0d-8f31-394073fa89a1) to Async(routers) with arguments: #<GlobalID:0x007fe2e366da00 @uri=#<URI::GID gid://wifi-management/Router/19>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 5d822546-b190-4270-9ada-3523d9fccff7) to Async(routers) with arguments: #<GlobalID:0x007fe2e366da00 @uri=#<URI::GID gid://wifi-management/Router/19>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 19], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 19], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 19], ["provider", "instagram"], ["location_id", 60], ["router_id", 19], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/social" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:56 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#social_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"social_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" IN (60, 61) AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 6ms [30m(Views: 1.3ms | ActiveRecord: 2.1ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "467-392-9659 x71918"], ["created_at", "2017-07-28 07:41:56.526420"], ["updated_at", "2017-07-28 07:41:56.526420"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jonas"], ["email", "breana_dibbert@trantow.com"], ["password", "IyFs69Iv3008J"], ["created_at", "2017-07-28 07:41:56.531443"], ["updated_at", "2017-07-28 07:41:56.531443"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "530429"], ["username", "giovanny_tremblay"], ["image", "http://instagram.com/img/giovanny_tremblay.jpg"], ["profile", "https://instagram.com/giovanny_tremblay"], ["email", "evert_carter@huelsleuschke.io"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 41], ["user_id", 100], ["created_at", "2017-07-28 07:41:56.536239"], ["updated_at", "2017-07-28 07:41:56.536239"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Holdlamis"], ["created_at", "2017-07-28 07:41:56.543950"], ["updated_at", "2017-07-28 07:41:56.543950"], ["local_path", "http://altenwerth.info/alf.funk"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fix San"], ["title_ru", "Название62"], ["created_at", "2017-07-28 07:41:56.547932"], ["updated_at", "2017-07-28 07:41:56.547932"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 62[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_62[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 62) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>62, "title"=>"Holdlamis", "created_at"=>Fri, 28 Jul 2017 07:41:56 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:56 UTC +00:00, "local_path"=>"http://altenwerth.info/alf.funk"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "prodder"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "prodder"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Prodder"], ["category_id", 62], ["slug", "prodder"], ["created_at", "2017-07-28 07:41:56.559521"], ["updated_at", "2017-07-28 07:41:56.559521"], ["layout_id", 62]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "deborah"], ["email", "jo.bruen@tillmansporer.io"], ["password", "RwI4VvEeO0"], ["created_at", "2017-07-28 07:41:56.564361"], ["updated_at", "2017-07-28 07:41:56.564361"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "maiores_blanditiis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zoolab"], ["phone", "108-854-4019"], ["address", "793 Rogahn Flat"], ["url", "http://nikolaus.name/dolores"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://mclaughlin.io/lauryn"], ["auth_expiration_time", 900], ["slug", "maiores_blanditiis"], ["brand_id", 62], ["user_id", 101], ["created_at", "2017-07-28 07:41:56.570453"], ["updated_at", "2017-07-28 07:41:56.570453"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tres-Zap"], ["created_at", "2017-07-28 07:41:56.578416"], ["updated_at", "2017-07-28 07:41:56.578416"], ["local_path", "http://dickihayes.net/roman_beer"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Matsoft"], ["title_ru", "Название63"], ["created_at", "2017-07-28 07:41:56.582158"], ["updated_at", "2017-07-28 07:41:56.582158"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 63[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_63[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 63) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>63, "title"=>"Tres-Zap", "created_at"=>Fri, 28 Jul 2017 07:41:56 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:56 UTC +00:00, "local_path"=>"http://dickihayes.net/roman_beer"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-find"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-find"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Y-find"], ["category_id", 63], ["slug", "y-find"], ["created_at", "2017-07-28 07:41:56.593226"], ["updated_at", "2017-07-28 07:41:56.593226"], ["layout_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "nola_stroman"], ["email", "efren_stroman@parkerschoen.info"], ["password", "OvHeF1SyC3Y4"], ["created_at", "2017-07-28 07:41:56.598307"], ["updated_at", "2017-07-28 07:41:56.598307"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "nisi-reprehenderit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Voyatouch"], ["phone", "1-993-024-8738"], ["address", "156 O'Conner Plains"], ["url", "http://runolfsdottir.biz/leopold.schroeder"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://roobstiedemann.info/kathryne.ko"], ["auth_expiration_time", 900], ["slug", "nisi-reprehenderit"], ["brand_id", 63], ["user_id", 102], ["created_at", "2017-07-28 07:41:56.604582"], ["updated_at", "2017-07-28 07:41:56.604582"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "brock.mayer"], ["email", "elna@larson.name"], ["password", "NaVhYyYfQ6TtA"], ["created_at", "2017-07-28 07:41:56.610104"], ["updated_at", "2017-07-28 07:41:56.610104"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53320"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53320"], ["comment", "comment 120"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "215.248.147.173"], ["router_admin_ip", "18.107.103.2"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "114"], ["status", "t"], ["location_id", 63], ["user_id", 103], ["created_at", "2017-07-28 07:41:56.615733"], ["updated_at", "2017-07-28 07:41:56.615733"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53320"], ["id", 20], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 20], ["serial", "643705CA5E36/53320"], ["comment", "comment 120"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "215.248.147.173"], ["router_admin_ip", "18.107.103.2"], ["admin_password", "b42aa7c52c5fb215"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "20"], ["status", "t"], ["location_id", 63], ["user_id", 103], ["created_at", "2017-07-28 07:41:56.615733"], ["updated_at", "2017-07-28 07:41:56.615733"], ["id", 20]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: a0eb1518-ad32-42e3-b143-e8ecc56b4f60) to Async(routers) with arguments: #<GlobalID:0x007fe2e07a0588 @uri=#<URI::GID gid://wifi-management/Router/20>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 299e9c0f-84e9-4a0d-b374-69b23c389c6c) to Async(routers) with arguments: #<GlobalID:0x007fe2e07a0588 @uri=#<URI::GID gid://wifi-management/Router/20>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.3ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 20], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 20], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 20], ["provider", "instagram"], ["location_id", 62], ["router_id", 20], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/age" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:56 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#age_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"age_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.9ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(62, 63) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 6ms [30m(Views: 1.2ms | ActiveRecord: 2.7ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-426-863-4227 x3538"], ["created_at", "2017-07-28 07:41:56.822420"], ["updated_at", "2017-07-28 07:41:56.822420"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lesly.kuhn"], ["email", "baron_bradtke@stiedemann.name"], ["password", "EdFjRtFiY"], ["created_at", "2017-07-28 07:41:56.827615"], ["updated_at", "2017-07-28 07:41:56.827615"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "386007"], ["username", "hershel.schaden"], ["image", "http://facebook.com/img/hershel.schaden.jpg"], ["profile", "https://facebook.com/hershel.schaden"], ["email", "lou@osinski.biz"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 42], ["user_id", 104], ["created_at", "2017-07-28 07:41:56.832456"], ["updated_at", "2017-07-28 07:41:56.832456"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Andalax"], ["created_at", "2017-07-28 07:41:56.840137"], ["updated_at", "2017-07-28 07:41:56.840137"], ["local_path", "http://crist.com/jodie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Holdlamis"], ["title_ru", "Название64"], ["created_at", "2017-07-28 07:41:56.844277"], ["updated_at", "2017-07-28 07:41:56.844277"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 64[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_64[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 64) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>64, "title"=>"Andalax", "created_at"=>Fri, 28 Jul 2017 07:41:56 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:56 UTC +00:00, "local_path"=>"http://crist.com/jodie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "holdlamis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "holdlamis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Holdlamis"], ["category_id", 64], ["slug", "holdlamis"], ["created_at", "2017-07-28 07:41:56.856084"], ["updated_at", "2017-07-28 07:41:56.856084"], ["layout_id", 64]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "alisha"], ["email", "amalia@roobgraham.name"], ["password", "3iVpR447Yz7pI9Zv"], ["created_at", "2017-07-28 07:41:56.861020"], ["updated_at", "2017-07-28 07:41:56.861020"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "qui.magni"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Treeflex"], ["phone", "(142) 969-5339"], ["address", "943 Price Landing"], ["url", "http://roberts.com/deangelo"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://bosco.net/milton"], ["auth_expiration_time", 900], ["slug", "qui.magni"], ["brand_id", 64], ["user_id", 105], ["created_at", "2017-07-28 07:41:56.867201"], ["updated_at", "2017-07-28 07:41:56.867201"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Stringtough"], ["created_at", "2017-07-28 07:41:56.875215"], ["updated_at", "2017-07-28 07:41:56.875215"], ["local_path", "http://braunoconner.biz/ocie.hermiston"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bitchip"], ["title_ru", "Название65"], ["created_at", "2017-07-28 07:41:56.879117"], ["updated_at", "2017-07-28 07:41:56.879117"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 65[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_65[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 65) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>65, "title"=>"Stringtough", "created_at"=>Fri, 28 Jul 2017 07:41:56 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:41:56 UTC +00:00, "local_path"=>"http://braunoconner.biz/ocie.hermiston"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "vagram"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "vagram"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Vagram"], ["category_id", 65], ["slug", "vagram"], ["created_at", "2017-07-28 07:41:56.890519"], ["updated_at", "2017-07-28 07:41:56.890519"], ["layout_id", 65]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "milton"], ["email", "lloyd@krajcikbahringer.io"], ["password", "Rq6f6lRfS6Gz4n1u"], ["created_at", "2017-07-28 07:41:56.895505"], ["updated_at", "2017-07-28 07:41:56.895505"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ea-veniam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Overhold"], ["phone", "(271) 306-7288"], ["address", "59681 McDermott Terrace"], ["url", "http://konopelski.io/wanda.kertzmann"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://bogan.org/asa"], ["auth_expiration_time", 900], ["slug", "ea-veniam"], ["brand_id", 65], ["user_id", 106], ["created_at", "2017-07-28 07:41:56.901799"], ["updated_at", "2017-07-28 07:41:56.901799"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "rickey"], ["email", "elinor@kiehn.biz"], ["password", "By6b1bCb7nTu29T6"], ["created_at", "2017-07-28 07:41:56.907322"], ["updated_at", "2017-07-28 07:41:56.907322"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53321"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53321"], ["comment", "comment 121"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "216.137.192.116"], ["router_admin_ip", "103.236.143.252"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "62"], ["status", "t"], ["location_id", 65], ["user_id", 107], ["created_at", "2017-07-28 07:41:56.913281"], ["updated_at", "2017-07-28 07:41:56.913281"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53321"], ["id", 21], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 21], ["serial", "643705CA5E36/53321"], ["comment", "comment 121"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "216.137.192.116"], ["router_admin_ip", "103.236.143.252"], ["admin_password", "199e98532896009b"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "21"], ["status", "t"], ["location_id", 65], ["user_id", 107], ["created_at", "2017-07-28 07:41:56.913281"], ["updated_at", "2017-07-28 07:41:56.913281"], ["id", 21]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 31d45664-746f-4f8c-aa30-9712dd68459d) to Async(routers) with arguments: #<GlobalID:0x007fe2da74a918 @uri=#<URI::GID gid://wifi-management/Router/21>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 16ecdea6-7f21-49a0-85e3-d72fe1864b48) to Async(routers) with arguments: #<GlobalID:0x007fe2da74a918 @uri=#<URI::GID gid://wifi-management/Router/21>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 21], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 21], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 21], ["provider", "instagram"], ["location_id", 64], ["router_id", 21], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/visitors" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:41:57 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#visitors_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"visitors_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.6ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" IN (64, 65) AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 7ms [30m(Views: 1.2ms | ActiveRecord: 2.4ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (4.0ms)[0m  [1m[35mALTER TABLE "answers" DISABLE TRIGGER ALL;ALTER TABLE "auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "bans" DISABLE TRIGGER ALL;ALTER TABLE "brands" DISABLE TRIGGER ALL;ALTER TABLE "categories" DISABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" DISABLE TRIGGER ALL;ALTER TABLE "social_logs" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "client_counters" DISABLE TRIGGER ALL;ALTER TABLE "client_devices" DISABLE TRIGGER ALL;ALTER TABLE "layouts" DISABLE TRIGGER ALL;ALTER TABLE "clients" DISABLE TRIGGER ALL;ALTER TABLE "social_accounts" DISABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" DISABLE TRIGGER ALL;ALTER TABLE "polls" DISABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" DISABLE TRIGGER ALL;ALTER TABLE "questions" DISABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" DISABLE TRIGGER ALL;ALTER TABLE "locations" DISABLE TRIGGER ALL;ALTER TABLE "notifications" DISABLE TRIGGER ALL;ALTER TABLE "opinions" DISABLE TRIGGER ALL;ALTER TABLE "pages" DISABLE TRIGGER ALL;ALTER TABLE "payments" DISABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "products" DISABLE TRIGGER ALL;ALTER TABLE "routers" DISABLE TRIGGER ALL;ALTER TABLE "sessions" DISABLE TRIGGER ALL;ALTER TABLE "sms_logs" DISABLE TRIGGER ALL;ALTER TABLE "vips" DISABLE TRIGGER ALL;ALTER TABLE "vouchers" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL;ALTER TABLE "attempts" DISABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.0ms)[0m  [1m[34m          SELECT schemaname || '.' || tablename
          FROM pg_tables
          WHERE
            tablename !~ '_prt_' AND
            tablename <> 'schema_migrations' AND
            schemaname = ANY (current_schemas(false))
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.3ms)[0m  [1m[34mselect table_name from information_schema.views where table_schema = 'gycwifi_api_test'[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (144.1ms)[0m  [1m[35mTRUNCATE TABLE "public"."answers", "public"."auth_logs", "public"."bans", "public"."brands", "public"."categories", "public"."client_accounting_logs", "public"."social_logs", "public"."users", "public"."client_counters", "public"."client_devices", "public"."layouts", "public"."clients", "public"."social_accounts", "public"."delayed_jobs", "public"."polls", "public"."device_auth_pendings", "public"."questions", "public"."friendly_id_slugs", "public"."locations", "public"."notifications", "public"."opinions", "public"."pages", "public"."payments", "public"."post_auth_logs", "public"."products", "public"."routers", "public"."sessions", "public"."sms_logs", "public"."vips", "public"."vouchers", "public"."ar_internal_metadata", "public"."attempts" RESTART IDENTITY CASCADE;[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.0ms)[0m  [1m[35mALTER TABLE "answers" ENABLE TRIGGER ALL;ALTER TABLE "brands" ENABLE TRIGGER ALL;ALTER TABLE "categories" ENABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" ENABLE TRIGGER ALL;ALTER TABLE "social_logs" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "client_counters" ENABLE TRIGGER ALL;ALTER TABLE "client_devices" ENABLE TRIGGER ALL;ALTER TABLE "clients" ENABLE TRIGGER ALL;ALTER TABLE "auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "social_accounts" ENABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" ENABLE TRIGGER ALL;ALTER TABLE "polls" ENABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" ENABLE TRIGGER ALL;ALTER TABLE "questions" ENABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" ENABLE TRIGGER ALL;ALTER TABLE "locations" ENABLE TRIGGER ALL;ALTER TABLE "notifications" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "opinions" ENABLE TRIGGER ALL;ALTER TABLE "pages" ENABLE TRIGGER ALL;ALTER TABLE "payments" ENABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "products" ENABLE TRIGGER ALL;ALTER TABLE "routers" ENABLE TRIGGER ALL;ALTER TABLE "sessions" ENABLE TRIGGER ALL;ALTER TABLE "sms_logs" ENABLE TRIGGER ALL;ALTER TABLE "attempts" ENABLE TRIGGER ALL;ALTER TABLE "bans" ENABLE TRIGGER ALL;ALTER TABLE "layouts" ENABLE TRIGGER ALL;ALTER TABLE "vips" ENABLE TRIGGER ALL;ALTER TABLE "vouchers" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.6ms)[0m  [1m[35mALTER TABLE "answers" DISABLE TRIGGER ALL;ALTER TABLE "brands" DISABLE TRIGGER ALL;ALTER TABLE "categories" DISABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" DISABLE TRIGGER ALL;ALTER TABLE "social_logs" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "client_counters" DISABLE TRIGGER ALL;ALTER TABLE "client_devices" DISABLE TRIGGER ALL;ALTER TABLE "clients" DISABLE TRIGGER ALL;ALTER TABLE "auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "social_accounts" DISABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" DISABLE TRIGGER ALL;ALTER TABLE "polls" DISABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" DISABLE TRIGGER ALL;ALTER TABLE "questions" DISABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" DISABLE TRIGGER ALL;ALTER TABLE "locations" DISABLE TRIGGER ALL;ALTER TABLE "notifications" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "opinions" DISABLE TRIGGER ALL;ALTER TABLE "pages" DISABLE TRIGGER ALL;ALTER TABLE "payments" DISABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "products" DISABLE TRIGGER ALL;ALTER TABLE "routers" DISABLE TRIGGER ALL;ALTER TABLE "sessions" DISABLE TRIGGER ALL;ALTER TABLE "sms_logs" DISABLE TRIGGER ALL;ALTER TABLE "attempts" DISABLE TRIGGER ALL;ALTER TABLE "bans" DISABLE TRIGGER ALL;ALTER TABLE "layouts" DISABLE TRIGGER ALL;ALTER TABLE "vips" DISABLE TRIGGER ALL;ALTER TABLE "vouchers" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.9ms)[0m  [1m[34m          SELECT schemaname || '.' || tablename
          FROM pg_tables
          WHERE
            tablename !~ '_prt_' AND
            tablename <> 'schema_migrations' AND
            schemaname = ANY (current_schemas(false))
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.1ms)[0m  [1m[34mselect table_name from information_schema.views where table_schema = 'gycwifi_api_test'[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (131.1ms)[0m  [1m[35mTRUNCATE TABLE "public"."answers", "public"."brands", "public"."categories", "public"."client_accounting_logs", "public"."social_logs", "public"."users", "public"."client_counters", "public"."client_devices", "public"."clients", "public"."auth_logs", "public"."social_accounts", "public"."delayed_jobs", "public"."polls", "public"."device_auth_pendings", "public"."questions", "public"."friendly_id_slugs", "public"."locations", "public"."notifications", "public"."opinions", "public"."pages", "public"."payments", "public"."post_auth_logs", "public"."products", "public"."routers", "public"."sessions", "public"."sms_logs", "public"."attempts", "public"."bans", "public"."layouts", "public"."vips", "public"."vouchers", "public"."ar_internal_metadata" RESTART IDENTITY CASCADE;[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.0ms)[0m  [1m[35mALTER TABLE "answers" ENABLE TRIGGER ALL;ALTER TABLE "brands" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "categories" ENABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" ENABLE TRIGGER ALL;ALTER TABLE "social_logs" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "client_counters" ENABLE TRIGGER ALL;ALTER TABLE "client_devices" ENABLE TRIGGER ALL;ALTER TABLE "clients" ENABLE TRIGGER ALL;ALTER TABLE "auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "social_accounts" ENABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" ENABLE TRIGGER ALL;ALTER TABLE "polls" ENABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" ENABLE TRIGGER ALL;ALTER TABLE "questions" ENABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" ENABLE TRIGGER ALL;ALTER TABLE "locations" ENABLE TRIGGER ALL;ALTER TABLE "notifications" ENABLE TRIGGER ALL;ALTER TABLE "opinions" ENABLE TRIGGER ALL;ALTER TABLE "pages" ENABLE TRIGGER ALL;ALTER TABLE "payments" ENABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "products" ENABLE TRIGGER ALL;ALTER TABLE "routers" ENABLE TRIGGER ALL;ALTER TABLE "sessions" ENABLE TRIGGER ALL;ALTER TABLE "sms_logs" ENABLE TRIGGER ALL;ALTER TABLE "attempts" ENABLE TRIGGER ALL;ALTER TABLE "bans" ENABLE TRIGGER ALL;ALTER TABLE "layouts" ENABLE TRIGGER ALL;ALTER TABLE "vips" ENABLE TRIGGER ALL;ALTER TABLE "vouchers" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.2ms)[0m  [1m[35mALTER TABLE "answers" DISABLE TRIGGER ALL;ALTER TABLE "brands" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "categories" DISABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" DISABLE TRIGGER ALL;ALTER TABLE "social_logs" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "client_counters" DISABLE TRIGGER ALL;ALTER TABLE "client_devices" DISABLE TRIGGER ALL;ALTER TABLE "clients" DISABLE TRIGGER ALL;ALTER TABLE "auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "social_accounts" DISABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" DISABLE TRIGGER ALL;ALTER TABLE "polls" DISABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" DISABLE TRIGGER ALL;ALTER TABLE "questions" DISABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" DISABLE TRIGGER ALL;ALTER TABLE "locations" DISABLE TRIGGER ALL;ALTER TABLE "notifications" DISABLE TRIGGER ALL;ALTER TABLE "opinions" DISABLE TRIGGER ALL;ALTER TABLE "pages" DISABLE TRIGGER ALL;ALTER TABLE "payments" DISABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "products" DISABLE TRIGGER ALL;ALTER TABLE "routers" DISABLE TRIGGER ALL;ALTER TABLE "sessions" DISABLE TRIGGER ALL;ALTER TABLE "sms_logs" DISABLE TRIGGER ALL;ALTER TABLE "attempts" DISABLE TRIGGER ALL;ALTER TABLE "bans" DISABLE TRIGGER ALL;ALTER TABLE "layouts" DISABLE TRIGGER ALL;ALTER TABLE "vips" DISABLE TRIGGER ALL;ALTER TABLE "vouchers" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.1ms)[0m  [1m[34m          SELECT schemaname || '.' || tablename
          FROM pg_tables
          WHERE
            tablename !~ '_prt_' AND
            tablename <> 'schema_migrations' AND
            schemaname = ANY (current_schemas(false))
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.1ms)[0m  [1m[34mselect table_name from information_schema.views where table_schema = 'gycwifi_api_test'[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (133.2ms)[0m  [1m[35mTRUNCATE TABLE "public"."answers", "public"."brands", "public"."categories", "public"."client_accounting_logs", "public"."social_logs", "public"."users", "public"."client_counters", "public"."client_devices", "public"."clients", "public"."auth_logs", "public"."social_accounts", "public"."delayed_jobs", "public"."polls", "public"."device_auth_pendings", "public"."questions", "public"."friendly_id_slugs", "public"."locations", "public"."notifications", "public"."opinions", "public"."pages", "public"."payments", "public"."post_auth_logs", "public"."products", "public"."routers", "public"."sessions", "public"."sms_logs", "public"."attempts", "public"."bans", "public"."layouts", "public"."vips", "public"."vouchers", "public"."ar_internal_metadata" RESTART IDENTITY CASCADE;[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.9ms)[0m  [1m[35mALTER TABLE "answers" ENABLE TRIGGER ALL;ALTER TABLE "brands" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "categories" ENABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" ENABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" ENABLE TRIGGER ALL;ALTER TABLE "vips" ENABLE TRIGGER ALL;ALTER TABLE "vouchers" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL;ALTER TABLE "social_logs" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "client_counters" ENABLE TRIGGER ALL;ALTER TABLE "client_devices" ENABLE TRIGGER ALL;ALTER TABLE "clients" ENABLE TRIGGER ALL;ALTER TABLE "auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "social_accounts" ENABLE TRIGGER ALL;ALTER TABLE "polls" ENABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" ENABLE TRIGGER ALL;ALTER TABLE "questions" ENABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" ENABLE TRIGGER ALL;ALTER TABLE "locations" ENABLE TRIGGER ALL;ALTER TABLE "notifications" ENABLE TRIGGER ALL;ALTER TABLE "opinions" ENABLE TRIGGER ALL;ALTER TABLE "pages" ENABLE TRIGGER ALL;ALTER TABLE "payments" ENABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "products" ENABLE TRIGGER ALL;ALTER TABLE "routers" ENABLE TRIGGER ALL;ALTER TABLE "sessions" ENABLE TRIGGER ALL;ALTER TABLE "sms_logs" ENABLE TRIGGER ALL;ALTER TABLE "attempts" ENABLE TRIGGER ALL;ALTER TABLE "bans" ENABLE TRIGGER ALL;ALTER TABLE "layouts" ENABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.8ms)[0m  [1m[35mALTER TABLE "answers" DISABLE TRIGGER ALL;ALTER TABLE "brands" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "categories" DISABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" DISABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" DISABLE TRIGGER ALL;ALTER TABLE "vips" DISABLE TRIGGER ALL;ALTER TABLE "vouchers" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL;ALTER TABLE "social_logs" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "client_counters" DISABLE TRIGGER ALL;ALTER TABLE "client_devices" DISABLE TRIGGER ALL;ALTER TABLE "clients" DISABLE TRIGGER ALL;ALTER TABLE "auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "social_accounts" DISABLE TRIGGER ALL;ALTER TABLE "polls" DISABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" DISABLE TRIGGER ALL;ALTER TABLE "questions" DISABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" DISABLE TRIGGER ALL;ALTER TABLE "locations" DISABLE TRIGGER ALL;ALTER TABLE "notifications" DISABLE TRIGGER ALL;ALTER TABLE "opinions" DISABLE TRIGGER ALL;ALTER TABLE "pages" DISABLE TRIGGER ALL;ALTER TABLE "payments" DISABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "products" DISABLE TRIGGER ALL;ALTER TABLE "routers" DISABLE TRIGGER ALL;ALTER TABLE "sessions" DISABLE TRIGGER ALL;ALTER TABLE "sms_logs" DISABLE TRIGGER ALL;ALTER TABLE "attempts" DISABLE TRIGGER ALL;ALTER TABLE "bans" DISABLE TRIGGER ALL;ALTER TABLE "layouts" DISABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.9ms)[0m  [1m[34m          SELECT schemaname || '.' || tablename
          FROM pg_tables
          WHERE
            tablename !~ '_prt_' AND
            tablename <> 'schema_migrations' AND
            schemaname = ANY (current_schemas(false))
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.2ms)[0m  [1m[34mselect table_name from information_schema.views where table_schema = 'gycwifi_api_test'[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (148.9ms)[0m  [1m[35mTRUNCATE TABLE "public"."answers", "public"."brands", "public"."categories", "public"."client_accounting_logs", "public"."delayed_jobs", "public"."vips", "public"."vouchers", "public"."ar_internal_metadata", "public"."social_logs", "public"."users", "public"."client_counters", "public"."client_devices", "public"."clients", "public"."auth_logs", "public"."social_accounts", "public"."polls", "public"."device_auth_pendings", "public"."questions", "public"."friendly_id_slugs", "public"."locations", "public"."notifications", "public"."opinions", "public"."pages", "public"."payments", "public"."post_auth_logs", "public"."products", "public"."routers", "public"."sessions", "public"."sms_logs", "public"."attempts", "public"."bans", "public"."layouts" RESTART IDENTITY CASCADE;[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.1ms)[0m  [1m[35mALTER TABLE "answers" ENABLE TRIGGER ALL;ALTER TABLE "social_logs" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "client_counters" ENABLE TRIGGER ALL;ALTER TABLE "client_devices" ENABLE TRIGGER ALL;ALTER TABLE "clients" ENABLE TRIGGER ALL;ALTER TABLE "auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "social_accounts" ENABLE TRIGGER ALL;ALTER TABLE "brands" ENABLE TRIGGER ALL;ALTER TABLE "polls" ENABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" ENABLE TRIGGER ALL;ALTER TABLE "questions" ENABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" ENABLE TRIGGER ALL;ALTER TABLE "locations" ENABLE TRIGGER ALL;ALTER TABLE "notifications" ENABLE TRIGGER ALL;ALTER TABLE "opinions" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "pages" ENABLE TRIGGER ALL;ALTER TABLE "payments" ENABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "products" ENABLE TRIGGER ALL;ALTER TABLE "routers" ENABLE TRIGGER ALL;ALTER TABLE "sessions" ENABLE TRIGGER ALL;ALTER TABLE "sms_logs" ENABLE TRIGGER ALL;ALTER TABLE "attempts" ENABLE TRIGGER ALL;ALTER TABLE "bans" ENABLE TRIGGER ALL;ALTER TABLE "layouts" ENABLE TRIGGER ALL;ALTER TABLE "categories" ENABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" ENABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" ENABLE TRIGGER ALL;ALTER TABLE "vips" ENABLE TRIGGER ALL;ALTER TABLE "vouchers" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mActiveRecord::SchemaMigration Load (1.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (4.5ms)[0m  [1m[35mALTER TABLE "answers" DISABLE TRIGGER ALL;ALTER TABLE "social_logs" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "client_counters" DISABLE TRIGGER ALL;ALTER TABLE "client_devices" DISABLE TRIGGER ALL;ALTER TABLE "clients" DISABLE TRIGGER ALL;ALTER TABLE "auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "social_accounts" DISABLE TRIGGER ALL;ALTER TABLE "brands" DISABLE TRIGGER ALL;ALTER TABLE "polls" DISABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" DISABLE TRIGGER ALL;ALTER TABLE "questions" DISABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" DISABLE TRIGGER ALL;ALTER TABLE "locations" DISABLE TRIGGER ALL;ALTER TABLE "notifications" DISABLE TRIGGER ALL;ALTER TABLE "opinions" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "pages" DISABLE TRIGGER ALL;ALTER TABLE "payments" DISABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "products" DISABLE TRIGGER ALL;ALTER TABLE "routers" DISABLE TRIGGER ALL;ALTER TABLE "sessions" DISABLE TRIGGER ALL;ALTER TABLE "sms_logs" DISABLE TRIGGER ALL;ALTER TABLE "attempts" DISABLE TRIGGER ALL;ALTER TABLE "bans" DISABLE TRIGGER ALL;ALTER TABLE "layouts" DISABLE TRIGGER ALL;ALTER TABLE "categories" DISABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" DISABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" DISABLE TRIGGER ALL;ALTER TABLE "vips" DISABLE TRIGGER ALL;ALTER TABLE "vouchers" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.4ms)[0m  [1m[34m          SELECT schemaname || '.' || tablename
          FROM pg_tables
          WHERE
            tablename !~ '_prt_' AND
            tablename <> 'schema_migrations' AND
            schemaname = ANY (current_schemas(false))
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.3ms)[0m  [1m[34mselect table_name from information_schema.views where table_schema = 'gycwifi_api_test'[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (150.7ms)[0m  [1m[35mTRUNCATE TABLE "public"."answers", "public"."social_logs", "public"."users", "public"."client_counters", "public"."client_devices", "public"."clients", "public"."auth_logs", "public"."social_accounts", "public"."brands", "public"."polls", "public"."device_auth_pendings", "public"."questions", "public"."friendly_id_slugs", "public"."locations", "public"."notifications", "public"."opinions", "public"."pages", "public"."payments", "public"."post_auth_logs", "public"."products", "public"."routers", "public"."sessions", "public"."sms_logs", "public"."attempts", "public"."bans", "public"."layouts", "public"."categories", "public"."client_accounting_logs", "public"."delayed_jobs", "public"."vips", "public"."vouchers", "public"."ar_internal_metadata" RESTART IDENTITY CASCADE;[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.9ms)[0m  [1m[35mALTER TABLE "answers" ENABLE TRIGGER ALL;ALTER TABLE "social_logs" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "client_counters" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "client_devices" ENABLE TRIGGER ALL;ALTER TABLE "clients" ENABLE TRIGGER ALL;ALTER TABLE "auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "social_accounts" ENABLE TRIGGER ALL;ALTER TABLE "brands" ENABLE TRIGGER ALL;ALTER TABLE "polls" ENABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" ENABLE TRIGGER ALL;ALTER TABLE "questions" ENABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" ENABLE TRIGGER ALL;ALTER TABLE "locations" ENABLE TRIGGER ALL;ALTER TABLE "notifications" ENABLE TRIGGER ALL;ALTER TABLE "opinions" ENABLE TRIGGER ALL;ALTER TABLE "pages" ENABLE TRIGGER ALL;ALTER TABLE "payments" ENABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "products" ENABLE TRIGGER ALL;ALTER TABLE "routers" ENABLE TRIGGER ALL;ALTER TABLE "sessions" ENABLE TRIGGER ALL;ALTER TABLE "sms_logs" ENABLE TRIGGER ALL;ALTER TABLE "attempts" ENABLE TRIGGER ALL;ALTER TABLE "bans" ENABLE TRIGGER ALL;ALTER TABLE "layouts" ENABLE TRIGGER ALL;ALTER TABLE "categories" ENABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" ENABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" ENABLE TRIGGER ALL;ALTER TABLE "vips" ENABLE TRIGGER ALL;ALTER TABLE "vouchers" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (2.2ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "684.612.9232 x9158"], ["created_at", "2017-07-28 07:55:11.525749"], ["updated_at", "2017-07-28 07:55:11.525749"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Lotlux"], ["created_at", "2017-07-28 07:55:11.665200"], ["updated_at", "2017-07-28 07:55:11.665200"], ["local_path", "http://carter.co/talon"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bamity"], ["title_ru", "Название1"], ["created_at", "2017-07-28 07:55:11.681469"], ["updated_at", "2017-07-28 07:55:11.681469"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 1[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (1.1ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 1) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>1, "title"=>"Lotlux", "created_at"=>Fri, 28 Jul 2017 07:55:11 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:11 UTC +00:00, "local_path"=>"http://carter.co/talon"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tres-zap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tres-zap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Tres-Zap"], ["category_id", 1], ["slug", "tres-zap"], ["created_at", "2017-07-28 07:55:11.818674"], ["updated_at", "2017-07-28 07:55:11.818674"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "anna"], ["email", "fabiola@tremblayheel.com"], ["password", "Ur4iE24cYc5"], ["created_at", "2017-07-28 07:55:11.863370"], ["updated_at", "2017-07-28 07:55:11.863370"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "vel_occaecati"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.4ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Subin"], ["phone", "1-256-078-8293"], ["address", "59267 Legros Mountains"], ["url", "http://wisozk.info/kenyatta"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://buckridgegoodwin.biz/bert"], ["auth_expiration_time", 900], ["slug", "vel_occaecati"], ["brand_id", 1], ["user_id", 1], ["created_at", "2017-07-28 07:55:11.873913"], ["updated_at", "2017-07-28 07:55:11.873913"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 1], ["location_id", 1], ["counter", 8], ["created_at", "2017-07-28 07:55:11.879845"], ["updated_at", "2017-07-28 07:55:11.879845"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(605) 863-0276 x12090"], ["created_at", "2017-07-28 07:55:11.884965"], ["updated_at", "2017-07-28 07:55:11.884965"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Daltfresh"], ["created_at", "2017-07-28 07:55:11.891563"], ["updated_at", "2017-07-28 07:55:11.891563"], ["local_path", "http://wintheiser.io/damon_jones"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Latlux"], ["title_ru", "Название2"], ["created_at", "2017-07-28 07:55:11.895430"], ["updated_at", "2017-07-28 07:55:11.895430"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 2[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_2[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 2) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>2, "title"=>"Daltfresh", "created_at"=>Fri, 28 Jul 2017 07:55:11 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:11 UTC +00:00, "local_path"=>"http://wintheiser.io/damon_jones"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "overhold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "overhold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Overhold"], ["category_id", 2], ["slug", "overhold"], ["created_at", "2017-07-28 07:55:11.906363"], ["updated_at", "2017-07-28 07:55:11.906363"], ["layout_id", 2]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "javier"], ["email", "rafaela.runolfsdottir@schinner.biz"], ["password", "TsWyHbWn4iK5J5G"], ["created_at", "2017-07-28 07:55:11.911044"], ["updated_at", "2017-07-28 07:55:11.911044"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "temporibus_voluptatem"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Otcom"], ["phone", "868-134-4463"], ["address", "638 Faustino Villages"], ["url", "http://schultzchristiansen.org/nya_simonis"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://wizalind.biz/deangelo.dooley"], ["auth_expiration_time", 900], ["slug", "temporibus_voluptatem"], ["brand_id", 2], ["user_id", 2], ["created_at", "2017-07-28 07:55:11.916498"], ["updated_at", "2017-07-28 07:55:11.916498"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 2], ["location_id", 2], ["counter", 1], ["created_at", "2017-07-28 07:55:11.920719"], ["updated_at", "2017-07-28 07:55:11.920719"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Alpha"], ["created_at", "2017-07-28 07:55:11.927130"], ["updated_at", "2017-07-28 07:55:11.927130"], ["local_path", "http://osinski.net/orrin_tromp"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Regrant"], ["title_ru", "Название3"], ["created_at", "2017-07-28 07:55:11.930653"], ["updated_at", "2017-07-28 07:55:11.930653"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 3[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_3[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 3) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>3, "title"=>"Alpha", "created_at"=>Fri, 28 Jul 2017 07:55:11 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:11 UTC +00:00, "local_path"=>"http://osinski.net/orrin_tromp"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "lotlux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "lotlux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Lotlux"], ["category_id", 3], ["slug", "lotlux"], ["created_at", "2017-07-28 07:55:11.942192"], ["updated_at", "2017-07-28 07:55:11.942192"], ["layout_id", 3]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "chelsie.bosco"], ["email", "marta@ryan.net"], ["password", "NyJ8HaK9CcX4Qv"], ["created_at", "2017-07-28 07:55:11.947321"], ["updated_at", "2017-07-28 07:55:11.947321"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "sit.rerum"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "It"], ["phone", "(935) 162-9686"], ["address", "6774 Prudence Port"], ["url", "http://borer.co/lavonne_schroeder"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://corwin.io/joey.hammes"], ["auth_expiration_time", 900], ["slug", "sit.rerum"], ["brand_id", 3], ["user_id", 3], ["created_at", "2017-07-28 07:55:11.953329"], ["updated_at", "2017-07-28 07:55:11.953329"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 1], ["location_id", 3], ["counter", 4], ["created_at", "2017-07-28 07:55:11.958975"], ["updated_at", "2017-07-28 07:55:11.958975"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "estelle.schoen"], ["email", "cynthia@robel.co"], ["password", "BzIeP5Rl9"], ["role_cd", 3], ["created_at", "2017-07-28 07:55:11.964460"], ["updated_at", "2017-07-28 07:55:11.964460"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:11 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"estelle.schoen", "email"=>"cynthia@robel.co", "password"=>"BzIeP5Rl9", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"estelle.schoen", :email=>"cynthia@robel.co", :password=>"BzIeP5Rl9", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"cynthia@robel.co", "password"=>"BzIeP5Rl9"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "estelle.schoen"], ["email", "cynthia@robel.co"], ["password", "BzIeP5Rl9"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 4, username: "estelle.schoen", email: "cynthia@robel.co", password: "BzIeP5Rl9", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:55:11", updated_at: "2017-07-28 07:55:11", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 4[0m
[INFO ] Completed [32m201 Created[0m in 7ms [30m(Views: 0.3ms | ActiveRecord: 1.3ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=updated_at&updated_at=asc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:12 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"updated_at", "updated_at"=>"asc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 4) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.5ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>4, "username"=>"estelle.schoen", "email"=>"cynthia@robel.co", "password"=>"BzIeP5Rl9", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:11 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:11 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"updated_at", :updated_at=>"asc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (1.1ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>4, :username=>"estelle.schoen", :email=>"cynthia@robel.co", :password=>"BzIeP5Rl9", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:55:11.964Z", :updated_at=>"2017-07-28T07:55:11.964Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:55:11.879845') AND "client_counters"."location_id" IN (1, 2, 3) GROUP BY client_id, phone_number ORDER BY updated_at asc, visits desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (2, 1)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (1.2ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (1, 2)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:55:11.879845') AND "client_counters"."location_id" IN (1, 2, 3) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 99ms [30m(Views: 0.6ms | ActiveRecord: 16.9ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "285.711.2825 x5565"], ["created_at", "2017-07-28 07:55:12.161730"], ["updated_at", "2017-07-28 07:55:12.161730"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Konklab"], ["created_at", "2017-07-28 07:55:12.168455"], ["updated_at", "2017-07-28 07:55:12.168455"], ["local_path", "http://langworthconn.com/ryleigh.sipes"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Viva"], ["title_ru", "Название4"], ["created_at", "2017-07-28 07:55:12.172030"], ["updated_at", "2017-07-28 07:55:12.172030"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_4[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 4) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>4, "title"=>"Konklab", "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "local_path"=>"http://langworthconn.com/ryleigh.sipes"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alpha"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alpha"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Alpha"], ["category_id", 4], ["slug", "alpha"], ["created_at", "2017-07-28 07:55:12.183008"], ["updated_at", "2017-07-28 07:55:12.183008"], ["layout_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "raleigh_erdman"], ["email", "olin_kub@gutkowski.name"], ["password", "BeY3Et4mEeT"], ["created_at", "2017-07-28 07:55:12.188000"], ["updated_at", "2017-07-28 07:55:12.188000"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "alias-error"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Matsoft"], ["phone", "(266) 234-2480"], ["address", "4321 Abshire Vista"], ["url", "http://anderson.io/letitia"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://schowalter.biz/luisa_reinger"], ["auth_expiration_time", 900], ["slug", "alias-error"], ["brand_id", 4], ["user_id", 5], ["created_at", "2017-07-28 07:55:12.193686"], ["updated_at", "2017-07-28 07:55:12.193686"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 3], ["location_id", 4], ["counter", 8], ["created_at", "2017-07-28 07:55:12.198004"], ["updated_at", "2017-07-28 07:55:12.198004"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(471) 745-1805 x356"], ["created_at", "2017-07-28 07:55:12.201571"], ["updated_at", "2017-07-28 07:55:12.201571"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bytecard"], ["created_at", "2017-07-28 07:55:12.207845"], ["updated_at", "2017-07-28 07:55:12.207845"], ["local_path", "http://heller.org/tracey.koch"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Kanlam"], ["title_ru", "Название5"], ["created_at", "2017-07-28 07:55:12.211509"], ["updated_at", "2017-07-28 07:55:12.211509"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 5[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_5[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 5) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>5, "title"=>"Bytecard", "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "local_path"=>"http://heller.org/tracey.koch"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "duobam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "duobam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Duobam"], ["category_id", 5], ["slug", "duobam"], ["created_at", "2017-07-28 07:55:12.222022"], ["updated_at", "2017-07-28 07:55:12.222022"], ["layout_id", 5]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "yesenia_konopelski"], ["email", "dawn@mertzbeatty.org"], ["password", "7wSaS2XqIb8dY6"], ["created_at", "2017-07-28 07:55:12.226608"], ["updated_at", "2017-07-28 07:55:12.226608"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "omnis.nihil"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Namfix"], ["phone", "1-486-588-6087"], ["address", "547 Aidan Cove"], ["url", "http://thiel.org/te"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://gleichner.biz/marion.pacocha"], ["auth_expiration_time", 900], ["slug", "omnis.nihil"], ["brand_id", 5], ["user_id", 6], ["created_at", "2017-07-28 07:55:12.232135"], ["updated_at", "2017-07-28 07:55:12.232135"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 4], ["location_id", 5], ["counter", 3], ["created_at", "2017-07-28 07:55:12.236505"], ["updated_at", "2017-07-28 07:55:12.236505"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Treeflex"], ["created_at", "2017-07-28 07:55:12.242813"], ["updated_at", "2017-07-28 07:55:12.242813"], ["local_path", "http://gerholdrath.info/noemi"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Hatity"], ["title_ru", "Название6"], ["created_at", "2017-07-28 07:55:12.246424"], ["updated_at", "2017-07-28 07:55:12.246424"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 6[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_6[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 6) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>6, "title"=>"Treeflex", "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "local_path"=>"http://gerholdrath.info/noemi"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "rank"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "rank"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Rank"], ["category_id", 6], ["slug", "rank"], ["created_at", "2017-07-28 07:55:12.256901"], ["updated_at", "2017-07-28 07:55:12.256901"], ["layout_id", 6]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "caandre_homenick"], ["email", "teresa_kub@heller.com"], ["password", "Bn86HiDb9q2bLuGb"], ["created_at", "2017-07-28 07:55:12.261519"], ["updated_at", "2017-07-28 07:55:12.261519"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "culpa_magni"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Span"], ["phone", "826-669-7718"], ["address", "2447 Bert Isle"], ["url", "http://schneider.co/guiseppe_tromp"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://rempel.info/dominic.legros"], ["auth_expiration_time", 900], ["slug", "culpa_magni"], ["brand_id", 6], ["user_id", 7], ["created_at", "2017-07-28 07:55:12.266998"], ["updated_at", "2017-07-28 07:55:12.266998"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 3], ["location_id", 6], ["counter", 5], ["created_at", "2017-07-28 07:55:12.271076"], ["updated_at", "2017-07-28 07:55:12.271076"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "scarlett"], ["email", "jerrold.bernhard@gibson.org"], ["password", "L2X0Z6Ur18T8"], ["role_cd", 3], ["created_at", "2017-07-28 07:55:12.275612"], ["updated_at", "2017-07-28 07:55:12.275612"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:12 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"scarlett", "email"=>"jerrold.bernhard@gibson.org", "password"=>"L2X0Z6Ur18T8", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"scarlett", :email=>"jerrold.bernhard@gibson.org", :password=>"L2X0Z6Ur18T8", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"jerrold.bernhard@gibson.org", "password"=>"L2X0Z6Ur18T8"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "scarlett"], ["email", "jerrold.bernhard@gibson.org"], ["password", "L2X0Z6Ur18T8"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 8, username: "scarlett", email: "jerrold.bernhard@gibson.org", password: "L2X0Z6Ur18T8", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:55:12", updated_at: "2017-07-28 07:55:12", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 8[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=regular&loyalty_days=7&page=1&sort_field=visits30&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:12 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"regular", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits30", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 8) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>8, "username"=>"scarlett", "email"=>"jerrold.bernhard@gibson.org", "password"=>"L2X0Z6Ur18T8", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"regular", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits30", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.8ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>8, :username=>"scarlett", :email=>"jerrold.bernhard@gibson.org", :password=>"L2X0Z6Ur18T8", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:55:12.275Z", :updated_at=>"2017-07-28T07:55:12.275Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:55:12.198004') AND "client_counters"."location_id" IN (4, 5, 6) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) > 1) ORDER BY visits30 asc, updated_at desc, visits desc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 3[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.7ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 3[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:55:12.198004') AND "client_counters"."location_id" IN (4, 5, 6) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) > 1)[0m
[INFO ] Completed [32m200 OK[0m in 30ms [30m(Views: 0.3ms | ActiveRecord: 8.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-190-393-9589 x0000"], ["created_at", "2017-07-28 07:55:12.325167"], ["updated_at", "2017-07-28 07:55:12.325167"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Alphazap"], ["created_at", "2017-07-28 07:55:12.331810"], ["updated_at", "2017-07-28 07:55:12.331810"], ["local_path", "http://feil.info/zella_emard"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Voltsillam"], ["title_ru", "Название7"], ["created_at", "2017-07-28 07:55:12.335502"], ["updated_at", "2017-07-28 07:55:12.335502"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 7[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_7[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 7) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>7, "title"=>"Alphazap", "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "local_path"=>"http://feil.info/zella_emard"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "flexidy"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "flexidy"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Flexidy"], ["category_id", 7], ["slug", "flexidy"], ["created_at", "2017-07-28 07:55:12.346320"], ["updated_at", "2017-07-28 07:55:12.346320"], ["layout_id", 7]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "susana_grant"], ["email", "eldridge@kreigerlabadie.io"], ["password", "CaXc4eU7FfBi"], ["created_at", "2017-07-28 07:55:12.351084"], ["updated_at", "2017-07-28 07:55:12.351084"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et.fugiat"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tres-Zap"], ["phone", "1-344-761-9649"], ["address", "43808 Watsica Cape"], ["url", "http://roobgaylord.org/lupe_pfeffer"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ratke.name/fernando"], ["auth_expiration_time", 900], ["slug", "et.fugiat"], ["brand_id", 7], ["user_id", 9], ["created_at", "2017-07-28 07:55:12.356562"], ["updated_at", "2017-07-28 07:55:12.356562"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 5], ["location_id", 7], ["counter", 1], ["created_at", "2017-07-28 07:55:12.360953"], ["updated_at", "2017-07-28 07:55:12.360953"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-412-848-2747"], ["created_at", "2017-07-28 07:55:12.364614"], ["updated_at", "2017-07-28 07:55:12.364614"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Daltfresh"], ["created_at", "2017-07-28 07:55:12.371052"], ["updated_at", "2017-07-28 07:55:12.371052"], ["local_path", "http://haley.org/jameson"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Namfix"], ["title_ru", "Название8"], ["created_at", "2017-07-28 07:55:12.374836"], ["updated_at", "2017-07-28 07:55:12.374836"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 8) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>8, "title"=>"Daltfresh", "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "local_path"=>"http://haley.org/jameson"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "andalax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "andalax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Andalax"], ["category_id", 8], ["slug", "andalax"], ["created_at", "2017-07-28 07:55:12.385360"], ["updated_at", "2017-07-28 07:55:12.385360"], ["layout_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "aliza_pagac"], ["email", "giuseppe@streichkautzer.com"], ["password", "Cr10WjCd"], ["created_at", "2017-07-28 07:55:12.390085"], ["updated_at", "2017-07-28 07:55:12.390085"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "dolor.quia"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Quo Lux"], ["phone", "552.022.9771"], ["address", "68038 Judy Bridge"], ["url", "http://hanewolf.org/dario_haag"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://toykuvalis.co/stanton"], ["auth_expiration_time", 900], ["slug", "dolor.quia"], ["brand_id", 8], ["user_id", 10], ["created_at", "2017-07-28 07:55:12.395652"], ["updated_at", "2017-07-28 07:55:12.395652"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 6], ["location_id", 8], ["counter", 5], ["created_at", "2017-07-28 07:55:12.399837"], ["updated_at", "2017-07-28 07:55:12.399837"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Mat Lam Tam"], ["created_at", "2017-07-28 07:55:12.406273"], ["updated_at", "2017-07-28 07:55:12.406273"], ["local_path", "http://powlowskihermiston.info/uriel_grady"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Voltsillam"], ["title_ru", "Название9"], ["created_at", "2017-07-28 07:55:12.409937"], ["updated_at", "2017-07-28 07:55:12.409937"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 9[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_9[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 9) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>9, "title"=>"Mat Lam Tam", "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "local_path"=>"http://powlowskihermiston.info/uriel_grady"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bamity"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bamity"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bamity"], ["category_id", 9], ["slug", "bamity"], ["created_at", "2017-07-28 07:55:12.420350"], ["updated_at", "2017-07-28 07:55:12.420350"], ["layout_id", 9]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "juston"], ["email", "chance.reinger@stamm.io"], ["password", "2k3b4g91"], ["created_at", "2017-07-28 07:55:12.424985"], ["updated_at", "2017-07-28 07:55:12.424985"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "animi.nulla"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bamity"], ["phone", "575.799.2199"], ["address", "32525 Cummerata Radial"], ["url", "http://moore.org/kathryn"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://terry.co/katelyn.runolfsdottir"], ["auth_expiration_time", 900], ["slug", "animi.nulla"], ["brand_id", 9], ["user_id", 11], ["created_at", "2017-07-28 07:55:12.430292"], ["updated_at", "2017-07-28 07:55:12.430292"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 5], ["location_id", 9], ["counter", 7], ["created_at", "2017-07-28 07:55:12.434517"], ["updated_at", "2017-07-28 07:55:12.434517"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "lue"], ["email", "isaiah@damore.name"], ["password", "AfYeXyKr2mV1XrNr"], ["role_cd", 3], ["created_at", "2017-07-28 07:55:12.439138"], ["updated_at", "2017-07-28 07:55:12.439138"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:12 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"lue", "email"=>"isaiah@damore.name", "password"=>"AfYeXyKr2mV1XrNr", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"lue", :email=>"isaiah@damore.name", :password=>"AfYeXyKr2mV1XrNr", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"isaiah@damore.name", "password"=>"AfYeXyKr2mV1XrNr"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "lue"], ["email", "isaiah@damore.name"], ["password", "AfYeXyKr2mV1XrNr"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 12, username: "lue", email: "isaiah@damore.name", password: "AfYeXyKr2mV1XrNr", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:55:12", updated_at: "2017-07-28 07:55:12", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 12[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=passed&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:12 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"passed", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 12) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>12, "username"=>"lue", "email"=>"isaiah@damore.name", "password"=>"AfYeXyKr2mV1XrNr", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"passed", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>12, :username=>"lue", :email=>"isaiah@damore.name", :password=>"AfYeXyKr2mV1XrNr", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:55:12.439Z", :updated_at=>"2017-07-28T07:55:12.439Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:55:12.467138') AND "client_counters"."location_id" IN (7, 8, 9) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1) ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 6[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 6[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:55:12.467138') AND "client_counters"."location_id" IN (7, 8, 9) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1)[0m
[INFO ] Completed [32m200 OK[0m in 28ms [30m(Views: 0.4ms | ActiveRecord: 7.8ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-796-510-4562 x6367"], ["created_at", "2017-07-28 07:55:12.487177"], ["updated_at", "2017-07-28 07:55:12.487177"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Fix San"], ["created_at", "2017-07-28 07:55:12.494017"], ["updated_at", "2017-07-28 07:55:12.494017"], ["local_path", "http://rueldonnelly.name/buddy_spinka"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Job"], ["title_ru", "Название10"], ["created_at", "2017-07-28 07:55:12.497777"], ["updated_at", "2017-07-28 07:55:12.497777"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 10[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_10[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 10) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>10, "title"=>"Fix San", "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "local_path"=>"http://rueldonnelly.name/buddy_spinka"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "subin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "subin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Subin"], ["category_id", 10], ["slug", "subin"], ["created_at", "2017-07-28 07:55:12.508869"], ["updated_at", "2017-07-28 07:55:12.508869"], ["layout_id", 10]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "teie"], ["email", "julien.harber@davisabernathy.io"], ["password", "U9D3TdL6MzNtUk"], ["created_at", "2017-07-28 07:55:12.513780"], ["updated_at", "2017-07-28 07:55:12.513780"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "perferendis_accusantium"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zamit"], ["phone", "478-149-3499"], ["address", "814 Alexys Rest"], ["url", "http://lang.info/nedra.schmidt"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hudson.com/darron"], ["auth_expiration_time", 900], ["slug", "perferendis_accusantium"], ["brand_id", 10], ["user_id", 13], ["created_at", "2017-07-28 07:55:12.519444"], ["updated_at", "2017-07-28 07:55:12.519444"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 7], ["location_id", 10], ["counter", 6], ["created_at", "2017-07-28 07:55:12.523727"], ["updated_at", "2017-07-28 07:55:12.523727"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(831) 219-7109"], ["created_at", "2017-07-28 07:55:12.527662"], ["updated_at", "2017-07-28 07:55:12.527662"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tempsoft"], ["created_at", "2017-07-28 07:55:12.534051"], ["updated_at", "2017-07-28 07:55:12.534051"], ["local_path", "http://gerlachnolan.biz/ansley.herzog"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "It"], ["title_ru", "Название11"], ["created_at", "2017-07-28 07:55:12.537564"], ["updated_at", "2017-07-28 07:55:12.537564"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 11[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_11[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 11) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>11, "title"=>"Tempsoft", "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "local_path"=>"http://gerlachnolan.biz/ansley.herzog"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "redhold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "redhold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Redhold"], ["category_id", 11], ["slug", "redhold"], ["created_at", "2017-07-28 07:55:12.548613"], ["updated_at", "2017-07-28 07:55:12.548613"], ["layout_id", 11]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "darian.rowe"], ["email", "keegan_eichmann@koelpin.net"], ["password", "18FbCp5h"], ["created_at", "2017-07-28 07:55:12.553267"], ["updated_at", "2017-07-28 07:55:12.553267"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "labore_reprehenderit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Lotstring"], ["phone", "304-261-5534"], ["address", "25976 Reid Manors"], ["url", "http://jacobson.name/kristina"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kihnwilliamson.biz/reva"], ["auth_expiration_time", 900], ["slug", "labore_reprehenderit"], ["brand_id", 11], ["user_id", 14], ["created_at", "2017-07-28 07:55:12.558894"], ["updated_at", "2017-07-28 07:55:12.558894"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 8], ["location_id", 11], ["counter", 6], ["created_at", "2017-07-28 07:55:12.563211"], ["updated_at", "2017-07-28 07:55:12.563211"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "It"], ["created_at", "2017-07-28 07:55:12.569696"], ["updated_at", "2017-07-28 07:55:12.569696"], ["local_path", "http://stantonheel.io/armani"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Overhold"], ["title_ru", "Название12"], ["created_at", "2017-07-28 07:55:12.573479"], ["updated_at", "2017-07-28 07:55:12.573479"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_12[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 12) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>12, "title"=>"It", "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "local_path"=>"http://stantonheel.io/armani"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "duobam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "duobam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Duobam"], ["category_id", 12], ["slug", "duobam"], ["created_at", "2017-07-28 07:55:12.584533"], ["updated_at", "2017-07-28 07:55:12.584533"], ["layout_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lisandro"], ["email", "juliana@walsh.com"], ["password", "5yQ56j0rOrW"], ["created_at", "2017-07-28 07:55:12.589317"], ["updated_at", "2017-07-28 07:55:12.589317"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "enim.aliquam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tempsoft"], ["phone", "(381) 254-0465"], ["address", "63406 Omer Meadow"], ["url", "http://will.io/cynthia"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://rosenbaum.co/celine"], ["auth_expiration_time", 900], ["slug", "enim.aliquam"], ["brand_id", 12], ["user_id", 15], ["created_at", "2017-07-28 07:55:12.594870"], ["updated_at", "2017-07-28 07:55:12.594870"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 7], ["location_id", 12], ["counter", 6], ["created_at", "2017-07-28 07:55:12.599290"], ["updated_at", "2017-07-28 07:55:12.599290"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Cardguard"], ["created_at", "2017-07-28 07:55:12.606437"], ["updated_at", "2017-07-28 07:55:12.606437"], ["local_path", "http://huels.info/magnolia_christiansen"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Span"], ["title_ru", "Название13"], ["created_at", "2017-07-28 07:55:12.610135"], ["updated_at", "2017-07-28 07:55:12.610135"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 13[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_13[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 13) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>13, "title"=>"Cardguard", "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "local_path"=>"http://huels.info/magnolia_christiansen"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "temp"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "temp"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Temp"], ["category_id", 13], ["slug", "temp"], ["created_at", "2017-07-28 07:55:12.620706"], ["updated_at", "2017-07-28 07:55:12.620706"], ["layout_id", 13]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "cathryn_rogahn"], ["email", "keven@kuphal.io"], ["password", "Tc89JeSgT"], ["created_at", "2017-07-28 07:55:12.625675"], ["updated_at", "2017-07-28 07:55:12.625675"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "aut-tenetur"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Matsoft"], ["phone", "730.307.5169"], ["address", "9597 Gulgowski Crossroad"], ["url", "http://cremin.info/porter"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://lind.com/lindsey.morar"], ["auth_expiration_time", 900], ["slug", "aut-tenetur"], ["brand_id", 13], ["user_id", 16], ["created_at", "2017-07-28 07:55:12.631740"], ["updated_at", "2017-07-28 07:55:12.631740"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 8], ["location_id", 13], ["counter", 6], ["created_at", "2017-07-20 07:55:12.601706"], ["updated_at", "2017-07-20 07:55:12.601996"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "carter"], ["email", "dario@auergleason.com"], ["password", "RlH95wApHm6e1sYo"], ["role_cd", 3], ["created_at", "2017-07-28 07:55:12.641850"], ["updated_at", "2017-07-28 07:55:12.641850"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:12 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"carter", "email"=>"dario@auergleason.com", "password"=>"RlH95wApHm6e1sYo", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"carter", :email=>"dario@auergleason.com", :password=>"RlH95wApHm6e1sYo", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"dario@auergleason.com", "password"=>"RlH95wApHm6e1sYo"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "carter"], ["email", "dario@auergleason.com"], ["password", "RlH95wApHm6e1sYo"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 17, username: "carter", email: "dario@auergleason.com", password: "RlH95wApHm6e1sYo", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:55:12", updated_at: "2017-07-28 07:55:12", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 17[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=passed&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:12 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"passed", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 17) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>17, "username"=>"carter", "email"=>"dario@auergleason.com", "password"=>"RlH95wApHm6e1sYo", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"passed", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>17, :username=>"carter", :email=>"dario@auergleason.com", :password=>"RlH95wApHm6e1sYo", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:55:12.641Z", :updated_at=>"2017-07-28T07:55:12.641Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:55:12.671453') AND "client_counters"."location_id" IN (10, 11, 12, 13) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1) ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.7ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 8[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:55:12.671453') AND "client_counters"."location_id" IN (10, 11, 12, 13) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1)[0m
[INFO ] Completed [32m200 OK[0m in 31ms [30m(Views: 0.5ms | ActiveRecord: 8.4ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-483-145-7150"], ["created_at", "2017-07-28 07:55:12.693129"], ["updated_at", "2017-07-28 07:55:12.693129"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "It"], ["created_at", "2017-07-28 07:55:12.700232"], ["updated_at", "2017-07-28 07:55:12.700232"], ["local_path", "http://collier.biz/ken.stanton"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Otcom"], ["title_ru", "Название14"], ["created_at", "2017-07-28 07:55:12.704187"], ["updated_at", "2017-07-28 07:55:12.704187"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 14[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_14[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 14) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>14, "title"=>"It", "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "local_path"=>"http://collier.biz/ken.stanton"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zathin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zathin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zathin"], ["category_id", 14], ["slug", "zathin"], ["created_at", "2017-07-28 07:55:12.715233"], ["updated_at", "2017-07-28 07:55:12.715233"], ["layout_id", 14]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "landen"], ["email", "aurore_trantow@yundt.org"], ["password", "N5L5OtAcG3Z"], ["created_at", "2017-07-28 07:55:12.720366"], ["updated_at", "2017-07-28 07:55:12.720366"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "inventore-facere"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Lotlux"], ["phone", "320-866-7356"], ["address", "444 Violet Locks"], ["url", "http://bode.org/mason"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ward.io/rowan.farrell"], ["auth_expiration_time", 900], ["slug", "inventore-facere"], ["brand_id", 14], ["user_id", 18], ["created_at", "2017-07-28 07:55:12.726417"], ["updated_at", "2017-07-28 07:55:12.726417"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 9], ["location_id", 14], ["counter", 1], ["created_at", "2017-07-28 07:55:12.730749"], ["updated_at", "2017-07-28 07:55:12.730749"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(529) 322-7432"], ["created_at", "2017-07-28 07:55:12.735319"], ["updated_at", "2017-07-28 07:55:12.735319"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Cookley"], ["created_at", "2017-07-28 07:55:12.741784"], ["updated_at", "2017-07-28 07:55:12.741784"], ["local_path", "http://rogahn.info/ignatius_oreilly"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Domainer"], ["title_ru", "Название15"], ["created_at", "2017-07-28 07:55:12.745614"], ["updated_at", "2017-07-28 07:55:12.745614"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 15[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_15[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 15) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>15, "title"=>"Cookley", "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "local_path"=>"http://rogahn.info/ignatius_oreilly"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "flowdesk"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "flowdesk"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Flowdesk"], ["category_id", 15], ["slug", "flowdesk"], ["created_at", "2017-07-28 07:55:12.756563"], ["updated_at", "2017-07-28 07:55:12.756563"], ["layout_id", 15]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "margarett_lubowitz"], ["email", "johanna@streich.info"], ["password", "Db0uUlAcIjAdFbOr"], ["created_at", "2017-07-28 07:55:12.761278"], ["updated_at", "2017-07-28 07:55:12.761278"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "sed_nulla"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tres-Zap"], ["phone", "(429) 567-9162"], ["address", "885 Everardo Path"], ["url", "http://haley.info/andy.beer"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://oharaschimmel.info/mose"], ["auth_expiration_time", 900], ["slug", "sed_nulla"], ["brand_id", 15], ["user_id", 19], ["created_at", "2017-07-28 07:55:12.766639"], ["updated_at", "2017-07-28 07:55:12.766639"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 10], ["location_id", 15], ["counter", 9], ["created_at", "2017-07-28 07:55:12.771104"], ["updated_at", "2017-07-28 07:55:12.771104"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bamity"], ["created_at", "2017-07-28 07:55:12.777633"], ["updated_at", "2017-07-28 07:55:12.777633"], ["local_path", "http://pfeffer.biz/eino.wisoky"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Holdlamis"], ["title_ru", "Название16"], ["created_at", "2017-07-28 07:55:12.781258"], ["updated_at", "2017-07-28 07:55:12.781258"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 16[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_16[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 16) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>16, "title"=>"Bamity", "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "local_path"=>"http://pfeffer.biz/eino.wisoky"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "solarbreeze"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "solarbreeze"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Solarbreeze"], ["category_id", 16], ["slug", "solarbreeze"], ["created_at", "2017-07-28 07:55:12.792104"], ["updated_at", "2017-07-28 07:55:12.792104"], ["layout_id", 16]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "shayna.hane"], ["email", "toni.jenkins@renner.name"], ["password", "F6Bh2yQm3jEt4z"], ["created_at", "2017-07-28 07:55:12.797093"], ["updated_at", "2017-07-28 07:55:12.797093"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "officiis_alias"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Vagram"], ["phone", "972-121-9055"], ["address", "742 Rollin Viaduct"], ["url", "http://morietteruecker.com/elmira"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://lind.com/cale_kirlin"], ["auth_expiration_time", 900], ["slug", "officiis_alias"], ["brand_id", 16], ["user_id", 20], ["created_at", "2017-07-28 07:55:12.802492"], ["updated_at", "2017-07-28 07:55:12.802492"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 9], ["location_id", 16], ["counter", 10], ["created_at", "2017-07-28 07:55:12.807721"], ["updated_at", "2017-07-28 07:55:12.807721"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "nigel.sporer"], ["email", "haven@lueilwitz.co"], ["password", "E8128l48"], ["role_cd", 3], ["created_at", "2017-07-28 07:55:12.812160"], ["updated_at", "2017-07-28 07:55:12.812160"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:12 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"nigel.sporer", "email"=>"haven@lueilwitz.co", "password"=>"E8128l48", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"nigel.sporer", :email=>"haven@lueilwitz.co", :password=>"E8128l48", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"haven@lueilwitz.co", "password"=>"E8128l48"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "nigel.sporer"], ["email", "haven@lueilwitz.co"], ["password", "E8128l48"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 21, username: "nigel.sporer", email: "haven@lueilwitz.co", password: "E8128l48", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:55:12", updated_at: "2017-07-28 07:55:12", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 21[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:12 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 21) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>21, "username"=>"nigel.sporer", "email"=>"haven@lueilwitz.co", "password"=>"E8128l48", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.7ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>21, :username=>"nigel.sporer", :email=>"haven@lueilwitz.co", :password=>"E8128l48", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:55:12.812Z", :updated_at=>"2017-07-28T07:55:12.812Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:55:12.730749') AND "client_counters"."location_id" IN (14, 15, 16) GROUP BY client_id, phone_number ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (9, 10)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (9, 10)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:55:12.730749') AND "client_counters"."location_id" IN (14, 15, 16) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 31ms [30m(Views: 0.5ms | ActiveRecord: 8.6ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "168.939.2178 x9488"], ["created_at", "2017-07-28 07:55:12.863265"], ["updated_at", "2017-07-28 07:55:12.863265"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zaam-Dox"], ["created_at", "2017-07-28 07:55:12.870074"], ["updated_at", "2017-07-28 07:55:12.870074"], ["local_path", "http://gottlieb.io/deon.carter"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Holdlamis"], ["title_ru", "Название17"], ["created_at", "2017-07-28 07:55:12.873807"], ["updated_at", "2017-07-28 07:55:12.873807"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_17[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 17) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>17, "title"=>"Zaam-Dox", "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "local_path"=>"http://gottlieb.io/deon.carter"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "transcof"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "transcof"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Transcof"], ["category_id", 17], ["slug", "transcof"], ["created_at", "2017-07-28 07:55:12.885325"], ["updated_at", "2017-07-28 07:55:12.885325"], ["layout_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "leie"], ["email", "lurline@witting.name"], ["password", "IaDlMgZjYrQvOv2"], ["created_at", "2017-07-28 07:55:12.890277"], ["updated_at", "2017-07-28 07:55:12.890277"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "corrupti-facere"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Flexidy"], ["phone", "1-506-258-6160"], ["address", "8272 Paucek Ways"], ["url", "http://dachmohr.co/grayson"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://grant.net/magnolia"], ["auth_expiration_time", 900], ["slug", "corrupti-facere"], ["brand_id", 17], ["user_id", 22], ["created_at", "2017-07-28 07:55:12.896068"], ["updated_at", "2017-07-28 07:55:12.896068"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 11], ["location_id", 17], ["counter", 5], ["created_at", "2017-07-28 07:55:12.900411"], ["updated_at", "2017-07-28 07:55:12.900411"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "366.656.7677 x2864"], ["created_at", "2017-07-28 07:55:12.904316"], ["updated_at", "2017-07-28 07:55:12.904316"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Konklux"], ["created_at", "2017-07-28 07:55:12.910752"], ["updated_at", "2017-07-28 07:55:12.910752"], ["local_path", "http://christiansenshields.info/reginald_schiller"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Pannier"], ["title_ru", "Название18"], ["created_at", "2017-07-28 07:55:12.914496"], ["updated_at", "2017-07-28 07:55:12.914496"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 18[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_18[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 18) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>18, "title"=>"Konklux", "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "local_path"=>"http://christiansenshields.info/reginald_schiller"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cookley"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cookley"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Cookley"], ["category_id", 18], ["slug", "cookley"], ["created_at", "2017-07-28 07:55:12.925485"], ["updated_at", "2017-07-28 07:55:12.925485"], ["layout_id", 18]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "prudence.williamson"], ["email", "price@dubuquehane.name"], ["password", "IeLrDvF7UuR"], ["created_at", "2017-07-28 07:55:12.930049"], ["updated_at", "2017-07-28 07:55:12.930049"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "qui-omnis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stronghold"], ["phone", "1-913-582-1185"], ["address", "9120 Janiya Flat"], ["url", "http://rowe.org/electa_watsica"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://caspermertz.name/lillie"], ["auth_expiration_time", 900], ["slug", "qui-omnis"], ["brand_id", 18], ["user_id", 23], ["created_at", "2017-07-28 07:55:12.935550"], ["updated_at", "2017-07-28 07:55:12.935550"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 12], ["location_id", 18], ["counter", 6], ["created_at", "2017-07-28 07:55:12.940050"], ["updated_at", "2017-07-28 07:55:12.940050"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Cardguard"], ["created_at", "2017-07-28 07:55:12.946615"], ["updated_at", "2017-07-28 07:55:12.946615"], ["local_path", "http://pollich.net/tyshawn_tillman"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zontrax"], ["title_ru", "Название19"], ["created_at", "2017-07-28 07:55:12.950390"], ["updated_at", "2017-07-28 07:55:12.950390"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 19[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_19[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 19) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>19, "title"=>"Cardguard", "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "local_path"=>"http://pollich.net/tyshawn_tillman"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-solowarm"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-solowarm"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Y-Solowarm"], ["category_id", 19], ["slug", "y-solowarm"], ["created_at", "2017-07-28 07:55:12.961024"], ["updated_at", "2017-07-28 07:55:12.961024"], ["layout_id", 19]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "bailee.kertzmann"], ["email", "scotty@binshaley.io"], ["password", "Kc9oVr4a4fMf38J"], ["created_at", "2017-07-28 07:55:12.965727"], ["updated_at", "2017-07-28 07:55:12.965727"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "beatae_et"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stringtough"], ["phone", "(823) 574-9836"], ["address", "89586 DuBuque Throughway"], ["url", "http://deckowvolkman.name/arch"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://vonrueden.co/coby.stroman"], ["auth_expiration_time", 900], ["slug", "beatae_et"], ["brand_id", 19], ["user_id", 24], ["created_at", "2017-07-28 07:55:12.971310"], ["updated_at", "2017-07-28 07:55:12.971310"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 11], ["location_id", 19], ["counter", 3], ["created_at", "2017-07-28 07:55:12.975655"], ["updated_at", "2017-07-28 07:55:12.975655"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "parker_torp"], ["email", "kelvin.homenick@adamsbashirian.info"], ["password", "KmG97vDnKjZpMo"], ["role_cd", 3], ["created_at", "2017-07-28 07:55:12.980413"], ["updated_at", "2017-07-28 07:55:12.980413"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:12 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"parker_torp", "email"=>"kelvin.homenick@adamsbashirian.info", "password"=>"KmG97vDnKjZpMo", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"parker_torp", :email=>"kelvin.homenick@adamsbashirian.info", :password=>"KmG97vDnKjZpMo", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"kelvin.homenick@adamsbashirian.info", "password"=>"KmG97vDnKjZpMo"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "parker_torp"], ["email", "kelvin.homenick@adamsbashirian.info"], ["password", "KmG97vDnKjZpMo"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 25, username: "parker_torp", email: "kelvin.homenick@adamsbashirian.info", password: "KmG97vDnKjZpMo", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:55:12", updated_at: "2017-07-28 07:55:12", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 25[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=updated_at&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:12 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"updated_at", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 25) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>25, "username"=>"parker_torp", "email"=>"kelvin.homenick@adamsbashirian.info", "password"=>"KmG97vDnKjZpMo", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:12 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"updated_at", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.7ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>25, :username=>"parker_torp", :email=>"kelvin.homenick@adamsbashirian.info", :password=>"KmG97vDnKjZpMo", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:55:12.980Z", :updated_at=>"2017-07-28T07:55:12.980Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:55:12.900411') AND "client_counters"."location_id" IN (17, 18, 19) GROUP BY client_id, phone_number ORDER BY updated_at desc, visits desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (11, 12)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (11, 12)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:55:12.900411') AND "client_counters"."location_id" IN (17, 18, 19) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 31ms [30m(Views: 0.6ms | ActiveRecord: 9.0ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-337-163-6447 x233"], ["created_at", "2017-07-28 07:55:13.031809"], ["updated_at", "2017-07-28 07:55:13.031809"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Gembucket"], ["created_at", "2017-07-28 07:55:13.038416"], ["updated_at", "2017-07-28 07:55:13.038416"], ["local_path", "http://grant.biz/wilbert"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Lotstring"], ["title_ru", "Название20"], ["created_at", "2017-07-28 07:55:13.042371"], ["updated_at", "2017-07-28 07:55:13.042371"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 20[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_20[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 20) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>20, "title"=>"Gembucket", "created_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "local_path"=>"http://grant.biz/wilbert"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "hatity"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "hatity"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Hatity"], ["category_id", 20], ["slug", "hatity"], ["created_at", "2017-07-28 07:55:13.053538"], ["updated_at", "2017-07-28 07:55:13.053538"], ["layout_id", 20]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "zoie_lueilwitz"], ["email", "summer.johnston@hegmanncartwright.io"], ["password", "5aT73p9gJiLdQ"], ["created_at", "2017-07-28 07:55:13.058595"], ["updated_at", "2017-07-28 07:55:13.058595"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "odit-quae"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stim"], ["phone", "313-351-2586"], ["address", "858 Brakus Fork"], ["url", "http://robelrice.biz/adrain.quigley"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://mills.com/grant"], ["auth_expiration_time", 900], ["slug", "odit-quae"], ["brand_id", 20], ["user_id", 26], ["created_at", "2017-07-28 07:55:13.064389"], ["updated_at", "2017-07-28 07:55:13.064389"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 13], ["location_id", 20], ["counter", 7], ["created_at", "2017-07-28 07:55:13.068903"], ["updated_at", "2017-07-28 07:55:13.068903"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(660) 383-4540 x8139"], ["created_at", "2017-07-28 07:55:13.072744"], ["updated_at", "2017-07-28 07:55:13.072744"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zathin"], ["created_at", "2017-07-28 07:55:13.079409"], ["updated_at", "2017-07-28 07:55:13.079409"], ["local_path", "http://turner.name/elody"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zoolab"], ["title_ru", "Название21"], ["created_at", "2017-07-28 07:55:13.083297"], ["updated_at", "2017-07-28 07:55:13.083297"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_21[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 21) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>21, "title"=>"Zathin", "created_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "local_path"=>"http://turner.name/elody"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zamit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zamit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zamit"], ["category_id", 21], ["slug", "zamit"], ["created_at", "2017-07-28 07:55:13.094472"], ["updated_at", "2017-07-28 07:55:13.094472"], ["layout_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lamar.hoeger"], ["email", "lisandro@pollich.io"], ["password", "BcShOeZ06s14Ge"], ["created_at", "2017-07-28 07:55:13.099396"], ["updated_at", "2017-07-28 07:55:13.099396"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "non-iusto"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tampflex"], ["phone", "645-079-0852"], ["address", "24878 Myrtis Coves"], ["url", "http://hahngrady.io/naomi.schoen"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://wiegandrogahn.net/alfredo"], ["auth_expiration_time", 900], ["slug", "non-iusto"], ["brand_id", 21], ["user_id", 27], ["created_at", "2017-07-28 07:55:13.104960"], ["updated_at", "2017-07-28 07:55:13.104960"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 14], ["location_id", 21], ["counter", 3], ["created_at", "2017-07-28 07:55:13.109447"], ["updated_at", "2017-07-28 07:55:13.109447"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Fintone"], ["created_at", "2017-07-28 07:55:13.116170"], ["updated_at", "2017-07-28 07:55:13.116170"], ["local_path", "http://harvey.net/althea"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Alpha"], ["title_ru", "Название22"], ["created_at", "2017-07-28 07:55:13.120056"], ["updated_at", "2017-07-28 07:55:13.120056"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 22[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_22[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 22) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>22, "title"=>"Fintone", "created_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "local_path"=>"http://harvey.net/althea"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bytecard"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bytecard"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bytecard"], ["category_id", 22], ["slug", "bytecard"], ["created_at", "2017-07-28 07:55:13.131051"], ["updated_at", "2017-07-28 07:55:13.131051"], ["layout_id", 22]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "sabrina"], ["email", "nicolas@corwinhane.net"], ["password", "7sFu192e7gEaC3"], ["created_at", "2017-07-28 07:55:13.135824"], ["updated_at", "2017-07-28 07:55:13.135824"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ut_vel"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Namfix"], ["phone", "430.522.9400"], ["address", "3274 Cassin Ridges"], ["url", "http://mann.io/kylie.hane"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://johns.name/diamond_goyette"], ["auth_expiration_time", 900], ["slug", "ut_vel"], ["brand_id", 22], ["user_id", 28], ["created_at", "2017-07-28 07:55:13.141017"], ["updated_at", "2017-07-28 07:55:13.141017"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 13], ["location_id", 22], ["counter", 10], ["created_at", "2017-07-28 07:55:13.145108"], ["updated_at", "2017-07-28 07:55:13.145108"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "620-927-8131 x69534"], ["created_at", "2017-07-28 07:55:13.149142"], ["updated_at", "2017-07-28 07:55:13.149142"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Y-find"], ["created_at", "2017-07-28 07:55:13.155052"], ["updated_at", "2017-07-28 07:55:13.155052"], ["local_path", "http://deckow.net/jaeden.rempel"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zathin"], ["title_ru", "Название23"], ["created_at", "2017-07-28 07:55:13.158487"], ["updated_at", "2017-07-28 07:55:13.158487"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 23[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_23[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 23) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>23, "title"=>"Y-find", "created_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "local_path"=>"http://deckow.net/jaeden.rempel"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zamit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zamit-category0x007fd001434710"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zamit-category0x007fd001434710"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zamit"], ["category_id", 23], ["slug", "zamit-category0x007fd001434710"], ["created_at", "2017-07-28 07:55:13.169979"], ["updated_at", "2017-07-28 07:55:13.169979"], ["layout_id", 23]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "alycia_ohara"], ["email", "johnathon@auer.co"], ["password", "HhMjGrSoQvNgSg35"], ["created_at", "2017-07-28 07:55:13.174491"], ["updated_at", "2017-07-28 07:55:13.174491"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "nisi_harum"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Subin"], ["phone", "(177) 205-6681"], ["address", "7800 Glover Crescent"], ["url", "http://labadie.io/jaquan_hamill"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://wyman.name/elmore.wyman"], ["auth_expiration_time", 900], ["slug", "nisi_harum"], ["brand_id", 23], ["user_id", 29], ["created_at", "2017-07-28 07:55:13.179807"], ["updated_at", "2017-07-28 07:55:13.179807"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 15], ["location_id", 23], ["counter", 9], ["created_at", "2017-06-26 07:55:13.147391"], ["updated_at", "2017-06-26 07:55:13.147495"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "brown"], ["email", "zelda@klocko.org"], ["password", "1lNnHvSz662"], ["role_cd", 3], ["created_at", "2017-07-28 07:55:13.188441"], ["updated_at", "2017-07-28 07:55:13.188441"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:13 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"brown", "email"=>"zelda@klocko.org", "password"=>"1lNnHvSz662", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"brown", :email=>"zelda@klocko.org", :password=>"1lNnHvSz662", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"zelda@klocko.org", "password"=>"1lNnHvSz662"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "brown"], ["email", "zelda@klocko.org"], ["password", "1lNnHvSz662"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 30, username: "brown", email: "zelda@klocko.org", password: "1lNnHvSz662", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:55:13", updated_at: "2017-07-28 07:55:13", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 30[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=visits30&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:13 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits30", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 30) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>30, "username"=>"brown", "email"=>"zelda@klocko.org", "password"=>"1lNnHvSz662", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits30", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.8ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>30, :username=>"brown", :email=>"zelda@klocko.org", :password=>"1lNnHvSz662", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:55:13.188Z", :updated_at=>"2017-07-28T07:55:13.188Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-06-26 07:55:13.147391') AND "client_counters"."location_id" IN (20, 21, 22, 23) GROUP BY client_id, phone_number ORDER BY visits30 asc, updated_at desc, visits desc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (15, 14, 13)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.9ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (13, 14, 15)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-06-26 07:55:13.147391') AND "client_counters"."location_id" IN (20, 21, 22, 23) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 45ms [30m(Views: 0.9ms | ActiveRecord: 8.8ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ricardo"], ["email", "genoveva@ernser.org"], ["password", "LoAfLpRlXmAuJ8"], ["created_at", "2017-07-28 07:55:13.254483"], ["updated_at", "2017-07-28 07:55:13.254483"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lurline.nicolas"], ["email", "jonathan@ullrichgerhold.co"], ["password", "VlHzCeJuFfU"], ["created_at", "2017-07-28 07:55:13.285921"], ["updated_at", "2017-07-28 07:55:13.285921"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "richmond"], ["email", "mose@parkermills.net"], ["password", "6z27VhGmH2"], ["created_at", "2017-07-28 07:55:13.303980"], ["updated_at", "2017-07-28 07:55:13.303980"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "madisyn_greenfelder"], ["email", "shanon_schimmel@wilderman.co"], ["password", "W6Wx3l727h62"], ["created_at", "2017-07-28 07:55:13.314494"], ["updated_at", "2017-07-28 07:55:13.314494"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "mollie"], ["email", "amber_greenholt@goodwin.com"], ["password", "Lq6kW2WzUj"], ["created_at", "2017-07-28 07:55:13.324922"], ["updated_at", "2017-07-28 07:55:13.324922"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(284) 805-3747 x95139"], ["created_at", "2017-07-28 07:55:13.358134"], ["updated_at", "2017-07-28 07:55:13.358134"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "maddison"], ["email", "clinton_zulauf@koelpindach.org"], ["password", "T8Yq52L1BtV"], ["created_at", "2017-07-28 07:55:13.364056"], ["updated_at", "2017-07-28 07:55:13.364056"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.9ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "814167"], ["username", "xavier.kuhn"], ["image", "http://twitter.com/img/xavier.kuhn.jpg"], ["profile", "https://twitter.com/xavier.kuhn"], ["email", "meda_schultz@kundeschinner.co"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 16], ["user_id", 36], ["created_at", "2017-07-28 07:55:13.368635"], ["updated_at", "2017-07-28 07:55:13.368635"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Home Ing"], ["created_at", "2017-07-28 07:55:13.377168"], ["updated_at", "2017-07-28 07:55:13.377168"], ["local_path", "http://krajcik.org/saige"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Duobam"], ["title_ru", "Название24"], ["created_at", "2017-07-28 07:55:13.380790"], ["updated_at", "2017-07-28 07:55:13.380790"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 24[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_24[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 24) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>24, "title"=>"Home Ing", "created_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "local_path"=>"http://krajcik.org/saige"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "latlux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "latlux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Latlux"], ["category_id", 24], ["slug", "latlux"], ["created_at", "2017-07-28 07:55:13.391992"], ["updated_at", "2017-07-28 07:55:13.391992"], ["layout_id", 24]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "inventore-ut"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Lotstring"], ["phone", "(351) 715-1076"], ["address", "840 Marietta Lane"], ["url", "http://runolfsdottir.org/antonette_osinski"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://shanahan.com/rigoberto.bartell"], ["auth_expiration_time", 900], ["slug", "inventore-ut"], ["brand_id", 24], ["user_id", 36], ["created_at", "2017-07-28 07:55:13.397341"], ["updated_at", "2017-07-28 07:55:13.397341"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Konklab"], ["created_at", "2017-07-28 07:55:13.446693"], ["updated_at", "2017-07-28 07:55:13.446693"], ["local_path", "http://dare.org/rachael_quigley"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Span"], ["title_ru", "Название25"], ["created_at", "2017-07-28 07:55:13.450666"], ["updated_at", "2017-07-28 07:55:13.450666"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_25[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 25) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>25, "title"=>"Konklab", "created_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "local_path"=>"http://dare.org/rachael_quigley"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zontrax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zontrax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zontrax"], ["category_id", 25], ["slug", "zontrax"], ["created_at", "2017-07-28 07:55:13.461999"], ["updated_at", "2017-07-28 07:55:13.461999"], ["layout_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "monty"], ["email", "andreane_leuschke@morarkirlin.io"], ["password", "NmY1571lMi3"], ["created_at", "2017-07-28 07:55:13.466923"], ["updated_at", "2017-07-28 07:55:13.466923"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "vel_iusto"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Redhold"], ["phone", "507.023.3727"], ["address", "896 Estevan Prairie"], ["url", "http://donnelly.biz/gennaro"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://harveycorwin.io/jacey_lubowitz"], ["auth_expiration_time", 900], ["slug", "vel_iusto"], ["brand_id", 25], ["user_id", 37], ["created_at", "2017-07-28 07:55:13.472642"], ["updated_at", "2017-07-28 07:55:13.472642"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "destin.howell"], ["email", "edwina@jacobsonpouros.info"], ["password", "16Hf5g68NsPz"], ["created_at", "2017-07-28 07:55:13.478002"], ["updated_at", "2017-07-28 07:55:13.478002"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5331"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5331"], ["comment", "comment 11"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "20.7.248.112"], ["router_admin_ip", "59.29.213.27"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "522"], ["status", "t"], ["location_id", 25], ["user_id", 38], ["created_at", "2017-07-28 07:55:13.486067"], ["updated_at", "2017-07-28 07:55:13.486067"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5331"], ["id", 1], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 1], ["serial", "643705CA5E36/5331"], ["comment", "comment 11"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "20.7.248.112"], ["router_admin_ip", "59.29.213.27"], ["admin_password", "c0c1257d2818d7fa"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "1"], ["status", "t"], ["location_id", 25], ["user_id", 38], ["created_at", "2017-07-28 07:55:13.486067"], ["updated_at", "2017-07-28 07:55:13.486067"], ["id", 1]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 031ee294-edb7-4b13-ae89-568b31451a8a) to Async(routers) with arguments: #<GlobalID:0x007fd001797010 @uri=#<URI::GID gid://wifi-management/Router/1>>
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 43b1b40c-773a-4b6b-a124-6678a3545fa0) to Async(routers) with arguments: #<GlobalID:0x007fd001797010 @uri=#<URI::GID gid://wifi-management/Router/1>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 1], ["provider", "instagram"], ["location_id", 24], ["router_id", 1], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:13 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"maddison", "email"=>"clinton_zulauf@koelpindach.org", "password"=>"T8Yq52L1BtV", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"maddison", :email=>"clinton_zulauf@koelpindach.org", :password=>"T8Yq52L1BtV", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"clinton_zulauf@koelpindach.org", "password"=>"T8Yq52L1BtV"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "maddison"], ["email", "clinton_zulauf@koelpindach.org"], ["password", "T8Yq52L1BtV"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 36, username: "maddison", email: "clinton_zulauf@koelpindach.org", password: "T8Yq52L1BtV", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:55:13", updated_at: "2017-07-28 07:55:13", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 36[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/stats/time_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:13 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#time_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_36[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 36) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 36]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>36, "username"=>"maddison", "email"=>"clinton_zulauf@koelpindach.org", "password"=>"T8Yq52L1BtV", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"time_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_36[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_36[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>36, :username=>"maddison", :email=>"clinton_zulauf@koelpindach.org", :password=>"T8Yq52L1BtV", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:55:13.364Z", :updated_at=>"2017-07-28T07:55:13.364Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 36[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.5ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(24)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 27ms [30m(Views: 1.2ms | ActiveRecord: 6.1ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "131-632-4449 x598"], ["created_at", "2017-07-28 07:55:13.734387"], ["updated_at", "2017-07-28 07:55:13.734387"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "aurore.waters"], ["email", "alverta_schmidt@faheybarton.co"], ["password", "Bj4oJbSh158f8"], ["created_at", "2017-07-28 07:55:13.739624"], ["updated_at", "2017-07-28 07:55:13.739624"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "420586"], ["username", "kale.schinner"], ["image", "http://instagram.com/img/kale.schinner.jpg"], ["profile", "https://instagram.com/kale.schinner"], ["email", "alexzander.gerhold@barton.co"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 17], ["user_id", 39], ["created_at", "2017-07-28 07:55:13.743882"], ["updated_at", "2017-07-28 07:55:13.743882"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bitwolf"], ["created_at", "2017-07-28 07:55:13.751618"], ["updated_at", "2017-07-28 07:55:13.751618"], ["local_path", "http://rau.info/emmitt"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Solarbreeze"], ["title_ru", "Название26"], ["created_at", "2017-07-28 07:55:13.755347"], ["updated_at", "2017-07-28 07:55:13.755347"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 26[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_26[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 26) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>26, "title"=>"Bitwolf", "created_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "local_path"=>"http://rau.info/emmitt"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tampflex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tampflex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tampflex"], ["category_id", 26], ["slug", "tampflex"], ["created_at", "2017-07-28 07:55:13.767259"], ["updated_at", "2017-07-28 07:55:13.767259"], ["layout_id", 26]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quod.id"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Transcof"], ["phone", "511.994.4731"], ["address", "6381 Eldred Road"], ["url", "http://gorczany.org/ida.turner"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://paucek.info/franz.marquardt"], ["auth_expiration_time", 900], ["slug", "quod.id"], ["brand_id", 26], ["user_id", 39], ["created_at", "2017-07-28 07:55:13.773032"], ["updated_at", "2017-07-28 07:55:13.773032"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bitchip"], ["created_at", "2017-07-28 07:55:13.781326"], ["updated_at", "2017-07-28 07:55:13.781326"], ["local_path", "http://rutherfordmurazik.name/johan_schamberger"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Home Ing"], ["title_ru", "Название27"], ["created_at", "2017-07-28 07:55:13.784952"], ["updated_at", "2017-07-28 07:55:13.784952"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 27[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_27[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 27) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>27, "title"=>"Bitchip", "created_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "local_path"=>"http://rutherfordmurazik.name/johan_schamberger"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tin"], ["category_id", 27], ["slug", "tin"], ["created_at", "2017-07-28 07:55:13.795422"], ["updated_at", "2017-07-28 07:55:13.795422"], ["layout_id", 27]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lexi"], ["email", "effie@stroman.net"], ["password", "V3OrI5ZeJ7"], ["created_at", "2017-07-28 07:55:13.800023"], ["updated_at", "2017-07-28 07:55:13.800023"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et.delectus"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Solarbreeze"], ["phone", "1-628-307-2801"], ["address", "121 Dibbert Terrace"], ["url", "http://reillyhalvorson.com/jaylan"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://smitham.io/jewel"], ["auth_expiration_time", 900], ["slug", "et.delectus"], ["brand_id", 27], ["user_id", 40], ["created_at", "2017-07-28 07:55:13.805476"], ["updated_at", "2017-07-28 07:55:13.805476"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "eugenia.crist"], ["email", "jasen_hickle@stark.name"], ["password", "TmVy05520dWg2k"], ["created_at", "2017-07-28 07:55:13.810841"], ["updated_at", "2017-07-28 07:55:13.810841"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5332"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5332"], ["comment", "comment 12"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "30.230.207.73"], ["router_admin_ip", "229.118.57.8"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "449"], ["status", "t"], ["location_id", 27], ["user_id", 41], ["created_at", "2017-07-28 07:55:13.816082"], ["updated_at", "2017-07-28 07:55:13.816082"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5332"], ["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 2], ["serial", "643705CA5E36/5332"], ["comment", "comment 12"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "30.230.207.73"], ["router_admin_ip", "229.118.57.8"], ["admin_password", "d020bd8aa9c8e562"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "2"], ["status", "t"], ["location_id", 27], ["user_id", 41], ["created_at", "2017-07-28 07:55:13.816082"], ["updated_at", "2017-07-28 07:55:13.816082"], ["id", 2]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: c16db03a-ac7e-4d15-8699-b386184de2b7) to Async(routers) with arguments: #<GlobalID:0x007fcffce92720 @uri=#<URI::GID gid://wifi-management/Router/2>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 844aadd8-52e6-42a4-9481-3b39e74ca2cd) to Async(routers) with arguments: #<GlobalID:0x007fcffce92720 @uri=#<URI::GID gid://wifi-management/Router/2>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 2], ["provider", "instagram"], ["location_id", 26], ["router_id", 2], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:14 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"aurore.waters", "email"=>"alverta_schmidt@faheybarton.co", "password"=>"Bj4oJbSh158f8", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"aurore.waters", :email=>"alverta_schmidt@faheybarton.co", :password=>"Bj4oJbSh158f8", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"alverta_schmidt@faheybarton.co", "password"=>"Bj4oJbSh158f8"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "aurore.waters"], ["email", "alverta_schmidt@faheybarton.co"], ["password", "Bj4oJbSh158f8"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 39, username: "aurore.waters", email: "alverta_schmidt@faheybarton.co", password: "Bj4oJbSh158f8", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:55:13", updated_at: "2017-07-28 07:55:13", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 39[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.2ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/stats/authorizations" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:14 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#authorizations[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 39) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>39, "username"=>"aurore.waters", "email"=>"alverta_schmidt@faheybarton.co", "password"=>"Bj4oJbSh158f8", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:13 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"authorizations"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>39, :username=>"aurore.waters", :email=>"alverta_schmidt@faheybarton.co", :password=>"Bj4oJbSh158f8", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:55:13.739Z", :updated_at=>"2017-07-28T07:55:13.739Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 39[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[34mSELECT COUNT("social_logs"."id") AS count_id, date_trunc('hour', created_at) AS date_trunc_hour_created_at FROM "social_logs" WHERE "social_logs"."location_id" = 26 AND ("social_logs"."created_at" BETWEEN $1 AND $2) GROUP BY date_trunc('hour', created_at) ORDER BY date_trunc_hour_created_at[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 29ms [30m(Views: 0.2ms | ActiveRecord: 9.4ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(179) 942-5264 x282"], ["created_at", "2017-07-28 07:55:14.066528"], ["updated_at", "2017-07-28 07:55:14.066528"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "sammy_johnston"], ["email", "rafael@friesen.name"], ["password", "2xNtBgHyVuX5"], ["created_at", "2017-07-28 07:55:14.071328"], ["updated_at", "2017-07-28 07:55:14.071328"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "791430"], ["username", "noah"], ["image", "http://facebook.com/img/noah.jpg"], ["profile", "https://facebook.com/noah"], ["email", "lowell@naderbradtke.net"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 18], ["user_id", 42], ["created_at", "2017-07-28 07:55:14.075435"], ["updated_at", "2017-07-28 07:55:14.075435"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Ventosanzap"], ["created_at", "2017-07-28 07:55:14.082490"], ["updated_at", "2017-07-28 07:55:14.082490"], ["local_path", "http://stoltenberg.org/margarete.heathcote"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Hatity"], ["title_ru", "Название28"], ["created_at", "2017-07-28 07:55:14.086309"], ["updated_at", "2017-07-28 07:55:14.086309"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 28[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_28[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 28) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>28, "title"=>"Ventosanzap", "created_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "local_path"=>"http://stoltenberg.org/margarete.heathcote"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "latlux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "latlux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Latlux"], ["category_id", 28], ["slug", "latlux"], ["created_at", "2017-07-28 07:55:14.097348"], ["updated_at", "2017-07-28 07:55:14.097348"], ["layout_id", 28]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "distinctio.quibusdam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Aerified"], ["phone", "(101) 096-8525"], ["address", "45595 Tyler Keys"], ["url", "http://hauck.com/haleigh.goodwin"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ritchiebergnaum.io/paxton_bartoletti"], ["auth_expiration_time", 900], ["slug", "distinctio.quibusdam"], ["brand_id", 28], ["user_id", 42], ["created_at", "2017-07-28 07:55:14.102896"], ["updated_at", "2017-07-28 07:55:14.102896"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Lotstring"], ["created_at", "2017-07-28 07:55:14.111137"], ["updated_at", "2017-07-28 07:55:14.111137"], ["local_path", "http://emmerich.net/courtney_emard"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Latlux"], ["title_ru", "Название29"], ["created_at", "2017-07-28 07:55:14.114621"], ["updated_at", "2017-07-28 07:55:14.114621"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 29[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_29[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 29) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>29, "title"=>"Lotstring", "created_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "local_path"=>"http://emmerich.net/courtney_emard"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alpha"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alpha"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Alpha"], ["category_id", 29], ["slug", "alpha"], ["created_at", "2017-07-28 07:55:14.125136"], ["updated_at", "2017-07-28 07:55:14.125136"], ["layout_id", 29]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "adriana.beier"], ["email", "joana@oberbrunner.org"], ["password", "QySgWhDy"], ["created_at", "2017-07-28 07:55:14.129842"], ["updated_at", "2017-07-28 07:55:14.129842"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "nihil-numquam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tempsoft"], ["phone", "523-759-4293"], ["address", "67616 MacGyver Centers"], ["url", "http://quitzon.co/kyler.goyette"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://veumdoyle.co/lance"], ["auth_expiration_time", 900], ["slug", "nihil-numquam"], ["brand_id", 29], ["user_id", 43], ["created_at", "2017-07-28 07:55:14.135394"], ["updated_at", "2017-07-28 07:55:14.135394"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ben"], ["email", "fausto.hickle@walsh.org"], ["password", "BhU9E1O80xV3Z"], ["created_at", "2017-07-28 07:55:14.140593"], ["updated_at", "2017-07-28 07:55:14.140593"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5333"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5333"], ["comment", "comment 13"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "192.207.232.246"], ["router_admin_ip", "67.36.159.220"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "362"], ["status", "t"], ["location_id", 29], ["user_id", 44], ["created_at", "2017-07-28 07:55:14.145957"], ["updated_at", "2017-07-28 07:55:14.145957"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5333"], ["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 3], ["serial", "643705CA5E36/5333"], ["comment", "comment 13"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "192.207.232.246"], ["router_admin_ip", "67.36.159.220"], ["admin_password", "d057f324c933aca8"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "3"], ["status", "t"], ["location_id", 29], ["user_id", 44], ["created_at", "2017-07-28 07:55:14.145957"], ["updated_at", "2017-07-28 07:55:14.145957"], ["id", 3]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 91f8d587-5bb3-42f4-8539-2d9256efa513) to Async(routers) with arguments: #<GlobalID:0x007fd005eabd70 @uri=#<URI::GID gid://wifi-management/Router/3>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 2202e045-5bbe-4408-b79e-3652e0900928) to Async(routers) with arguments: #<GlobalID:0x007fd005eabd70 @uri=#<URI::GID gid://wifi-management/Router/3>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 3], ["provider", "instagram"], ["location_id", 28], ["router_id", 3], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:14 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"sammy_johnston", "email"=>"rafael@friesen.name", "password"=>"2xNtBgHyVuX5", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"sammy_johnston", :email=>"rafael@friesen.name", :password=>"2xNtBgHyVuX5", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"rafael@friesen.name", "password"=>"2xNtBgHyVuX5"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "sammy_johnston"], ["email", "rafael@friesen.name"], ["password", "2xNtBgHyVuX5"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 42, username: "sammy_johnston", email: "rafael@friesen.name", password: "2xNtBgHyVuX5", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:55:14", updated_at: "2017-07-28 07:55:14", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 42[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/social_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:14 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#social_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_42[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 42) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 42]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>42, "username"=>"sammy_johnston", "email"=>"rafael@friesen.name", "password"=>"2xNtBgHyVuX5", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"social_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_42[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_42[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>42, :username=>"sammy_johnston", :email=>"rafael@friesen.name", :password=>"2xNtBgHyVuX5", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:55:14.071Z", :updated_at=>"2017-07-28T07:55:14.071Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 42[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" = 28 AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 25ms [30m(Views: 1.2ms | ActiveRecord: 6.7ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "268-600-8150 x7006"], ["created_at", "2017-07-28 07:55:14.363463"], ["updated_at", "2017-07-28 07:55:14.363463"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jaeden"], ["email", "elenor@torphy.org"], ["password", "IzMgEe2q9qMp"], ["created_at", "2017-07-28 07:55:14.368910"], ["updated_at", "2017-07-28 07:55:14.368910"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "968458"], ["username", "jimmie.kutch"], ["image", "http://instagram.com/img/jimmie.kutch.jpg"], ["profile", "https://instagram.com/jimmie.kutch"], ["email", "anabelle@marvin.name"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 19], ["user_id", 45], ["created_at", "2017-07-28 07:55:14.373081"], ["updated_at", "2017-07-28 07:55:14.373081"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Flowdesk"], ["created_at", "2017-07-28 07:55:14.380705"], ["updated_at", "2017-07-28 07:55:14.380705"], ["local_path", "http://hermanstamm.name/everette.rath"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zathin"], ["title_ru", "Название30"], ["created_at", "2017-07-28 07:55:14.384566"], ["updated_at", "2017-07-28 07:55:14.384566"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_30[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 30) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>30, "title"=>"Flowdesk", "created_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "local_path"=>"http://hermanstamm.name/everette.rath"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitwolf"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitwolf"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bitwolf"], ["category_id", 30], ["slug", "bitwolf"], ["created_at", "2017-07-28 07:55:14.396416"], ["updated_at", "2017-07-28 07:55:14.396416"], ["layout_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "corporis-nihil"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zontrax"], ["phone", "(615) 406-7111"], ["address", "9031 Pagac Lock"], ["url", "http://towne.org/cortez_oreilly"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://wizamurphy.io/kaleigh"], ["auth_expiration_time", 900], ["slug", "corporis-nihil"], ["brand_id", 30], ["user_id", 45], ["created_at", "2017-07-28 07:55:14.402555"], ["updated_at", "2017-07-28 07:55:14.402555"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Lotlux"], ["created_at", "2017-07-28 07:55:14.410730"], ["updated_at", "2017-07-28 07:55:14.410730"], ["local_path", "http://batzsipes.io/zackary.roberts"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Hatity"], ["title_ru", "Название31"], ["created_at", "2017-07-28 07:55:14.414322"], ["updated_at", "2017-07-28 07:55:14.414322"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 31[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_31[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 31) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>31, "title"=>"Lotlux", "created_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "local_path"=>"http://batzsipes.io/zackary.roberts"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "keylex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "keylex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Keylex"], ["category_id", 31], ["slug", "keylex"], ["created_at", "2017-07-28 07:55:14.424737"], ["updated_at", "2017-07-28 07:55:14.424737"], ["layout_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "benjamin"], ["email", "janick_hyatt@daniel.io"], ["password", "JvLuQlQ1P"], ["created_at", "2017-07-28 07:55:14.429365"], ["updated_at", "2017-07-28 07:55:14.429365"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ullam.officiis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Aerified"], ["phone", "577.322.2246"], ["address", "32696 Abe Plaza"], ["url", "http://weimann.org/anastacio"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://conroy.info/ole"], ["auth_expiration_time", 900], ["slug", "ullam.officiis"], ["brand_id", 31], ["user_id", 46], ["created_at", "2017-07-28 07:55:14.434872"], ["updated_at", "2017-07-28 07:55:14.434872"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "brock.hyatt"], ["email", "jacey.sanford@johnson.com"], ["password", "3iA5Bw456jMlIkS9"], ["created_at", "2017-07-28 07:55:14.440233"], ["updated_at", "2017-07-28 07:55:14.440233"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5334"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5334"], ["comment", "comment 14"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "199.130.45.233"], ["router_admin_ip", "127.168.143.26"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "230"], ["status", "t"], ["location_id", 31], ["user_id", 47], ["created_at", "2017-07-28 07:55:14.445594"], ["updated_at", "2017-07-28 07:55:14.445594"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5334"], ["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 4], ["serial", "643705CA5E36/5334"], ["comment", "comment 14"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "199.130.45.233"], ["router_admin_ip", "127.168.143.26"], ["admin_password", "5fee0403f7002aea"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "4"], ["status", "t"], ["location_id", 31], ["user_id", 47], ["created_at", "2017-07-28 07:55:14.445594"], ["updated_at", "2017-07-28 07:55:14.445594"], ["id", 4]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 0304362e-c10c-41de-be2d-f342897e7748) to Async(routers) with arguments: #<GlobalID:0x007fd0014c6818 @uri=#<URI::GID gid://wifi-management/Router/4>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 5386557f-3ec2-49ca-9cbe-c6bdb34401db) to Async(routers) with arguments: #<GlobalID:0x007fd0014c6818 @uri=#<URI::GID gid://wifi-management/Router/4>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.3ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (2.4ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 4], ["provider", "instagram"], ["location_id", 30], ["router_id", 4], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(266) 824-1241 x7907"], ["created_at", "2017-07-28 07:55:14.588385"], ["updated_at", "2017-07-28 07:55:14.588385"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "tyreek_pouros"], ["email", "yasmin.brakus@douglas.com"], ["password", "ViLu82LtPq"], ["created_at", "2017-07-28 07:55:14.593448"], ["updated_at", "2017-07-28 07:55:14.593448"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "221722"], ["username", "evelyn"], ["image", "http://twitter.com/img/evelyn.jpg"], ["profile", "https://twitter.com/evelyn"], ["email", "justen_greenholt@roweyundt.io"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 20], ["user_id", 48], ["created_at", "2017-07-28 07:55:14.597669"], ["updated_at", "2017-07-28 07:55:14.597669"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Kanlam"], ["created_at", "2017-07-28 07:55:14.604872"], ["updated_at", "2017-07-28 07:55:14.604872"], ["local_path", "http://abbott.name/turner.morar"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Tampflex"], ["title_ru", "Название32"], ["created_at", "2017-07-28 07:55:14.608873"], ["updated_at", "2017-07-28 07:55:14.608873"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 32[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_32[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 32) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>32, "title"=>"Kanlam", "created_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "local_path"=>"http://abbott.name/turner.morar"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tresom"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tresom"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tresom"], ["category_id", 32], ["slug", "tresom"], ["created_at", "2017-07-28 07:55:14.620147"], ["updated_at", "2017-07-28 07:55:14.620147"], ["layout_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "nisi_doloribus"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Voltsillam"], ["phone", "978.808.3901"], ["address", "541 Gibson Bridge"], ["url", "http://ondrickaoconner.io/shayna"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://goyettesmitham.io/boris"], ["auth_expiration_time", 900], ["slug", "nisi_doloribus"], ["brand_id", 32], ["user_id", 48], ["created_at", "2017-07-28 07:55:14.626042"], ["updated_at", "2017-07-28 07:55:14.626042"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Flowdesk"], ["created_at", "2017-07-28 07:55:14.634767"], ["updated_at", "2017-07-28 07:55:14.634767"], ["local_path", "http://ward.co/taurean.walker"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Veribet"], ["title_ru", "Название33"], ["created_at", "2017-07-28 07:55:14.640032"], ["updated_at", "2017-07-28 07:55:14.640032"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 33[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_33[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 33) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>33, "title"=>"Flowdesk", "created_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "local_path"=>"http://ward.co/taurean.walker"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "fintone"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "fintone"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Fintone"], ["category_id", 33], ["slug", "fintone"], ["created_at", "2017-07-28 07:55:14.651623"], ["updated_at", "2017-07-28 07:55:14.651623"], ["layout_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "beulah"], ["email", "taya@auergleichner.io"], ["password", "Ah8u2dN6W9"], ["created_at", "2017-07-28 07:55:14.656471"], ["updated_at", "2017-07-28 07:55:14.656471"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "qui-voluptas"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Wrapsafe"], ["phone", "723.523.7082"], ["address", "52928 Tania Squares"], ["url", "http://okunevagorczany.biz/corrine"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://herman.name/logan"], ["auth_expiration_time", 900], ["slug", "qui-voluptas"], ["brand_id", 33], ["user_id", 49], ["created_at", "2017-07-28 07:55:14.662271"], ["updated_at", "2017-07-28 07:55:14.662271"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jalon_davis"], ["email", "yvette.boyer@shanahanjacobs.name"], ["password", "08J9Nj82Gx2b"], ["created_at", "2017-07-28 07:55:14.667587"], ["updated_at", "2017-07-28 07:55:14.667587"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5335"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5335"], ["comment", "comment 15"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "131.190.30.216"], ["router_admin_ip", "57.169.198.138"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "867"], ["status", "t"], ["location_id", 33], ["user_id", 50], ["created_at", "2017-07-28 07:55:14.673023"], ["updated_at", "2017-07-28 07:55:14.673023"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5335"], ["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 5], ["serial", "643705CA5E36/5335"], ["comment", "comment 15"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "131.190.30.216"], ["router_admin_ip", "57.169.198.138"], ["admin_password", "eee7501cc2e27022"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "5"], ["status", "t"], ["location_id", 33], ["user_id", 50], ["created_at", "2017-07-28 07:55:14.673023"], ["updated_at", "2017-07-28 07:55:14.673023"], ["id", 5]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: db759285-b99d-4986-bc11-ad654076c7c5) to Async(routers) with arguments: #<GlobalID:0x007fcffbeda968 @uri=#<URI::GID gid://wifi-management/Router/5>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 8b253588-3fe1-4dd7-b7f5-37e5cbde0b65) to Async(routers) with arguments: #<GlobalID:0x007fcffbeda968 @uri=#<URI::GID gid://wifi-management/Router/5>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 5], ["provider", "instagram"], ["location_id", 32], ["router_id", 5], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:14 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"tyreek_pouros", "email"=>"yasmin.brakus@douglas.com", "password"=>"ViLu82LtPq", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"tyreek_pouros", :email=>"yasmin.brakus@douglas.com", :password=>"ViLu82LtPq", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"yasmin.brakus@douglas.com", "password"=>"ViLu82LtPq"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "tyreek_pouros"], ["email", "yasmin.brakus@douglas.com"], ["password", "ViLu82LtPq"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 48, username: "tyreek_pouros", email: "yasmin.brakus@douglas.com", password: "ViLu82LtPq", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:55:14", updated_at: "2017-07-28 07:55:14", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 48[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/locations_list" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:14 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#locations_list[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_48[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 48) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 48]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>48, "username"=>"tyreek_pouros", "email"=>"yasmin.brakus@douglas.com", "password"=>"ViLu82LtPq", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"locations_list"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_48[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_48[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>48, :username=>"tyreek_pouros", :email=>"yasmin.brakus@douglas.com", :password=>"ViLu82LtPq", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:55:14.593Z", :updated_at=>"2017-07-28T07:55:14.593Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 48[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Load (0.7ms)[0m  [1m[34mSELECT "locations".* FROM "locations" WHERE "locations"."user_id" = 48[0m
[INFO ] Completed [32m200 OK[0m in 23ms [30m(Views: 0.2ms | ActiveRecord: 5.2ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-760-450-3898 x121"], ["created_at", "2017-07-28 07:55:14.777310"], ["updated_at", "2017-07-28 07:55:14.777310"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "cleveland.yost"], ["email", "elda@spinkakerluke.io"], ["password", "AnHgKgEdZs7nVp8"], ["created_at", "2017-07-28 07:55:14.782213"], ["updated_at", "2017-07-28 07:55:14.782213"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "53759"], ["username", "taylor"], ["image", "http://facebook.com/img/taylor.jpg"], ["profile", "https://facebook.com/taylor"], ["email", "jazmyne@collins.biz"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 21], ["user_id", 51], ["created_at", "2017-07-28 07:55:14.786604"], ["updated_at", "2017-07-28 07:55:14.786604"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Toughjoyfax"], ["created_at", "2017-07-28 07:55:14.793711"], ["updated_at", "2017-07-28 07:55:14.793711"], ["local_path", "http://willms.biz/shaina_koepp"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Greenlam"], ["title_ru", "Название34"], ["created_at", "2017-07-28 07:55:14.797430"], ["updated_at", "2017-07-28 07:55:14.797430"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 34[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_34[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 34) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>34, "title"=>"Toughjoyfax", "created_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "local_path"=>"http://willms.biz/shaina_koepp"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitchip"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitchip"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bitchip"], ["category_id", 34], ["slug", "bitchip"], ["created_at", "2017-07-28 07:55:14.808767"], ["updated_at", "2017-07-28 07:55:14.808767"], ["layout_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "numquam.tempora"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Flexidy"], ["phone", "1-985-957-2667"], ["address", "620 Misael Summit"], ["url", "http://hettinger.io/jillian"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://runolfon.info/salvatore.mohr"], ["auth_expiration_time", 900], ["slug", "numquam.tempora"], ["brand_id", 34], ["user_id", 51], ["created_at", "2017-07-28 07:55:14.814289"], ["updated_at", "2017-07-28 07:55:14.814289"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Lotstring"], ["created_at", "2017-07-28 07:55:14.822501"], ["updated_at", "2017-07-28 07:55:14.822501"], ["local_path", "http://keeblermorar.io/ofelia.leffler"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Pannier"], ["title_ru", "Название35"], ["created_at", "2017-07-28 07:55:14.826272"], ["updated_at", "2017-07-28 07:55:14.826272"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 35[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_35[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 35) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>35, "title"=>"Lotstring", "created_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "local_path"=>"http://keeblermorar.io/ofelia.leffler"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zathin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zathin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zathin"], ["category_id", 35], ["slug", "zathin"], ["created_at", "2017-07-28 07:55:14.836837"], ["updated_at", "2017-07-28 07:55:14.836837"], ["layout_id", 35]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "rex.crona"], ["email", "jaron@bergekeebler.biz"], ["password", "14ZvYg7b"], ["created_at", "2017-07-28 07:55:14.841599"], ["updated_at", "2017-07-28 07:55:14.841599"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quisquam_ut"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Wrapsafe"], ["phone", "1-153-846-5535"], ["address", "89670 Juliana Circles"], ["url", "http://cronaleannon.biz/elliot_okon"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://jerdewilderman.io/haylee_wolff"], ["auth_expiration_time", 900], ["slug", "quisquam_ut"], ["brand_id", 35], ["user_id", 52], ["created_at", "2017-07-28 07:55:14.847096"], ["updated_at", "2017-07-28 07:55:14.847096"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "amari"], ["email", "ruell.prosacco@weinat.biz"], ["password", "EvM1P2Ix"], ["created_at", "2017-07-28 07:55:14.852328"], ["updated_at", "2017-07-28 07:55:14.852328"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5336"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5336"], ["comment", "comment 16"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "42.153.164.21"], ["router_admin_ip", "190.176.144.13"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "903"], ["status", "t"], ["location_id", 35], ["user_id", 53], ["created_at", "2017-07-28 07:55:14.857623"], ["updated_at", "2017-07-28 07:55:14.857623"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5336"], ["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 6], ["serial", "643705CA5E36/5336"], ["comment", "comment 16"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "42.153.164.21"], ["router_admin_ip", "190.176.144.13"], ["admin_password", "29bc0808ab6f9342"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "6"], ["status", "t"], ["location_id", 35], ["user_id", 53], ["created_at", "2017-07-28 07:55:14.857623"], ["updated_at", "2017-07-28 07:55:14.857623"], ["id", 6]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: c9f1e0db-2fad-40f0-afe3-dbaedbd2ae46) to Async(routers) with arguments: #<GlobalID:0x007fd000470ef0 @uri=#<URI::GID gid://wifi-management/Router/6>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: be375384-5dff-4628-b2a1-8ad96bb62691) to Async(routers) with arguments: #<GlobalID:0x007fd000470ef0 @uri=#<URI::GID gid://wifi-management/Router/6>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 6], ["provider", "instagram"], ["location_id", 34], ["router_id", 6], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:14 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"cleveland.yost", "email"=>"elda@spinkakerluke.io", "password"=>"AnHgKgEdZs7nVp8", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"cleveland.yost", :email=>"elda@spinkakerluke.io", :password=>"AnHgKgEdZs7nVp8", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"elda@spinkakerluke.io", "password"=>"AnHgKgEdZs7nVp8"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "cleveland.yost"], ["email", "elda@spinkakerluke.io"], ["password", "AnHgKgEdZs7nVp8"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 51, username: "cleveland.yost", email: "elda@spinkakerluke.io", password: "AnHgKgEdZs7nVp8", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:55:14", updated_at: "2017-07-28 07:55:14", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 51[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/all_connects" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:14 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#all_connects[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_51[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 51) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 51]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>51, "username"=>"cleveland.yost", "email"=>"elda@spinkakerluke.io", "password"=>"AnHgKgEdZs7nVp8", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:14 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"all_connects"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_51[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_51[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>51, :username=>"cleveland.yost", :email=>"elda@spinkakerluke.io", :password=>"AnHgKgEdZs7nVp8", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:55:14.782Z", :updated_at=>"2017-07-28T07:55:14.782Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 51[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 34[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 34 AND ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-06-28 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 34 AND ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 26ms [30m(Views: 0.2ms | ActiveRecord: 7.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(873) 398-6605 x30582"], ["created_at", "2017-07-28 07:55:14.997185"], ["updated_at", "2017-07-28 07:55:14.997185"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "laurine_feest"], ["email", "quinn_grady@schroeder.net"], ["password", "Z588H7H6Z9PxFdF"], ["created_at", "2017-07-28 07:55:15.002126"], ["updated_at", "2017-07-28 07:55:15.002126"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "473349"], ["username", "carley.kihn"], ["image", "http://vk.com/img/carley.kihn.jpg"], ["profile", "https://vk.com/carley.kihn"], ["email", "finn@durgan.biz"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 22], ["user_id", 54], ["created_at", "2017-07-28 07:55:15.006460"], ["updated_at", "2017-07-28 07:55:15.006460"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Holdlamis"], ["created_at", "2017-07-28 07:55:15.013967"], ["updated_at", "2017-07-28 07:55:15.013967"], ["local_path", "http://doyle.name/anahi"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Kanlam"], ["title_ru", "Название36"], ["created_at", "2017-07-28 07:55:15.018071"], ["updated_at", "2017-07-28 07:55:15.018071"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_36[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 36) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>36, "title"=>"Holdlamis", "created_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "local_path"=>"http://doyle.name/anahi"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bigtax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bigtax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bigtax"], ["category_id", 36], ["slug", "bigtax"], ["created_at", "2017-07-28 07:55:15.029612"], ["updated_at", "2017-07-28 07:55:15.029612"], ["layout_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "repellendus.nulla"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Trippledex"], ["phone", "(268) 513-8208"], ["address", "1041 Stracke Manors"], ["url", "http://thiel.co/evie"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ebert.net/gabriel"], ["auth_expiration_time", 900], ["slug", "repellendus.nulla"], ["brand_id", 36], ["user_id", 54], ["created_at", "2017-07-28 07:55:15.035337"], ["updated_at", "2017-07-28 07:55:15.035337"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Konklab"], ["created_at", "2017-07-28 07:55:15.043954"], ["updated_at", "2017-07-28 07:55:15.043954"], ["local_path", "http://wittingquitzon.biz/meta"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Alpha"], ["title_ru", "Название37"], ["created_at", "2017-07-28 07:55:15.047864"], ["updated_at", "2017-07-28 07:55:15.047864"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 37[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_37[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 37) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>37, "title"=>"Konklab", "created_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "local_path"=>"http://wittingquitzon.biz/meta"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "fix-san"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "fix-san"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Fix San"], ["category_id", 37], ["slug", "fix-san"], ["created_at", "2017-07-28 07:55:15.058954"], ["updated_at", "2017-07-28 07:55:15.058954"], ["layout_id", 37]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "larue.steuber"], ["email", "alta_sporer@mcdermottdaniel.info"], ["password", "TwFcO7NkNfMcU0W"], ["created_at", "2017-07-28 07:55:15.063947"], ["updated_at", "2017-07-28 07:55:15.063947"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "qui_impedit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Ronstring"], ["phone", "(102) 164-4807"], ["address", "59721 Herzog Summit"], ["url", "http://bashirianturner.net/phoebe"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://carter.co/ayden.swaniawski"], ["auth_expiration_time", 900], ["slug", "qui_impedit"], ["brand_id", 37], ["user_id", 55], ["created_at", "2017-07-28 07:55:15.069587"], ["updated_at", "2017-07-28 07:55:15.069587"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "laurie.littel"], ["email", "titus_kohler@rosenbaum.net"], ["password", "2oHkGyFp80972"], ["created_at", "2017-07-28 07:55:15.075024"], ["updated_at", "2017-07-28 07:55:15.075024"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5337"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5337"], ["comment", "comment 17"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "214.7.69.44"], ["router_admin_ip", "110.175.69.162"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "72"], ["status", "t"], ["location_id", 37], ["user_id", 56], ["created_at", "2017-07-28 07:55:15.080865"], ["updated_at", "2017-07-28 07:55:15.080865"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5337"], ["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 7], ["serial", "643705CA5E36/5337"], ["comment", "comment 17"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "214.7.69.44"], ["router_admin_ip", "110.175.69.162"], ["admin_password", "156624192fe7b789"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "7"], ["status", "t"], ["location_id", 37], ["user_id", 56], ["created_at", "2017-07-28 07:55:15.080865"], ["updated_at", "2017-07-28 07:55:15.080865"], ["id", 7]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 927e40ce-7440-4868-b5cd-de91c77b169a) to Async(routers) with arguments: #<GlobalID:0x007fcffca11ef8 @uri=#<URI::GID gid://wifi-management/Router/7>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 13a76ec6-4a0d-405f-956b-5d4875d40152) to Async(routers) with arguments: #<GlobalID:0x007fcffca11ef8 @uri=#<URI::GID gid://wifi-management/Router/7>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.4ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 7], ["provider", "instagram"], ["location_id", 36], ["router_id", 7], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:15 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"laurine_feest", "email"=>"quinn_grady@schroeder.net", "password"=>"Z588H7H6Z9PxFdF", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"laurine_feest", :email=>"quinn_grady@schroeder.net", :password=>"Z588H7H6Z9PxFdF", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"quinn_grady@schroeder.net", "password"=>"Z588H7H6Z9PxFdF"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "laurine_feest"], ["email", "quinn_grady@schroeder.net"], ["password", "Z588H7H6Z9PxFdF"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 54, username: "laurine_feest", email: "quinn_grady@schroeder.net", password: "Z588H7H6Z9PxFdF", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:55:15", updated_at: "2017-07-28 07:55:15", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 54[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.1ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/new_old_users_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:15 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#new_old_users_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_54[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 54) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 54]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>54, "username"=>"laurine_feest", "email"=>"quinn_grady@schroeder.net", "password"=>"Z588H7H6Z9PxFdF", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"new_old_users_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_54[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_54[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>54, :username=>"laurine_feest", :email=>"quinn_grady@schroeder.net", :password=>"Z588H7H6Z9PxFdF", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:55:15.002Z", :updated_at=>"2017-07-28T07:55:15.002Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 54[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.0ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" = 36 AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 37ms [30m(Views: 1.3ms | ActiveRecord: 12.2ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "981.681.3986"], ["created_at", "2017-07-28 07:55:15.262591"], ["updated_at", "2017-07-28 07:55:15.262591"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "quinten"], ["email", "stevie.vandervort@kubboyle.co"], ["password", "GkV2Nq4xRy"], ["created_at", "2017-07-28 07:55:15.267668"], ["updated_at", "2017-07-28 07:55:15.267668"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "621450"], ["username", "naomi"], ["image", "http://twitter.com/img/naomi.jpg"], ["profile", "https://twitter.com/naomi"], ["email", "kayley@haag.io"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 23], ["user_id", 57], ["created_at", "2017-07-28 07:55:15.271540"], ["updated_at", "2017-07-28 07:55:15.271540"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Keylex"], ["created_at", "2017-07-28 07:55:15.279178"], ["updated_at", "2017-07-28 07:55:15.279178"], ["local_path", "http://wolff.org/nova_von"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Flexidy"], ["title_ru", "Название38"], ["created_at", "2017-07-28 07:55:15.282924"], ["updated_at", "2017-07-28 07:55:15.282924"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 38[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_38[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 38) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>38, "title"=>"Keylex", "created_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "local_path"=>"http://wolff.org/nova_von"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "vagram"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "vagram"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Vagram"], ["category_id", 38], ["slug", "vagram"], ["created_at", "2017-07-28 07:55:15.293918"], ["updated_at", "2017-07-28 07:55:15.293918"], ["layout_id", 38]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "facilis_saepe"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Quo Lux"], ["phone", "795.858.5575"], ["address", "2395 Kian Knolls"], ["url", "http://ondricka.net/ibrahim"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://beerbruen.name/pete"], ["auth_expiration_time", 900], ["slug", "facilis_saepe"], ["brand_id", 38], ["user_id", 57], ["created_at", "2017-07-28 07:55:15.299340"], ["updated_at", "2017-07-28 07:55:15.299340"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Sonsing"], ["created_at", "2017-07-28 07:55:15.307235"], ["updated_at", "2017-07-28 07:55:15.307235"], ["local_path", "http://bernier.biz/eugenia"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Matsoft"], ["title_ru", "Название39"], ["created_at", "2017-07-28 07:55:15.310996"], ["updated_at", "2017-07-28 07:55:15.310996"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_39[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 39) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>39, "title"=>"Sonsing", "created_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "local_path"=>"http://bernier.biz/eugenia"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zontrax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zontrax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zontrax"], ["category_id", 39], ["slug", "zontrax"], ["created_at", "2017-07-28 07:55:15.321333"], ["updated_at", "2017-07-28 07:55:15.321333"], ["layout_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "soledad"], ["email", "waldo_hettinger@deckow.name"], ["password", "XeU8P27a"], ["created_at", "2017-07-28 07:55:15.326039"], ["updated_at", "2017-07-28 07:55:15.326039"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.5ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "distinctio-dicta"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Toughjoyfax"], ["phone", "1-806-876-2497"], ["address", "789 Kulas Vista"], ["url", "http://leffler.co/amy"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://mertz.name/chelsea"], ["auth_expiration_time", 900], ["slug", "distinctio-dicta"], ["brand_id", 39], ["user_id", 58], ["created_at", "2017-07-28 07:55:15.332380"], ["updated_at", "2017-07-28 07:55:15.332380"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "leatha"], ["email", "leonardo@mayer.biz"], ["password", "FlXsVf31SwAt0"], ["created_at", "2017-07-28 07:55:15.337557"], ["updated_at", "2017-07-28 07:55:15.337557"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5338"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5338"], ["comment", "comment 18"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "54.65.231.213"], ["router_admin_ip", "36.174.114.165"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "674"], ["status", "t"], ["location_id", 39], ["user_id", 59], ["created_at", "2017-07-28 07:55:15.342751"], ["updated_at", "2017-07-28 07:55:15.342751"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5338"], ["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 8], ["serial", "643705CA5E36/5338"], ["comment", "comment 18"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "54.65.231.213"], ["router_admin_ip", "36.174.114.165"], ["admin_password", "6467d8aaaf66c15a"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "8"], ["status", "t"], ["location_id", 39], ["user_id", 59], ["created_at", "2017-07-28 07:55:15.342751"], ["updated_at", "2017-07-28 07:55:15.342751"], ["id", 8]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: e97417d2-c667-4fce-a789-cdc8ea8f6a9b) to Async(routers) with arguments: #<GlobalID:0x007fd006994a48 @uri=#<URI::GID gid://wifi-management/Router/8>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: ce74d119-3e37-45e8-92e0-c428ff855316) to Async(routers) with arguments: #<GlobalID:0x007fd006994a48 @uri=#<URI::GID gid://wifi-management/Router/8>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.3ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 8], ["provider", "instagram"], ["location_id", 38], ["router_id", 8], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:15 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"quinten", "email"=>"stevie.vandervort@kubboyle.co", "password"=>"GkV2Nq4xRy", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"quinten", :email=>"stevie.vandervort@kubboyle.co", :password=>"GkV2Nq4xRy", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"stevie.vandervort@kubboyle.co", "password"=>"GkV2Nq4xRy"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "quinten"], ["email", "stevie.vandervort@kubboyle.co"], ["password", "GkV2Nq4xRy"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 57, username: "quinten", email: "stevie.vandervort@kubboyle.co", password: "GkV2Nq4xRy", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:55:15", updated_at: "2017-07-28 07:55:15", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 57[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/visitors_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:15 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#visitors_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_57[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 57) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 57]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>57, "username"=>"quinten", "email"=>"stevie.vandervort@kubboyle.co", "password"=>"GkV2Nq4xRy", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"visitors_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_57[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_57[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>57, :username=>"quinten", :email=>"stevie.vandervort@kubboyle.co", :password=>"GkV2Nq4xRy", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:55:15.267Z", :updated_at=>"2017-07-28T07:55:15.267Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 57[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.2ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" = 38 AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 24ms [30m(Views: 1.0ms | ActiveRecord: 7.2ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-749-313-6277 x945"], ["created_at", "2017-07-28 07:55:15.583138"], ["updated_at", "2017-07-28 07:55:15.583138"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "christ_white"], ["email", "bryon.price@strosin.io"], ["password", "2h6vXe8j5oSqVr"], ["created_at", "2017-07-28 07:55:15.587911"], ["updated_at", "2017-07-28 07:55:15.587911"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "460562"], ["username", "alexzander.mante"], ["image", "http://vk.com/img/alexzander.mante.jpg"], ["profile", "https://vk.com/alexzander.mante"], ["email", "natalia.streich@johnsonkoepp.name"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 24], ["user_id", 60], ["created_at", "2017-07-28 07:55:15.591938"], ["updated_at", "2017-07-28 07:55:15.591938"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Overhold"], ["created_at", "2017-07-28 07:55:15.598890"], ["updated_at", "2017-07-28 07:55:15.598890"], ["local_path", "http://wintheiserwill.org/rudy"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Overhold"], ["title_ru", "Название40"], ["created_at", "2017-07-28 07:55:15.602681"], ["updated_at", "2017-07-28 07:55:15.602681"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 40[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_40[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 40) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>40, "title"=>"Overhold", "created_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "local_path"=>"http://wintheiserwill.org/rudy"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cookley"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cookley"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Cookley"], ["category_id", 40], ["slug", "cookley"], ["created_at", "2017-07-28 07:55:15.613670"], ["updated_at", "2017-07-28 07:55:15.613670"], ["layout_id", 40]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "dolores_praesentium"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Home Ing"], ["phone", "(358) 203-3210"], ["address", "1277 Shawna Crest"], ["url", "http://weber.io/madie_gulgowski"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kub.co/jett"], ["auth_expiration_time", 900], ["slug", "dolores_praesentium"], ["brand_id", 40], ["user_id", 60], ["created_at", "2017-07-28 07:55:15.619241"], ["updated_at", "2017-07-28 07:55:15.619241"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Holdlamis"], ["created_at", "2017-07-28 07:55:15.640897"], ["updated_at", "2017-07-28 07:55:15.640897"], ["local_path", "http://oconnell.org/cedrick"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Span"], ["title_ru", "Название41"], ["created_at", "2017-07-28 07:55:15.645128"], ["updated_at", "2017-07-28 07:55:15.645128"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 41[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_41[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 41) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>41, "title"=>"Holdlamis", "created_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "local_path"=>"http://oconnell.org/cedrick"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zamit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zamit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zamit"], ["category_id", 41], ["slug", "zamit"], ["created_at", "2017-07-28 07:55:15.656101"], ["updated_at", "2017-07-28 07:55:15.656101"], ["layout_id", 41]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "mariana_lindgren"], ["email", "kyler@batz.com"], ["password", "1n7b3m9b3gN0"], ["created_at", "2017-07-28 07:55:15.660843"], ["updated_at", "2017-07-28 07:55:15.660843"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "iste.animi"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Rank"], ["phone", "(857) 726-9513"], ["address", "98620 Kohler Field"], ["url", "http://breitenberg.name/ollie"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://bogisichbogisich.biz/cora"], ["auth_expiration_time", 900], ["slug", "iste.animi"], ["brand_id", 41], ["user_id", 61], ["created_at", "2017-07-28 07:55:15.666591"], ["updated_at", "2017-07-28 07:55:15.666591"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "bartholome.moen"], ["email", "cristina@dibbert.biz"], ["password", "Ca7612Ew"], ["created_at", "2017-07-28 07:55:15.672001"], ["updated_at", "2017-07-28 07:55:15.672001"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5339"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5339"], ["comment", "comment 19"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "102.59.2.253"], ["router_admin_ip", "189.203.187.147"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "261"], ["status", "t"], ["location_id", 41], ["user_id", 62], ["created_at", "2017-07-28 07:55:15.677614"], ["updated_at", "2017-07-28 07:55:15.677614"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5339"], ["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 9], ["serial", "643705CA5E36/5339"], ["comment", "comment 19"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "102.59.2.253"], ["router_admin_ip", "189.203.187.147"], ["admin_password", "1305763d536d649e"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "9"], ["status", "t"], ["location_id", 41], ["user_id", 62], ["created_at", "2017-07-28 07:55:15.677614"], ["updated_at", "2017-07-28 07:55:15.677614"], ["id", 9]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 716c3684-225c-4357-b6ad-409e7b87cc57) to Async(routers) with arguments: #<GlobalID:0x007fcffceb18f0 @uri=#<URI::GID gid://wifi-management/Router/9>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 2e26ce1a-989c-4dd4-bc7e-a55b237b8bff) to Async(routers) with arguments: #<GlobalID:0x007fcffceb18f0 @uri=#<URI::GID gid://wifi-management/Router/9>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 9], ["provider", "instagram"], ["location_id", 40], ["router_id", 9], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(453) 288-6807 x3859"], ["created_at", "2017-07-28 07:55:15.758440"], ["updated_at", "2017-07-28 07:55:15.758440"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "hoyt"], ["email", "dino_schoen@bauchfeest.co"], ["password", "Dy5l8oW387Cn2o"], ["created_at", "2017-07-28 07:55:15.763546"], ["updated_at", "2017-07-28 07:55:15.763546"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "812150"], ["username", "lauren"], ["image", "http://instagram.com/img/lauren.jpg"], ["profile", "https://instagram.com/lauren"], ["email", "ciara@fay.com"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 25], ["user_id", 63], ["created_at", "2017-07-28 07:55:15.767449"], ["updated_at", "2017-07-28 07:55:15.767449"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Daltfresh"], ["created_at", "2017-07-28 07:55:15.776029"], ["updated_at", "2017-07-28 07:55:15.776029"], ["local_path", "http://klein.net/annamarie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Gembucket"], ["title_ru", "Название42"], ["created_at", "2017-07-28 07:55:15.780339"], ["updated_at", "2017-07-28 07:55:15.780339"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_42[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 42) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>42, "title"=>"Daltfresh", "created_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "local_path"=>"http://klein.net/annamarie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cardify"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cardify"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Cardify"], ["category_id", 42], ["slug", "cardify"], ["created_at", "2017-07-28 07:55:15.791596"], ["updated_at", "2017-07-28 07:55:15.791596"], ["layout_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quam-nemo"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Home Ing"], ["phone", "(872) 797-9150"], ["address", "437 Goyette Coves"], ["url", "http://adams.org/kayli"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://swift.io/elvis"], ["auth_expiration_time", 900], ["slug", "quam-nemo"], ["brand_id", 42], ["user_id", 63], ["created_at", "2017-07-28 07:55:15.797642"], ["updated_at", "2017-07-28 07:55:15.797642"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Mat Lam Tam"], ["created_at", "2017-07-28 07:55:15.806141"], ["updated_at", "2017-07-28 07:55:15.806141"], ["local_path", "http://hodkiewiczjast.biz/german"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Stronghold"], ["title_ru", "Название43"], ["created_at", "2017-07-28 07:55:15.810003"], ["updated_at", "2017-07-28 07:55:15.810003"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 43[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_43[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 43) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>43, "title"=>"Mat Lam Tam", "created_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "local_path"=>"http://hodkiewiczjast.biz/german"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "keylex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "keylex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Keylex"], ["category_id", 43], ["slug", "keylex"], ["created_at", "2017-07-28 07:55:15.820454"], ["updated_at", "2017-07-28 07:55:15.820454"], ["layout_id", 43]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "hillard"], ["email", "nikko.tremblay@donnellyheel.com"], ["password", "WqIp8fF990"], ["created_at", "2017-07-28 07:55:15.825169"], ["updated_at", "2017-07-28 07:55:15.825169"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "qui-suscipit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Subin"], ["phone", "(565) 004-9541"], ["address", "80461 Beier Street"], ["url", "http://kozey.co/tommie.dickens"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://muraziklittle.com/terrance.haley"], ["auth_expiration_time", 900], ["slug", "qui-suscipit"], ["brand_id", 43], ["user_id", 64], ["created_at", "2017-07-28 07:55:15.830751"], ["updated_at", "2017-07-28 07:55:15.830751"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "orval_thiel"], ["email", "emely@schmidt.net"], ["password", "HaBoLkWeNy572nSi"], ["created_at", "2017-07-28 07:55:15.835972"], ["updated_at", "2017-07-28 07:55:15.835972"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53310"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53310"], ["comment", "comment 110"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "111.185.179.60"], ["router_admin_ip", "41.51.124.133"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "709"], ["status", "t"], ["location_id", 43], ["user_id", 65], ["created_at", "2017-07-28 07:55:15.841231"], ["updated_at", "2017-07-28 07:55:15.841231"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53310"], ["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 10], ["serial", "643705CA5E36/53310"], ["comment", "comment 110"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "111.185.179.60"], ["router_admin_ip", "41.51.124.133"], ["admin_password", "c55f734161036d07"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "10"], ["status", "t"], ["location_id", 43], ["user_id", 65], ["created_at", "2017-07-28 07:55:15.841231"], ["updated_at", "2017-07-28 07:55:15.841231"], ["id", 10]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 4274166e-217d-47e7-8c60-6d48a04928f1) to Async(routers) with arguments: #<GlobalID:0x007fd0069e0e70 @uri=#<URI::GID gid://wifi-management/Router/10>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 6a676fb7-5acf-49d0-9394-ed203f2adcfc) to Async(routers) with arguments: #<GlobalID:0x007fd0069e0e70 @uri=#<URI::GID gid://wifi-management/Router/10>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 10], ["provider", "instagram"], ["location_id", 42], ["router_id", 10], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:16 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"hoyt", "email"=>"dino_schoen@bauchfeest.co", "password"=>"Dy5l8oW387Cn2o", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"hoyt", :email=>"dino_schoen@bauchfeest.co", :password=>"Dy5l8oW387Cn2o", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"dino_schoen@bauchfeest.co", "password"=>"Dy5l8oW387Cn2o"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "hoyt"], ["email", "dino_schoen@bauchfeest.co"], ["password", "Dy5l8oW387Cn2o"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 63, username: "hoyt", email: "dino_schoen@bauchfeest.co", password: "Dy5l8oW387Cn2o", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:55:15", updated_at: "2017-07-28 07:55:15", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 63[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/age_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:16 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#age_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 63[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_63[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 63) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 63]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>63, "username"=>"hoyt", "email"=>"dino_schoen@bauchfeest.co", "password"=>"Dy5l8oW387Cn2o", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:15 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"age_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 63[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_63[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 63[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_63[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>63, :username=>"hoyt", :email=>"dino_schoen@bauchfeest.co", :password=>"Dy5l8oW387Cn2o", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:55:15.763Z", :updated_at=>"2017-07-28T07:55:15.763Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 63[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.2ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(42) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 25ms [30m(Views: 1.3ms | ActiveRecord: 8.3ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "959-630-5248 x24637"], ["created_at", "2017-07-28 07:55:16.095584"], ["updated_at", "2017-07-28 07:55:16.095584"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "gerson"], ["email", "tianna_olson@mckenzie.name"], ["password", "R7HqUuV659M2Pu"], ["created_at", "2017-07-28 07:55:16.100486"], ["updated_at", "2017-07-28 07:55:16.100486"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "674859"], ["username", "jenifer.powlowski"], ["image", "http://instagram.com/img/jenifer.powlowski.jpg"], ["profile", "https://instagram.com/jenifer.powlowski"], ["email", "werner@hahn.name"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 26], ["user_id", 66], ["created_at", "2017-07-28 07:55:16.104643"], ["updated_at", "2017-07-28 07:55:16.104643"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Ronstring"], ["created_at", "2017-07-28 07:55:16.112222"], ["updated_at", "2017-07-28 07:55:16.112222"], ["local_path", "http://simonis.name/theo"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Span"], ["title_ru", "Название44"], ["created_at", "2017-07-28 07:55:16.116293"], ["updated_at", "2017-07-28 07:55:16.116293"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 44[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_44[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 44) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>44, "title"=>"Ronstring", "created_at"=>Fri, 28 Jul 2017 07:55:16 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:16 UTC +00:00, "local_path"=>"http://simonis.name/theo"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "duobam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "duobam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Duobam"], ["category_id", 44], ["slug", "duobam"], ["created_at", "2017-07-28 07:55:16.128167"], ["updated_at", "2017-07-28 07:55:16.128167"], ["layout_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "recusandae.nobis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bamity"], ["phone", "(761) 443-6275"], ["address", "1681 Candelario Terrace"], ["url", "http://metz.info/lowell"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kerluke.co/gregoria_brakus"], ["auth_expiration_time", 900], ["slug", "recusandae.nobis"], ["brand_id", 44], ["user_id", 66], ["created_at", "2017-07-28 07:55:16.134035"], ["updated_at", "2017-07-28 07:55:16.134035"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Andalax"], ["created_at", "2017-07-28 07:55:16.142427"], ["updated_at", "2017-07-28 07:55:16.142427"], ["local_path", "http://schroeder.name/jettie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Konklux"], ["title_ru", "Название45"], ["created_at", "2017-07-28 07:55:16.146211"], ["updated_at", "2017-07-28 07:55:16.146211"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 45[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_45[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 45) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>45, "title"=>"Andalax", "created_at"=>Fri, 28 Jul 2017 07:55:16 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:16 UTC +00:00, "local_path"=>"http://schroeder.name/jettie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "opela"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "opela"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Opela"], ["category_id", 45], ["slug", "opela"], ["created_at", "2017-07-28 07:55:16.156568"], ["updated_at", "2017-07-28 07:55:16.156568"], ["layout_id", 45]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "frederique"], ["email", "shirley@jaskolski.biz"], ["password", "8dQk3cWuBrZ"], ["created_at", "2017-07-28 07:55:16.161210"], ["updated_at", "2017-07-28 07:55:16.161210"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "accusamus_rem"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Namfix"], ["phone", "227.462.1694"], ["address", "48955 Hattie Plains"], ["url", "http://breitenberg.co/julius.bode"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://weinatwolf.io/howard"], ["auth_expiration_time", 900], ["slug", "accusamus_rem"], ["brand_id", 45], ["user_id", 67], ["created_at", "2017-07-28 07:55:16.166602"], ["updated_at", "2017-07-28 07:55:16.166602"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ulices_keler"], ["email", "lazaro_upton@kaulkecartwright.info"], ["password", "TlL5IjNkWvFyA"], ["created_at", "2017-07-28 07:55:16.171689"], ["updated_at", "2017-07-28 07:55:16.171689"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53311"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53311"], ["comment", "comment 111"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "204.79.66.92"], ["router_admin_ip", "41.199.220.213"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "43"], ["status", "t"], ["location_id", 45], ["user_id", 68], ["created_at", "2017-07-28 07:55:16.177086"], ["updated_at", "2017-07-28 07:55:16.177086"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53311"], ["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 11], ["serial", "643705CA5E36/53311"], ["comment", "comment 111"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "204.79.66.92"], ["router_admin_ip", "41.199.220.213"], ["admin_password", "53e0577c5d245a09"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "11"], ["status", "t"], ["location_id", 45], ["user_id", 68], ["created_at", "2017-07-28 07:55:16.177086"], ["updated_at", "2017-07-28 07:55:16.177086"], ["id", 11]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 68e5444e-5e66-4ae4-85de-506c42134f86) to Async(routers) with arguments: #<GlobalID:0x007fd009073df8 @uri=#<URI::GID gid://wifi-management/Router/11>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 11b3cb31-cbf8-4719-b4df-81dec209117e) to Async(routers) with arguments: #<GlobalID:0x007fd009073df8 @uri=#<URI::GID gid://wifi-management/Router/11>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.3ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 11], ["provider", "instagram"], ["location_id", 44], ["router_id", 11], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:16 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"gerson", "email"=>"tianna_olson@mckenzie.name", "password"=>"R7HqUuV659M2Pu", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"gerson", :email=>"tianna_olson@mckenzie.name", :password=>"R7HqUuV659M2Pu", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"tianna_olson@mckenzie.name", "password"=>"R7HqUuV659M2Pu"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "gerson"], ["email", "tianna_olson@mckenzie.name"], ["password", "R7HqUuV659M2Pu"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 66, username: "gerson", email: "tianna_olson@mckenzie.name", password: "R7HqUuV659M2Pu", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:55:16", updated_at: "2017-07-28 07:55:16", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 66[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/gender_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:16 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#gender_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 66[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_66[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 66) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 66]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>66, "username"=>"gerson", "email"=>"tianna_olson@mckenzie.name", "password"=>"R7HqUuV659M2Pu", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:16 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:16 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"gender_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 66[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_66[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 66[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_66[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>66, :username=>"gerson", :email=>"tianna_olson@mckenzie.name", :password=>"R7HqUuV659M2Pu", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:55:16.100Z", :updated_at=>"2017-07-28T07:55:16.100Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 66[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[34mSELECT DISTINCT COUNT(DISTINCT social_accounts.id) AS count_social_accounts_id, "gender" AS gender FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" = 44 AND ("social_logs"."updated_at" BETWEEN $1 AND $2) GROUP BY "gender"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 25ms [30m(Views: 1.2ms | ActiveRecord: 6.7ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "842-168-6778 x683"], ["created_at", "2017-07-28 07:55:16.406283"], ["updated_at", "2017-07-28 07:55:16.406283"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "aleandro_ledner"], ["email", "dawson@dach.org"], ["password", "J0KdK8UqRxT747Be"], ["created_at", "2017-07-28 07:55:16.411429"], ["updated_at", "2017-07-28 07:55:16.411429"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "409333"], ["username", "demarcus.nolan"], ["image", "http://instagram.com/img/demarcus.nolan.jpg"], ["profile", "https://instagram.com/demarcus.nolan"], ["email", "mallie.kunze@wilderman.biz"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 27], ["user_id", 69], ["created_at", "2017-07-28 07:55:16.415617"], ["updated_at", "2017-07-28 07:55:16.415617"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Rank"], ["created_at", "2017-07-28 07:55:16.423237"], ["updated_at", "2017-07-28 07:55:16.423237"], ["local_path", "http://rice.net/billie_sauer"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bamity"], ["title_ru", "Название46"], ["created_at", "2017-07-28 07:55:16.426968"], ["updated_at", "2017-07-28 07:55:16.426968"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 46[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_46[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 46) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>46, "title"=>"Rank", "created_at"=>Fri, 28 Jul 2017 07:55:16 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:16 UTC +00:00, "local_path"=>"http://rice.net/billie_sauer"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "regrant"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "regrant"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Regrant"], ["category_id", 46], ["slug", "regrant"], ["created_at", "2017-07-28 07:55:16.438227"], ["updated_at", "2017-07-28 07:55:16.438227"], ["layout_id", 46]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "maiores_eos"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tampflex"], ["phone", "1-727-274-3906"], ["address", "5011 Jaylin Fort"], ["url", "http://runolfon.biz/jacynthe"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ryan.biz/damaris"], ["auth_expiration_time", 900], ["slug", "maiores_eos"], ["brand_id", 46], ["user_id", 69], ["created_at", "2017-07-28 07:55:16.444461"], ["updated_at", "2017-07-28 07:55:16.444461"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Biodex"], ["created_at", "2017-07-28 07:55:16.453084"], ["updated_at", "2017-07-28 07:55:16.453084"], ["local_path", "http://satterfieldschmitt.org/freeda.murray"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Vagram"], ["title_ru", "Название47"], ["created_at", "2017-07-28 07:55:16.456829"], ["updated_at", "2017-07-28 07:55:16.456829"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 47[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_47[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 47) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>47, "title"=>"Biodex", "created_at"=>Fri, 28 Jul 2017 07:55:16 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:16 UTC +00:00, "local_path"=>"http://satterfieldschmitt.org/freeda.murray"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "prodder"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "prodder"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Prodder"], ["category_id", 47], ["slug", "prodder"], ["created_at", "2017-07-28 07:55:16.467348"], ["updated_at", "2017-07-28 07:55:16.467348"], ["layout_id", 47]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "laurine"], ["email", "keara@grimes.biz"], ["password", "MuXd92HcTlCiCt"], ["created_at", "2017-07-28 07:55:16.471994"], ["updated_at", "2017-07-28 07:55:16.471994"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et.porro"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Y-Solowarm"], ["phone", "856-233-9686"], ["address", "9409 Bradtke Heights"], ["url", "http://kuhlmanwitting.io/tyshawn_rolfson"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://pagac.biz/domenic"], ["auth_expiration_time", 900], ["slug", "et.porro"], ["brand_id", 47], ["user_id", 70], ["created_at", "2017-07-28 07:55:16.477353"], ["updated_at", "2017-07-28 07:55:16.477353"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "catherine.parker"], ["email", "valentina@damore.io"], ["password", "U60vVjPo6tDj"], ["created_at", "2017-07-28 07:55:16.482565"], ["updated_at", "2017-07-28 07:55:16.482565"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53312"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53312"], ["comment", "comment 112"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "98.32.172.150"], ["router_admin_ip", "155.203.54.207"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "848"], ["status", "t"], ["location_id", 47], ["user_id", 71], ["created_at", "2017-07-28 07:55:16.487943"], ["updated_at", "2017-07-28 07:55:16.487943"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53312"], ["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 12], ["serial", "643705CA5E36/53312"], ["comment", "comment 112"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "98.32.172.150"], ["router_admin_ip", "155.203.54.207"], ["admin_password", "59d1aba605cbf433"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "12"], ["status", "t"], ["location_id", 47], ["user_id", 71], ["created_at", "2017-07-28 07:55:16.487943"], ["updated_at", "2017-07-28 07:55:16.487943"], ["id", 12]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 4f0b4d9d-f94c-4e65-99dd-25df6f4ed664) to Async(routers) with arguments: #<GlobalID:0x007fd00153ede0 @uri=#<URI::GID gid://wifi-management/Router/12>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: e4bcd80e-f65c-4846-b6e1-5e0064b3a835) to Async(routers) with arguments: #<GlobalID:0x007fd00153ede0 @uri=#<URI::GID gid://wifi-management/Router/12>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.4ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 12], ["provider", "instagram"], ["location_id", 46], ["router_id", 12], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:16 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"aleandro_ledner", "email"=>"dawson@dach.org", "password"=>"J0KdK8UqRxT747Be", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"aleandro_ledner", :email=>"dawson@dach.org", :password=>"J0KdK8UqRxT747Be", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"dawson@dach.org", "password"=>"J0KdK8UqRxT747Be"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "aleandro_ledner"], ["email", "dawson@dach.org"], ["password", "J0KdK8UqRxT747Be"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 69, username: "aleandro_ledner", email: "dawson@dach.org", password: "J0KdK8UqRxT747Be", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:55:16", updated_at: "2017-07-28 07:55:16", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 69[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/new_old_users" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:16 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#new_old_users[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 69[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_69[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 69) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 69]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>69, "username"=>"aleandro_ledner", "email"=>"dawson@dach.org", "password"=>"J0KdK8UqRxT747Be", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:16 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:16 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"new_old_users"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 69[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_69[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 69[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_69[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>69, :username=>"aleandro_ledner", :email=>"dawson@dach.org", :password=>"J0KdK8UqRxT747Be", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:55:16.411Z", :updated_at=>"2017-07-28T07:55:16.411Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 69[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (4.7ms)[0m  [1m[34m
      select
        newusrs.chart_interval,
        ttlusrs.returning as returning_users,
        newusrs.new_users,
        ttlusrs.returning + newusrs.new_users as total
      from (select
          chart_interval,
          count (id) as new_users
        from (select
            distinct cl.id,
            date_trunc('day', dd)::date as chart_interval
          FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
          left outer join social_accounts sa on date_trunc('day', sa.created_at) = date_trunc('day', dd)
          left outer join clients cl on sa.client_id = cl.id
          join social_logs sl on sa.id = sl.social_account_id
            and location_id in(46)
      	  order by chart_interval) as chart
        group by chart_interval
        order by chart_interval
      ) as newusrs join (select
          date_trunc('day', dd):: date as chart_interval,
          count (distinct cl.id) as returning
        FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
        left outer join social_logs sl on date_trunc('day', sl.created_at) = date_trunc('day', dd)
          and location_id in(46)
        join social_accounts sa on sa.id = sl.social_account_id
        left outer join clients cl on date_trunc('day', cl.created_at) < date_trunc('day', dd)
          and sa.client_id = cl.id
        group by chart_interval
        order by chart_interval
      ) as ttlusrs on ttlusrs.chart_interval = newusrs.chart_interval[0m
[INFO ] Completed [32m200 OK[0m in 26ms [30m(Views: 0.6ms | ActiveRecord: 9.6ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-991-197-3705"], ["created_at", "2017-07-28 07:55:16.727602"], ["updated_at", "2017-07-28 07:55:16.727602"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "kolby"], ["email", "arianna.hirthe@walshhaley.biz"], ["password", "H8RxXaJ7Jb"], ["created_at", "2017-07-28 07:55:16.732435"], ["updated_at", "2017-07-28 07:55:16.732435"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "684998"], ["username", "ona.wunsch"], ["image", "http://facebook.com/img/ona.wunsch.jpg"], ["profile", "https://facebook.com/ona.wunsch"], ["email", "patricia.metz@crona.co"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 28], ["user_id", 72], ["created_at", "2017-07-28 07:55:16.736217"], ["updated_at", "2017-07-28 07:55:16.736217"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Hatity"], ["created_at", "2017-07-28 07:55:16.743450"], ["updated_at", "2017-07-28 07:55:16.743450"], ["local_path", "http://hickle.info/kayla_bins"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Aerified"], ["title_ru", "Название48"], ["created_at", "2017-07-28 07:55:16.747312"], ["updated_at", "2017-07-28 07:55:16.747312"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_48[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 48) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>48, "title"=>"Hatity", "created_at"=>Fri, 28 Jul 2017 07:55:16 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:16 UTC +00:00, "local_path"=>"http://hickle.info/kayla_bins"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "lotlux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "lotlux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Lotlux"], ["category_id", 48], ["slug", "lotlux"], ["created_at", "2017-07-28 07:55:16.758382"], ["updated_at", "2017-07-28 07:55:16.758382"], ["layout_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "sit_quae"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Flowdesk"], ["phone", "194-261-5708"], ["address", "9413 Paucek Canyon"], ["url", "http://haag.name/heath"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://armstrong.co/dino.anderson"], ["auth_expiration_time", 900], ["slug", "sit_quae"], ["brand_id", 48], ["user_id", 72], ["created_at", "2017-07-28 07:55:16.763816"], ["updated_at", "2017-07-28 07:55:16.763816"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "It"], ["created_at", "2017-07-28 07:55:16.772025"], ["updated_at", "2017-07-28 07:55:16.772025"], ["local_path", "http://connellyoreilly.org/alexanne"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Treeflex"], ["title_ru", "Название49"], ["created_at", "2017-07-28 07:55:16.775718"], ["updated_at", "2017-07-28 07:55:16.775718"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 49[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_49[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 49) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>49, "title"=>"It", "created_at"=>Fri, 28 Jul 2017 07:55:16 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:16 UTC +00:00, "local_path"=>"http://connellyoreilly.org/alexanne"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "quo-lux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Quo Lux"], ["category_id", 49], ["slug", "quo-lux"], ["created_at", "2017-07-28 07:55:16.786374"], ["updated_at", "2017-07-28 07:55:16.786374"], ["layout_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "claria"], ["email", "olaf@stromanmurray.net"], ["password", "5fDi1dO2SpWmJ"], ["created_at", "2017-07-28 07:55:16.791255"], ["updated_at", "2017-07-28 07:55:16.791255"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "nulla.et"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Namfix"], ["phone", "117.753.2442"], ["address", "2863 Howe Mission"], ["url", "http://lindgren.io/ima"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://abshire.org/cornell"], ["auth_expiration_time", 900], ["slug", "nulla.et"], ["brand_id", 49], ["user_id", 73], ["created_at", "2017-07-28 07:55:16.797127"], ["updated_at", "2017-07-28 07:55:16.797127"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "dorthy_windler"], ["email", "jewel.kilback@haley.co"], ["password", "JkNrCuPn"], ["created_at", "2017-07-28 07:55:16.802451"], ["updated_at", "2017-07-28 07:55:16.802451"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53313"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53313"], ["comment", "comment 113"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "58.186.141.219"], ["router_admin_ip", "213.160.216.151"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "668"], ["status", "t"], ["location_id", 49], ["user_id", 74], ["created_at", "2017-07-28 07:55:16.807867"], ["updated_at", "2017-07-28 07:55:16.807867"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53313"], ["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 13], ["serial", "643705CA5E36/53313"], ["comment", "comment 113"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "58.186.141.219"], ["router_admin_ip", "213.160.216.151"], ["admin_password", "61f5ab51d2e77b78"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "13"], ["status", "t"], ["location_id", 49], ["user_id", 74], ["created_at", "2017-07-28 07:55:16.807867"], ["updated_at", "2017-07-28 07:55:16.807867"], ["id", 13]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: aaa2275f-0a3a-496e-a27c-bc5bf8860eb7) to Async(routers) with arguments: #<GlobalID:0x007fd0073c8320 @uri=#<URI::GID gid://wifi-management/Router/13>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 216142b9-275c-4e9c-8e87-59a8ab3952e7) to Async(routers) with arguments: #<GlobalID:0x007fd0073c8320 @uri=#<URI::GID gid://wifi-management/Router/13>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 13], ["provider", "instagram"], ["location_id", 48], ["router_id", 13], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:17 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"kolby", "email"=>"arianna.hirthe@walshhaley.biz", "password"=>"H8RxXaJ7Jb", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"kolby", :email=>"arianna.hirthe@walshhaley.biz", :password=>"H8RxXaJ7Jb", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"arianna.hirthe@walshhaley.biz", "password"=>"H8RxXaJ7Jb"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "kolby"], ["email", "arianna.hirthe@walshhaley.biz"], ["password", "H8RxXaJ7Jb"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 72, username: "kolby", email: "arianna.hirthe@walshhaley.biz", password: "H8RxXaJ7Jb", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:55:16", updated_at: "2017-07-28 07:55:16", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 72[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/clients_count" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:17 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#clients_count[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 72[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_72[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 72) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 72]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>72, "username"=>"kolby", "email"=>"arianna.hirthe@walshhaley.biz", "password"=>"H8RxXaJ7Jb", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:16 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:16 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"clients_count"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 72[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_72[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 72[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_72[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>72, :username=>"kolby", :email=>"arianna.hirthe@walshhaley.biz", :password=>"H8RxXaJ7Jb", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:55:16.732Z", :updated_at=>"2017-07-28T07:55:16.732Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 72[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 48[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 48 AND ("client_visits"."updated_at" BETWEEN $1 AND $2)[0m  [["updated_at", "2017-06-28 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 48 AND ("client_visits"."updated_at" BETWEEN $1 AND $2)[0m  [["updated_at", "2017-07-21 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 27ms [30m(Views: 0.2ms | ActiveRecord: 8.9ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "444-048-8764 x476"], ["created_at", "2017-07-28 07:55:17.044750"], ["updated_at", "2017-07-28 07:55:17.044750"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "alyce_price"], ["email", "kianna.harvey@vonrueden.net"], ["password", "Ku4u6jQw6p"], ["created_at", "2017-07-28 07:55:17.049516"], ["updated_at", "2017-07-28 07:55:17.049516"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "575696"], ["username", "skye"], ["image", "http://facebook.com/img/skye.jpg"], ["profile", "https://facebook.com/skye"], ["email", "christ.kling@stoltenbergcormier.io"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 29], ["user_id", 75], ["created_at", "2017-07-28 07:55:17.053413"], ["updated_at", "2017-07-28 07:55:17.053413"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Gembucket"], ["created_at", "2017-07-28 07:55:17.060614"], ["updated_at", "2017-07-28 07:55:17.060614"], ["local_path", "http://dach.org/eladio_barrows"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Ronstring"], ["title_ru", "Название50"], ["created_at", "2017-07-28 07:55:17.064383"], ["updated_at", "2017-07-28 07:55:17.064383"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 50[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_50[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 50) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>50, "title"=>"Gembucket", "created_at"=>Fri, 28 Jul 2017 07:55:17 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:17 UTC +00:00, "local_path"=>"http://dach.org/eladio_barrows"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stronghold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stronghold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Stronghold"], ["category_id", 50], ["slug", "stronghold"], ["created_at", "2017-07-28 07:55:17.075489"], ["updated_at", "2017-07-28 07:55:17.075489"], ["layout_id", 50]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "roie_mohr"], ["email", "monica@kshlerinkuhic.net"], ["password", "SbQ89l64"], ["created_at", "2017-07-28 07:55:17.080416"], ["updated_at", "2017-07-28 07:55:17.080416"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "recusandae.aut"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Latlux"], ["phone", "(189) 482-4903"], ["address", "34322 Michel Stream"], ["url", "http://renner.com/rowland_frami"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://conroymayert.io/burdette.cole"], ["auth_expiration_time", 900], ["slug", "recusandae.aut"], ["brand_id", 50], ["user_id", 76], ["created_at", "2017-07-28 07:55:17.085893"], ["updated_at", "2017-07-28 07:55:17.085893"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Toughjoyfax"], ["created_at", "2017-07-28 07:55:17.093489"], ["updated_at", "2017-07-28 07:55:17.093489"], ["local_path", "http://bednar.com/margarette"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Domainer"], ["title_ru", "Название51"], ["created_at", "2017-07-28 07:55:17.097145"], ["updated_at", "2017-07-28 07:55:17.097145"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_51[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 51) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>51, "title"=>"Toughjoyfax", "created_at"=>Fri, 28 Jul 2017 07:55:17 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:17 UTC +00:00, "local_path"=>"http://bednar.com/margarette"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zoolab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zoolab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zoolab"], ["category_id", 51], ["slug", "zoolab"], ["created_at", "2017-07-28 07:55:17.107477"], ["updated_at", "2017-07-28 07:55:17.107477"], ["layout_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ernesto"], ["email", "furman.bergnaum@prohaskadeckow.biz"], ["password", "RxIrU5X6A56oM"], ["created_at", "2017-07-28 07:55:17.112334"], ["updated_at", "2017-07-28 07:55:17.112334"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "expedita-ea"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Redhold"], ["phone", "191-971-8136"], ["address", "96435 Thompson Forest"], ["url", "http://ruecker.co/sherman_pagac"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://schinner.com/raphael_murazik"], ["auth_expiration_time", 900], ["slug", "expedita-ea"], ["brand_id", 51], ["user_id", 77], ["created_at", "2017-07-28 07:55:17.118138"], ["updated_at", "2017-07-28 07:55:17.118138"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "yadira"], ["email", "paula_goodwin@romaguerapaucek.biz"], ["password", "S4Gj70NlQe"], ["created_at", "2017-07-28 07:55:17.123229"], ["updated_at", "2017-07-28 07:55:17.123229"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53314"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53314"], ["comment", "comment 114"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "208.156.16.69"], ["router_admin_ip", "107.236.32.76"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "96"], ["status", "t"], ["location_id", 51], ["user_id", 78], ["created_at", "2017-07-28 07:55:17.128510"], ["updated_at", "2017-07-28 07:55:17.128510"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53314"], ["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 14], ["serial", "643705CA5E36/53314"], ["comment", "comment 114"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "208.156.16.69"], ["router_admin_ip", "107.236.32.76"], ["admin_password", "3d64032369c731d2"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "14"], ["status", "t"], ["location_id", 51], ["user_id", 78], ["created_at", "2017-07-28 07:55:17.128510"], ["updated_at", "2017-07-28 07:55:17.128510"], ["id", 14]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 6d1a8922-4d73-4cc6-a484-892c85d5939d) to Async(routers) with arguments: #<GlobalID:0x007fd005df7c80 @uri=#<URI::GID gid://wifi-management/Router/14>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 060dc41f-76da-4867-9ee3-51dafb32c60d) to Async(routers) with arguments: #<GlobalID:0x007fd005df7c80 @uri=#<URI::GID gid://wifi-management/Router/14>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.3ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 14], ["provider", "instagram"], ["location_id", 50], ["router_id", 14], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/totals" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:17 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#all_connections[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"all_connections"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-06-28 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(50, 51)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" IN (50, 51) AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.1ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(50, 51) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.9ms)[0m  [1m[34m
      select
        newusrs.chart_interval,
        ttlusrs.returning as returning_users,
        newusrs.new_users,
        ttlusrs.returning + newusrs.new_users as total
      from (select
          chart_interval,
          count (id) as new_users
        from (select
            distinct cl.id,
            date_trunc('day', dd)::date as chart_interval
          FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
          left outer join social_accounts sa on date_trunc('day', sa.created_at) = date_trunc('day', dd)
          left outer join clients cl on sa.client_id = cl.id
          join social_logs sl on sa.id = sl.social_account_id
            and location_id in(50, 51)
      	  order by chart_interval) as chart
        group by chart_interval
        order by chart_interval
      ) as newusrs join (select
          date_trunc('day', dd):: date as chart_interval,
          count (distinct cl.id) as returning
        FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
        left outer join social_logs sl on date_trunc('day', sl.created_at) = date_trunc('day', dd)
          and location_id in(50, 51)
        join social_accounts sa on sa.id = sl.social_account_id
        left outer join clients cl on date_trunc('day', cl.created_at) < date_trunc('day', dd)
          and sa.client_id = cl.id
        group by chart_interval
        order by chart_interval
      ) as ttlusrs on ttlusrs.chart_interval = newusrs.chart_interval[0m
[INFO ] Completed [32m200 OK[0m in 26ms [30m(Views: 3.9ms | ActiveRecord: 10.3ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(292) 778-1072"], ["created_at", "2017-07-28 07:55:17.270212"], ["updated_at", "2017-07-28 07:55:17.270212"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "chandler"], ["email", "kaleigh.feeney@pacochacasper.net"], ["password", "2jM4SbOhS4IoJrPx"], ["created_at", "2017-07-28 07:55:17.274923"], ["updated_at", "2017-07-28 07:55:17.274923"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "877207"], ["username", "caitlyn"], ["image", "http://instagram.com/img/caitlyn.jpg"], ["profile", "https://instagram.com/caitlyn"], ["email", "janae.nolan@wolffkirlin.com"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 30], ["user_id", 79], ["created_at", "2017-07-28 07:55:17.279066"], ["updated_at", "2017-07-28 07:55:17.279066"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zoolab"], ["created_at", "2017-07-28 07:55:17.286405"], ["updated_at", "2017-07-28 07:55:17.286405"], ["local_path", "http://gutmann.io/kaitlin"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Matsoft"], ["title_ru", "Название52"], ["created_at", "2017-07-28 07:55:17.289974"], ["updated_at", "2017-07-28 07:55:17.289974"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 52[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_52[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 52) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>52, "title"=>"Zoolab", "created_at"=>Fri, 28 Jul 2017 07:55:17 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:17 UTC +00:00, "local_path"=>"http://gutmann.io/kaitlin"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "treeflex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "treeflex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Treeflex"], ["category_id", 52], ["slug", "treeflex"], ["created_at", "2017-07-28 07:55:17.300863"], ["updated_at", "2017-07-28 07:55:17.300863"], ["layout_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "gielle"], ["email", "lisandro@grimes.net"], ["password", "VdUf7eCtM9Xk"], ["created_at", "2017-07-28 07:55:17.305533"], ["updated_at", "2017-07-28 07:55:17.305533"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "omnis-eum"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stringtough"], ["phone", "403.981.1110"], ["address", "6299 Harvey Station"], ["url", "http://von.biz/brant"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kertzmann.biz/chelsie.kovacek"], ["auth_expiration_time", 900], ["slug", "omnis-eum"], ["brand_id", 52], ["user_id", 80], ["created_at", "2017-07-28 07:55:17.311109"], ["updated_at", "2017-07-28 07:55:17.311109"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Redhold"], ["created_at", "2017-07-28 07:55:17.318936"], ["updated_at", "2017-07-28 07:55:17.318936"], ["local_path", "http://vonrueden.co/angelita"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bigtax"], ["title_ru", "Название53"], ["created_at", "2017-07-28 07:55:17.322695"], ["updated_at", "2017-07-28 07:55:17.322695"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 53[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_53[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 53) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>53, "title"=>"Redhold", "created_at"=>Fri, 28 Jul 2017 07:55:17 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:17 UTC +00:00, "local_path"=>"http://vonrueden.co/angelita"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "redhold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "redhold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Redhold"], ["category_id", 53], ["slug", "redhold"], ["created_at", "2017-07-28 07:55:17.332998"], ["updated_at", "2017-07-28 07:55:17.332998"], ["layout_id", 53]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "floyd_cain"], ["email", "lydia@walsh.org"], ["password", "8i46Rx7uNgAzK6Q1"], ["created_at", "2017-07-28 07:55:17.337592"], ["updated_at", "2017-07-28 07:55:17.337592"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "autem-laboriosam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Flexidy"], ["phone", "1-636-131-7518"], ["address", "6122 Myrtis Cliffs"], ["url", "http://hintz.biz/macy.olson"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kuhictreutel.net/karley_homenick"], ["auth_expiration_time", 900], ["slug", "autem-laboriosam"], ["brand_id", 53], ["user_id", 81], ["created_at", "2017-07-28 07:55:17.343338"], ["updated_at", "2017-07-28 07:55:17.343338"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "kristy"], ["email", "dax_zboncak@ernser.co"], ["password", "Sd17UeDr"], ["created_at", "2017-07-28 07:55:17.348372"], ["updated_at", "2017-07-28 07:55:17.348372"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53315"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53315"], ["comment", "comment 115"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "242.140.253.188"], ["router_admin_ip", "170.147.94.141"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "261"], ["status", "t"], ["location_id", 53], ["user_id", 82], ["created_at", "2017-07-28 07:55:17.353664"], ["updated_at", "2017-07-28 07:55:17.353664"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53315"], ["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 15], ["serial", "643705CA5E36/53315"], ["comment", "comment 115"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "242.140.253.188"], ["router_admin_ip", "170.147.94.141"], ["admin_password", "b3f2300087b41286"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "15"], ["status", "t"], ["location_id", 53], ["user_id", 82], ["created_at", "2017-07-28 07:55:17.353664"], ["updated_at", "2017-07-28 07:55:17.353664"], ["id", 15]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: efeda724-08d0-487d-a30e-72e60c8b9877) to Async(routers) with arguments: #<GlobalID:0x007fd003f688c8 @uri=#<URI::GID gid://wifi-management/Router/15>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: a8c2e674-95b1-4d6b-b635-a4b274897709) to Async(routers) with arguments: #<GlobalID:0x007fd003f688c8 @uri=#<URI::GID gid://wifi-management/Router/15>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 15], ["provider", "instagram"], ["location_id", 52], ["router_id", 15], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/time" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:17 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#time_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"time_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(52, 53)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 5ms [30m(Views: 1.2ms | ActiveRecord: 2.3ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(315) 985-6434"], ["created_at", "2017-07-28 07:55:17.454804"], ["updated_at", "2017-07-28 07:55:17.454804"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "newton_ko"], ["email", "marc@jonesaufderhar.name"], ["password", "7oGfKjG44yTpM6"], ["created_at", "2017-07-28 07:55:17.459506"], ["updated_at", "2017-07-28 07:55:17.459506"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "204677"], ["username", "leif.lehner"], ["image", "http://facebook.com/img/leif.lehner.jpg"], ["profile", "https://facebook.com/leif.lehner"], ["email", "conor@steuberskiles.net"], ["gender", "female"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 31], ["user_id", 83], ["created_at", "2017-07-28 07:55:17.463478"], ["updated_at", "2017-07-28 07:55:17.463478"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zamit"], ["created_at", "2017-07-28 07:55:17.470906"], ["updated_at", "2017-07-28 07:55:17.470906"], ["local_path", "http://dickinsonwillms.org/wilburn"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fix San"], ["title_ru", "Название54"], ["created_at", "2017-07-28 07:55:17.474819"], ["updated_at", "2017-07-28 07:55:17.474819"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_54[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 54) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>54, "title"=>"Zamit", "created_at"=>Fri, 28 Jul 2017 07:55:17 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:17 UTC +00:00, "local_path"=>"http://dickinsonwillms.org/wilburn"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitwolf"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bitwolf"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bitwolf"], ["category_id", 54], ["slug", "bitwolf"], ["created_at", "2017-07-28 07:55:17.486182"], ["updated_at", "2017-07-28 07:55:17.486182"], ["layout_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "deja"], ["email", "winifred.hettinger@von.io"], ["password", "8cMmJhFp56QmSdUc"], ["created_at", "2017-07-28 07:55:17.491233"], ["updated_at", "2017-07-28 07:55:17.491233"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "laboriosam-dignissimos"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Ronstring"], ["phone", "727.490.1238"], ["address", "81958 O'Keefe Plains"], ["url", "http://cormier.info/kiana"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://deckow.org/gabe"], ["auth_expiration_time", 900], ["slug", "laboriosam-dignissimos"], ["brand_id", 54], ["user_id", 84], ["created_at", "2017-07-28 07:55:17.497291"], ["updated_at", "2017-07-28 07:55:17.497291"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Flexidy"], ["created_at", "2017-07-28 07:55:17.505211"], ["updated_at", "2017-07-28 07:55:17.505211"], ["local_path", "http://heathcote.org/gabrielle_gerlach"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Duobam"], ["title_ru", "Название55"], ["created_at", "2017-07-28 07:55:17.508996"], ["updated_at", "2017-07-28 07:55:17.508996"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 55[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_55[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 55) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>55, "title"=>"Flexidy", "created_at"=>Fri, 28 Jul 2017 07:55:17 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:17 UTC +00:00, "local_path"=>"http://heathcote.org/gabrielle_gerlach"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stronghold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stronghold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Stronghold"], ["category_id", 55], ["slug", "stronghold"], ["created_at", "2017-07-28 07:55:17.519700"], ["updated_at", "2017-07-28 07:55:17.519700"], ["layout_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "stephany"], ["email", "ally@will.co"], ["password", "PzVt7gJ9"], ["created_at", "2017-07-28 07:55:17.524423"], ["updated_at", "2017-07-28 07:55:17.524423"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptatum_ea"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Cardguard"], ["phone", "1-117-108-7054"], ["address", "976 Hagenes Way"], ["url", "http://prosacco.com/richie.mcglynn"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://orn.io/wilford"], ["auth_expiration_time", 900], ["slug", "voluptatum_ea"], ["brand_id", 55], ["user_id", 85], ["created_at", "2017-07-28 07:55:17.530035"], ["updated_at", "2017-07-28 07:55:17.530035"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "alycia"], ["email", "sebastian.kerluke@oharaborer.org"], ["password", "Ei87TtDzY5SsSoN"], ["created_at", "2017-07-28 07:55:17.535414"], ["updated_at", "2017-07-28 07:55:17.535414"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53316"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53316"], ["comment", "comment 116"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "60.123.126.21"], ["router_admin_ip", "227.92.19.192"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "981"], ["status", "t"], ["location_id", 55], ["user_id", 86], ["created_at", "2017-07-28 07:55:17.540792"], ["updated_at", "2017-07-28 07:55:17.540792"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53316"], ["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 16], ["serial", "643705CA5E36/53316"], ["comment", "comment 116"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "60.123.126.21"], ["router_admin_ip", "227.92.19.192"], ["admin_password", "6d6e142dc4e5a8ab"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "16"], ["status", "t"], ["location_id", 55], ["user_id", 86], ["created_at", "2017-07-28 07:55:17.540792"], ["updated_at", "2017-07-28 07:55:17.540792"], ["id", 16]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 94e31879-7860-46c7-96f5-89347bf43b5b) to Async(routers) with arguments: #<GlobalID:0x007fd0007edc18 @uri=#<URI::GID gid://wifi-management/Router/16>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 476be4d9-60dd-4e0e-867c-c1e6510aac24) to Async(routers) with arguments: #<GlobalID:0x007fd0007edc18 @uri=#<URI::GID gid://wifi-management/Router/16>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 16], ["provider", "instagram"], ["location_id", 54], ["router_id", 16], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/social" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:17 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#social_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"social_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.6ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" IN (54, 55) AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 7ms [30m(Views: 1.3ms | ActiveRecord: 2.4ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(563) 339-8163"], ["created_at", "2017-07-28 07:55:17.997544"], ["updated_at", "2017-07-28 07:55:17.997544"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "tyshawn"], ["email", "torey_renner@heaney.co"], ["password", "6u99PrKzOkP2Gh"], ["created_at", "2017-07-28 07:55:18.002461"], ["updated_at", "2017-07-28 07:55:18.002461"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "807399"], ["username", "lawrence"], ["image", "http://instagram.com/img/lawrence.jpg"], ["profile", "https://instagram.com/lawrence"], ["email", "nicholas@huels.com"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 32], ["user_id", 87], ["created_at", "2017-07-28 07:55:18.006477"], ["updated_at", "2017-07-28 07:55:18.006477"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Rank"], ["created_at", "2017-07-28 07:55:18.013945"], ["updated_at", "2017-07-28 07:55:18.013945"], ["local_path", "http://dietrichyundt.net/vada"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zathin"], ["title_ru", "Название56"], ["created_at", "2017-07-28 07:55:18.017748"], ["updated_at", "2017-07-28 07:55:18.017748"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 56[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_56[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 56) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>56, "title"=>"Rank", "created_at"=>Fri, 28 Jul 2017 07:55:18 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:18 UTC +00:00, "local_path"=>"http://dietrichyundt.net/vada"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bytecard"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bytecard"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bytecard"], ["category_id", 56], ["slug", "bytecard"], ["created_at", "2017-07-28 07:55:18.029296"], ["updated_at", "2017-07-28 07:55:18.029296"], ["layout_id", 56]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ivory.bayer"], ["email", "lemuel@reillybruen.io"], ["password", "ZnYjVhQr9"], ["created_at", "2017-07-28 07:55:18.034630"], ["updated_at", "2017-07-28 07:55:18.034630"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quis_libero"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Aerified"], ["phone", "(557) 302-2816"], ["address", "391 Lockman Hills"], ["url", "http://nikolaus.io/peggie"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://stoltenberg.org/alexandrine.monahan"], ["auth_expiration_time", 900], ["slug", "quis_libero"], ["brand_id", 56], ["user_id", 88], ["created_at", "2017-07-28 07:55:18.040418"], ["updated_at", "2017-07-28 07:55:18.040418"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Toughjoyfax"], ["created_at", "2017-07-28 07:55:18.048234"], ["updated_at", "2017-07-28 07:55:18.048234"], ["local_path", "http://kutchbrakus.com/diego"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Sub-Ex"], ["title_ru", "Название57"], ["created_at", "2017-07-28 07:55:18.051996"], ["updated_at", "2017-07-28 07:55:18.051996"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_57[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 57) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>57, "title"=>"Toughjoyfax", "created_at"=>Fri, 28 Jul 2017 07:55:18 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:18 UTC +00:00, "local_path"=>"http://kutchbrakus.com/diego"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "ventosanzap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "ventosanzap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Ventosanzap"], ["category_id", 57], ["slug", "ventosanzap"], ["created_at", "2017-07-28 07:55:18.063187"], ["updated_at", "2017-07-28 07:55:18.063187"], ["layout_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "arlene"], ["email", "yadira.walker@barrows.co"], ["password", "IjZlA3SsEyNeLdL"], ["created_at", "2017-07-28 07:55:18.068190"], ["updated_at", "2017-07-28 07:55:18.068190"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptas.in"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Latlux"], ["phone", "357-659-7539"], ["address", "65074 Spencer Junction"], ["url", "http://wiegand.org/cletus"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://fisher.info/melyna.jerde"], ["auth_expiration_time", 900], ["slug", "voluptas.in"], ["brand_id", 57], ["user_id", 89], ["created_at", "2017-07-28 07:55:18.073946"], ["updated_at", "2017-07-28 07:55:18.073946"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "camron"], ["email", "anika@oconner.info"], ["password", "Ym5iUq9w"], ["created_at", "2017-07-28 07:55:18.079333"], ["updated_at", "2017-07-28 07:55:18.079333"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53317"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53317"], ["comment", "comment 117"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "31.153.230.14"], ["router_admin_ip", "71.239.190.134"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "795"], ["status", "t"], ["location_id", 57], ["user_id", 90], ["created_at", "2017-07-28 07:55:18.084813"], ["updated_at", "2017-07-28 07:55:18.084813"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53317"], ["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 17], ["serial", "643705CA5E36/53317"], ["comment", "comment 117"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "31.153.230.14"], ["router_admin_ip", "71.239.190.134"], ["admin_password", "181ed826f0588729"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "17"], ["status", "t"], ["location_id", 57], ["user_id", 90], ["created_at", "2017-07-28 07:55:18.084813"], ["updated_at", "2017-07-28 07:55:18.084813"], ["id", 17]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 13499cbd-beea-4db8-a7d1-5a688c94040e) to Async(routers) with arguments: #<GlobalID:0x007fcffbd2ff50 @uri=#<URI::GID gid://wifi-management/Router/17>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 74771928-eec7-439b-9285-bee2fd1a44dc) to Async(routers) with arguments: #<GlobalID:0x007fcffbd2ff50 @uri=#<URI::GID gid://wifi-management/Router/17>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 17], ["provider", "instagram"], ["location_id", 56], ["router_id", 17], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/age" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:18 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#age_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"age_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(56, 57) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 5ms [30m(Views: 1.2ms | ActiveRecord: 2.1ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "470-675-0879 x451"], ["created_at", "2017-07-28 07:55:18.143739"], ["updated_at", "2017-07-28 07:55:18.143739"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "webster"], ["email", "hanna@ledner.info"], ["password", "9cOh8dKi9bF8"], ["created_at", "2017-07-28 07:55:18.148635"], ["updated_at", "2017-07-28 07:55:18.148635"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "56109"], ["username", "lonnie"], ["image", "http://vk.com/img/lonnie.jpg"], ["profile", "https://vk.com/lonnie"], ["email", "marques_veum@turnerrohan.biz"], ["gender", "female"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 33], ["user_id", 91], ["created_at", "2017-07-28 07:55:18.152478"], ["updated_at", "2017-07-28 07:55:18.152478"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Sonair"], ["created_at", "2017-07-28 07:55:18.159756"], ["updated_at", "2017-07-28 07:55:18.159756"], ["local_path", "http://feil.biz/germaine_bauch"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Voyatouch"], ["title_ru", "Название58"], ["created_at", "2017-07-28 07:55:18.163612"], ["updated_at", "2017-07-28 07:55:18.163612"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 58[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_58[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 58) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>58, "title"=>"Sonair", "created_at"=>Fri, 28 Jul 2017 07:55:18 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:18 UTC +00:00, "local_path"=>"http://feil.biz/germaine_bauch"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stronghold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stronghold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Stronghold"], ["category_id", 58], ["slug", "stronghold"], ["created_at", "2017-07-28 07:55:18.174500"], ["updated_at", "2017-07-28 07:55:18.174500"], ["layout_id", 58]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "cletus"], ["email", "marta@barrowsgleason.co"], ["password", "B1JdHeIjMm1t7hS"], ["created_at", "2017-07-28 07:55:18.179385"], ["updated_at", "2017-07-28 07:55:18.179385"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "aliquam-sint"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Latlux"], ["phone", "843-352-1579"], ["address", "78097 Will Garden"], ["url", "http://eichmann.org/myrtle.heathcote"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://krismetz.info/dock"], ["auth_expiration_time", 900], ["slug", "aliquam-sint"], ["brand_id", 58], ["user_id", 92], ["created_at", "2017-07-28 07:55:18.185130"], ["updated_at", "2017-07-28 07:55:18.185130"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Matsoft"], ["created_at", "2017-07-28 07:55:18.192934"], ["updated_at", "2017-07-28 07:55:18.192934"], ["local_path", "http://runte.co/oral_upton"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Y-Solowarm"], ["title_ru", "Название59"], ["created_at", "2017-07-28 07:55:18.196734"], ["updated_at", "2017-07-28 07:55:18.196734"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 59[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_59[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 59) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>59, "title"=>"Matsoft", "created_at"=>Fri, 28 Jul 2017 07:55:18 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:18 UTC +00:00, "local_path"=>"http://runte.co/oral_upton"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "aerified"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "aerified"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Aerified"], ["category_id", 59], ["slug", "aerified"], ["created_at", "2017-07-28 07:55:18.207376"], ["updated_at", "2017-07-28 07:55:18.207376"], ["layout_id", 59]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ila.von"], ["email", "citlalli_stroman@bergnaum.net"], ["password", "J5Hb8vA5Te7z"], ["created_at", "2017-07-28 07:55:18.212137"], ["updated_at", "2017-07-28 07:55:18.212137"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "debitis.sit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Fintone"], ["phone", "1-750-770-6906"], ["address", "3658 Abelardo Fields"], ["url", "http://kertzmann.com/tiana.effertz"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://predovic.biz/frederic"], ["auth_expiration_time", 900], ["slug", "debitis.sit"], ["brand_id", 59], ["user_id", 93], ["created_at", "2017-07-28 07:55:18.217554"], ["updated_at", "2017-07-28 07:55:18.217554"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "colleen"], ["email", "meaghan@mertzschulist.co"], ["password", "DkFnKc4f"], ["created_at", "2017-07-28 07:55:18.222553"], ["updated_at", "2017-07-28 07:55:18.222553"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53318"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53318"], ["comment", "comment 118"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "81.54.83.54"], ["router_admin_ip", "148.224.186.211"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "464"], ["status", "t"], ["location_id", 59], ["user_id", 94], ["created_at", "2017-07-28 07:55:18.227812"], ["updated_at", "2017-07-28 07:55:18.227812"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53318"], ["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 18], ["serial", "643705CA5E36/53318"], ["comment", "comment 118"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "81.54.83.54"], ["router_admin_ip", "148.224.186.211"], ["admin_password", "094fbbca6caaa70e"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "18"], ["status", "t"], ["location_id", 59], ["user_id", 94], ["created_at", "2017-07-28 07:55:18.227812"], ["updated_at", "2017-07-28 07:55:18.227812"], ["id", 18]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: d18a7184-e3d8-4e55-a987-52f5a7d11402) to Async(routers) with arguments: #<GlobalID:0x007fcffca280e0 @uri=#<URI::GID gid://wifi-management/Router/18>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 42eed5c0-43cb-4468-bfd0-4833cd0d2996) to Async(routers) with arguments: #<GlobalID:0x007fcffca280e0 @uri=#<URI::GID gid://wifi-management/Router/18>>
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 18], ["provider", "instagram"], ["location_id", 58], ["router_id", 18], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/visitors" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:18 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#visitors_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"visitors_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.0ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" IN (58, 59) AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 7ms [30m(Views: 1.3ms | ActiveRecord: 2.8ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mActiveRecord::SchemaMigration Load (1.5ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.6ms)[0m  [1m[35mALTER TABLE "answers" DISABLE TRIGGER ALL;ALTER TABLE "social_logs" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "client_counters" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "client_devices" DISABLE TRIGGER ALL;ALTER TABLE "clients" DISABLE TRIGGER ALL;ALTER TABLE "auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "social_accounts" DISABLE TRIGGER ALL;ALTER TABLE "brands" DISABLE TRIGGER ALL;ALTER TABLE "polls" DISABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" DISABLE TRIGGER ALL;ALTER TABLE "questions" DISABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" DISABLE TRIGGER ALL;ALTER TABLE "locations" DISABLE TRIGGER ALL;ALTER TABLE "notifications" DISABLE TRIGGER ALL;ALTER TABLE "opinions" DISABLE TRIGGER ALL;ALTER TABLE "pages" DISABLE TRIGGER ALL;ALTER TABLE "payments" DISABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" DISABLE TRIGGER ALL;ALTER TABLE "products" DISABLE TRIGGER ALL;ALTER TABLE "routers" DISABLE TRIGGER ALL;ALTER TABLE "sessions" DISABLE TRIGGER ALL;ALTER TABLE "sms_logs" DISABLE TRIGGER ALL;ALTER TABLE "attempts" DISABLE TRIGGER ALL;ALTER TABLE "bans" DISABLE TRIGGER ALL;ALTER TABLE "layouts" DISABLE TRIGGER ALL;ALTER TABLE "categories" DISABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" DISABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" DISABLE TRIGGER ALL;ALTER TABLE "vips" DISABLE TRIGGER ALL;ALTER TABLE "vouchers" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.2ms)[0m  [1m[34m          SELECT schemaname || '.' || tablename
          FROM pg_tables
          WHERE
            tablename !~ '_prt_' AND
            tablename <> 'schema_migrations' AND
            schemaname = ANY (current_schemas(false))
[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.1ms)[0m  [1m[34mselect table_name from information_schema.views where table_schema = 'gycwifi_api_test'[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (122.1ms)[0m  [1m[35mTRUNCATE TABLE "public"."answers", "public"."social_logs", "public"."users", "public"."client_counters", "public"."client_devices", "public"."clients", "public"."auth_logs", "public"."social_accounts", "public"."brands", "public"."polls", "public"."device_auth_pendings", "public"."questions", "public"."friendly_id_slugs", "public"."locations", "public"."notifications", "public"."opinions", "public"."pages", "public"."payments", "public"."post_auth_logs", "public"."products", "public"."routers", "public"."sessions", "public"."sms_logs", "public"."attempts", "public"."bans", "public"."layouts", "public"."categories", "public"."client_accounting_logs", "public"."delayed_jobs", "public"."vips", "public"."vouchers", "public"."ar_internal_metadata" RESTART IDENTITY CASCADE;[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[35mALTER TABLE "answers" ENABLE TRIGGER ALL;ALTER TABLE "auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "social_accounts" ENABLE TRIGGER ALL;ALTER TABLE "brands" ENABLE TRIGGER ALL;ALTER TABLE "polls" ENABLE TRIGGER ALL;ALTER TABLE "device_auth_pendings" ENABLE TRIGGER ALL;ALTER TABLE "questions" ENABLE TRIGGER ALL;ALTER TABLE "social_logs" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "friendly_id_slugs" ENABLE TRIGGER ALL;ALTER TABLE "locations" ENABLE TRIGGER ALL;ALTER TABLE "notifications" ENABLE TRIGGER ALL;ALTER TABLE "opinions" ENABLE TRIGGER ALL;ALTER TABLE "pages" ENABLE TRIGGER ALL;ALTER TABLE "payments" ENABLE TRIGGER ALL;ALTER TABLE "post_auth_logs" ENABLE TRIGGER ALL;ALTER TABLE "client_counters" ENABLE TRIGGER ALL;ALTER TABLE "products" ENABLE TRIGGER ALL;ALTER TABLE "routers" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "sessions" ENABLE TRIGGER ALL;ALTER TABLE "sms_logs" ENABLE TRIGGER ALL;ALTER TABLE "attempts" ENABLE TRIGGER ALL;ALTER TABLE "bans" ENABLE TRIGGER ALL;ALTER TABLE "layouts" ENABLE TRIGGER ALL;ALTER TABLE "categories" ENABLE TRIGGER ALL;ALTER TABLE "client_accounting_logs" ENABLE TRIGGER ALL;ALTER TABLE "delayed_jobs" ENABLE TRIGGER ALL;ALTER TABLE "client_devices" ENABLE TRIGGER ALL;ALTER TABLE "clients" ENABLE TRIGGER ALL;ALTER TABLE "vips" ENABLE TRIGGER ALL;ALTER TABLE "vouchers" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-330-579-5393 x55414"], ["created_at", "2017-07-28 07:55:57.879659"], ["updated_at", "2017-07-28 07:55:57.879659"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Y-find"], ["created_at", "2017-07-28 07:55:58.009417"], ["updated_at", "2017-07-28 07:55:58.009417"], ["local_path", "http://gottlieb.org/xzavier"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Kanlam"], ["title_ru", "Название1"], ["created_at", "2017-07-28 07:55:58.024367"], ["updated_at", "2017-07-28 07:55:58.024367"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 1[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (1.2ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 1) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>1, "title"=>"Y-find", "created_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "local_path"=>"http://gottlieb.org/xzavier"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "lotlux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "lotlux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "Lotlux"], ["category_id", 1], ["slug", "lotlux"], ["created_at", "2017-07-28 07:55:58.153976"], ["updated_at", "2017-07-28 07:55:58.153976"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "bartholome"], ["email", "lynn@walter.biz"], ["password", "Xc89NuTuYoZ"], ["created_at", "2017-07-28 07:55:58.198402"], ["updated_at", "2017-07-28 07:55:58.198402"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "itaque-nihil"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Latlux"], ["phone", "232-790-7113"], ["address", "277 McGlynn Mountains"], ["url", "http://ruel.org/hilton"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://glover.com/margarett"], ["auth_expiration_time", 900], ["slug", "itaque-nihil"], ["brand_id", 1], ["user_id", 1], ["created_at", "2017-07-28 07:55:58.209342"], ["updated_at", "2017-07-28 07:55:58.209342"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 1], ["location_id", 1], ["counter", 1], ["created_at", "2017-07-28 07:55:58.215418"], ["updated_at", "2017-07-28 07:55:58.215418"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "585.406.0827 x64637"], ["created_at", "2017-07-28 07:55:58.219995"], ["updated_at", "2017-07-28 07:55:58.219995"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Holdlamis"], ["created_at", "2017-07-28 07:55:58.226320"], ["updated_at", "2017-07-28 07:55:58.226320"], ["local_path", "http://baileyschuster.net/clark_lueilwitz"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bytecard"], ["title_ru", "Название2"], ["created_at", "2017-07-28 07:55:58.230117"], ["updated_at", "2017-07-28 07:55:58.230117"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 2[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_2[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 2) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>2, "title"=>"Holdlamis", "created_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "local_path"=>"http://baileyschuster.net/clark_lueilwitz"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Konklux"], ["category_id", 2], ["slug", "konklux"], ["created_at", "2017-07-28 07:55:58.241067"], ["updated_at", "2017-07-28 07:55:58.241067"], ["layout_id", 2]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "alivia"], ["email", "sylvan.heaney@howelljakubowski.com"], ["password", "Rz6rMiMaM4HeSg"], ["created_at", "2017-07-28 07:55:58.245817"], ["updated_at", "2017-07-28 07:55:58.245817"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "impedit_natus"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tempsoft"], ["phone", "(289) 707-5914"], ["address", "286 Kulas Shoals"], ["url", "http://okonortiz.biz/makenna"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://price.co/jerrod.sipes"], ["auth_expiration_time", 900], ["slug", "impedit_natus"], ["brand_id", 2], ["user_id", 2], ["created_at", "2017-07-28 07:55:58.251324"], ["updated_at", "2017-07-28 07:55:58.251324"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 2], ["location_id", 2], ["counter", 4], ["created_at", "2017-07-28 07:55:58.255468"], ["updated_at", "2017-07-28 07:55:58.255468"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Cardguard"], ["created_at", "2017-07-28 07:55:58.262106"], ["updated_at", "2017-07-28 07:55:58.262106"], ["local_path", "http://cormier.co/reid"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Ventosanzap"], ["title_ru", "Название3"], ["created_at", "2017-07-28 07:55:58.265902"], ["updated_at", "2017-07-28 07:55:58.265902"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 3[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_3[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 3) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>3, "title"=>"Cardguard", "created_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "local_path"=>"http://cormier.co/reid"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "gembucket"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "gembucket"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Gembucket"], ["category_id", 3], ["slug", "gembucket"], ["created_at", "2017-07-28 07:55:58.276580"], ["updated_at", "2017-07-28 07:55:58.276580"], ["layout_id", 3]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "esperanza"], ["email", "enola@hudson.co"], ["password", "Md8dIjCcYoLzYs1m"], ["created_at", "2017-07-28 07:55:58.281602"], ["updated_at", "2017-07-28 07:55:58.281602"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "qui_nihil"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Pannier"], ["phone", "(925) 957-3418"], ["address", "313 Zboncak Common"], ["url", "http://durganschinner.name/elise.kovacek"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://heel.name/dustin"], ["auth_expiration_time", 900], ["slug", "qui_nihil"], ["brand_id", 3], ["user_id", 3], ["created_at", "2017-07-28 07:55:58.287005"], ["updated_at", "2017-07-28 07:55:58.287005"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 1], ["location_id", 3], ["counter", 7], ["created_at", "2017-07-28 07:55:58.291260"], ["updated_at", "2017-07-28 07:55:58.291260"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "marley"], ["email", "unique@bayer.net"], ["password", "3kMtAgN632"], ["role_cd", 3], ["created_at", "2017-07-28 07:55:58.295858"], ["updated_at", "2017-07-28 07:55:58.295858"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:58 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"marley", "email"=>"unique@bayer.net", "password"=>"3kMtAgN632", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"marley", :email=>"unique@bayer.net", :password=>"3kMtAgN632", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"unique@bayer.net", "password"=>"3kMtAgN632"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "marley"], ["email", "unique@bayer.net"], ["password", "3kMtAgN632"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 4, username: "marley", email: "unique@bayer.net", password: "3kMtAgN632", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:55:58", updated_at: "2017-07-28 07:55:58", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 4[0m
[INFO ] Completed [32m201 Created[0m in 7ms [30m(Views: 0.3ms | ActiveRecord: 1.2ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=updated_at&updated_at=asc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:58 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"updated_at", "updated_at"=>"asc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 4) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.3ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 4]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>4, "username"=>"marley", "email"=>"unique@bayer.net", "password"=>"3kMtAgN632", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"updated_at", :updated_at=>"asc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (1.4ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_4[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>4, :username=>"marley", :email=>"unique@bayer.net", :password=>"3kMtAgN632", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:55:58.295Z", :updated_at=>"2017-07-28T07:55:58.295Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.4ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:55:58.215418') AND "client_counters"."location_id" IN (1, 2, 3) GROUP BY client_id, phone_number ORDER BY updated_at asc, visits desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.9ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (2, 1)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (1.7ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (1, 2)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:55:58.215418') AND "client_counters"."location_id" IN (1, 2, 3) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 109ms [30m(Views: 0.6ms | ActiveRecord: 22.9ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "176-401-1546 x00547"], ["created_at", "2017-07-28 07:55:58.502723"], ["updated_at", "2017-07-28 07:55:58.502723"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Subin"], ["created_at", "2017-07-28 07:55:58.509759"], ["updated_at", "2017-07-28 07:55:58.509759"], ["local_path", "http://nader.net/raphaelle_romaguera"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fixflex"], ["title_ru", "Название4"], ["created_at", "2017-07-28 07:55:58.513737"], ["updated_at", "2017-07-28 07:55:58.513737"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 4[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_4[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 4) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>4, "title"=>"Subin", "created_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "local_path"=>"http://nader.net/raphaelle_romaguera"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "aerified"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "aerified"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Aerified"], ["category_id", 4], ["slug", "aerified"], ["created_at", "2017-07-28 07:55:58.525168"], ["updated_at", "2017-07-28 07:55:58.525168"], ["layout_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "savanah.hackett"], ["email", "kiel.sawayn@swaniawskihilll.com"], ["password", "P99bFgFpOuT"], ["created_at", "2017-07-28 07:55:58.530196"], ["updated_at", "2017-07-28 07:55:58.530196"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "numquam.repellendus"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Voltsillam"], ["phone", "201.178.6266"], ["address", "8796 Linwood Gardens"], ["url", "http://cremin.io/terence_schiller"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://lakinhills.io/connie_blick"], ["auth_expiration_time", 900], ["slug", "numquam.repellendus"], ["brand_id", 4], ["user_id", 5], ["created_at", "2017-07-28 07:55:58.536078"], ["updated_at", "2017-07-28 07:55:58.536078"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 3], ["location_id", 4], ["counter", 7], ["created_at", "2017-07-28 07:55:58.540553"], ["updated_at", "2017-07-28 07:55:58.540553"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "639-687-9881 x22818"], ["created_at", "2017-07-28 07:55:58.544343"], ["updated_at", "2017-07-28 07:55:58.544343"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Stringtough"], ["created_at", "2017-07-28 07:55:58.550882"], ["updated_at", "2017-07-28 07:55:58.550882"], ["local_path", "http://mertz.com/yazmin"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Sub-Ex"], ["title_ru", "Название5"], ["created_at", "2017-07-28 07:55:58.554628"], ["updated_at", "2017-07-28 07:55:58.554628"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 5[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_5[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 5) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>5, "title"=>"Stringtough", "created_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "local_path"=>"http://mertz.com/yazmin"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "treeflex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "treeflex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Treeflex"], ["category_id", 5], ["slug", "treeflex"], ["created_at", "2017-07-28 07:55:58.565439"], ["updated_at", "2017-07-28 07:55:58.565439"], ["layout_id", 5]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "otilia_mann"], ["email", "ezequiel@anderson.biz"], ["password", "Px4eU8DmUpS3Nu"], ["created_at", "2017-07-28 07:55:58.569979"], ["updated_at", "2017-07-28 07:55:58.569979"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptates_esse"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zontrax"], ["phone", "452.760.2224"], ["address", "80032 Runolfsson Viaduct"], ["url", "http://trompjohnson.com/gerson_mann"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kreiger.com/henri"], ["auth_expiration_time", 900], ["slug", "voluptates_esse"], ["brand_id", 5], ["user_id", 6], ["created_at", "2017-07-28 07:55:58.575441"], ["updated_at", "2017-07-28 07:55:58.575441"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 4], ["location_id", 5], ["counter", 2], ["created_at", "2017-07-28 07:55:58.579749"], ["updated_at", "2017-07-28 07:55:58.579749"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Alpha"], ["created_at", "2017-07-28 07:55:58.586230"], ["updated_at", "2017-07-28 07:55:58.586230"], ["local_path", "http://leannon.info/miles.quitzon"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Flexidy"], ["title_ru", "Название6"], ["created_at", "2017-07-28 07:55:58.589808"], ["updated_at", "2017-07-28 07:55:58.589808"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 6[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_6[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 6) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>6, "title"=>"Alpha", "created_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "local_path"=>"http://leannon.info/miles.quitzon"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stronghold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "stronghold"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Stronghold"], ["category_id", 6], ["slug", "stronghold"], ["created_at", "2017-07-28 07:55:58.600805"], ["updated_at", "2017-07-28 07:55:58.600805"], ["layout_id", 6]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "elda"], ["email", "loren@shieldpinka.name"], ["password", "Xv15TgEpO3X3HlG"], ["created_at", "2017-07-28 07:55:58.605738"], ["updated_at", "2017-07-28 07:55:58.605738"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "occaecati-necessitatibus"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Greenlam"], ["phone", "102-284-4856"], ["address", "503 Rafael Way"], ["url", "http://klein.io/carmine"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hand.name/alyce"], ["auth_expiration_time", 900], ["slug", "occaecati-necessitatibus"], ["brand_id", 6], ["user_id", 7], ["created_at", "2017-07-28 07:55:58.611439"], ["updated_at", "2017-07-28 07:55:58.611439"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 3], ["location_id", 6], ["counter", 4], ["created_at", "2017-07-28 07:55:58.615854"], ["updated_at", "2017-07-28 07:55:58.615854"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "mitchell"], ["email", "niko@mohrlind.co"], ["password", "7eQrL0Np42ZnLi2t"], ["role_cd", 3], ["created_at", "2017-07-28 07:55:58.620492"], ["updated_at", "2017-07-28 07:55:58.620492"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:58 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"mitchell", "email"=>"niko@mohrlind.co", "password"=>"7eQrL0Np42ZnLi2t", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"mitchell", :email=>"niko@mohrlind.co", :password=>"7eQrL0Np42ZnLi2t", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"niko@mohrlind.co", "password"=>"7eQrL0Np42ZnLi2t"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "mitchell"], ["email", "niko@mohrlind.co"], ["password", "7eQrL0Np42ZnLi2t"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 8, username: "mitchell", email: "niko@mohrlind.co", password: "7eQrL0Np42ZnLi2t", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:55:58", updated_at: "2017-07-28 07:55:58", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 8[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=regular&loyalty_days=7&page=1&sort_field=visits30&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:58 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"regular", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits30", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 8) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 8]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>8, "username"=>"mitchell", "email"=>"niko@mohrlind.co", "password"=>"7eQrL0Np42ZnLi2t", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"regular", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits30", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.7ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_8[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>8, :username=>"mitchell", :email=>"niko@mohrlind.co", :password=>"7eQrL0Np42ZnLi2t", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:55:58.620Z", :updated_at=>"2017-07-28T07:55:58.620Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:55:58.540553') AND "client_counters"."location_id" IN (4, 5, 6) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) > 1) ORDER BY visits30 asc, updated_at desc, visits desc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 3[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.9ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 3[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:55:58.540553') AND "client_counters"."location_id" IN (4, 5, 6) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) > 1)[0m
[INFO ] Completed [32m200 OK[0m in 32ms [30m(Views: 0.4ms | ActiveRecord: 9.3ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "175.077.7065 x258"], ["created_at", "2017-07-28 07:55:58.672549"], ["updated_at", "2017-07-28 07:55:58.672549"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Keylex"], ["created_at", "2017-07-28 07:55:58.679790"], ["updated_at", "2017-07-28 07:55:58.679790"], ["local_path", "http://predoviclabadie.com/leonardo"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Rank"], ["title_ru", "Название7"], ["created_at", "2017-07-28 07:55:58.683688"], ["updated_at", "2017-07-28 07:55:58.683688"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 7[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_7[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 7) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>7, "title"=>"Keylex", "created_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "local_path"=>"http://predoviclabadie.com/leonardo"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "pannier"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "pannier"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Pannier"], ["category_id", 7], ["slug", "pannier"], ["created_at", "2017-07-28 07:55:58.694960"], ["updated_at", "2017-07-28 07:55:58.694960"], ["layout_id", 7]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "maude.kulas"], ["email", "orin@boylemcdermott.co"], ["password", "LwVvJfDc9j4"], ["created_at", "2017-07-28 07:55:58.699975"], ["updated_at", "2017-07-28 07:55:58.699975"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "qui_error"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Fintone"], ["phone", "1-947-845-5497"], ["address", "647 Reagan Canyon"], ["url", "http://kleinjakubowski.com/stephen"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ortiz.name/timmothy"], ["auth_expiration_time", 900], ["slug", "qui_error"], ["brand_id", 7], ["user_id", 9], ["created_at", "2017-07-28 07:55:58.705698"], ["updated_at", "2017-07-28 07:55:58.705698"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 5], ["location_id", 7], ["counter", 5], ["created_at", "2017-07-28 07:55:58.710256"], ["updated_at", "2017-07-28 07:55:58.710256"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "799.549.2010 x7276"], ["created_at", "2017-07-28 07:55:58.714245"], ["updated_at", "2017-07-28 07:55:58.714245"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Otcom"], ["created_at", "2017-07-28 07:55:58.721195"], ["updated_at", "2017-07-28 07:55:58.721195"], ["local_path", "http://mohr.net/leopoldo_doyle"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Treeflex"], ["title_ru", "Название8"], ["created_at", "2017-07-28 07:55:58.725133"], ["updated_at", "2017-07-28 07:55:58.725133"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 8[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (1.0ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 8) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>8, "title"=>"Otcom", "created_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "local_path"=>"http://mohr.net/leopoldo_doyle"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "greenlam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "greenlam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Greenlam"], ["category_id", 8], ["slug", "greenlam"], ["created_at", "2017-07-28 07:55:58.736429"], ["updated_at", "2017-07-28 07:55:58.736429"], ["layout_id", 8]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "miles.wiegand"], ["email", "renee@grahammraz.co"], ["password", "4g8yQhQwI1Wr"], ["created_at", "2017-07-28 07:55:58.741254"], ["updated_at", "2017-07-28 07:55:58.741254"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "velit.esse"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Duobam"], ["phone", "826.847.2960"], ["address", "85485 Turcotte Gateway"], ["url", "http://bernhard.co/isabella"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://tremblay.info/sherwood"], ["auth_expiration_time", 900], ["slug", "velit.esse"], ["brand_id", 8], ["user_id", 10], ["created_at", "2017-07-28 07:55:58.746776"], ["updated_at", "2017-07-28 07:55:58.746776"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 6], ["location_id", 8], ["counter", 8], ["created_at", "2017-07-28 07:55:58.751064"], ["updated_at", "2017-07-28 07:55:58.751064"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Domainer"], ["created_at", "2017-07-28 07:55:58.757681"], ["updated_at", "2017-07-28 07:55:58.757681"], ["local_path", "http://cainabshire.biz/darrel"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Veribet"], ["title_ru", "Название9"], ["created_at", "2017-07-28 07:55:58.761627"], ["updated_at", "2017-07-28 07:55:58.761627"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 9[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_9[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 9) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>9, "title"=>"Domainer", "created_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "local_path"=>"http://cainabshire.biz/darrel"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "lotlux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "lotlux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Lotlux"], ["category_id", 9], ["slug", "lotlux"], ["created_at", "2017-07-28 07:55:58.772216"], ["updated_at", "2017-07-28 07:55:58.772216"], ["layout_id", 9]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "eliza.lowe"], ["email", "gavin@vonrueden.biz"], ["password", "Kv3kV6BhZ"], ["created_at", "2017-07-28 07:55:58.776878"], ["updated_at", "2017-07-28 07:55:58.776878"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "minus.illum"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Mat Lam Tam"], ["phone", "1-410-782-0429"], ["address", "8881 Rodriguez Forges"], ["url", "http://doylelakin.co/greg"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://caingottlieb.com/reynold_white"], ["auth_expiration_time", 900], ["slug", "minus.illum"], ["brand_id", 9], ["user_id", 11], ["created_at", "2017-07-28 07:55:58.782425"], ["updated_at", "2017-07-28 07:55:58.782425"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 5], ["location_id", 9], ["counter", 4], ["created_at", "2017-07-28 07:55:58.786752"], ["updated_at", "2017-07-28 07:55:58.786752"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "vada"], ["email", "kirstin@leuschkeveum.com"], ["password", "X2Je0rBwU"], ["role_cd", 3], ["created_at", "2017-07-28 07:55:58.791299"], ["updated_at", "2017-07-28 07:55:58.791299"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:58 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"vada", "email"=>"kirstin@leuschkeveum.com", "password"=>"X2Je0rBwU", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"vada", :email=>"kirstin@leuschkeveum.com", :password=>"X2Je0rBwU", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"kirstin@leuschkeveum.com", "password"=>"X2Je0rBwU"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "vada"], ["email", "kirstin@leuschkeveum.com"], ["password", "X2Je0rBwU"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 12, username: "vada", email: "kirstin@leuschkeveum.com", password: "X2Je0rBwU", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:55:58", updated_at: "2017-07-28 07:55:58", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 12[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=passed&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:58 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"passed", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 12) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 12]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>12, "username"=>"vada", "email"=>"kirstin@leuschkeveum.com", "password"=>"X2Je0rBwU", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"passed", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_12[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>12, :username=>"vada", :email=>"kirstin@leuschkeveum.com", :password=>"X2Je0rBwU", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:55:58.791Z", :updated_at=>"2017-07-28T07:55:58.791Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.2ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:55:58.820399') AND "client_counters"."location_id" IN (7, 8, 9) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1) ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 6[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 6[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:55:58.820399') AND "client_counters"."location_id" IN (7, 8, 9) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1)[0m
[INFO ] Completed [32m200 OK[0m in 30ms [30m(Views: 0.6ms | ActiveRecord: 8.3ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-961-419-1806 x41350"], ["created_at", "2017-07-28 07:55:58.841374"], ["updated_at", "2017-07-28 07:55:58.841374"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Holdlamis"], ["created_at", "2017-07-28 07:55:58.848576"], ["updated_at", "2017-07-28 07:55:58.848576"], ["local_path", "http://doyle.com/adonis.emmerich"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Flowdesk"], ["title_ru", "Название10"], ["created_at", "2017-07-28 07:55:58.852419"], ["updated_at", "2017-07-28 07:55:58.852419"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 10[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_10[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 10) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>10, "title"=>"Holdlamis", "created_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "local_path"=>"http://doyle.com/adonis.emmerich"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bigtax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bigtax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bigtax"], ["category_id", 10], ["slug", "bigtax"], ["created_at", "2017-07-28 07:55:58.863433"], ["updated_at", "2017-07-28 07:55:58.863433"], ["layout_id", 10]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ro"], ["email", "chad@kirlin.biz"], ["password", "3sAs29K7MpZyN3U"], ["created_at", "2017-07-28 07:55:58.868345"], ["updated_at", "2017-07-28 07:55:58.868345"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "quia-veniam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Gembucket"], ["phone", "(929) 232-6519"], ["address", "1736 Van Squares"], ["url", "http://sporer.info/eleanore.rohan"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://leannon.io/holly"], ["auth_expiration_time", 900], ["slug", "quia-veniam"], ["brand_id", 10], ["user_id", 13], ["created_at", "2017-07-28 07:55:58.874182"], ["updated_at", "2017-07-28 07:55:58.874182"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 7], ["location_id", 10], ["counter", 5], ["created_at", "2017-07-28 07:55:58.878759"], ["updated_at", "2017-07-28 07:55:58.878759"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(973) 793-7549 x27056"], ["created_at", "2017-07-28 07:55:58.882779"], ["updated_at", "2017-07-28 07:55:58.882779"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Duobam"], ["created_at", "2017-07-28 07:55:58.889810"], ["updated_at", "2017-07-28 07:55:58.889810"], ["local_path", "http://kutchkuhic.com/karlie.wilkinson"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zaam-Dox"], ["title_ru", "Название11"], ["created_at", "2017-07-28 07:55:58.893703"], ["updated_at", "2017-07-28 07:55:58.893703"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 11[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_11[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 11) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>11, "title"=>"Duobam", "created_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "local_path"=>"http://kutchkuhic.com/karlie.wilkinson"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-find"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-find"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Y-find"], ["category_id", 11], ["slug", "y-find"], ["created_at", "2017-07-28 07:55:58.905115"], ["updated_at", "2017-07-28 07:55:58.905115"], ["layout_id", 11]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "myrtle_wolff"], ["email", "brenden@turnerwilkinson.co"], ["password", "SlL5ZbKoR7Uj"], ["created_at", "2017-07-28 07:55:58.910107"], ["updated_at", "2017-07-28 07:55:58.910107"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "laboriosam.alias"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Regrant"], ["phone", "546-074-8233"], ["address", "9433 Spencer Crossing"], ["url", "http://cremin.name/durward"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://harber.name/teie.grimes"], ["auth_expiration_time", 900], ["slug", "laboriosam.alias"], ["brand_id", 11], ["user_id", 14], ["created_at", "2017-07-28 07:55:58.915802"], ["updated_at", "2017-07-28 07:55:58.915802"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 8], ["location_id", 11], ["counter", 9], ["created_at", "2017-07-28 07:55:58.920031"], ["updated_at", "2017-07-28 07:55:58.920031"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Cardify"], ["created_at", "2017-07-28 07:55:58.927172"], ["updated_at", "2017-07-28 07:55:58.927172"], ["local_path", "http://bergnaumhowell.org/bette_crooks"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Duobam"], ["title_ru", "Название12"], ["created_at", "2017-07-28 07:55:58.931046"], ["updated_at", "2017-07-28 07:55:58.931046"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 12[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_12[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 12) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>12, "title"=>"Cardify", "created_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "local_path"=>"http://bergnaumhowell.org/bette_crooks"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alphazap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alphazap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Alphazap"], ["category_id", 12], ["slug", "alphazap"], ["created_at", "2017-07-28 07:55:58.942217"], ["updated_at", "2017-07-28 07:55:58.942217"], ["layout_id", 12]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "trevor_hudson"], ["email", "dulce.keler@hahnschmeler.biz"], ["password", "ZpTf9h4pLn"], ["created_at", "2017-07-28 07:55:58.947389"], ["updated_at", "2017-07-28 07:55:58.947389"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "cupiditate_maxime"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bitchip"], ["phone", "689-154-3781"], ["address", "146 Romaine Dam"], ["url", "http://hammesmurphy.info/eino_beer"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://vandervortmccullough.org/amir_schowalter"], ["auth_expiration_time", 900], ["slug", "cupiditate_maxime"], ["brand_id", 12], ["user_id", 15], ["created_at", "2017-07-28 07:55:58.953395"], ["updated_at", "2017-07-28 07:55:58.953395"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 7], ["location_id", 12], ["counter", 10], ["created_at", "2017-07-28 07:55:58.957945"], ["updated_at", "2017-07-28 07:55:58.957945"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bitwolf"], ["created_at", "2017-07-28 07:55:58.964886"], ["updated_at", "2017-07-28 07:55:58.964886"], ["local_path", "http://lehner.io/logan"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Asoka"], ["title_ru", "Название13"], ["created_at", "2017-07-28 07:55:58.968720"], ["updated_at", "2017-07-28 07:55:58.968720"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 13[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_13[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 13) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>13, "title"=>"Bitwolf", "created_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "local_path"=>"http://lehner.io/logan"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voltsillam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voltsillam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Voltsillam"], ["category_id", 13], ["slug", "voltsillam"], ["created_at", "2017-07-28 07:55:58.979819"], ["updated_at", "2017-07-28 07:55:58.979819"], ["layout_id", 13]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "camden.klein"], ["email", "donato_kuhn@lynch.co"], ["password", "KiG9434eFe1oXkKr"], ["created_at", "2017-07-28 07:55:58.984664"], ["updated_at", "2017-07-28 07:55:58.984664"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "aliquid-voluptates"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Holdlamis"], ["phone", "(663) 684-3052"], ["address", "379 Beahan Mount"], ["url", "http://powlowskihyatt.org/olin"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ebert.net/laurine"], ["auth_expiration_time", 900], ["slug", "aliquid-voluptates"], ["brand_id", 13], ["user_id", 16], ["created_at", "2017-07-28 07:55:58.990056"], ["updated_at", "2017-07-28 07:55:58.990056"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 8], ["location_id", 13], ["counter", 5], ["created_at", "2017-07-20 07:55:58.960370"], ["updated_at", "2017-07-20 07:55:58.960487"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "kasandra"], ["email", "ebba@hauck.name"], ["password", "Zc0261BfWeK"], ["role_cd", 3], ["created_at", "2017-07-28 07:55:58.999589"], ["updated_at", "2017-07-28 07:55:58.999589"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:59 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"kasandra", "email"=>"ebba@hauck.name", "password"=>"Zc0261BfWeK", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"kasandra", :email=>"ebba@hauck.name", :password=>"Zc0261BfWeK", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"ebba@hauck.name", "password"=>"Zc0261BfWeK"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "kasandra"], ["email", "ebba@hauck.name"], ["password", "Zc0261BfWeK"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 17, username: "kasandra", email: "ebba@hauck.name", password: "Zc0261BfWeK", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:55:58", updated_at: "2017-07-28 07:55:58", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 17[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=passed&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:59 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"passed", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 17) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 17]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>17, "username"=>"kasandra", "email"=>"ebba@hauck.name", "password"=>"Zc0261BfWeK", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:58 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"passed", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_17[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>17, :username=>"kasandra", :email=>"ebba@hauck.name", :password=>"Zc0261BfWeK", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:55:58.999Z", :updated_at=>"2017-07-28T07:55:58.999Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:55:59.028624') AND "client_counters"."location_id" IN (10, 11, 12, 13) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1) ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 8[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" = 8[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-21 07:55:59.028624') AND "client_counters"."location_id" IN (10, 11, 12, 13) GROUP BY "client_counters"."client_id", client_id, phone_number HAVING (count(client_counters.id) = 1)[0m
[INFO ] Completed [32m200 OK[0m in 30ms [30m(Views: 0.4ms | ActiveRecord: 8.1ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "627.738.2573 x5003"], ["created_at", "2017-07-28 07:55:59.049766"], ["updated_at", "2017-07-28 07:55:59.049766"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Vagram"], ["created_at", "2017-07-28 07:55:59.056651"], ["updated_at", "2017-07-28 07:55:59.056651"], ["local_path", "http://boehm.name/maureen_frami"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Tampflex"], ["title_ru", "Название14"], ["created_at", "2017-07-28 07:55:59.060279"], ["updated_at", "2017-07-28 07:55:59.060279"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 14[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_14[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 14) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>14, "title"=>"Vagram", "created_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "local_path"=>"http://boehm.name/maureen_frami"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "home-ing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "home-ing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Home Ing"], ["category_id", 14], ["slug", "home-ing"], ["created_at", "2017-07-28 07:55:59.071368"], ["updated_at", "2017-07-28 07:55:59.071368"], ["layout_id", 14]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "verlie_raynor"], ["email", "ryley_connelly@kihnlynch.io"], ["password", "ZlMlIyQ4OnOw"], ["created_at", "2017-07-28 07:55:59.076239"], ["updated_at", "2017-07-28 07:55:59.076239"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "facere.officia"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Kanlam"], ["phone", "(600) 716-0239"], ["address", "484 Esta Ferry"], ["url", "http://beer.biz/kathryne_nitzsche"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://eichmann.org/denis_cummerata"], ["auth_expiration_time", 900], ["slug", "facere.officia"], ["brand_id", 14], ["user_id", 18], ["created_at", "2017-07-28 07:55:59.081808"], ["updated_at", "2017-07-28 07:55:59.081808"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 9], ["location_id", 14], ["counter", 5], ["created_at", "2017-07-28 07:55:59.086089"], ["updated_at", "2017-07-28 07:55:59.086089"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-865-464-9854 x289"], ["created_at", "2017-07-28 07:55:59.090118"], ["updated_at", "2017-07-28 07:55:59.090118"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Asoka"], ["created_at", "2017-07-28 07:55:59.096832"], ["updated_at", "2017-07-28 07:55:59.096832"], ["local_path", "http://wisoky.info/jaycee.cole"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Biodex"], ["title_ru", "Название15"], ["created_at", "2017-07-28 07:55:59.100589"], ["updated_at", "2017-07-28 07:55:59.100589"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 15[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_15[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 15) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>15, "title"=>"Asoka", "created_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "local_path"=>"http://wisoky.info/jaycee.cole"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "otcom"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "otcom"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Otcom"], ["category_id", 15], ["slug", "otcom"], ["created_at", "2017-07-28 07:55:59.111774"], ["updated_at", "2017-07-28 07:55:59.111774"], ["layout_id", 15]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jamal"], ["email", "beth_klein@moriette.biz"], ["password", "QhL7KuA1SpZ"], ["created_at", "2017-07-28 07:55:59.116800"], ["updated_at", "2017-07-28 07:55:59.116800"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "sunt_dolorem"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Cardguard"], ["phone", "635.815.3431"], ["address", "828 Abelardo Glen"], ["url", "http://schroeder.info/stephon"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://renner.biz/antone"], ["auth_expiration_time", 900], ["slug", "sunt_dolorem"], ["brand_id", 15], ["user_id", 19], ["created_at", "2017-07-28 07:55:59.122390"], ["updated_at", "2017-07-28 07:55:59.122390"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 10], ["location_id", 15], ["counter", 9], ["created_at", "2017-07-28 07:55:59.126808"], ["updated_at", "2017-07-28 07:55:59.126808"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Sonair"], ["created_at", "2017-07-28 07:55:59.133618"], ["updated_at", "2017-07-28 07:55:59.133618"], ["local_path", "http://block.info/onie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Prodder"], ["title_ru", "Название16"], ["created_at", "2017-07-28 07:55:59.137516"], ["updated_at", "2017-07-28 07:55:59.137516"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 16[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_16[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 16) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>16, "title"=>"Sonair", "created_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "local_path"=>"http://block.info/onie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tin"], ["category_id", 16], ["slug", "tin"], ["created_at", "2017-07-28 07:55:59.148350"], ["updated_at", "2017-07-28 07:55:59.148350"], ["layout_id", 16]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "makenzie.feil"], ["email", "jeanette.bayer@anderson.org"], ["password", "XnOu51RvX0Sm"], ["created_at", "2017-07-28 07:55:59.153240"], ["updated_at", "2017-07-28 07:55:59.153240"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "iusto_repudiandae"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Overhold"], ["phone", "511-602-4349"], ["address", "2195 Dayna Glen"], ["url", "http://runolfonrunolfon.org/mandy"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://labadie.org/eula.carroll"], ["auth_expiration_time", 900], ["slug", "iusto_repudiandae"], ["brand_id", 16], ["user_id", 20], ["created_at", "2017-07-28 07:55:59.158908"], ["updated_at", "2017-07-28 07:55:59.158908"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 9], ["location_id", 16], ["counter", 3], ["created_at", "2017-07-28 07:55:59.163174"], ["updated_at", "2017-07-28 07:55:59.163174"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "edna_kshlerin"], ["email", "michaela_hyatt@mitchell.org"], ["password", "GpTnFs5wH"], ["role_cd", 3], ["created_at", "2017-07-28 07:55:59.167739"], ["updated_at", "2017-07-28 07:55:59.167739"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:59 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"edna_kshlerin", "email"=>"michaela_hyatt@mitchell.org", "password"=>"GpTnFs5wH", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"edna_kshlerin", :email=>"michaela_hyatt@mitchell.org", :password=>"GpTnFs5wH", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"michaela_hyatt@mitchell.org", "password"=>"GpTnFs5wH"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "edna_kshlerin"], ["email", "michaela_hyatt@mitchell.org"], ["password", "GpTnFs5wH"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 21, username: "edna_kshlerin", email: "michaela_hyatt@mitchell.org", password: "GpTnFs5wH", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:55:59", updated_at: "2017-07-28 07:55:59", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 21[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=visits&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:59 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 21) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 21]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>21, "username"=>"edna_kshlerin", "email"=>"michaela_hyatt@mitchell.org", "password"=>"GpTnFs5wH", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (1.0ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_21[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>21, :username=>"edna_kshlerin", :email=>"michaela_hyatt@mitchell.org", :password=>"GpTnFs5wH", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:55:59.167Z", :updated_at=>"2017-07-28T07:55:59.167Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:55:59.086089') AND "client_counters"."location_id" IN (14, 15, 16) GROUP BY client_id, phone_number ORDER BY visits desc, updated_at desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (9, 10)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.7ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (9, 10)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:55:59.086089') AND "client_counters"."location_id" IN (14, 15, 16) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 31ms [30m(Views: 0.6ms | ActiveRecord: 8.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "460.323.5537"], ["created_at", "2017-07-28 07:55:59.219357"], ["updated_at", "2017-07-28 07:55:59.219357"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Alpha"], ["created_at", "2017-07-28 07:55:59.226443"], ["updated_at", "2017-07-28 07:55:59.226443"], ["local_path", "http://langworth.net/elise"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Span"], ["title_ru", "Название17"], ["created_at", "2017-07-28 07:55:59.230439"], ["updated_at", "2017-07-28 07:55:59.230439"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 17[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_17[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 17) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>17, "title"=>"Alpha", "created_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "local_path"=>"http://langworth.net/elise"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "temp"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "temp"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Temp"], ["category_id", 17], ["slug", "temp"], ["created_at", "2017-07-28 07:55:59.241569"], ["updated_at", "2017-07-28 07:55:59.241569"], ["layout_id", 17]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "arnoldo.aufderhar"], ["email", "colt@corwinzulauf.com"], ["password", "X4Iv5gK3OmLgC"], ["created_at", "2017-07-28 07:55:59.246508"], ["updated_at", "2017-07-28 07:55:59.246508"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "sit_voluptate"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bitchip"], ["phone", "(282) 464-1435"], ["address", "79129 Asha Square"], ["url", "http://stantonbeer.io/april_okon"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://lowe.com/jensen"], ["auth_expiration_time", 900], ["slug", "sit_voluptate"], ["brand_id", 17], ["user_id", 22], ["created_at", "2017-07-28 07:55:59.251951"], ["updated_at", "2017-07-28 07:55:59.251951"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 11], ["location_id", 17], ["counter", 1], ["created_at", "2017-07-28 07:55:59.256187"], ["updated_at", "2017-07-28 07:55:59.256187"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-588-158-7466"], ["created_at", "2017-07-28 07:55:59.260059"], ["updated_at", "2017-07-28 07:55:59.260059"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Biodex"], ["created_at", "2017-07-28 07:55:59.266806"], ["updated_at", "2017-07-28 07:55:59.266806"], ["local_path", "http://collins.net/kelli"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "It"], ["title_ru", "Название18"], ["created_at", "2017-07-28 07:55:59.270807"], ["updated_at", "2017-07-28 07:55:59.270807"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 18[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_18[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 18) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>18, "title"=>"Biodex", "created_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "local_path"=>"http://collins.net/kelli"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Konklab"], ["category_id", 18], ["slug", "konklab"], ["created_at", "2017-07-28 07:55:59.281729"], ["updated_at", "2017-07-28 07:55:59.281729"], ["layout_id", 18]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lucius"], ["email", "justine@wehner.io"], ["password", "HqG1LzTk70P90p94"], ["created_at", "2017-07-28 07:55:59.286604"], ["updated_at", "2017-07-28 07:55:59.286604"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "distinctio-culpa"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zamit"], ["phone", "(148) 293-1997"], ["address", "25460 Alfredo Isle"], ["url", "http://boganmarquardt.name/salvador_hirthe"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://braunmitchell.org/samanta_mcclure"], ["auth_expiration_time", 900], ["slug", "distinctio-culpa"], ["brand_id", 18], ["user_id", 23], ["created_at", "2017-07-28 07:55:59.292195"], ["updated_at", "2017-07-28 07:55:59.292195"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 12], ["location_id", 18], ["counter", 1], ["created_at", "2017-07-28 07:55:59.296708"], ["updated_at", "2017-07-28 07:55:59.296708"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Pannier"], ["created_at", "2017-07-28 07:55:59.303865"], ["updated_at", "2017-07-28 07:55:59.303865"], ["local_path", "http://rice.biz/judson_bahringer"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Sonair"], ["title_ru", "Название19"], ["created_at", "2017-07-28 07:55:59.307779"], ["updated_at", "2017-07-28 07:55:59.307779"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 19[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_19[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 19) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>19, "title"=>"Pannier", "created_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "local_path"=>"http://rice.biz/judson_bahringer"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklab"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklab-category0x007fdb9f8c9218"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "konklab-category0x007fdb9f8c9218"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Konklab"], ["category_id", 19], ["slug", "konklab-category0x007fdb9f8c9218"], ["created_at", "2017-07-28 07:55:59.320127"], ["updated_at", "2017-07-28 07:55:59.320127"], ["layout_id", 19]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "estelle_reichel"], ["email", "domenick@robel.co"], ["password", "3nZkRsUjLbPq9d"], ["created_at", "2017-07-28 07:55:59.325129"], ["updated_at", "2017-07-28 07:55:59.325129"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "deleniti.consequuntur"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Tresom"], ["phone", "383.595.1176"], ["address", "77445 Mante Rapids"], ["url", "http://rutherfordmcdermott.info/brett_leuschke"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ohara.io/alisha"], ["auth_expiration_time", 900], ["slug", "deleniti.consequuntur"], ["brand_id", 19], ["user_id", 24], ["created_at", "2017-07-28 07:55:59.330892"], ["updated_at", "2017-07-28 07:55:59.330892"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 11], ["location_id", 19], ["counter", 7], ["created_at", "2017-07-28 07:55:59.335278"], ["updated_at", "2017-07-28 07:55:59.335278"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "greyson"], ["email", "javonte@lueilwitzziemann.net"], ["password", "I2Xh3bBuGx1pJ"], ["role_cd", 3], ["created_at", "2017-07-28 07:55:59.340035"], ["updated_at", "2017-07-28 07:55:59.340035"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:59 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"greyson", "email"=>"javonte@lueilwitzziemann.net", "password"=>"I2Xh3bBuGx1pJ", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"greyson", :email=>"javonte@lueilwitzziemann.net", :password=>"I2Xh3bBuGx1pJ", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"javonte@lueilwitzziemann.net", "password"=>"I2Xh3bBuGx1pJ"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "greyson"], ["email", "javonte@lueilwitzziemann.net"], ["password", "I2Xh3bBuGx1pJ"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 25, username: "greyson", email: "javonte@lueilwitzziemann.net", password: "I2Xh3bBuGx1pJ", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:55:59", updated_at: "2017-07-28 07:55:59", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 25[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=updated_at&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:59 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"updated_at", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 25) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 25]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>25, "username"=>"greyson", "email"=>"javonte@lueilwitzziemann.net", "password"=>"I2Xh3bBuGx1pJ", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"updated_at", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.7ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_25[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>25, :username=>"greyson", :email=>"javonte@lueilwitzziemann.net", :password=>"I2Xh3bBuGx1pJ", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:55:59.340Z", :updated_at=>"2017-07-28T07:55:59.340Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:55:59.256187') AND "client_counters"."location_id" IN (17, 18, 19) GROUP BY client_id, phone_number ORDER BY updated_at desc, visits desc, visits30 asc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (11, 12)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (11, 12)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-07-28 07:55:59.256187') AND "client_counters"."location_id" IN (17, 18, 19) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 30ms [30m(Views: 0.5ms | ActiveRecord: 8.4ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "802-230-6478 x547"], ["created_at", "2017-07-28 07:55:59.390651"], ["updated_at", "2017-07-28 07:55:59.390651"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Viva"], ["created_at", "2017-07-28 07:55:59.397141"], ["updated_at", "2017-07-28 07:55:59.397141"], ["local_path", "http://skiles.biz/polly"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Alpha"], ["title_ru", "Название20"], ["created_at", "2017-07-28 07:55:59.400639"], ["updated_at", "2017-07-28 07:55:59.400639"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 20[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_20[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 20) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>20, "title"=>"Viva", "created_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "local_path"=>"http://skiles.biz/polly"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonsing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonsing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Sonsing"], ["category_id", 20], ["slug", "sonsing"], ["created_at", "2017-07-28 07:55:59.411159"], ["updated_at", "2017-07-28 07:55:59.411159"], ["layout_id", 20]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "armando.kuhic"], ["email", "aleia@kaulkecarroll.net"], ["password", "QqKo4iUo"], ["created_at", "2017-07-28 07:55:59.415744"], ["updated_at", "2017-07-28 07:55:59.415744"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "nisi_in"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bigtax"], ["phone", "455.122.7627"], ["address", "924 Champlin Knolls"], ["url", "http://brown.net/yasmine_kuhic"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://johnson.com/murray_gulgowski"], ["auth_expiration_time", 900], ["slug", "nisi_in"], ["brand_id", 20], ["user_id", 26], ["created_at", "2017-07-28 07:55:59.421066"], ["updated_at", "2017-07-28 07:55:59.421066"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 13], ["location_id", 20], ["counter", 4], ["created_at", "2017-07-28 07:55:59.425441"], ["updated_at", "2017-07-28 07:55:59.425441"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-322-309-4616"], ["created_at", "2017-07-28 07:55:59.429257"], ["updated_at", "2017-07-28 07:55:59.429257"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Fixflex"], ["created_at", "2017-07-28 07:55:59.435493"], ["updated_at", "2017-07-28 07:55:59.435493"], ["local_path", "http://schinner.net/jana"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Toughjoyfax"], ["title_ru", "Название21"], ["created_at", "2017-07-28 07:55:59.439191"], ["updated_at", "2017-07-28 07:55:59.439191"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 21[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_21[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 21) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>21, "title"=>"Fixflex", "created_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "local_path"=>"http://schinner.net/jana"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "rank"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "rank"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Rank"], ["category_id", 21], ["slug", "rank"], ["created_at", "2017-07-28 07:55:59.449588"], ["updated_at", "2017-07-28 07:55:59.449588"], ["layout_id", 21]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "giovanny"], ["email", "ben_gleichner@durganrunte.co"], ["password", "O6AiGqS98p"], ["created_at", "2017-07-28 07:55:59.454170"], ["updated_at", "2017-07-28 07:55:59.454170"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "fugit.nisi"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Overhold"], ["phone", "(335) 100-2319"], ["address", "6223 Donnell Underpass"], ["url", "http://wisoky.org/eryn"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://buckridgechristiansen.io/brain"], ["auth_expiration_time", 900], ["slug", "fugit.nisi"], ["brand_id", 21], ["user_id", 27], ["created_at", "2017-07-28 07:55:59.459451"], ["updated_at", "2017-07-28 07:55:59.459451"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 14], ["location_id", 21], ["counter", 9], ["created_at", "2017-07-28 07:55:59.463519"], ["updated_at", "2017-07-28 07:55:59.463519"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Span"], ["created_at", "2017-07-28 07:55:59.483531"], ["updated_at", "2017-07-28 07:55:59.483531"], ["local_path", "http://whiteschuster.name/mandy_swaniawski"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Home Ing"], ["title_ru", "Название22"], ["created_at", "2017-07-28 07:55:59.487504"], ["updated_at", "2017-07-28 07:55:59.487504"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 22[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_22[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 22) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>22, "title"=>"Span", "created_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "local_path"=>"http://whiteschuster.name/mandy_swaniawski"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonsing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonsing-category0x007fdba4251390"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonsing-category0x007fdba4251390"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Sonsing"], ["category_id", 22], ["slug", "sonsing-category0x007fdba4251390"], ["created_at", "2017-07-28 07:55:59.500371"], ["updated_at", "2017-07-28 07:55:59.500371"], ["layout_id", 22]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ellis"], ["email", "alyson_beier@klocko.net"], ["password", "NrL30zAy"], ["created_at", "2017-07-28 07:55:59.505271"], ["updated_at", "2017-07-28 07:55:59.505271"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "autem-laborum"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Fintone"], ["phone", "(933) 304-6740"], ["address", "6458 Vandervort Islands"], ["url", "http://balistreri.info/reyna.raynor"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://nikolaus.com/ozella"], ["auth_expiration_time", 900], ["slug", "autem-laborum"], ["brand_id", 22], ["user_id", 28], ["created_at", "2017-07-28 07:55:59.511118"], ["updated_at", "2017-07-28 07:55:59.511118"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 13], ["location_id", 22], ["counter", 6], ["created_at", "2017-07-28 07:55:59.515796"], ["updated_at", "2017-07-28 07:55:59.515796"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-113-098-7253"], ["created_at", "2017-07-28 07:55:59.520347"], ["updated_at", "2017-07-28 07:55:59.520347"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Viva"], ["created_at", "2017-07-28 07:55:59.526820"], ["updated_at", "2017-07-28 07:55:59.526820"], ["local_path", "http://cummerataharris.net/graham"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Mat Lam Tam"], ["title_ru", "Название23"], ["created_at", "2017-07-28 07:55:59.530639"], ["updated_at", "2017-07-28 07:55:59.530639"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 23[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_23[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 23) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>23, "title"=>"Viva", "created_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "local_path"=>"http://cummerataharris.net/graham"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "veribet"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "veribet"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Veribet"], ["category_id", 23], ["slug", "veribet"], ["created_at", "2017-07-28 07:55:59.542227"], ["updated_at", "2017-07-28 07:55:59.542227"], ["layout_id", 23]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "frida_hudson"], ["email", "terrill@erdmansporer.name"], ["password", "V9F8PhY6"], ["created_at", "2017-07-28 07:55:59.547279"], ["updated_at", "2017-07-28 07:55:59.547279"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "laborum-qui"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stim"], ["phone", "542-670-9972"], ["address", "483 McClure Junctions"], ["url", "http://keelingmiller.com/adeline"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://wolf.com/juliet_spinka"], ["auth_expiration_time", 900], ["slug", "laborum-qui"], ["brand_id", 23], ["user_id", 29], ["created_at", "2017-07-28 07:55:59.553741"], ["updated_at", "2017-07-28 07:55:59.553741"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "client_counters" ("client_id", "location_id", "counter", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 15], ["location_id", 23], ["counter", 5], ["created_at", "2017-06-26 07:55:59.518454"], ["updated_at", "2017-06-26 07:55:59.518568"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "role_cd", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["username", "leda"], ["email", "dorothea@purdykoepp.net"], ["password", "9hGlTgD22a9"], ["role_cd", 3], ["created_at", "2017-07-28 07:55:59.563281"], ["updated_at", "2017-07-28 07:55:59.563281"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:59 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"leda", "email"=>"dorothea@purdykoepp.net", "password"=>"9hGlTgD22a9", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"leda", :email=>"dorothea@purdykoepp.net", :password=>"9hGlTgD22a9", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"dorothea@purdykoepp.net", "password"=>"9hGlTgD22a9"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "leda"], ["email", "dorothea@purdykoepp.net"], ["password", "9hGlTgD22a9"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 30, username: "leda", email: "dorothea@purdykoepp.net", password: "9hGlTgD22a9", avatar: "/images/avatars/default.jpg", role_cd: 3, tour: true, created_at: "2017-07-28 07:55:59", updated_at: "2017-07-28 07:55:59", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 30[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/clients/?loyalty=all&loyalty_days=7&page=1&sort_field=visits30&updated_at=desc&visits=desc&visits30=asc" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:59 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::ClientsController#index[0m as [33mJSON[0m
[INFO ]   Parameters: {"loyalty"=>"all", "loyalty_days"=>"7", "page"=>"1", "sort_field"=>"visits30", "updated_at"=>"desc", "visits"=>"desc", "visits30"=>"asc"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 30) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 30]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>30, "username"=>"leda", "email"=>"dorothea@purdykoepp.net", "password"=>"9hGlTgD22a9", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>3, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:loyalty=>"all", :loyalty_days=>"7", :page=>"1", :sort_field=>"visits30", :updated_at=>"desc", :visits=>"desc", :visits30=>"asc", :format=>"json", :controller=>"dashboard/clients", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClientCounter Load (0.8ms)[0m  [1m[34mSELECT  "client_counters".* FROM "client_counters" ORDER BY "client_counters"."created_at" ASC LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_30[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>30, :username=>"leda", :email=>"dorothea@purdykoepp.net", :password=>"9hGlTgD22a9", :avatar=>"/images/avatars/default.jpg", :role_cd=>3, :tour=>true, :created_at=>"2017-07-28T07:55:59.563Z", :updated_at=>"2017-07-28T07:55:59.563Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>true, :power_user=>true, :can_manage_child_items=>true, :can_create_as_child=>true, :can_view_child_items=>true, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>true, :can_create_employees=>true, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT  client_id, phone_number, max(client_counters.updated_at) as updated_at,
                                                              count(client_counters.id) as visits,
                                                              sum(case when client_counters.created_at
                                                                  between
                                                                  '2017-06-28 00:00:00 UTC'
                                                                  and
                                                                  '2017-07-29 00:00:00 UTC'
                                                                  then 1 else 0 end) as visits30 FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-06-26 07:55:59.518454') AND "client_counters"."location_id" IN (20, 21, 22, 23) GROUP BY client_id, phone_number ORDER BY visits30 asc, updated_at desc, visits desc LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (15, 14, 13)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.7ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (13, 14, 15)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT count("client_counters"."client_id") FROM "client_counters" INNER JOIN "clients" ON "clients"."id" = "client_counters"."client_id" WHERE (client_counters.created_at >= '2017-06-26 07:55:59.518454') AND "client_counters"."location_id" IN (20, 21, 22, 23) GROUP BY client_id, phone_number[0m
[INFO ] Completed [32m200 OK[0m in 32ms [30m(Views: 0.7ms | ActiveRecord: 8.8ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "dejon_kunde"], ["email", "cleo@heller.net"], ["password", "QcXyQlG11j"], ["created_at", "2017-07-28 07:55:59.615992"], ["updated_at", "2017-07-28 07:55:59.615992"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "opinions" ("style", "message", "location", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["style", "positive"], ["message", "Joe, gag on my fat dauber."], ["location", "localhost"], ["user_id", 31], ["created_at", "2017-07-28 07:55:59.633976"], ["updated_at", "2017-07-28 07:55:59.633976"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:59 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"dejon_kunde", "email"=>"cleo@heller.net", "password"=>"QcXyQlG11j", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"dejon_kunde", :email=>"cleo@heller.net", :password=>"QcXyQlG11j", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"cleo@heller.net", "password"=>"QcXyQlG11j"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "dejon_kunde"], ["email", "cleo@heller.net"], ["password", "QcXyQlG11j"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 31, username: "dejon_kunde", email: "cleo@heller.net", password: "QcXyQlG11j", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:55:59", updated_at: "2017-07-28 07:55:59", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 31[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.7ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//opinions" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:59 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::OpinionsController#index[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 31[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_31[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 31) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 31]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>31, "username"=>"dejon_kunde", "email"=>"cleo@heller.net", "password"=>"QcXyQlG11j", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/opinions", :action=>"index"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 31[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_31[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 31[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_31[0m
[[1m[30mDEBUG[0m[0m] [1m[36mauthorize index Opinion for user 31[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "opinions" WHERE "opinions"."user_id" = 31[0m
[[1m[30mDEBUG[0m[0m] [1m[36muser {:id=>31, :username=>"dejon_kunde", :email=>"cleo@heller.net", :password=>"QcXyQlG11j", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:55:59.615Z", :updated_at=>"2017-07-28T07:55:59.615Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false} can access resource Opinion(id: integer, style: string, message: text, location: string, user_id: integer, created_at: datetime, updated_at: datetime)[0m[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 31[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_31[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 31[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_31[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Opinion for user {:id=>31, :username=>"dejon_kunde", :email=>"cleo@heller.net", :password=>"QcXyQlG11j", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:55:59.615Z", :updated_at=>"2017-07-28T07:55:59.615Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mOpinion Load (0.8ms)[0m  [1m[34mSELECT "opinions".* FROM "opinions" WHERE "opinions"."user_id" = 31[0m
[INFO ] Completed [32m200 OK[0m in 27ms [30m(Views: 0.6ms | ActiveRecord: 5.4ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "iac_jenkins"], ["email", "delta@rogahncorwin.name"], ["password", "1nYqFbW2T0R"], ["created_at", "2017-07-28 07:55:59.688857"], ["updated_at", "2017-07-28 07:55:59.688857"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:59 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"iac_jenkins", "email"=>"delta@rogahncorwin.name", "password"=>"1nYqFbW2T0R", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"iac_jenkins", :email=>"delta@rogahncorwin.name", :password=>"1nYqFbW2T0R", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"delta@rogahncorwin.name", "password"=>"1nYqFbW2T0R"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "iac_jenkins"], ["email", "delta@rogahncorwin.name"], ["password", "1nYqFbW2T0R"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 32, username: "iac_jenkins", email: "delta@rogahncorwin.name", password: "1nYqFbW2T0R", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:55:59", updated_at: "2017-07-28 07:55:59", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 32[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "//opinions" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:59 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::OpinionsController#create[0m as [33mJSON[0m
[INFO ]   Parameters: {"style"=>"positive", "message"=>"Hey, don't try to take this away from me. This is the only thing I've ever been good at. Well, this and timing my farts to a thunderstorm.", "location"=>"localhost"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 32[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_32[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 32) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 32]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>32, "username"=>"iac_jenkins", "email"=>"delta@rogahncorwin.name", "password"=>"1nYqFbW2T0R", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:style=>"positive", :message=>"Hey, don't try to take this away from me. This is the only thing I've ever been good at. Well, this and timing my farts to a thunderstorm.", :location=>"localhost", :format=>"json", :controller=>"dashboard/opinions", :action=>"create"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 32[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_32[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 32[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_32[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "opinions" ("user_id", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["user_id", 32], ["created_at", "2017-07-28 07:55:59.720354"], ["updated_at", "2017-07-28 07:55:59.720354"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] Completed [32m200 OK[0m in 22ms [30m(Views: 0.4ms | ActiveRecord: 5.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "opinions"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "sam"], ["email", "aliyah@jerde.info"], ["password", "DgMbJnAaH38v6"], ["created_at", "2017-07-28 07:55:59.731951"], ["updated_at", "2017-07-28 07:55:59.731951"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "polls" ("title", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Now I may be an idiot, but there’s one thing I am not sir, and that sir, is an idiot."], ["user_id", 33], ["created_at", "2017-07-28 07:55:59.744824"], ["updated_at", "2017-07-28 07:55:59.744824"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "questions" ("title", "poll_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Now I may be an idiot, but there’s one thing I am not sir, and that sir, is an idiot."], ["poll_id", 1], ["created_at", "2017-07-28 07:55:59.764185"], ["updated_at", "2017-07-28 07:55:59.764185"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:59 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"sam", "email"=>"aliyah@jerde.info", "password"=>"DgMbJnAaH38v6", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"sam", :email=>"aliyah@jerde.info", :password=>"DgMbJnAaH38v6", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"aliyah@jerde.info", "password"=>"DgMbJnAaH38v6"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "sam"], ["email", "aliyah@jerde.info"], ["password", "DgMbJnAaH38v6"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 33, username: "sam", email: "aliyah@jerde.info", password: "DgMbJnAaH38v6", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:55:59", updated_at: "2017-07-28 07:55:59", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 33[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.7ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//polls/1/export_to_xlsx" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:55:59 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::Surveys::PollsController#export_to_xlsx[0m as [33mJSON[0m
[INFO ]   Parameters: {"poll_id"=>"1"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 33[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_33[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 33) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 33]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>33, "username"=>"sam", "email"=>"aliyah@jerde.info", "password"=>"DgMbJnAaH38v6", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>1, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/surveys/polls", :action=>"export_to_xlsx", :poll_id=>"1"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mPoll Load (1.1ms)[0m  [1m[34mSELECT  "polls".* FROM "polls" WHERE "polls"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mQuestion Load (0.8ms)[0m  [1m[34mSELECT "questions".* FROM "questions" WHERE (poll_id = 1)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mAnswer Load (0.8ms)[0m  [1m[34mSELECT "answers".* FROM "answers" WHERE "answers"."question_id" = 1 ORDER BY "answers"."id" ASC[0m
[INFO ]   Rendering text template
[INFO ]   Rendered text template (0.0ms)
[[31mERROR[0m] [31mCould not log "render_template.action_view" event. NoMethodError: undefined method `render_views?' for RSpec::ExampleGroups::PollsXlsxExport::PollsIdExportToXlsx:Class ["/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/example_group.rb:732:in `method_missing'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-rails-3.6.0/lib/rspec/rails/view_rendering.rb:71:in `render_template'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/subscriber.rb:95:in `finish'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/log_subscriber.rb:83:in `finish'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/notifications/fanout.rb:102:in `finish'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/notifications/fanout.rb:46:in `block in finish'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/notifications/fanout.rb:46:in `each'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/notifications/fanout.rb:46:in `finish'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/notifications/instrumenter.rb:42:in `finish_with_state'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/notifications/instrumenter.rb:27:in `instrument'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/notifications.rb:164:in `instrument'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionview-5.0.4/lib/action_view/renderer/abstract_renderer.rb:41:in `instrument'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionview-5.0.4/lib/action_view/renderer/template_renderer.rb:53:in `block in render_template'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionview-5.0.4/lib/action_view/renderer/template_renderer.rb:61:in `render_with_layout'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/skylight-1.3.1/lib/skylight/probes/action_view.rb:35:in `render_with_layout'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionview-5.0.4/lib/action_view/renderer/template_renderer.rb:52:in `render_template'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionview-5.0.4/lib/action_view/renderer/template_renderer.rb:14:in `render'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionview-5.0.4/lib/action_view/renderer/renderer.rb:42:in `render_template'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionview-5.0.4/lib/action_view/renderer/renderer.rb:23:in `render'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionview-5.0.4/lib/action_view/rendering.rb:104:in `_render_template'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionview-5.0.4/lib/action_view/rendering.rb:83:in `render_to_body'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_controller/api/api_rendering.rb:11:in `render_to_body'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_controller/metal/rendering.rb:52:in `render_to_body'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_controller/metal/renderers.rb:142:in `render_to_body'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/abstract_controller/rendering.rb:26:in `render'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_controller/metal/rendering.rb:36:in `render'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_controller/metal/instrumentation.rb:44:in `block (2 levels) in render'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/core_ext/benchmark.rb:12:in `block in ms'", "/Users/sekrett/.rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/benchmark.rb:308:in `realtime'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/core_ext/benchmark.rb:12:in `ms'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_controller/metal/instrumentation.rb:44:in `block in render'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_controller/metal/instrumentation.rb:87:in `cleanup_view_runtime'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activerecord-5.0.4/lib/active_record/railties/controller_runtime.rb:25:in `cleanup_view_runtime'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_controller/metal/instrumentation.rb:43:in `render'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_controller/metal/data_streaming.rb:108:in `send_data'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_controller/metal/instrumentation.rb:58:in `block in send_data'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/notifications.rb:164:in `block in instrument'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/notifications/instrumenter.rb:21:in `instrument'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/notifications.rb:164:in `instrument'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_controller/metal/instrumentation.rb:57:in `send_data'", "/Users/sekrett/code/api_wifi/api/app/controllers/dashboard/surveys/polls_controller.rb:115:in `export_to_xlsx'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/skylight-1.3.1/lib/skylight/helpers.rb:149:in `export_to_xlsx'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_controller/metal/basic_implicit_render.rb:4:in `send_action'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/abstract_controller/base.rb:188:in `process_action'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_controller/metal/rendering.rb:30:in `process_action'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/abstract_controller/callbacks.rb:20:in `block in process_action'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/callbacks.rb:126:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/callbacks.rb:506:in `block (2 levels) in compile'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/callbacks.rb:455:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/callbacks.rb:101:in `__run_callbacks__'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/callbacks.rb:750:in `_run_process_action_callbacks'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/callbacks.rb:90:in `run_callbacks'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/abstract_controller/callbacks.rb:19:in `process_action'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_controller/metal/rescue.rb:20:in `process_action'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_controller/metal/instrumentation.rb:32:in `block in process_action'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/notifications.rb:164:in `block in instrument'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/notifications/instrumenter.rb:21:in `instrument'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/notifications.rb:164:in `instrument'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_controller/metal/instrumentation.rb:30:in `process_action'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_controller/metal/params_wrapper.rb:248:in `process_action'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activerecord-5.0.4/lib/active_record/railties/controller_runtime.rb:18:in `process_action'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/abstract_controller/base.rb:126:in `process'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionview-5.0.4/lib/action_view/rendering.rb:30:in `process'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_controller/metal.rb:190:in `dispatch'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_controller/metal.rb:262:in `dispatch'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_dispatch/routing/route_set.rb:50:in `dispatch'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_dispatch/routing/route_set.rb:32:in `serve'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_dispatch/journey/router.rb:39:in `block in serve'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_dispatch/journey/router.rb:26:in `each'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_dispatch/journey/router.rb:26:in `serve'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_dispatch/routing/route_set.rb:725:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/bullet-5.5.1/lib/bullet/rack.rb:12:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rack-2.0.3/lib/rack/session/abstract/id.rb:232:in `context'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rack-2.0.3/lib/rack/session/abstract/id.rb:226:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_dispatch/middleware/cookies.rb:613:in `call'", "/Users/sekrett/code/api_wifi/api/config/initializers/log_before_timeout.rb:20:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rack-2.0.3/lib/rack/etag.rb:25:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rack-2.0.3/lib/rack/conditional_get.rb:25:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rack-2.0.3/lib/rack/head.rb:12:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_dispatch/middleware/callbacks.rb:38:in `block in call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/callbacks.rb:97:in `__run_callbacks__'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/callbacks.rb:750:in `_run_call_callbacks'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/callbacks.rb:90:in `run_callbacks'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_dispatch/middleware/callbacks.rb:36:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_dispatch/middleware/remote_ip.rb:79:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_dispatch/middleware/debug_exceptions.rb:49:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_dispatch/middleware/show_exceptions.rb:31:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/railties-5.0.4/lib/rails/rack/logger.rb:36:in `call_app'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/railties-5.0.4/lib/rails/rack/logger.rb:24:in `block in call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/tagged_logging.rb:69:in `block in tagged'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/tagged_logging.rb:26:in `tagged'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/tagged_logging.rb:69:in `tagged'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/railties-5.0.4/lib/rails/rack/logger.rb:24:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_dispatch/middleware/request_id.rb:24:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rack-2.0.3/lib/rack/runtime.rb:22:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/activesupport-5.0.4/lib/active_support/cache/strategy/local_cache_middleware.rb:28:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_dispatch/middleware/executor.rb:12:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_dispatch/middleware/static.rb:136:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rack-2.0.3/lib/rack/sendfile.rb:111:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rack-cors-0.4.1/lib/rack/cors.rb:81:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/railties-5.0.4/lib/rails/engine.rb:522:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rack-test-0.6.3/lib/rack/mock_session.rb:30:in `request'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rack-test-0.6.3/lib/rack/test.rb:244:in `process_request'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rack-test-0.6.3/lib/rack/test.rb:124:in `request'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_dispatch/testing/integration.rb:334:in `process'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_dispatch/testing/integration.rb:361:in `process_with_kwargs'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_dispatch/testing/integration.rb:15:in `get'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/actionpack-5.0.4/lib/action_dispatch/testing/integration.rb:442:in `block (2 levels) in <module:Runner>'", "/Users/sekrett/code/api_wifi/api/spec/requests/api/polls/export_xlsx_spec.rb:8:in `block (3 levels) in <top (required)>'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/example.rb:254:in `instance_exec'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/example.rb:254:in `block in run'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/example.rb:500:in `block in with_around_and_singleton_context_hooks'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/example.rb:457:in `block in with_around_example_hooks'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/hooks.rb:464:in `block in run'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/hooks.rb:604:in `block in run_around_example_hooks_for'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/example.rb:342:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-rails-3.6.0/lib/rspec/rails/adapters.rb:127:in `block (2 levels) in <module:MinitestLifecycleAdapter>'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/example.rb:447:in `instance_exec'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/example.rb:447:in `instance_exec'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/hooks.rb:375:in `execute_with'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/hooks.rb:606:in `block (2 levels) in run_around_example_hooks_for'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/example.rb:342:in `call'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/hooks.rb:607:in `run_around_example_hooks_for'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/hooks.rb:464:in `run'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/example.rb:457:in `with_around_example_hooks'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/example.rb:500:in `with_around_and_singleton_context_hooks'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/example.rb:251:in `run'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/example_group.rb:627:in `block in run_examples'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/example_group.rb:623:in `map'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/example_group.rb:623:in `run_examples'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/example_group.rb:589:in `run'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/example_group.rb:590:in `block in run'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/example_group.rb:590:in `map'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/example_group.rb:590:in `run'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/runner.rb:118:in `block (3 levels) in run_specs'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/runner.rb:118:in `map'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/runner.rb:118:in `block (2 levels) in run_specs'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/configuration.rb:1894:in `with_suite_hooks'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/runner.rb:113:in `block in run_specs'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/reporter.rb:79:in `report'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/runner.rb:112:in `run_specs'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/runner.rb:87:in `run'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/runner.rb:71:in `run'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/lib/rspec/core/runner.rb:45:in `invoke'", "/Users/sekrett/.rvm/gems/ruby-2.3.1/gems/rspec-core-3.6.0/exe/rspec:4:in `<main>'"][0m
[INFO ] Sent data poll#1.xlsx (8.6ms)
[INFO ] Completed [32m200 OK[0m in 76ms [30m(Views: 8.3ms | ActiveRecord: 8.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "myrtis"], ["email", "pearline.shanahan@hegmann.com"], ["password", "Fx1oQkKjG2Hr"], ["created_at", "2017-07-28 07:55:59.868816"], ["updated_at", "2017-07-28 07:55:59.868816"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "polls" ("title", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "I’ve got an idea–an idea so smart that my head would explode if I even began to know what I’m talking about."], ["user_id", 34], ["created_at", "2016-07-28 07:55:59.871839"], ["updated_at", "2017-07-28 07:55:59.873889"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "questions" ("title", "poll_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Amazing. One second of a stranger's voice on a phone, and you've got full Bollywood."], ["poll_id", 2], ["created_at", "2017-07-28 07:55:59.878401"], ["updated_at", "2017-07-28 07:55:59.878401"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "answers" ("title", "question_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "I am so not competitive. In fact, I am the least non-competitive. So I win."], ["question_id", 2], ["created_at", "2017-07-28 07:55:59.893017"], ["updated_at", "2017-07-28 07:55:59.893017"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "534.508.8064 x27802"], ["created_at", "2017-07-28 07:55:59.909703"], ["updated_at", "2017-07-28 07:55:59.909703"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.4ms)[0m  [1m[32mINSERT INTO "attempts" ("client_id", "answer_id", "created_at", "updated_at", "interview_uuid") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 16], ["answer_id", 1], ["created_at", "2017-07-28 07:55:59.915092"], ["updated_at", "2017-07-28 07:55:59.915092"], ["interview_uuid", 301278]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Sonsing"], ["created_at", "2017-07-28 07:55:59.922866"], ["updated_at", "2017-07-28 07:55:59.922866"], ["local_path", "http://jast.net/bill"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Trippledex"], ["title_ru", "Название24"], ["created_at", "2017-07-28 07:55:59.926768"], ["updated_at", "2017-07-28 07:55:59.926768"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 24[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_24[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 24) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>24, "title"=>"Sonsing", "created_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "local_path"=>"http://jast.net/bill"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bytecard"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bytecard"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bytecard"], ["category_id", 24], ["slug", "bytecard"], ["created_at", "2017-07-28 07:55:59.938174"], ["updated_at", "2017-07-28 07:55:59.938174"], ["layout_id", 24]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "abe"], ["email", "douglas.kuvalis@spinka.co"], ["password", "T4Vy1qCyMyNp4n"], ["created_at", "2017-07-28 07:55:59.943012"], ["updated_at", "2017-07-28 07:55:59.943012"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et.perferendis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "poll_id", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17) RETURNING "id"[0m  [["title", "Zamit"], ["phone", "1-716-931-5219"], ["address", "942 Francesco Avenue"], ["url", "http://hartmann.biz/jaquan.bruen"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://wuckert.biz/beulah"], ["auth_expiration_time", 900], ["slug", "et.perferendis"], ["brand_id", 24], ["user_id", 35], ["created_at", "2017-07-28 07:55:59.949581"], ["updated_at", "2017-07-28 07:55:59.949581"], ["poll_id", 2], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(734) 002-5253"], ["created_at", "2017-07-28 07:55:59.988071"], ["updated_at", "2017-07-28 07:55:59.988071"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "cesar"], ["email", "margaret.crooks@mosciski.biz"], ["password", "NnS2CaTr1n"], ["created_at", "2017-07-28 07:55:59.993808"], ["updated_at", "2017-07-28 07:55:59.993808"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "961129"], ["username", "sam"], ["image", "http://instagram.com/img/sam.jpg"], ["profile", "https://instagram.com/sam"], ["email", "kimberly@gerhold.co"], ["gender", "female"], ["location", "Москва, Россия"], ["bdate_day", 29], ["bdate_month", 6], ["bdate_year", 1959], ["client_id", 17], ["user_id", 36], ["created_at", "2017-07-28 07:55:59.998575"], ["updated_at", "2017-07-28 07:55:59.998575"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Hatity"], ["created_at", "2017-07-28 07:56:00.034403"], ["updated_at", "2017-07-28 07:56:00.034403"], ["local_path", "http://oberbrunner.biz/jammie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Latlux"], ["title_ru", "Название25"], ["created_at", "2017-07-28 07:56:00.038311"], ["updated_at", "2017-07-28 07:56:00.038311"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 25[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_25[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 25) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>25, "title"=>"Hatity", "created_at"=>Fri, 28 Jul 2017 07:56:00 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:00 UTC +00:00, "local_path"=>"http://oberbrunner.biz/jammie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "home-ing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "home-ing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Home Ing"], ["category_id", 25], ["slug", "home-ing"], ["created_at", "2017-07-28 07:56:00.049139"], ["updated_at", "2017-07-28 07:56:00.049139"], ["layout_id", 25]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ova"], ["email", "simone@johnson.org"], ["password", "UyA84iEsZ2Of9o"], ["created_at", "2017-07-28 07:56:00.054371"], ["updated_at", "2017-07-28 07:56:00.054371"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "rem.natus"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Konklab"], ["phone", "1-528-401-3871"], ["address", "13030 Coleman Ford"], ["url", "http://schulist.biz/zack.emard"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://schaefer.info/hunter"], ["auth_expiration_time", 900], ["slug", "rem.natus"], ["brand_id", 25], ["user_id", 37], ["created_at", "2017-07-28 07:56:00.059878"], ["updated_at", "2017-07-28 07:56:00.059878"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "christopher"], ["email", "kolby_yundt@borer.co"], ["password", "IgWy7wD2CnKvHfN"], ["created_at", "2017-07-28 07:56:00.065261"], ["updated_at", "2017-07-28 07:56:00.065261"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5331"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.6ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5331"], ["comment", "comment 11"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "201.151.112.176"], ["router_admin_ip", "68.107.43.212"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "993"], ["status", "t"], ["location_id", 25], ["user_id", 38], ["created_at", "2017-07-28 07:56:00.073338"], ["updated_at", "2017-07-28 07:56:00.073338"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5331"], ["id", 1], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 1], ["serial", "643705CA5E36/5331"], ["comment", "comment 11"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "201.151.112.176"], ["router_admin_ip", "68.107.43.212"], ["admin_password", "ec5f54386765234e"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "1"], ["status", "t"], ["location_id", 25], ["user_id", 38], ["created_at", "2017-07-28 07:56:00.073338"], ["updated_at", "2017-07-28 07:56:00.073338"], ["id", 1]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: d0c620e8-79b3-4cac-8b1b-64980578ee0b) to Async(routers) with arguments: #<GlobalID:0x007fdb9bfda308 @uri=#<URI::GID gid://wifi-management/Router/1>>
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: f760c076-d3f2-4001-8465-73cac9d18917) to Async(routers) with arguments: #<GlobalID:0x007fdb9bfda308 @uri=#<URI::GID gid://wifi-management/Router/1>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.6ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 1], ["provider", "instagram"], ["location_id", 24], ["router_id", 1], ["created_at", "2017-07-28 07:56:00.264006"], ["updated_at", "2017-07-28 07:56:00.264006"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mQuestion Load (0.7ms)[0m  [1m[34mSELECT  "questions".* FROM "questions" WHERE "questions"."poll_id" = $1 ORDER BY "questions"."id" ASC LIMIT $2[0m  [["poll_id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mAnswer Load (0.6ms)[0m  [1m[34mSELECT  "answers".* FROM "answers" WHERE "answers"."question_id" = $1 ORDER BY "answers"."id" ASC LIMIT $2[0m  [["question_id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "530.127.9306"], ["created_at", "2017-07-28 07:56:00.278126"], ["updated_at", "2017-07-28 07:56:00.278126"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "attempts" ("client_id", "answer_id", "created_at", "updated_at", "interview_uuid") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 18], ["answer_id", 1], ["created_at", "2017-03-28 07:56:00.275986"], ["updated_at", "2017-07-28 07:56:00.281834"], ["interview_uuid", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:00 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"myrtis", "email"=>"pearline.shanahan@hegmann.com", "password"=>"Fx1oQkKjG2Hr", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"myrtis", :email=>"pearline.shanahan@hegmann.com", :password=>"Fx1oQkKjG2Hr", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"pearline.shanahan@hegmann.com", "password"=>"Fx1oQkKjG2Hr"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "myrtis"], ["email", "pearline.shanahan@hegmann.com"], ["password", "Fx1oQkKjG2Hr"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 34, username: "myrtis", email: "pearline.shanahan@hegmann.com", password: "Fx1oQkKjG2Hr", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:55:59", updated_at: "2017-07-28 07:55:59", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 34[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/stats/poll_activity?id=2" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:00 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#poll_activity[0m as [33mJSON[0m
[INFO ]   Parameters: {"id"=>"2"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 34[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_34[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 34) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 34]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>34, "username"=>"myrtis", "email"=>"pearline.shanahan@hegmann.com", "password"=>"Fx1oQkKjG2Hr", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:55:59 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>1, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:id=>"2", :format=>"json", :controller=>"dashboard/stats", :action=>"poll_activity"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 34[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_34[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 34[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_34[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>34, :username=>"myrtis", :email=>"pearline.shanahan@hegmann.com", :password=>"Fx1oQkKjG2Hr", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:55:59.868Z", :updated_at=>"2017-07-28T07:55:59.868Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>1, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 34[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mPoll Load (0.8ms)[0m  [1m[34mSELECT  "polls".* FROM "polls" WHERE "polls"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mAttempt Load (1.4ms)[0m  [1m[34mSELECT  "attempts".* FROM "attempts" INNER JOIN "answers" ON "attempts"."answer_id" = "answers"."id" INNER JOIN "questions" ON "answers"."question_id" = "questions"."id" WHERE "questions"."poll_id" = $1 ORDER BY "answers"."id" ASC, "attempts"."created_at" ASC LIMIT $2[0m  [["poll_id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "questions"."id" FROM "questions" WHERE "questions"."poll_id" = $1[0m  [["poll_id", 2]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[35mWITH attempts_amount AS
        (
          SELECT
              count(id) AS amount,
              date_trunc('month', attempts.created_at) AS PERIOD
          FROM attempts
          WHERE attempts.answer_id in (SELECT id FROM answers where question_id = 2)
          GROUP BY PERIOD
        )
        SELECT period,
               CASE
                  WHEN attempts_amount.amount is NULL THEN 0
                  ELSE attempts_amount.amount
               END as amount
        FROM
            (SELECT generate_series(min(period), max(period), '1 month') AS PERIOD
            FROM attempts_amount) x
        LEFT JOIN attempts_amount
        USING (period)
        ORDER BY period;[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" IN (SELECT "locations"."id" FROM "locations" WHERE "locations"."poll_id" = $1) AND (created_at > '2017-03-28 07:56:00.275986')[0m  [["poll_id", 2]]
[[1m[30mDEBUG[0m[0m]   [1m[36mQuestion Load (0.7ms)[0m  [1m[34mSELECT "questions".* FROM "questions" WHERE (poll_id = 2)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mAnswer Load (0.7ms)[0m  [1m[34mSELECT "answers".* FROM "answers" WHERE "answers"."question_id" = 2 ORDER BY "answers"."id" ASC[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mAttempt Load (0.6ms)[0m  [1m[34mSELECT "attempts".* FROM "attempts" WHERE "attempts"."answer_id" = 1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (16, 18)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.6ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (16, 18)[0m
[INFO ] Completed [32m200 OK[0m in 65ms [30m(Views: 0.7ms | ActiveRecord: 13.7ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "attempts" WHERE "attempts"."answer_id" = $1[0m  [["answer_id", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mAttempt Load (0.5ms)[0m  [1m[34mSELECT  "attempts".* FROM "attempts" WHERE "attempts"."answer_id" = $1 ORDER BY "attempts"."id" ASC LIMIT $2[0m  [["answer_id", 1], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jonathan_zieme"], ["email", "garnett_murazik@denesik.org"], ["password", "5zNqF3CwTpE9An"], ["created_at", "2017-07-28 07:56:00.382115"], ["updated_at", "2017-07-28 07:56:00.382115"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "polls" ("title", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Now I may be an idiot, but there’s one thing I am not sir, and that sir, is an idiot."], ["user_id", 39], ["created_at", "2016-07-28 07:56:00.385485"], ["updated_at", "2017-07-28 07:56:00.387542"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "questions" ("title", "poll_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "People in love can overcome anything."], ["poll_id", 3], ["created_at", "2017-07-28 07:56:00.391727"], ["updated_at", "2017-07-28 07:56:00.391727"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "answers" ("title", "question_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Amazing. One second of a stranger's voice on a phone, and you've got full Bollywood."], ["question_id", 3], ["created_at", "2017-07-28 07:56:00.395827"], ["updated_at", "2017-07-28 07:56:00.395827"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "936-737-3748 x658"], ["created_at", "2017-07-28 07:56:00.400021"], ["updated_at", "2017-07-28 07:56:00.400021"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "attempts" ("client_id", "answer_id", "created_at", "updated_at", "interview_uuid") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 19], ["answer_id", 2], ["created_at", "2017-07-28 07:56:00.403577"], ["updated_at", "2017-07-28 07:56:00.403577"], ["interview_uuid", 72]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Biodex"], ["created_at", "2017-07-28 07:56:00.410368"], ["updated_at", "2017-07-28 07:56:00.410368"], ["local_path", "http://cummings.net/sonny_labadie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "It"], ["title_ru", "Название26"], ["created_at", "2017-07-28 07:56:00.414220"], ["updated_at", "2017-07-28 07:56:00.414220"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 26[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_26[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 26) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>26, "title"=>"Biodex", "created_at"=>Fri, 28 Jul 2017 07:56:00 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:00 UTC +00:00, "local_path"=>"http://cummings.net/sonny_labadie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-solowarm"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-solowarm"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Y-Solowarm"], ["category_id", 26], ["slug", "y-solowarm"], ["created_at", "2017-07-28 07:56:00.426093"], ["updated_at", "2017-07-28 07:56:00.426093"], ["layout_id", 26]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "luis"], ["email", "arnaldo@bode.biz"], ["password", "WcYxMqCuC"], ["created_at", "2017-07-28 07:56:00.430858"], ["updated_at", "2017-07-28 07:56:00.430858"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et-amet"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "poll_id", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17) RETURNING "id"[0m  [["title", "Flowdesk"], ["phone", "1-365-249-6864"], ["address", "50377 Kayden Shore"], ["url", "http://larsonveum.name/hank"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://gleason.com/jermey"], ["auth_expiration_time", 900], ["slug", "et-amet"], ["brand_id", 26], ["user_id", 40], ["created_at", "2017-07-28 07:56:00.436791"], ["updated_at", "2017-07-28 07:56:00.436791"], ["poll_id", 3], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "790-899-0494 x280"], ["created_at", "2017-07-28 07:56:00.442884"], ["updated_at", "2017-07-28 07:56:00.442884"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "berneice.bernier"], ["email", "althea@gleichnercorwin.org"], ["password", "TnEkD0KyFxD023"], ["created_at", "2017-07-28 07:56:00.447370"], ["updated_at", "2017-07-28 07:56:00.447370"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "423568"], ["username", "ricky.hoeger"], ["image", "http://vk.com/img/ricky.hoeger.jpg"], ["profile", "https://vk.com/ricky.hoeger"], ["email", "collin@kautzeradams.com"], ["gender", "female"], ["location", "Москва, Россия"], ["bdate_day", 4], ["bdate_month", 2], ["bdate_year", 1976], ["client_id", 20], ["user_id", 41], ["created_at", "2017-07-28 07:56:00.450860"], ["updated_at", "2017-07-28 07:56:00.450860"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Vagram"], ["created_at", "2017-07-28 07:56:00.458581"], ["updated_at", "2017-07-28 07:56:00.458581"], ["local_path", "http://gusikowskifeest.net/kaia"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Konklux"], ["title_ru", "Название27"], ["created_at", "2017-07-28 07:56:00.462076"], ["updated_at", "2017-07-28 07:56:00.462076"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 27[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_27[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.5ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 27) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>27, "title"=>"Vagram", "created_at"=>Fri, 28 Jul 2017 07:56:00 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:00 UTC +00:00, "local_path"=>"http://gusikowskifeest.net/kaia"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-find"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "y-find"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Y-find"], ["category_id", 27], ["slug", "y-find"], ["created_at", "2017-07-28 07:56:00.472462"], ["updated_at", "2017-07-28 07:56:00.472462"], ["layout_id", 27]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "will.kirlin"], ["email", "ethelyn.rempel@rippinbruen.biz"], ["password", "T2FvU2IjXoQ9Ow7"], ["created_at", "2017-07-28 07:56:00.477341"], ["updated_at", "2017-07-28 07:56:00.477341"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "provident_totam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Temp"], ["phone", "993.217.4320"], ["address", "28694 Murphy Pass"], ["url", "http://weimannkrajcik.net/talia"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://wisozk.name/daphnee"], ["auth_expiration_time", 900], ["slug", "provident_totam"], ["brand_id", 27], ["user_id", 42], ["created_at", "2017-07-28 07:56:00.482799"], ["updated_at", "2017-07-28 07:56:00.482799"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "scarlett_bernier"], ["email", "mona@harvey.name"], ["password", "KrAnTj1lE"], ["created_at", "2017-07-28 07:56:00.488068"], ["updated_at", "2017-07-28 07:56:00.488068"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5332"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5332"], ["comment", "comment 12"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "184.172.248.195"], ["router_admin_ip", "227.108.101.115"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "244"], ["status", "t"], ["location_id", 27], ["user_id", 43], ["created_at", "2017-07-28 07:56:00.493239"], ["updated_at", "2017-07-28 07:56:00.493239"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5332"], ["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 2], ["serial", "643705CA5E36/5332"], ["comment", "comment 12"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "184.172.248.195"], ["router_admin_ip", "227.108.101.115"], ["admin_password", "7387e8c544e8278a"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "2"], ["status", "t"], ["location_id", 27], ["user_id", 43], ["created_at", "2017-07-28 07:56:00.493239"], ["updated_at", "2017-07-28 07:56:00.493239"], ["id", 2]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 8a060018-7622-4937-8814-94632d162e92) to Async(routers) with arguments: #<GlobalID:0x007fdba2195548 @uri=#<URI::GID gid://wifi-management/Router/2>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 99d3bfed-99a9-429a-9fe4-486e66819c01) to Async(routers) with arguments: #<GlobalID:0x007fdba2195548 @uri=#<URI::GID gid://wifi-management/Router/2>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 2], ["provider", "vk"], ["location_id", 26], ["router_id", 2], ["created_at", "2017-07-28 07:56:00.741541"], ["updated_at", "2017-07-28 07:56:00.741541"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mQuestion Load (0.9ms)[0m  [1m[34mSELECT  "questions".* FROM "questions" WHERE "questions"."poll_id" = $1 ORDER BY "questions"."id" ASC LIMIT $2[0m  [["poll_id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mAnswer Load (0.7ms)[0m  [1m[34mSELECT  "answers".* FROM "answers" WHERE "answers"."question_id" = $1 ORDER BY "answers"."id" ASC LIMIT $2[0m  [["question_id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-466-176-7485 x20762"], ["created_at", "2017-07-28 07:56:00.754658"], ["updated_at", "2017-07-28 07:56:00.754658"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "attempts" ("client_id", "answer_id", "created_at", "updated_at", "interview_uuid") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 21], ["answer_id", 2], ["created_at", "2017-04-29 07:56:00.752467"], ["updated_at", "2017-07-28 07:56:00.759909"], ["interview_uuid", 241]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:00 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"jonathan_zieme", "email"=>"garnett_murazik@denesik.org", "password"=>"5zNqF3CwTpE9An", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"jonathan_zieme", :email=>"garnett_murazik@denesik.org", :password=>"5zNqF3CwTpE9An", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.2ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"garnett_murazik@denesik.org", "password"=>"5zNqF3CwTpE9An"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "jonathan_zieme"], ["email", "garnett_murazik@denesik.org"], ["password", "5zNqF3CwTpE9An"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 39, username: "jonathan_zieme", email: "garnett_murazik@denesik.org", password: "5zNqF3CwTpE9An", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:56:00", updated_at: "2017-07-28 07:56:00", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 39[0m
[INFO ] Completed [32m201 Created[0m in 6ms [30m(Views: 0.2ms | ActiveRecord: 1.1ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/stats/poll_activity?id=3" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:00 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#poll_activity[0m as [33mJSON[0m
[INFO ]   Parameters: {"id"=>"3"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 39) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 39]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>39, "username"=>"jonathan_zieme", "email"=>"garnett_murazik@denesik.org", "password"=>"5zNqF3CwTpE9An", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:56:00 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:00 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>1, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:id=>"3", :format=>"json", :controller=>"dashboard/stats", :action=>"poll_activity"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_39[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>39, :username=>"jonathan_zieme", :email=>"garnett_murazik@denesik.org", :password=>"5zNqF3CwTpE9An", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:56:00.382Z", :updated_at=>"2017-07-28T07:56:00.382Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>1, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 39[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mPoll Load (0.7ms)[0m  [1m[34mSELECT  "polls".* FROM "polls" WHERE "polls"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mAttempt Load (1.7ms)[0m  [1m[34mSELECT  "attempts".* FROM "attempts" INNER JOIN "answers" ON "attempts"."answer_id" = "answers"."id" INNER JOIN "questions" ON "answers"."question_id" = "questions"."id" WHERE "questions"."poll_id" = $1 ORDER BY "answers"."id" ASC, "attempts"."created_at" ASC LIMIT $2[0m  [["poll_id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "questions"."id" FROM "questions" WHERE "questions"."poll_id" = $1[0m  [["poll_id", 3]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[35mWITH attempts_amount AS
        (
          SELECT
              count(id) AS amount,
              date_trunc('week', attempts.created_at) AS PERIOD
          FROM attempts
          WHERE attempts.answer_id in (SELECT id FROM answers where question_id = 3)
          GROUP BY PERIOD
        )
        SELECT period,
               CASE
                  WHEN attempts_amount.amount is NULL THEN 0
                  ELSE attempts_amount.amount
               END as amount
        FROM
            (SELECT generate_series(min(period), max(period), '1 week') AS PERIOD
            FROM attempts_amount) x
        LEFT JOIN attempts_amount
        USING (period)
        ORDER BY period;[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" IN (SELECT "locations"."id" FROM "locations" WHERE "locations"."poll_id" = $1) AND (created_at > '2017-04-29 07:56:00.752467')[0m  [["poll_id", 3]]
[[1m[30mDEBUG[0m[0m]   [1m[36mQuestion Load (0.7ms)[0m  [1m[34mSELECT "questions".* FROM "questions" WHERE (poll_id = 3)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mAnswer Load (0.8ms)[0m  [1m[34mSELECT "answers".* FROM "answers" WHERE "answers"."question_id" = 3 ORDER BY "answers"."id" ASC[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mAttempt Load (0.8ms)[0m  [1m[34mSELECT "attempts".* FROM "attempts" WHERE "attempts"."answer_id" = 2[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.9ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (19, 21)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (1.0ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (19, 21)[0m
[INFO ] Completed [32m200 OK[0m in 53ms [30m(Views: 0.8ms | ActiveRecord: 17.2ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "attempts" WHERE "attempts"."answer_id" = $1[0m  [["answer_id", 2]]
[[1m[30mDEBUG[0m[0m]   [1m[36mAttempt Load (0.6ms)[0m  [1m[34mSELECT  "attempts".* FROM "attempts" WHERE "attempts"."answer_id" = $1 ORDER BY "attempts"."id" ASC LIMIT $2[0m  [["answer_id", 2], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."id" = $1 LIMIT $2[0m  [["id", 19], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "vidal"], ["email", "adele.heel@cormier.org"], ["password", "VsLkMmTeExX"], ["created_at", "2017-07-28 07:56:00.842606"], ["updated_at", "2017-07-28 07:56:00.842606"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "polls" ("title", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "I’ve got an idea–an idea so smart that my head would explode if I even began to know what I’m talking about."], ["user_id", 44], ["created_at", "2016-07-28 07:56:00.845884"], ["updated_at", "2017-07-28 07:56:00.847871"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "questions" ("title", "poll_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Hey, don't try to take this away from me. This is the only thing I've ever been good at. Well, this and timing my farts to a thunderstorm."], ["poll_id", 4], ["created_at", "2017-07-28 07:56:00.851892"], ["updated_at", "2017-07-28 07:56:00.851892"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "answers" ("title", "question_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Isn’t ‘bribe’ just another word for ‘love’?"], ["question_id", 4], ["created_at", "2017-07-28 07:56:00.855916"], ["updated_at", "2017-07-28 07:56:00.855916"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-949-714-6363 x391"], ["created_at", "2017-07-28 07:56:00.860148"], ["updated_at", "2017-07-28 07:56:00.860148"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "attempts" ("client_id", "answer_id", "created_at", "updated_at", "interview_uuid") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 22], ["answer_id", 3], ["created_at", "2017-07-28 07:56:00.863689"], ["updated_at", "2017-07-28 07:56:00.863689"], ["interview_uuid", 3255001]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Ventosanzap"], ["created_at", "2017-07-28 07:56:00.870564"], ["updated_at", "2017-07-28 07:56:00.870564"], ["local_path", "http://mclaughlin.org/rory"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Domainer"], ["title_ru", "Название28"], ["created_at", "2017-07-28 07:56:00.874383"], ["updated_at", "2017-07-28 07:56:00.874383"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 28[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_28[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 28) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>28, "title"=>"Ventosanzap", "created_at"=>Fri, 28 Jul 2017 07:56:00 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:00 UTC +00:00, "local_path"=>"http://mclaughlin.org/rory"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alpha"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alpha"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Alpha"], ["category_id", 28], ["slug", "alpha"], ["created_at", "2017-07-28 07:56:00.885622"], ["updated_at", "2017-07-28 07:56:00.885622"], ["layout_id", 28]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "hildegard"], ["email", "mackenzie@walker.info"], ["password", "9j4dV4QsSdIr5"], ["created_at", "2017-07-28 07:56:00.890535"], ["updated_at", "2017-07-28 07:56:00.890535"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "tempore.et"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "poll_id", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17) RETURNING "id"[0m  [["title", "Matsoft"], ["phone", "437.645.9804"], ["address", "37681 Hagenes Center"], ["url", "http://schroederschmeler.biz/tyrique_cole"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://pacocha.biz/anabelle"], ["auth_expiration_time", 900], ["slug", "tempore.et"], ["brand_id", 28], ["user_id", 45], ["created_at", "2017-07-28 07:56:00.896714"], ["updated_at", "2017-07-28 07:56:00.896714"], ["poll_id", 4], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-864-306-2953 x866"], ["created_at", "2017-07-28 07:56:00.902991"], ["updated_at", "2017-07-28 07:56:00.902991"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "mikel.corwin"], ["email", "rhett_oberbrunner@okon.com"], ["password", "QkX9Er9d22"], ["created_at", "2017-07-28 07:56:00.907509"], ["updated_at", "2017-07-28 07:56:00.907509"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "191549"], ["username", "dora.schinner"], ["image", "http://instagram.com/img/dora.schinner.jpg"], ["profile", "https://instagram.com/dora.schinner"], ["email", "onie@smitham.biz"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 15], ["bdate_month", 1], ["bdate_year", 1987], ["client_id", 23], ["user_id", 46], ["created_at", "2017-07-28 07:56:00.911376"], ["updated_at", "2017-07-28 07:56:00.911376"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Cookley"], ["created_at", "2017-07-28 07:56:00.919036"], ["updated_at", "2017-07-28 07:56:00.919036"], ["local_path", "http://thompsondaugherty.name/valerie.cole"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Lotlux"], ["title_ru", "Название29"], ["created_at", "2017-07-28 07:56:00.922807"], ["updated_at", "2017-07-28 07:56:00.922807"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 29[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_29[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 29) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>29, "title"=>"Cookley", "created_at"=>Fri, 28 Jul 2017 07:56:00 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:00 UTC +00:00, "local_path"=>"http://thompsondaugherty.name/valerie.cole"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "matsoft"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "matsoft"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Matsoft"], ["category_id", 29], ["slug", "matsoft"], ["created_at", "2017-07-28 07:56:00.933540"], ["updated_at", "2017-07-28 07:56:00.933540"], ["layout_id", 29]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "celestino_ernser"], ["email", "laron_feest@mertz.biz"], ["password", "GyX2StL9B2M5"], ["created_at", "2017-07-28 07:56:00.938610"], ["updated_at", "2017-07-28 07:56:00.938610"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "fuga-qui"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Sonsing"], ["phone", "(653) 300-5838"], ["address", "3833 Bradly Squares"], ["url", "http://barrowsritchie.biz/woodrow_adams"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://pouros.io/axel"], ["auth_expiration_time", 900], ["slug", "fuga-qui"], ["brand_id", 29], ["user_id", 47], ["created_at", "2017-07-28 07:56:00.944226"], ["updated_at", "2017-07-28 07:56:00.944226"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "kade"], ["email", "micah@halvorsonsatterfield.name"], ["password", "P5X737B04m8rO4"], ["created_at", "2017-07-28 07:56:00.949758"], ["updated_at", "2017-07-28 07:56:00.949758"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5333"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5333"], ["comment", "comment 13"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "47.36.164.17"], ["router_admin_ip", "29.152.209.18"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "889"], ["status", "t"], ["location_id", 29], ["user_id", 48], ["created_at", "2017-07-28 07:56:00.955239"], ["updated_at", "2017-07-28 07:56:00.955239"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5333"], ["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 3], ["serial", "643705CA5E36/5333"], ["comment", "comment 13"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "47.36.164.17"], ["router_admin_ip", "29.152.209.18"], ["admin_password", "f7af7d12eb63ff59"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "3"], ["status", "t"], ["location_id", 29], ["user_id", 48], ["created_at", "2017-07-28 07:56:00.955239"], ["updated_at", "2017-07-28 07:56:00.955239"], ["id", 3]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 495b89e3-b902-496f-a191-b3a8efaf7889) to Async(routers) with arguments: #<GlobalID:0x007fdb9b4ba1a8 @uri=#<URI::GID gid://wifi-management/Router/3>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: eedc92c7-0000-4549-aa2d-b9ca97629910) to Async(routers) with arguments: #<GlobalID:0x007fdb9b4ba1a8 @uri=#<URI::GID gid://wifi-management/Router/3>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 3], ["provider", "instagram"], ["location_id", 28], ["router_id", 3], ["created_at", "2017-07-28 07:56:01.091717"], ["updated_at", "2017-07-28 07:56:01.091717"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mQuestion Load (0.6ms)[0m  [1m[34mSELECT  "questions".* FROM "questions" WHERE "questions"."poll_id" = $1 ORDER BY "questions"."id" ASC LIMIT $2[0m  [["poll_id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mAnswer Load (0.8ms)[0m  [1m[34mSELECT  "answers".* FROM "answers" WHERE "answers"."question_id" = $1 ORDER BY "answers"."id" ASC LIMIT $2[0m  [["question_id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-813-476-6562"], ["created_at", "2017-07-28 07:56:01.102000"], ["updated_at", "2017-07-28 07:56:01.102000"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "attempts" ("client_id", "answer_id", "created_at", "updated_at", "interview_uuid") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["client_id", 24], ["answer_id", 3], ["created_at", "2017-06-28 07:56:02.099894"], ["updated_at", "2017-07-28 07:56:01.105765"], ["interview_uuid", 9]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:01 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"vidal", "email"=>"adele.heel@cormier.org", "password"=>"VsLkMmTeExX", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"vidal", :email=>"adele.heel@cormier.org", :password=>"VsLkMmTeExX", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"adele.heel@cormier.org", "password"=>"VsLkMmTeExX"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "vidal"], ["email", "adele.heel@cormier.org"], ["password", "VsLkMmTeExX"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 44, username: "vidal", email: "adele.heel@cormier.org", password: "VsLkMmTeExX", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:56:00", updated_at: "2017-07-28 07:56:00", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 44[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/stats/poll_activity?id=4" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:01 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#poll_activity[0m as [33mJSON[0m
[INFO ]   Parameters: {"id"=>"4"}
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 44[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_44[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 44) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 44]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>44, "username"=>"vidal", "email"=>"adele.heel@cormier.org", "password"=>"VsLkMmTeExX", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:56:00 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:00 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>1, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:id=>"4", :format=>"json", :controller=>"dashboard/stats", :action=>"poll_activity"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 44[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_44[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 44[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_44[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>44, :username=>"vidal", :email=>"adele.heel@cormier.org", :password=>"VsLkMmTeExX", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:56:00.842Z", :updated_at=>"2017-07-28T07:56:00.842Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>0, :routers_count=>0, :brands_count=>0, :polls_count=>1, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 44[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mPoll Load (0.7ms)[0m  [1m[34mSELECT  "polls".* FROM "polls" WHERE "polls"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mAttempt Load (1.1ms)[0m  [1m[34mSELECT  "attempts".* FROM "attempts" INNER JOIN "answers" ON "attempts"."answer_id" = "answers"."id" INNER JOIN "questions" ON "answers"."question_id" = "questions"."id" WHERE "questions"."poll_id" = $1 ORDER BY "answers"."id" ASC, "attempts"."created_at" ASC LIMIT $2[0m  [["poll_id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "questions"."id" FROM "questions" WHERE "questions"."poll_id" = $1[0m  [["poll_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[35mWITH attempts_amount AS
        (
          SELECT
              count(id) AS amount,
              date_trunc('day', attempts.created_at) AS PERIOD
          FROM attempts
          WHERE attempts.answer_id in (SELECT id FROM answers where question_id = 4)
          GROUP BY PERIOD
        )
        SELECT period,
               CASE
                  WHEN attempts_amount.amount is NULL THEN 0
                  ELSE attempts_amount.amount
               END as amount
        FROM
            (SELECT generate_series(min(period), max(period), '1 day') AS PERIOD
            FROM attempts_amount) x
        LEFT JOIN attempts_amount
        USING (period)
        ORDER BY period;[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" IN (SELECT "locations"."id" FROM "locations" WHERE "locations"."poll_id" = $1) AND (created_at > '2017-06-28 07:56:02.099894')[0m  [["poll_id", 4]]
[[1m[30mDEBUG[0m[0m]   [1m[36mQuestion Load (0.7ms)[0m  [1m[34mSELECT "questions".* FROM "questions" WHERE (poll_id = 4)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mAnswer Load (0.7ms)[0m  [1m[34mSELECT "answers".* FROM "answers" WHERE "answers"."question_id" = 4 ORDER BY "answers"."id" ASC[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mAttempt Load (0.6ms)[0m  [1m[34mSELECT "attempts".* FROM "attempts" WHERE "attempts"."answer_id" = 3[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."id" IN (22, 24)[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mSocialAccount Load (0.8ms)[0m  [1m[34mSELECT "social_accounts".* FROM "social_accounts" WHERE "social_accounts"."client_id" IN (22, 24)[0m
[INFO ] Completed [32m200 OK[0m in 51ms [30m(Views: 0.9ms | ActiveRecord: 13.1ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "attempts" WHERE "attempts"."answer_id" = $1[0m  [["answer_id", 3]]
[[1m[30mDEBUG[0m[0m]   [1m[36mAttempt Load (0.6ms)[0m  [1m[34mSELECT  "attempts".* FROM "attempts" WHERE "attempts"."answer_id" = $1 ORDER BY "attempts"."id" ASC LIMIT $2[0m  [["answer_id", 3], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."id" = $1 LIMIT $2[0m  [["id", 22], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "757-455-4520"], ["created_at", "2017-07-28 07:56:01.185913"], ["updated_at", "2017-07-28 07:56:01.185913"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "okey"], ["email", "elmira@jacobson.io"], ["password", "M76pGiXuSnOr"], ["created_at", "2017-07-28 07:56:01.191690"], ["updated_at", "2017-07-28 07:56:01.191690"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "447054"], ["username", "adolph"], ["image", "http://twitter.com/img/adolph.jpg"], ["profile", "https://twitter.com/adolph"], ["email", "zakary.lubowitz@macejkovicsmitham.name"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 25], ["user_id", 49], ["created_at", "2017-07-28 07:56:01.195866"], ["updated_at", "2017-07-28 07:56:01.195866"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Konklux"], ["created_at", "2017-07-28 07:56:01.203340"], ["updated_at", "2017-07-28 07:56:01.203340"], ["local_path", "http://sporer.io/tod_rau"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Trippledex"], ["title_ru", "Название30"], ["created_at", "2017-07-28 07:56:01.207234"], ["updated_at", "2017-07-28 07:56:01.207234"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 30[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_30[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 30) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>30, "title"=>"Konklux", "created_at"=>Fri, 28 Jul 2017 07:56:01 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:01 UTC +00:00, "local_path"=>"http://sporer.io/tod_rau"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "it"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "it"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "It"], ["category_id", 30], ["slug", "it"], ["created_at", "2017-07-28 07:56:01.218940"], ["updated_at", "2017-07-28 07:56:01.218940"], ["layout_id", 30]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "commodi.aperiam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Cookley"], ["phone", "1-574-637-2077"], ["address", "2524 Andreane Corner"], ["url", "http://millerdooley.info/alene.welch"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://flatley.info/arno"], ["auth_expiration_time", 900], ["slug", "commodi.aperiam"], ["brand_id", 30], ["user_id", 49], ["created_at", "2017-07-28 07:56:01.225055"], ["updated_at", "2017-07-28 07:56:01.225055"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Sub-Ex"], ["created_at", "2017-07-28 07:56:01.233496"], ["updated_at", "2017-07-28 07:56:01.233496"], ["local_path", "http://powlowskibradtke.com/shanelle"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Temp"], ["title_ru", "Название31"], ["created_at", "2017-07-28 07:56:01.237175"], ["updated_at", "2017-07-28 07:56:01.237175"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 31[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_31[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 31) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>31, "title"=>"Sub-Ex", "created_at"=>Fri, 28 Jul 2017 07:56:01 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:01 UTC +00:00, "local_path"=>"http://powlowskibradtke.com/shanelle"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "namfix"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "namfix"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Namfix"], ["category_id", 31], ["slug", "namfix"], ["created_at", "2017-07-28 07:56:01.247586"], ["updated_at", "2017-07-28 07:56:01.247586"], ["layout_id", 31]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "mark_carter"], ["email", "elian@franeckihudson.biz"], ["password", "Lx267hKeXaMk"], ["created_at", "2017-07-28 07:56:01.252263"], ["updated_at", "2017-07-28 07:56:01.252263"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "autem-inventore"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bytecard"], ["phone", "897-104-5766"], ["address", "826 Leffler Freeway"], ["url", "http://hilpert.biz/name"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hoppe.io/garett"], ["auth_expiration_time", 900], ["slug", "autem-inventore"], ["brand_id", 31], ["user_id", 50], ["created_at", "2017-07-28 07:56:01.257547"], ["updated_at", "2017-07-28 07:56:01.257547"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "demetrius"], ["email", "andrew@nienow.info"], ["password", "37LcExVdN1HqMwV"], ["created_at", "2017-07-28 07:56:01.262684"], ["updated_at", "2017-07-28 07:56:01.262684"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5334"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5334"], ["comment", "comment 14"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "5.184.50.43"], ["router_admin_ip", "99.56.234.220"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "442"], ["status", "t"], ["location_id", 31], ["user_id", 51], ["created_at", "2017-07-28 07:56:01.267706"], ["updated_at", "2017-07-28 07:56:01.267706"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5334"], ["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 4], ["serial", "643705CA5E36/5334"], ["comment", "comment 14"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "5.184.50.43"], ["router_admin_ip", "99.56.234.220"], ["admin_password", "6bdff4463e12b282"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "4"], ["status", "t"], ["location_id", 31], ["user_id", 51], ["created_at", "2017-07-28 07:56:01.267706"], ["updated_at", "2017-07-28 07:56:01.267706"], ["id", 4]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: c93430fe-559c-476f-8d0a-3765145bf006) to Async(routers) with arguments: #<GlobalID:0x007fdba51b7168 @uri=#<URI::GID gid://wifi-management/Router/4>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 2faa5b89-fc30-4d54-a58d-e7300561d741) to Async(routers) with arguments: #<GlobalID:0x007fdba51b7168 @uri=#<URI::GID gid://wifi-management/Router/4>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 4], ["provider", "instagram"], ["location_id", 30], ["router_id", 4], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:01 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"okey", "email"=>"elmira@jacobson.io", "password"=>"M76pGiXuSnOr", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"okey", :email=>"elmira@jacobson.io", :password=>"M76pGiXuSnOr", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"elmira@jacobson.io", "password"=>"M76pGiXuSnOr"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "okey"], ["email", "elmira@jacobson.io"], ["password", "M76pGiXuSnOr"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 49, username: "okey", email: "elmira@jacobson.io", password: "M76pGiXuSnOr", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:56:01", updated_at: "2017-07-28 07:56:01", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 49[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.2ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/stats/time_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:01 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#time_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 49[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_49[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 49) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 49]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>49, "username"=>"okey", "email"=>"elmira@jacobson.io", "password"=>"M76pGiXuSnOr", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:56:01 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:01 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"time_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 49[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_49[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 49[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_49[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>49, :username=>"okey", :email=>"elmira@jacobson.io", :password=>"M76pGiXuSnOr", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:56:01.191Z", :updated_at=>"2017-07-28T07:56:01.191Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 49[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.2ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(30)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 38ms [30m(Views: 16.3ms | ActiveRecord: 7.2ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(959) 664-0072 x6841"], ["created_at", "2017-07-28 07:56:01.450027"], ["updated_at", "2017-07-28 07:56:01.450027"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "zola"], ["email", "carlos.parker@stammlesch.net"], ["password", "15HnR8UwD9C"], ["created_at", "2017-07-28 07:56:01.454762"], ["updated_at", "2017-07-28 07:56:01.454762"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "81948"], ["username", "tierra_bradtke"], ["image", "http://instagram.com/img/tierra_bradtke.jpg"], ["profile", "https://instagram.com/tierra_bradtke"], ["email", "jaycee_wilkinson@heel.net"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 26], ["user_id", 52], ["created_at", "2017-07-28 07:56:01.458918"], ["updated_at", "2017-07-28 07:56:01.458918"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Overhold"], ["created_at", "2017-07-28 07:56:01.466307"], ["updated_at", "2017-07-28 07:56:01.466307"], ["local_path", "http://spencer.name/kira"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Toughjoyfax"], ["title_ru", "Название32"], ["created_at", "2017-07-28 07:56:01.469939"], ["updated_at", "2017-07-28 07:56:01.469939"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 32[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_32[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 32) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>32, "title"=>"Overhold", "created_at"=>Fri, 28 Jul 2017 07:56:01 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:01 UTC +00:00, "local_path"=>"http://spencer.name/kira"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alphazap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alphazap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Alphazap"], ["category_id", 32], ["slug", "alphazap"], ["created_at", "2017-07-28 07:56:01.481441"], ["updated_at", "2017-07-28 07:56:01.481441"], ["layout_id", 32]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et_quasi"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Voyatouch"], ["phone", "311.802.1002"], ["address", "755 Glenna Mountains"], ["url", "http://rowebailey.biz/angelita_dickens"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://schmitt.name/marlene"], ["auth_expiration_time", 900], ["slug", "et_quasi"], ["brand_id", 32], ["user_id", 52], ["created_at", "2017-07-28 07:56:01.487041"], ["updated_at", "2017-07-28 07:56:01.487041"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Daltfresh"], ["created_at", "2017-07-28 07:56:01.495385"], ["updated_at", "2017-07-28 07:56:01.495385"], ["local_path", "http://donnelly.info/jacinto"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Sonsing"], ["title_ru", "Название33"], ["created_at", "2017-07-28 07:56:01.499114"], ["updated_at", "2017-07-28 07:56:01.499114"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 33[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_33[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 33) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>33, "title"=>"Daltfresh", "created_at"=>Fri, 28 Jul 2017 07:56:01 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:01 UTC +00:00, "local_path"=>"http://donnelly.info/jacinto"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "wrapsafe"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "wrapsafe"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Wrapsafe"], ["category_id", 33], ["slug", "wrapsafe"], ["created_at", "2017-07-28 07:56:01.509606"], ["updated_at", "2017-07-28 07:56:01.509606"], ["layout_id", 33]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ethelyn.gorczany"], ["email", "haley@renner.biz"], ["password", "04MeNi7wZ2"], ["created_at", "2017-07-28 07:56:01.514283"], ["updated_at", "2017-07-28 07:56:01.514283"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "est.eum"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Greenlam"], ["phone", "965-500-5180"], ["address", "64259 Bernita Row"], ["url", "http://ortiz.info/javier"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://jones.name/gabrielle"], ["auth_expiration_time", 900], ["slug", "est.eum"], ["brand_id", 33], ["user_id", 53], ["created_at", "2017-07-28 07:56:01.519661"], ["updated_at", "2017-07-28 07:56:01.519661"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "alyson"], ["email", "ed.conroy@ohara.io"], ["password", "2rGq20XqN3Z"], ["created_at", "2017-07-28 07:56:01.525041"], ["updated_at", "2017-07-28 07:56:01.525041"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5335"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5335"], ["comment", "comment 15"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "133.190.14.191"], ["router_admin_ip", "206.86.185.7"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "54"], ["status", "t"], ["location_id", 33], ["user_id", 54], ["created_at", "2017-07-28 07:56:01.530298"], ["updated_at", "2017-07-28 07:56:01.530298"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5335"], ["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 5], ["serial", "643705CA5E36/5335"], ["comment", "comment 15"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "133.190.14.191"], ["router_admin_ip", "206.86.185.7"], ["admin_password", "1189f00547ed716c"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "5"], ["status", "t"], ["location_id", 33], ["user_id", 54], ["created_at", "2017-07-28 07:56:01.530298"], ["updated_at", "2017-07-28 07:56:01.530298"], ["id", 5]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: f5e97d1e-6c68-4e30-b9fb-c5e9d94a10d3) to Async(routers) with arguments: #<GlobalID:0x007fdba265db98 @uri=#<URI::GID gid://wifi-management/Router/5>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 14a26f75-9cde-4054-b934-eddd5bf8c4f9) to Async(routers) with arguments: #<GlobalID:0x007fdba265db98 @uri=#<URI::GID gid://wifi-management/Router/5>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 5], ["provider", "instagram"], ["location_id", 32], ["router_id", 5], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:01 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"zola", "email"=>"carlos.parker@stammlesch.net", "password"=>"15HnR8UwD9C", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"zola", :email=>"carlos.parker@stammlesch.net", :password=>"15HnR8UwD9C", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"carlos.parker@stammlesch.net", "password"=>"15HnR8UwD9C"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "zola"], ["email", "carlos.parker@stammlesch.net"], ["password", "15HnR8UwD9C"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 52, username: "zola", email: "carlos.parker@stammlesch.net", password: "15HnR8UwD9C", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:56:01", updated_at: "2017-07-28 07:56:01", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 52[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/stats/authorizations" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:01 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#authorizations[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 52[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_52[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 52) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 52]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>52, "username"=>"zola", "email"=>"carlos.parker@stammlesch.net", "password"=>"15HnR8UwD9C", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:56:01 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:01 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"authorizations"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 52[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_52[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 52[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_52[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>52, :username=>"zola", :email=>"carlos.parker@stammlesch.net", :password=>"15HnR8UwD9C", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:56:01.454Z", :updated_at=>"2017-07-28T07:56:01.454Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 52[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT("social_logs"."id") AS count_id, date_trunc('hour', created_at) AS date_trunc_hour_created_at FROM "social_logs" WHERE "social_logs"."location_id" = 32 AND ("social_logs"."created_at" BETWEEN $1 AND $2) GROUP BY date_trunc('hour', created_at) ORDER BY date_trunc_hour_created_at[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 27ms [30m(Views: 0.2ms | ActiveRecord: 6.0ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "948.031.3335 x28749"], ["created_at", "2017-07-28 07:56:01.798085"], ["updated_at", "2017-07-28 07:56:01.798085"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "dayana"], ["email", "tyrese@erdmanhilll.name"], ["password", "R063OuMsWh4a"], ["created_at", "2017-07-28 07:56:01.803045"], ["updated_at", "2017-07-28 07:56:01.803045"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "facebook"], ["uid", "693885"], ["username", "adriel_romaguera"], ["image", "http://facebook.com/img/adriel_romaguera.jpg"], ["profile", "https://facebook.com/adriel_romaguera"], ["email", "jonathan@brown.io"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 27], ["user_id", 55], ["created_at", "2017-07-28 07:56:01.807445"], ["updated_at", "2017-07-28 07:56:01.807445"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Transcof"], ["created_at", "2017-07-28 07:56:01.815004"], ["updated_at", "2017-07-28 07:56:01.815004"], ["local_path", "http://collier.net/malika.ohara"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Lotstring"], ["title_ru", "Название34"], ["created_at", "2017-07-28 07:56:01.818754"], ["updated_at", "2017-07-28 07:56:01.818754"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 34[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_34[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 34) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>34, "title"=>"Transcof", "created_at"=>Fri, 28 Jul 2017 07:56:01 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:01 UTC +00:00, "local_path"=>"http://collier.net/malika.ohara"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "holdlamis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "holdlamis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Holdlamis"], ["category_id", 34], ["slug", "holdlamis"], ["created_at", "2017-07-28 07:56:01.829523"], ["updated_at", "2017-07-28 07:56:01.829523"], ["layout_id", 34]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "qui-est"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Konklux"], ["phone", "493-301-0270"], ["address", "41703 Bins Mission"], ["url", "http://wunsch.biz/gielle_ward"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://prosaccoschamberger.com/audrey"], ["auth_expiration_time", 900], ["slug", "qui-est"], ["brand_id", 34], ["user_id", 55], ["created_at", "2017-07-28 07:56:01.834969"], ["updated_at", "2017-07-28 07:56:01.834969"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Subin"], ["created_at", "2017-07-28 07:56:01.843163"], ["updated_at", "2017-07-28 07:56:01.843163"], ["local_path", "http://ondricka.name/rodger.howell"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Matsoft"], ["title_ru", "Название35"], ["created_at", "2017-07-28 07:56:01.846701"], ["updated_at", "2017-07-28 07:56:01.846701"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 35[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_35[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 35) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>35, "title"=>"Subin", "created_at"=>Fri, 28 Jul 2017 07:56:01 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:01 UTC +00:00, "local_path"=>"http://ondricka.name/rodger.howell"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alpha"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "alpha"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Alpha"], ["category_id", 35], ["slug", "alpha"], ["created_at", "2017-07-28 07:56:01.857163"], ["updated_at", "2017-07-28 07:56:01.857163"], ["layout_id", 35]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "george.heidenreich"], ["email", "monique@larsonharris.info"], ["password", "Kj3qXpJ9T"], ["created_at", "2017-07-28 07:56:01.861724"], ["updated_at", "2017-07-28 07:56:01.861724"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "nemo-earum"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Stim"], ["phone", "1-242-255-3672"], ["address", "53518 Barrows Rue"], ["url", "http://kohlerpurdy.name/carmen"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://swaniawskicronin.com/kaci.howe"], ["auth_expiration_time", 900], ["slug", "nemo-earum"], ["brand_id", 35], ["user_id", 56], ["created_at", "2017-07-28 07:56:01.866949"], ["updated_at", "2017-07-28 07:56:01.866949"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ari.fahey"], ["email", "howard@strosin.name"], ["password", "7yEk4hWp6hIm9eBt"], ["created_at", "2017-07-28 07:56:01.872052"], ["updated_at", "2017-07-28 07:56:01.872052"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5336"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5336"], ["comment", "comment 16"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "48.178.155.229"], ["router_admin_ip", "198.122.243.161"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "102"], ["status", "t"], ["location_id", 35], ["user_id", 57], ["created_at", "2017-07-28 07:56:01.877125"], ["updated_at", "2017-07-28 07:56:01.877125"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5336"], ["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 6], ["serial", "643705CA5E36/5336"], ["comment", "comment 16"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "48.178.155.229"], ["router_admin_ip", "198.122.243.161"], ["admin_password", "45855bb08e0ff031"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "6"], ["status", "t"], ["location_id", 35], ["user_id", 57], ["created_at", "2017-07-28 07:56:01.877125"], ["updated_at", "2017-07-28 07:56:01.877125"], ["id", 6]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 89bb0146-6349-4993-ab18-c58138626a64) to Async(routers) with arguments: #<GlobalID:0x007fdba4725678 @uri=#<URI::GID gid://wifi-management/Router/6>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: ba06d4cc-de39-443a-a45c-81d12ddefb22) to Async(routers) with arguments: #<GlobalID:0x007fdba4725678 @uri=#<URI::GID gid://wifi-management/Router/6>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 6], ["provider", "instagram"], ["location_id", 34], ["router_id", 6], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:02 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"dayana", "email"=>"tyrese@erdmanhilll.name", "password"=>"R063OuMsWh4a", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"dayana", :email=>"tyrese@erdmanhilll.name", :password=>"R063OuMsWh4a", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"tyrese@erdmanhilll.name", "password"=>"R063OuMsWh4a"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "dayana"], ["email", "tyrese@erdmanhilll.name"], ["password", "R063OuMsWh4a"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 55, username: "dayana", email: "tyrese@erdmanhilll.name", password: "R063OuMsWh4a", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:56:01", updated_at: "2017-07-28 07:56:01", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 55[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/social_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:02 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#social_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 55[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_55[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 55) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 55]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>55, "username"=>"dayana", "email"=>"tyrese@erdmanhilll.name", "password"=>"R063OuMsWh4a", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:56:01 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:01 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"social_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 55[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_55[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 55[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_55[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>55, :username=>"dayana", :email=>"tyrese@erdmanhilll.name", :password=>"R063OuMsWh4a", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:56:01.803Z", :updated_at=>"2017-07-28T07:56:01.803Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 55[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" = 34 AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 26ms [30m(Views: 1.4ms | ActiveRecord: 5.9ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(667) 875-9070"], ["created_at", "2017-07-28 07:56:02.139060"], ["updated_at", "2017-07-28 07:56:02.139060"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "winifred"], ["email", "henry@gottlieb.com"], ["password", "QcLiZk3sN1W00oM"], ["created_at", "2017-07-28 07:56:02.144481"], ["updated_at", "2017-07-28 07:56:02.144481"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "551112"], ["username", "augusta_kirlin"], ["image", "http://instagram.com/img/augusta_kirlin.jpg"], ["profile", "https://instagram.com/augusta_kirlin"], ["email", "era@yundt.io"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 28], ["user_id", 58], ["created_at", "2017-07-28 07:56:02.148323"], ["updated_at", "2017-07-28 07:56:02.148323"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zathin"], ["created_at", "2017-07-28 07:56:02.155385"], ["updated_at", "2017-07-28 07:56:02.155385"], ["local_path", "http://hartmann.info/aryanna.crona"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Latlux"], ["title_ru", "Название36"], ["created_at", "2017-07-28 07:56:02.158936"], ["updated_at", "2017-07-28 07:56:02.158936"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 36[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_36[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 36) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>36, "title"=>"Zathin", "created_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "local_path"=>"http://hartmann.info/aryanna.crona"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "kanlam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "kanlam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Kanlam"], ["category_id", 36], ["slug", "kanlam"], ["created_at", "2017-07-28 07:56:02.169665"], ["updated_at", "2017-07-28 07:56:02.169665"], ["layout_id", 36]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "beatae_expedita"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Lotlux"], ["phone", "130.730.8405"], ["address", "1942 Towne Place"], ["url", "http://ziemann.name/libby"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://goodwin.io/avery_brakus"], ["auth_expiration_time", 900], ["slug", "beatae_expedita"], ["brand_id", 36], ["user_id", 58], ["created_at", "2017-07-28 07:56:02.175608"], ["updated_at", "2017-07-28 07:56:02.175608"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Overhold"], ["created_at", "2017-07-28 07:56:02.184953"], ["updated_at", "2017-07-28 07:56:02.184953"], ["local_path", "http://davis.io/willow"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Holdlamis"], ["title_ru", "Название37"], ["created_at", "2017-07-28 07:56:02.189434"], ["updated_at", "2017-07-28 07:56:02.189434"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 37[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_37[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 37) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>37, "title"=>"Overhold", "created_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "local_path"=>"http://davis.io/willow"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zontrax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zontrax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zontrax"], ["category_id", 37], ["slug", "zontrax"], ["created_at", "2017-07-28 07:56:02.201717"], ["updated_at", "2017-07-28 07:56:02.201717"], ["layout_id", 37]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "hobart"], ["email", "bart.lockman@homenick.io"], ["password", "VkMbXzXaX"], ["created_at", "2017-07-28 07:56:02.206557"], ["updated_at", "2017-07-28 07:56:02.206557"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "velit-ipsam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Namfix"], ["phone", "1-928-110-5318"], ["address", "2605 Hackett Well"], ["url", "http://vandervort.name/darian"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://okeefe.org/fannie.spinka"], ["auth_expiration_time", 900], ["slug", "velit-ipsam"], ["brand_id", 37], ["user_id", 59], ["created_at", "2017-07-28 07:56:02.211867"], ["updated_at", "2017-07-28 07:56:02.211867"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "samanta"], ["email", "rupert@sauer.info"], ["password", "6cJzR2LzZtV00"], ["created_at", "2017-07-28 07:56:02.217071"], ["updated_at", "2017-07-28 07:56:02.217071"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5337"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5337"], ["comment", "comment 17"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "246.191.66.119"], ["router_admin_ip", "133.70.89.231"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "87"], ["status", "t"], ["location_id", 37], ["user_id", 60], ["created_at", "2017-07-28 07:56:02.222186"], ["updated_at", "2017-07-28 07:56:02.222186"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5337"], ["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 7], ["serial", "643705CA5E36/5337"], ["comment", "comment 17"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "246.191.66.119"], ["router_admin_ip", "133.70.89.231"], ["admin_password", "149fcaa06d700b6d"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "7"], ["status", "t"], ["location_id", 37], ["user_id", 60], ["created_at", "2017-07-28 07:56:02.222186"], ["updated_at", "2017-07-28 07:56:02.222186"], ["id", 7]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 4bc94230-1eb6-441b-947e-a0b48bfd26d2) to Async(routers) with arguments: #<GlobalID:0x007fdba6913a00 @uri=#<URI::GID gid://wifi-management/Router/7>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: e30dacaf-9c41-4317-9686-80ff7408fb84) to Async(routers) with arguments: #<GlobalID:0x007fdba6913a00 @uri=#<URI::GID gid://wifi-management/Router/7>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 7], ["provider", "instagram"], ["location_id", 36], ["router_id", 7], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "907.460.5446"], ["created_at", "2017-07-28 07:56:02.298267"], ["updated_at", "2017-07-28 07:56:02.298267"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "alexandra"], ["email", "karianne@schamberger.co"], ["password", "2tAjD0WjJaC"], ["created_at", "2017-07-28 07:56:02.303719"], ["updated_at", "2017-07-28 07:56:02.303719"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "464686"], ["username", "treva"], ["image", "http://twitter.com/img/treva.jpg"], ["profile", "https://twitter.com/treva"], ["email", "keith@kuphal.org"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 29], ["user_id", 61], ["created_at", "2017-07-28 07:56:02.308246"], ["updated_at", "2017-07-28 07:56:02.308246"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Wrapsafe"], ["created_at", "2017-07-28 07:56:02.315750"], ["updated_at", "2017-07-28 07:56:02.315750"], ["local_path", "http://ledner.name/ahmad.vandervort"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Cookley"], ["title_ru", "Название38"], ["created_at", "2017-07-28 07:56:02.319747"], ["updated_at", "2017-07-28 07:56:02.319747"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 38[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_38[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 38) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>38, "title"=>"Wrapsafe", "created_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "local_path"=>"http://ledner.name/ahmad.vandervort"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tin"], ["category_id", 38], ["slug", "tin"], ["created_at", "2017-07-28 07:56:02.331400"], ["updated_at", "2017-07-28 07:56:02.331400"], ["layout_id", 38]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "aut-consequatur"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Keylex"], ["phone", "1-787-568-5158"], ["address", "96919 Lupe Mall"], ["url", "http://stiedemann.name/thaddeus"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kuhn.io/salvatore_muller"], ["auth_expiration_time", 900], ["slug", "aut-consequatur"], ["brand_id", 38], ["user_id", 61], ["created_at", "2017-07-28 07:56:02.337219"], ["updated_at", "2017-07-28 07:56:02.337219"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Ronstring"], ["created_at", "2017-07-28 07:56:02.345792"], ["updated_at", "2017-07-28 07:56:02.345792"], ["local_path", "http://larkin.name/fanny"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bitchip"], ["title_ru", "Название39"], ["created_at", "2017-07-28 07:56:02.349472"], ["updated_at", "2017-07-28 07:56:02.349472"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 39[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_39[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 39) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>39, "title"=>"Ronstring", "created_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "local_path"=>"http://larkin.name/fanny"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "daltfresh"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "daltfresh"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Daltfresh"], ["category_id", 39], ["slug", "daltfresh"], ["created_at", "2017-07-28 07:56:02.361158"], ["updated_at", "2017-07-28 07:56:02.361158"], ["layout_id", 39]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "golda.zieme"], ["email", "tyrell_koch@harris.info"], ["password", "Pu0oAnKeDn"], ["created_at", "2017-07-28 07:56:02.366482"], ["updated_at", "2017-07-28 07:56:02.366482"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "et-ea"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Solarbreeze"], ["phone", "(985) 156-7363"], ["address", "5877 Dameon Parkway"], ["url", "http://borerkunze.org/willard"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://mante.biz/maria"], ["auth_expiration_time", 900], ["slug", "et-ea"], ["brand_id", 39], ["user_id", 62], ["created_at", "2017-07-28 07:56:02.372382"], ["updated_at", "2017-07-28 07:56:02.372382"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "noemie"], ["email", "gia@ruel.org"], ["password", "BpI7Ri5pAvZ"], ["created_at", "2017-07-28 07:56:02.377940"], ["updated_at", "2017-07-28 07:56:02.377940"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5338"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5338"], ["comment", "comment 18"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "224.242.47.140"], ["router_admin_ip", "231.46.58.146"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "405"], ["status", "t"], ["location_id", 39], ["user_id", 63], ["created_at", "2017-07-28 07:56:02.383955"], ["updated_at", "2017-07-28 07:56:02.383955"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5338"], ["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 8], ["serial", "643705CA5E36/5338"], ["comment", "comment 18"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "224.242.47.140"], ["router_admin_ip", "231.46.58.146"], ["admin_password", "53496d817862d56f"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "8"], ["status", "t"], ["location_id", 39], ["user_id", 63], ["created_at", "2017-07-28 07:56:02.383955"], ["updated_at", "2017-07-28 07:56:02.383955"], ["id", 8]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 02933ea0-f02d-4290-8a84-9e95f63f86ef) to Async(routers) with arguments: #<GlobalID:0x007fdba4608b78 @uri=#<URI::GID gid://wifi-management/Router/8>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: df711920-ed76-44f3-80fb-5de026786e88) to Async(routers) with arguments: #<GlobalID:0x007fdba4608b78 @uri=#<URI::GID gid://wifi-management/Router/8>>
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 8], ["provider", "instagram"], ["location_id", 38], ["router_id", 8], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:02 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"alexandra", "email"=>"karianne@schamberger.co", "password"=>"2tAjD0WjJaC", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"alexandra", :email=>"karianne@schamberger.co", :password=>"2tAjD0WjJaC", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"karianne@schamberger.co", "password"=>"2tAjD0WjJaC"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "alexandra"], ["email", "karianne@schamberger.co"], ["password", "2tAjD0WjJaC"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 61, username: "alexandra", email: "karianne@schamberger.co", password: "2tAjD0WjJaC", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:56:02", updated_at: "2017-07-28 07:56:02", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 61[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/locations_list" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:02 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#locations_list[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 61[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_61[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 61) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 61]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 61]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 61]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 61]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 61]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 61]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 61]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 61]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>61, "username"=>"alexandra", "email"=>"karianne@schamberger.co", "password"=>"2tAjD0WjJaC", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"locations_list"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 61[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_61[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 61[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_61[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>61, :username=>"alexandra", :email=>"karianne@schamberger.co", :password=>"2tAjD0WjJaC", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:56:02.303Z", :updated_at=>"2017-07-28T07:56:02.303Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 61[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Load (0.8ms)[0m  [1m[34mSELECT "locations".* FROM "locations" WHERE "locations"."user_id" = 61[0m
[INFO ] Completed [32m200 OK[0m in 25ms [30m(Views: 0.3ms | ActiveRecord: 5.7ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "322.904.7677"], ["created_at", "2017-07-28 07:56:02.531771"], ["updated_at", "2017-07-28 07:56:02.531771"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "velda"], ["email", "lilly@kris.info"], ["password", "Dw9bB3Xr945"], ["created_at", "2017-07-28 07:56:02.536871"], ["updated_at", "2017-07-28 07:56:02.536871"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "332262"], ["username", "bella.ohara"], ["image", "http://instagram.com/img/bella.ohara.jpg"], ["profile", "https://instagram.com/bella.ohara"], ["email", "ramon.beer@bednar.org"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 30], ["user_id", 64], ["created_at", "2017-07-28 07:56:02.541165"], ["updated_at", "2017-07-28 07:56:02.541165"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Lotstring"], ["created_at", "2017-07-28 07:56:02.548949"], ["updated_at", "2017-07-28 07:56:02.548949"], ["local_path", "http://adamstrantow.co/renee.purdy"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Treeflex"], ["title_ru", "Название40"], ["created_at", "2017-07-28 07:56:02.552903"], ["updated_at", "2017-07-28 07:56:02.552903"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 40[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_40[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 40) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>40, "title"=>"Lotstring", "created_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "local_path"=>"http://adamstrantow.co/renee.purdy"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "ventosanzap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "ventosanzap"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Ventosanzap"], ["category_id", 40], ["slug", "ventosanzap"], ["created_at", "2017-07-28 07:56:02.564631"], ["updated_at", "2017-07-28 07:56:02.564631"], ["layout_id", 40]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "reiciendis_voluptatem"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Gembucket"], ["phone", "(439) 390-4324"], ["address", "44934 Sipes Trace"], ["url", "http://mann.org/ashlee"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://simonis.name/domenic_corwin"], ["auth_expiration_time", 900], ["slug", "reiciendis_voluptatem"], ["brand_id", 40], ["user_id", 64], ["created_at", "2017-07-28 07:56:02.570244"], ["updated_at", "2017-07-28 07:56:02.570244"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Mat Lam Tam"], ["created_at", "2017-07-28 07:56:02.579416"], ["updated_at", "2017-07-28 07:56:02.579416"], ["local_path", "http://johnsmurazik.net/eleonore.wiza"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Holdlamis"], ["title_ru", "Название41"], ["created_at", "2017-07-28 07:56:02.583504"], ["updated_at", "2017-07-28 07:56:02.583504"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 41[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_41[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 41) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>41, "title"=>"Mat Lam Tam", "created_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "local_path"=>"http://johnsmurazik.net/eleonore.wiza"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zathin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zathin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zathin"], ["category_id", 41], ["slug", "zathin"], ["created_at", "2017-07-28 07:56:02.595192"], ["updated_at", "2017-07-28 07:56:02.595192"], ["layout_id", 41]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ora"], ["email", "jarrod@schmitthomenick.net"], ["password", "8dV6MwEo"], ["created_at", "2017-07-28 07:56:02.600367"], ["updated_at", "2017-07-28 07:56:02.600367"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ea_velit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Veribet"], ["phone", "595.743.2160"], ["address", "48211 Elvera Drives"], ["url", "http://harber.co/marina.monahan"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://padbergaltenwerth.co/maida_zemlak"], ["auth_expiration_time", 900], ["slug", "ea_velit"], ["brand_id", 41], ["user_id", 65], ["created_at", "2017-07-28 07:56:02.606563"], ["updated_at", "2017-07-28 07:56:02.606563"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "oren"], ["email", "guillermo_herman@robelcartwright.org"], ["password", "MxQqMj298dWb6b1d"], ["created_at", "2017-07-28 07:56:02.612242"], ["updated_at", "2017-07-28 07:56:02.612242"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/5339"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/5339"], ["comment", "comment 19"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "111.98.207.177"], ["router_admin_ip", "119.8.45.96"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "340"], ["status", "t"], ["location_id", 41], ["user_id", 66], ["created_at", "2017-07-28 07:56:02.618059"], ["updated_at", "2017-07-28 07:56:02.618059"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/5339"], ["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 9], ["serial", "643705CA5E36/5339"], ["comment", "comment 19"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "111.98.207.177"], ["router_admin_ip", "119.8.45.96"], ["admin_password", "e28e64a1b731a2e2"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "9"], ["status", "t"], ["location_id", 41], ["user_id", 66], ["created_at", "2017-07-28 07:56:02.618059"], ["updated_at", "2017-07-28 07:56:02.618059"], ["id", 9]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 02b99727-2892-4c5b-8505-fc54df4859d2) to Async(routers) with arguments: #<GlobalID:0x007fdba5aa4e88 @uri=#<URI::GID gid://wifi-management/Router/9>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: a8b77288-828d-4417-a882-78baf17a65bb) to Async(routers) with arguments: #<GlobalID:0x007fdba5aa4e88 @uri=#<URI::GID gid://wifi-management/Router/9>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 9], ["provider", "instagram"], ["location_id", 40], ["router_id", 9], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:02 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"velda", "email"=>"lilly@kris.info", "password"=>"Dw9bB3Xr945", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"velda", :email=>"lilly@kris.info", :password=>"Dw9bB3Xr945", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"lilly@kris.info", "password"=>"Dw9bB3Xr945"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "velda"], ["email", "lilly@kris.info"], ["password", "Dw9bB3Xr945"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 64, username: "velda", email: "lilly@kris.info", password: "Dw9bB3Xr945", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:56:02", updated_at: "2017-07-28 07:56:02", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 64[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.8ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/all_connects" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:02 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#all_connects[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 64[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_64[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 64) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 64]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 64]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 64]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 64]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 64]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 64]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 64]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 64]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>64, "username"=>"velda", "email"=>"lilly@kris.info", "password"=>"Dw9bB3Xr945", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"all_connects"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 64[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_64[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 64[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_64[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>64, :username=>"velda", :email=>"lilly@kris.info", :password=>"Dw9bB3Xr945", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:56:02.536Z", :updated_at=>"2017-07-28T07:56:02.536Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 64[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 40[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 40 AND ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-06-28 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE "social_logs"."location_id" = 40 AND ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 26ms [30m(Views: 0.2ms | ActiveRecord: 6.7ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "681-005-2450 x93866"], ["created_at", "2017-07-28 07:56:02.866004"], ["updated_at", "2017-07-28 07:56:02.866004"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jean"], ["email", "mara@hagenes.info"], ["password", "6f50O6K2"], ["created_at", "2017-07-28 07:56:02.870999"], ["updated_at", "2017-07-28 07:56:02.870999"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "829868"], ["username", "kristoffer.volkman"], ["image", "http://instagram.com/img/kristoffer.volkman.jpg"], ["profile", "https://instagram.com/kristoffer.volkman"], ["email", "emely.kshlerin@lehner.info"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 31], ["user_id", 67], ["created_at", "2017-07-28 07:56:02.874939"], ["updated_at", "2017-07-28 07:56:02.874939"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tampflex"], ["created_at", "2017-07-28 07:56:02.882751"], ["updated_at", "2017-07-28 07:56:02.882751"], ["local_path", "http://rempel.com/mitchel_wyman"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zontrax"], ["title_ru", "Название42"], ["created_at", "2017-07-28 07:56:02.887426"], ["updated_at", "2017-07-28 07:56:02.887426"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 42[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_42[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 42) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>42, "title"=>"Tampflex", "created_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "local_path"=>"http://rempel.com/mitchel_wyman"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "solarbreeze"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "solarbreeze"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Solarbreeze"], ["category_id", 42], ["slug", "solarbreeze"], ["created_at", "2017-07-28 07:56:02.898936"], ["updated_at", "2017-07-28 07:56:02.898936"], ["layout_id", 42]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "sequi_mollitia"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Domainer"], ["phone", "1-312-356-7793"], ["address", "30128 Hettinger Loaf"], ["url", "http://schimmel.co/buster"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hayes.net/donnell.jenkins"], ["auth_expiration_time", 900], ["slug", "sequi_mollitia"], ["brand_id", 42], ["user_id", 67], ["created_at", "2017-07-28 07:56:02.904752"], ["updated_at", "2017-07-28 07:56:02.904752"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Asoka"], ["created_at", "2017-07-28 07:56:02.913301"], ["updated_at", "2017-07-28 07:56:02.913301"], ["local_path", "http://ryan.com/greg.cormier"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fixflex"], ["title_ru", "Название43"], ["created_at", "2017-07-28 07:56:02.916940"], ["updated_at", "2017-07-28 07:56:02.916940"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 43[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_43[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 43) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>43, "title"=>"Asoka", "created_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "local_path"=>"http://ryan.com/greg.cormier"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "asoka"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "asoka"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Asoka"], ["category_id", 43], ["slug", "asoka"], ["created_at", "2017-07-28 07:56:02.927433"], ["updated_at", "2017-07-28 07:56:02.927433"], ["layout_id", 43]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "tanya.larkin"], ["email", "amelie.schaefer@ruecker.com"], ["password", "AyVjJtXpT09tBrNx"], ["created_at", "2017-07-28 07:56:02.932248"], ["updated_at", "2017-07-28 07:56:02.932248"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "illum_corporis"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Sonair"], ["phone", "(328) 127-2465"], ["address", "1343 Kaleigh Union"], ["url", "http://ritchie.com/green"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://cummeratalarson.net/sallie"], ["auth_expiration_time", 900], ["slug", "illum_corporis"], ["brand_id", 43], ["user_id", 68], ["created_at", "2017-07-28 07:56:02.937560"], ["updated_at", "2017-07-28 07:56:02.937560"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "abbigail.ullrich"], ["email", "reese.green@damore.info"], ["password", "EcJzWwOoBrKeBtO"], ["created_at", "2017-07-28 07:56:02.942819"], ["updated_at", "2017-07-28 07:56:02.942819"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53310"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53310"], ["comment", "comment 110"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "182.7.133.69"], ["router_admin_ip", "39.202.160.95"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "874"], ["status", "t"], ["location_id", 43], ["user_id", 69], ["created_at", "2017-07-28 07:56:02.947957"], ["updated_at", "2017-07-28 07:56:02.947957"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53310"], ["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 10], ["serial", "643705CA5E36/53310"], ["comment", "comment 110"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "182.7.133.69"], ["router_admin_ip", "39.202.160.95"], ["admin_password", "c68b3c5b381037ef"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "10"], ["status", "t"], ["location_id", 43], ["user_id", 69], ["created_at", "2017-07-28 07:56:02.947957"], ["updated_at", "2017-07-28 07:56:02.947957"], ["id", 10]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 5f6e5141-320d-46aa-bed1-27ac1ec4cd09) to Async(routers) with arguments: #<GlobalID:0x007fdba1e9b518 @uri=#<URI::GID gid://wifi-management/Router/10>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 9631f6e4-c70f-4892-82b7-d49f17b93fd6) to Async(routers) with arguments: #<GlobalID:0x007fdba1e9b518 @uri=#<URI::GID gid://wifi-management/Router/10>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 10], ["provider", "instagram"], ["location_id", 42], ["router_id", 10], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:03 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"jean", "email"=>"mara@hagenes.info", "password"=>"6f50O6K2", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"jean", :email=>"mara@hagenes.info", :password=>"6f50O6K2", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"mara@hagenes.info", "password"=>"6f50O6K2"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "jean"], ["email", "mara@hagenes.info"], ["password", "6f50O6K2"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 67, username: "jean", email: "mara@hagenes.info", password: "6f50O6K2", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:56:02", updated_at: "2017-07-28 07:56:02", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 67[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/new_old_users_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:03 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#new_old_users_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 67[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_67[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 67) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 67]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 67]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 67]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 67]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 67]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 67]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 67]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 67]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>67, "username"=>"jean", "email"=>"mara@hagenes.info", "password"=>"6f50O6K2", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:02 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"new_old_users_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 67[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_67[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 67[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_67[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>67, :username=>"jean", :email=>"mara@hagenes.info", :password=>"6f50O6K2", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:56:02.870Z", :updated_at=>"2017-07-28T07:56:02.870Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 67[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.2ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" = 42 AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 36ms [30m(Views: 1.3ms | ActiveRecord: 10.9ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "425.568.5534"], ["created_at", "2017-07-28 07:56:03.471012"], ["updated_at", "2017-07-28 07:56:03.471012"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "luisa"], ["email", "kyler.moriette@grant.biz"], ["password", "HnE1O5Q7U9283kK"], ["created_at", "2017-07-28 07:56:03.475937"], ["updated_at", "2017-07-28 07:56:03.475937"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "493425"], ["username", "webster"], ["image", "http://vk.com/img/webster.jpg"], ["profile", "https://vk.com/webster"], ["email", "eleazar.grant@osinskiking.io"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 32], ["user_id", 70], ["created_at", "2017-07-28 07:56:03.479902"], ["updated_at", "2017-07-28 07:56:03.479902"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Zoolab"], ["created_at", "2017-07-28 07:56:03.487305"], ["updated_at", "2017-07-28 07:56:03.487305"], ["local_path", "http://watersraynor.co/minerva.mueller"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Voyatouch"], ["title_ru", "Название44"], ["created_at", "2017-07-28 07:56:03.491066"], ["updated_at", "2017-07-28 07:56:03.491066"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 44[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_44[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 44) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>44, "title"=>"Zoolab", "created_at"=>Fri, 28 Jul 2017 07:56:03 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:03 UTC +00:00, "local_path"=>"http://watersraynor.co/minerva.mueller"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "mat-lam-tam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "mat-lam-tam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Mat Lam Tam"], ["category_id", 44], ["slug", "mat-lam-tam"], ["created_at", "2017-07-28 07:56:03.502534"], ["updated_at", "2017-07-28 07:56:03.502534"], ["layout_id", 44]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "qui.consectetur"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Bytecard"], ["phone", "1-716-271-4010"], ["address", "382 Arianna Ports"], ["url", "http://metz.biz/thalia_kozey"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://mckenzie.name/corbin"], ["auth_expiration_time", 900], ["slug", "qui.consectetur"], ["brand_id", 44], ["user_id", 70], ["created_at", "2017-07-28 07:56:03.508281"], ["updated_at", "2017-07-28 07:56:03.508281"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Flexidy"], ["created_at", "2017-07-28 07:56:03.516656"], ["updated_at", "2017-07-28 07:56:03.516656"], ["local_path", "http://grady.name/rickie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Vagram"], ["title_ru", "Название45"], ["created_at", "2017-07-28 07:56:03.520341"], ["updated_at", "2017-07-28 07:56:03.520341"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 45[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_45[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 45) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>45, "title"=>"Flexidy", "created_at"=>Fri, 28 Jul 2017 07:56:03 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:03 UTC +00:00, "local_path"=>"http://grady.name/rickie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "prodder"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "prodder"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Prodder"], ["category_id", 45], ["slug", "prodder"], ["created_at", "2017-07-28 07:56:03.531211"], ["updated_at", "2017-07-28 07:56:03.531211"], ["layout_id", 45]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "catharine"], ["email", "jaylan@goodwinschiller.org"], ["password", "K95nUd0uDs8j1a"], ["created_at", "2017-07-28 07:56:03.536176"], ["updated_at", "2017-07-28 07:56:03.536176"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "inventore-quos"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Domainer"], ["phone", "(245) 066-1236"], ["address", "40690 Sophia Station"], ["url", "http://walkerdach.info/loyce.gutkowski"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ratke.info/gia.wolff"], ["auth_expiration_time", 900], ["slug", "inventore-quos"], ["brand_id", 45], ["user_id", 71], ["created_at", "2017-07-28 07:56:03.541804"], ["updated_at", "2017-07-28 07:56:03.541804"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "quinten.daugherty"], ["email", "forest@gusikowskirodriguez.org"], ["password", "VsFf3kCnBc79ZlGw"], ["created_at", "2017-07-28 07:56:03.547213"], ["updated_at", "2017-07-28 07:56:03.547213"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53311"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53311"], ["comment", "comment 111"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "184.34.200.57"], ["router_admin_ip", "224.111.166.204"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "775"], ["status", "t"], ["location_id", 45], ["user_id", 72], ["created_at", "2017-07-28 07:56:03.552774"], ["updated_at", "2017-07-28 07:56:03.552774"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53311"], ["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 11], ["serial", "643705CA5E36/53311"], ["comment", "comment 111"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "184.34.200.57"], ["router_admin_ip", "224.111.166.204"], ["admin_password", "84b795c1e3eaff24"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "11"], ["status", "t"], ["location_id", 45], ["user_id", 72], ["created_at", "2017-07-28 07:56:03.552774"], ["updated_at", "2017-07-28 07:56:03.552774"], ["id", 11]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 6c4544d6-f2a8-406f-9796-f1c6d8e8f2a1) to Async(routers) with arguments: #<GlobalID:0x007fdba2630288 @uri=#<URI::GID gid://wifi-management/Router/11>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 6cb7643c-3fe0-4f49-b133-a2476a4e6b2c) to Async(routers) with arguments: #<GlobalID:0x007fdba2630288 @uri=#<URI::GID gid://wifi-management/Router/11>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.3ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 11], ["provider", "instagram"], ["location_id", 44], ["router_id", 11], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:03 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"luisa", "email"=>"kyler.moriette@grant.biz", "password"=>"HnE1O5Q7U9283kK", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"luisa", :email=>"kyler.moriette@grant.biz", :password=>"HnE1O5Q7U9283kK", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"kyler.moriette@grant.biz", "password"=>"HnE1O5Q7U9283kK"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "luisa"], ["email", "kyler.moriette@grant.biz"], ["password", "HnE1O5Q7U9283kK"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 70, username: "luisa", email: "kyler.moriette@grant.biz", password: "HnE1O5Q7U9283kK", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:56:03", updated_at: "2017-07-28 07:56:03", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 70[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/visitors_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:03 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#visitors_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 70[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_70[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 70) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 70]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 70]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 70]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 70]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 70]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 70]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 70]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 70]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>70, "username"=>"luisa", "email"=>"kyler.moriette@grant.biz", "password"=>"HnE1O5Q7U9283kK", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:56:03 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:03 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"visitors_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 70[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_70[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 70[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_70[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>70, :username=>"luisa", :email=>"kyler.moriette@grant.biz", :password=>"HnE1O5Q7U9283kK", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:56:03.475Z", :updated_at=>"2017-07-28T07:56:03.475Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 70[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.5ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" = 44 AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 27ms [30m(Views: 1.3ms | ActiveRecord: 8.1ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-163-588-2663"], ["created_at", "2017-07-28 07:56:03.684421"], ["updated_at", "2017-07-28 07:56:03.684421"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "juwan"], ["email", "camille.batz@bartell.net"], ["password", "EuAh4zAnJ"], ["created_at", "2017-07-28 07:56:03.689800"], ["updated_at", "2017-07-28 07:56:03.689800"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "101259"], ["username", "elisabeth"], ["image", "http://instagram.com/img/elisabeth.jpg"], ["profile", "https://instagram.com/elisabeth"], ["email", "itzel@buckridgemiller.info"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 33], ["user_id", 73], ["created_at", "2017-07-28 07:56:03.693619"], ["updated_at", "2017-07-28 07:56:03.693619"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Andalax"], ["created_at", "2017-07-28 07:56:03.700839"], ["updated_at", "2017-07-28 07:56:03.700839"], ["local_path", "http://moore.co/alexa"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Fixflex"], ["title_ru", "Название46"], ["created_at", "2017-07-28 07:56:03.704556"], ["updated_at", "2017-07-28 07:56:03.704556"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 46[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_46[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 46) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>46, "title"=>"Andalax", "created_at"=>Fri, 28 Jul 2017 07:56:03 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:03 UTC +00:00, "local_path"=>"http://moore.co/alexa"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "domainer"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "domainer"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Domainer"], ["category_id", 46], ["slug", "domainer"], ["created_at", "2017-07-28 07:56:03.716192"], ["updated_at", "2017-07-28 07:56:03.716192"], ["layout_id", 46]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "qui_impedit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "It"], ["phone", "371-817-0587"], ["address", "6081 Schmitt Run"], ["url", "http://breitenberg.name/mariam"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://hansen.com/ryley_witting"], ["auth_expiration_time", 900], ["slug", "qui_impedit"], ["brand_id", 46], ["user_id", 73], ["created_at", "2017-07-28 07:56:03.722016"], ["updated_at", "2017-07-28 07:56:03.722016"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Sonair"], ["created_at", "2017-07-28 07:56:03.730576"], ["updated_at", "2017-07-28 07:56:03.730576"], ["local_path", "http://rosenbaum.info/luther"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Daltfresh"], ["title_ru", "Название47"], ["created_at", "2017-07-28 07:56:03.734426"], ["updated_at", "2017-07-28 07:56:03.734426"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 47[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_47[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 47) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>47, "title"=>"Sonair", "created_at"=>Fri, 28 Jul 2017 07:56:03 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:03 UTC +00:00, "local_path"=>"http://rosenbaum.info/luther"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zathin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "zathin"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Zathin"], ["category_id", 47], ["slug", "zathin"], ["created_at", "2017-07-28 07:56:03.745228"], ["updated_at", "2017-07-28 07:56:03.745228"], ["layout_id", 47]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "fabian.stehr"], ["email", "laverna.morar@pollich.co"], ["password", "BvH8LuZuU"], ["created_at", "2017-07-28 07:56:03.749884"], ["updated_at", "2017-07-28 07:56:03.749884"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "asperiores-incidunt"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zathin"], ["phone", "(628) 746-1314"], ["address", "7504 Bogan Mills"], ["url", "http://waelchicarroll.io/darrell.ko"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://ankunding.io/trisha.runolfon"], ["auth_expiration_time", 900], ["slug", "asperiores-incidunt"], ["brand_id", 47], ["user_id", 74], ["created_at", "2017-07-28 07:56:03.755675"], ["updated_at", "2017-07-28 07:56:03.755675"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "mathilde"], ["email", "holly@tillman.name"], ["password", "0vWfV6W3O8"], ["created_at", "2017-07-28 07:56:03.761008"], ["updated_at", "2017-07-28 07:56:03.761008"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53312"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53312"], ["comment", "comment 112"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "139.19.72.154"], ["router_admin_ip", "129.110.212.75"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "252"], ["status", "t"], ["location_id", 47], ["user_id", 75], ["created_at", "2017-07-28 07:56:03.766371"], ["updated_at", "2017-07-28 07:56:03.766371"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53312"], ["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 12], ["serial", "643705CA5E36/53312"], ["comment", "comment 112"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "139.19.72.154"], ["router_admin_ip", "129.110.212.75"], ["admin_password", "b81291bf050ab843"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "12"], ["status", "t"], ["location_id", 47], ["user_id", 75], ["created_at", "2017-07-28 07:56:03.766371"], ["updated_at", "2017-07-28 07:56:03.766371"], ["id", 12]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: f558de30-5624-47ed-924c-ad54f188e934) to Async(routers) with arguments: #<GlobalID:0x007fdb9b5a4f50 @uri=#<URI::GID gid://wifi-management/Router/12>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: f5d0a836-2bde-4fe0-ab15-41e9722730a5) to Async(routers) with arguments: #<GlobalID:0x007fdb9b5a4f50 @uri=#<URI::GID gid://wifi-management/Router/12>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.4ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.3ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 12], ["provider", "instagram"], ["location_id", 46], ["router_id", 12], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "747-056-2364 x64998"], ["created_at", "2017-07-28 07:56:03.884196"], ["updated_at", "2017-07-28 07:56:03.884196"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "kimberly"], ["email", "katheryn@bradtke.biz"], ["password", "1y30W418L5"], ["created_at", "2017-07-28 07:56:03.889192"], ["updated_at", "2017-07-28 07:56:03.889192"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "115534"], ["username", "rory_klocko"], ["image", "http://instagram.com/img/rory_klocko.jpg"], ["profile", "https://instagram.com/rory_klocko"], ["email", "mervin.donnelly@beahan.name"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 34], ["user_id", 76], ["created_at", "2017-07-28 07:56:03.893391"], ["updated_at", "2017-07-28 07:56:03.893391"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Holdlamis"], ["created_at", "2017-07-28 07:56:03.900936"], ["updated_at", "2017-07-28 07:56:03.900936"], ["local_path", "http://hackett.biz/simeon"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bamity"], ["title_ru", "Название48"], ["created_at", "2017-07-28 07:56:03.905061"], ["updated_at", "2017-07-28 07:56:03.905061"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 48[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_48[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 48) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>48, "title"=>"Holdlamis", "created_at"=>Fri, 28 Jul 2017 07:56:03 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:03 UTC +00:00, "local_path"=>"http://hackett.biz/simeon"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "prodder"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "prodder"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Prodder"], ["category_id", 48], ["slug", "prodder"], ["created_at", "2017-07-28 07:56:03.916761"], ["updated_at", "2017-07-28 07:56:03.916761"], ["layout_id", 48]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "doloribus.qui"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Flowdesk"], ["phone", "449.497.6694"], ["address", "9406 Runolfsdottir Islands"], ["url", "http://barton.net/domingo_sauer"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://rohan.name/trystan_dicki"], ["auth_expiration_time", 900], ["slug", "doloribus.qui"], ["brand_id", 48], ["user_id", 76], ["created_at", "2017-07-28 07:56:03.922578"], ["updated_at", "2017-07-28 07:56:03.922578"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "It"], ["created_at", "2017-07-28 07:56:03.931535"], ["updated_at", "2017-07-28 07:56:03.931535"], ["local_path", "http://damore.io/kaley.gleason"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Namfix"], ["title_ru", "Название49"], ["created_at", "2017-07-28 07:56:03.935470"], ["updated_at", "2017-07-28 07:56:03.935470"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 49[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_49[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 49) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>49, "title"=>"It", "created_at"=>Fri, 28 Jul 2017 07:56:03 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:03 UTC +00:00, "local_path"=>"http://damore.io/kaley.gleason"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonsing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "sonsing"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Sonsing"], ["category_id", 49], ["slug", "sonsing"], ["created_at", "2017-07-28 07:56:03.946878"], ["updated_at", "2017-07-28 07:56:03.946878"], ["layout_id", 49]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "elmo"], ["email", "janet@boylemoriette.info"], ["password", "MwToR85gTzUa"], ["created_at", "2017-07-28 07:56:03.952232"], ["updated_at", "2017-07-28 07:56:03.952232"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "aut_asperiores"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Zaam-Dox"], ["phone", "531.669.2600"], ["address", "77522 Geovany Fall"], ["url", "http://eichmannlowe.info/savanah.corwin"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://moorelittel.co/domenic"], ["auth_expiration_time", 900], ["slug", "aut_asperiores"], ["brand_id", 49], ["user_id", 77], ["created_at", "2017-07-28 07:56:03.958201"], ["updated_at", "2017-07-28 07:56:03.958201"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "tommie.wisoky"], ["email", "clarabelle@kuphal.net"], ["password", "NaE9Ao4qTjTeE"], ["created_at", "2017-07-28 07:56:03.963651"], ["updated_at", "2017-07-28 07:56:03.963651"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53313"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53313"], ["comment", "comment 113"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "154.101.56.190"], ["router_admin_ip", "64.183.160.241"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "130"], ["status", "t"], ["location_id", 49], ["user_id", 78], ["created_at", "2017-07-28 07:56:03.969092"], ["updated_at", "2017-07-28 07:56:03.969092"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53313"], ["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.3ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 13], ["serial", "643705CA5E36/53313"], ["comment", "comment 113"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "154.101.56.190"], ["router_admin_ip", "64.183.160.241"], ["admin_password", "5047b4987308755f"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "13"], ["status", "t"], ["location_id", 49], ["user_id", 78], ["created_at", "2017-07-28 07:56:03.969092"], ["updated_at", "2017-07-28 07:56:03.969092"], ["id", 13]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 0f24da4e-6dea-4fec-8094-6d29848726a1) to Async(routers) with arguments: #<GlobalID:0x007fdb9fc300a0 @uri=#<URI::GID gid://wifi-management/Router/13>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 5d44bc7e-1a77-4ca0-8075-58cb5874bb65) to Async(routers) with arguments: #<GlobalID:0x007fdb9fc300a0 @uri=#<URI::GID gid://wifi-management/Router/13>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.3ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 13], ["provider", "instagram"], ["location_id", 48], ["router_id", 13], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:04 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"kimberly", "email"=>"katheryn@bradtke.biz", "password"=>"1y30W418L5", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"kimberly", :email=>"katheryn@bradtke.biz", :password=>"1y30W418L5", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"katheryn@bradtke.biz", "password"=>"1y30W418L5"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "kimberly"], ["email", "katheryn@bradtke.biz"], ["password", "1y30W418L5"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 76, username: "kimberly", email: "katheryn@bradtke.biz", password: "1y30W418L5", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:56:03", updated_at: "2017-07-28 07:56:03", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 76[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 0.9ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/age_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:04 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#age_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 76[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_76[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 76) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 76]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 76]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 76]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 76]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 76]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 76]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 76]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 76]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>76, "username"=>"kimberly", "email"=>"katheryn@bradtke.biz", "password"=>"1y30W418L5", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:56:03 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:03 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"age_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 76[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_76[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 76[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_76[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>76, :username=>"kimberly", :email=>"katheryn@bradtke.biz", :password=>"1y30W418L5", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:56:03.889Z", :updated_at=>"2017-07-28T07:56:03.889Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 76[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.0ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(48) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 27ms [30m(Views: 1.4ms | ActiveRecord: 8.3ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "772.187.7078"], ["created_at", "2017-07-28 07:56:04.131269"], ["updated_at", "2017-07-28 07:56:04.131269"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "marley_kunze"], ["email", "keagan.klein@johnston.info"], ["password", "N0WfCqT9PoQtPvT5"], ["created_at", "2017-07-28 07:56:04.136398"], ["updated_at", "2017-07-28 07:56:04.136398"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "13606"], ["username", "stephon"], ["image", "http://twitter.com/img/stephon.jpg"], ["profile", "https://twitter.com/stephon"], ["email", "mohammad.christiansen@halvorson.net"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 35], ["user_id", 79], ["created_at", "2017-07-28 07:56:04.140466"], ["updated_at", "2017-07-28 07:56:04.140466"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tres-Zap"], ["created_at", "2017-07-28 07:56:04.148222"], ["updated_at", "2017-07-28 07:56:04.148222"], ["local_path", "http://shields.net/minnie_mcclure"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Y-Solowarm"], ["title_ru", "Название50"], ["created_at", "2017-07-28 07:56:04.152693"], ["updated_at", "2017-07-28 07:56:04.152693"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 50[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_50[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 50) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>50, "title"=>"Tres-Zap", "created_at"=>Fri, 28 Jul 2017 07:56:04 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:04 UTC +00:00, "local_path"=>"http://shields.net/minnie_mcclure"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "solarbreeze"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "solarbreeze"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Solarbreeze"], ["category_id", 50], ["slug", "solarbreeze"], ["created_at", "2017-07-28 07:56:04.164864"], ["updated_at", "2017-07-28 07:56:04.164864"], ["layout_id", 50]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "consequatur_et"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Cardify"], ["phone", "(976) 637-1172"], ["address", "3989 Arlo Road"], ["url", "http://grimechiller.co/adelbert_kuvalis"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://moriette.org/cristal"], ["auth_expiration_time", 900], ["slug", "consequatur_et"], ["brand_id", 50], ["user_id", 79], ["created_at", "2017-07-28 07:56:04.170945"], ["updated_at", "2017-07-28 07:56:04.170945"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Job"], ["created_at", "2017-07-28 07:56:04.180516"], ["updated_at", "2017-07-28 07:56:04.180516"], ["local_path", "http://mitchell.io/randy.mueller"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Ronstring"], ["title_ru", "Название51"], ["created_at", "2017-07-28 07:56:04.185355"], ["updated_at", "2017-07-28 07:56:04.185355"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 51[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_51[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 51) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>51, "title"=>"Job", "created_at"=>Fri, 28 Jul 2017 07:56:04 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:04 UTC +00:00, "local_path"=>"http://mitchell.io/randy.mueller"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "regrant"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "regrant"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Regrant"], ["category_id", 51], ["slug", "regrant"], ["created_at", "2017-07-28 07:56:04.196833"], ["updated_at", "2017-07-28 07:56:04.196833"], ["layout_id", 51]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "bella"], ["email", "tatum.streich@gradyadams.biz"], ["password", "Ue98ZdS89"], ["created_at", "2017-07-28 07:56:04.201909"], ["updated_at", "2017-07-28 07:56:04.201909"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "ea-velit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Cardify"], ["phone", "(481) 954-3326"], ["address", "888 Gaylord Haven"], ["url", "http://weimann.info/cathy_bergstrom"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://donnellyblanda.co/maureen"], ["auth_expiration_time", 900], ["slug", "ea-velit"], ["brand_id", 51], ["user_id", 80], ["created_at", "2017-07-28 07:56:04.207696"], ["updated_at", "2017-07-28 07:56:04.207696"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "felicity"], ["email", "macey.donnelly@braun.co"], ["password", "2vTsCaNyOqSr5qMn"], ["created_at", "2017-07-28 07:56:04.213349"], ["updated_at", "2017-07-28 07:56:04.213349"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53314"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53314"], ["comment", "comment 114"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "43.46.207.207"], ["router_admin_ip", "99.227.103.116"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "384"], ["status", "t"], ["location_id", 51], ["user_id", 81], ["created_at", "2017-07-28 07:56:04.218902"], ["updated_at", "2017-07-28 07:56:04.218902"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53314"], ["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 14], ["serial", "643705CA5E36/53314"], ["comment", "comment 114"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "43.46.207.207"], ["router_admin_ip", "99.227.103.116"], ["admin_password", "696e1cbc15545d29"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "14"], ["status", "t"], ["location_id", 51], ["user_id", 81], ["created_at", "2017-07-28 07:56:04.218902"], ["updated_at", "2017-07-28 07:56:04.218902"], ["id", 14]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 5444d1b8-a581-4792-8109-a5b26ebc562a) to Async(routers) with arguments: #<GlobalID:0x007fdb9b126cd0 @uri=#<URI::GID gid://wifi-management/Router/14>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: c73611eb-588d-4400-89c9-ff9f087858dd) to Async(routers) with arguments: #<GlobalID:0x007fdb9b126cd0 @uri=#<URI::GID gid://wifi-management/Router/14>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (3.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 14], ["provider", "instagram"], ["location_id", 50], ["router_id", 14], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:04 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"marley_kunze", "email"=>"keagan.klein@johnston.info", "password"=>"N0WfCqT9PoQtPvT5", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"marley_kunze", :email=>"keagan.klein@johnston.info", :password=>"N0WfCqT9PoQtPvT5", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"keagan.klein@johnston.info", "password"=>"N0WfCqT9PoQtPvT5"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "marley_kunze"], ["email", "keagan.klein@johnston.info"], ["password", "N0WfCqT9PoQtPvT5"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 79, username: "marley_kunze", email: "keagan.klein@johnston.info", password: "N0WfCqT9PoQtPvT5", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:56:04", updated_at: "2017-07-28 07:56:04", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 79[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.3ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/gender_pie" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:04 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#gender_pie[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 79[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_79[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 79) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 79]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.6ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 79]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 79]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 79]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 79]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 79]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 79]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 79]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>79, "username"=>"marley_kunze", "email"=>"keagan.klein@johnston.info", "password"=>"N0WfCqT9PoQtPvT5", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:56:04 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:04 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"gender_pie"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 79[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_79[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 79[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_79[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>79, :username=>"marley_kunze", :email=>"keagan.klein@johnston.info", :password=>"N0WfCqT9PoQtPvT5", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:56:04.136Z", :updated_at=>"2017-07-28T07:56:04.136Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 79[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT DISTINCT COUNT(DISTINCT social_accounts.id) AS count_social_accounts_id, "gender" AS gender FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" = 50 AND ("social_logs"."updated_at" BETWEEN $1 AND $2) GROUP BY "gender"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 24ms [30m(Views: 1.1ms | ActiveRecord: 7.0ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(258) 017-6659"], ["created_at", "2017-07-28 07:56:04.495254"], ["updated_at", "2017-07-28 07:56:04.495254"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "thad_mclaughlin"], ["email", "hubert@weimann.info"], ["password", "Oy0h0xHj91M"], ["created_at", "2017-07-28 07:56:04.500409"], ["updated_at", "2017-07-28 07:56:04.500409"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "331558"], ["username", "antonetta_huels"], ["image", "http://vk.com/img/antonetta_huels.jpg"], ["profile", "https://vk.com/antonetta_huels"], ["email", "esther_hamill@huels.net"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 36], ["user_id", 82], ["created_at", "2017-07-28 07:56:04.504384"], ["updated_at", "2017-07-28 07:56:04.504384"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Bamity"], ["created_at", "2017-07-28 07:56:04.512219"], ["updated_at", "2017-07-28 07:56:04.512219"], ["local_path", "http://lefflermueller.net/jimmy_emmerich"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Bitwolf"], ["title_ru", "Название52"], ["created_at", "2017-07-28 07:56:04.516218"], ["updated_at", "2017-07-28 07:56:04.516218"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 52[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_52[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.8ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 52) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>52, "title"=>"Bamity", "created_at"=>Fri, 28 Jul 2017 07:56:04 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:04 UTC +00:00, "local_path"=>"http://lefflermueller.net/jimmy_emmerich"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "otcom"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "otcom"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Otcom"], ["category_id", 52], ["slug", "otcom"], ["created_at", "2017-07-28 07:56:04.527827"], ["updated_at", "2017-07-28 07:56:04.527827"], ["layout_id", 52]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "delectus_illum"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Konklab"], ["phone", "970.772.4383"], ["address", "909 Little River"], ["url", "http://anderson.io/trudie_romaguera"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://stanton.name/barrett"], ["auth_expiration_time", 900], ["slug", "delectus_illum"], ["brand_id", 52], ["user_id", 82], ["created_at", "2017-07-28 07:56:04.533341"], ["updated_at", "2017-07-28 07:56:04.533341"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Vagram"], ["created_at", "2017-07-28 07:56:04.542099"], ["updated_at", "2017-07-28 07:56:04.542099"], ["local_path", "http://howe.info/antoinette"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Sonair"], ["title_ru", "Название53"], ["created_at", "2017-07-28 07:56:04.545872"], ["updated_at", "2017-07-28 07:56:04.545872"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 53[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_53[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 53) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>53, "title"=>"Vagram", "created_at"=>Fri, 28 Jul 2017 07:56:04 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:04 UTC +00:00, "local_path"=>"http://howe.info/antoinette"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tampflex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tampflex"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tampflex"], ["category_id", 53], ["slug", "tampflex"], ["created_at", "2017-07-28 07:56:04.556504"], ["updated_at", "2017-07-28 07:56:04.556504"], ["layout_id", 53]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ferne_konopelski"], ["email", "juanita@stamm.co"], ["password", "6h7uSfUt25E"], ["created_at", "2017-07-28 07:56:04.561193"], ["updated_at", "2017-07-28 07:56:04.561193"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "molestias-aliquam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Namfix"], ["phone", "958.568.6655"], ["address", "4240 Janiya Inlet"], ["url", "http://hirthepfeffer.io/hermann_aufderhar"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://murphyweinat.biz/althea.macgyver"], ["auth_expiration_time", 900], ["slug", "molestias-aliquam"], ["brand_id", 53], ["user_id", 83], ["created_at", "2017-07-28 07:56:04.566872"], ["updated_at", "2017-07-28 07:56:04.566872"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "caitlyn"], ["email", "eric.bosco@wolf.co"], ["password", "Sg9yP3Vb"], ["created_at", "2017-07-28 07:56:04.572209"], ["updated_at", "2017-07-28 07:56:04.572209"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53315"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53315"], ["comment", "comment 115"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "182.103.6.222"], ["router_admin_ip", "157.210.148.96"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "303"], ["status", "t"], ["location_id", 53], ["user_id", 84], ["created_at", "2017-07-28 07:56:04.577586"], ["updated_at", "2017-07-28 07:56:04.577586"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53315"], ["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 15], ["serial", "643705CA5E36/53315"], ["comment", "comment 115"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "182.103.6.222"], ["router_admin_ip", "157.210.148.96"], ["admin_password", "5723b6298a3a1193"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "15"], ["status", "t"], ["location_id", 53], ["user_id", 84], ["created_at", "2017-07-28 07:56:04.577586"], ["updated_at", "2017-07-28 07:56:04.577586"], ["id", 15]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: acb03b18-3eb3-4174-8bff-c450956b5637) to Async(routers) with arguments: #<GlobalID:0x007fdba6adc6e8 @uri=#<URI::GID gid://wifi-management/Router/15>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 8b9bb8f0-2ff0-42de-9bf9-244b5dacca63) to Async(routers) with arguments: #<GlobalID:0x007fdba6adc6e8 @uri=#<URI::GID gid://wifi-management/Router/15>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.6ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 15], ["provider", "instagram"], ["location_id", 52], ["router_id", 15], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:04 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"thad_mclaughlin", "email"=>"hubert@weimann.info", "password"=>"Oy0h0xHj91M", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"thad_mclaughlin", :email=>"hubert@weimann.info", :password=>"Oy0h0xHj91M", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"hubert@weimann.info", "password"=>"Oy0h0xHj91M"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "thad_mclaughlin"], ["email", "hubert@weimann.info"], ["password", "Oy0h0xHj91M"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 82, username: "thad_mclaughlin", email: "hubert@weimann.info", password: "Oy0h0xHj91M", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:56:04", updated_at: "2017-07-28 07:56:04", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 82[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.4ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/new_old_users" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:04 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#new_old_users[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 82[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_82[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 82) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 82]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 82]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 82]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 82]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 82]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 82]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 82]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 82]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>82, "username"=>"thad_mclaughlin", "email"=>"hubert@weimann.info", "password"=>"Oy0h0xHj91M", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:56:04 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:04 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"new_old_users"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 82[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_82[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 82[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_82[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>82, :username=>"thad_mclaughlin", :email=>"hubert@weimann.info", :password=>"Oy0h0xHj91M", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:56:04.500Z", :updated_at=>"2017-07-28T07:56:04.500Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 82[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (3.3ms)[0m  [1m[34m
      select
        newusrs.chart_interval,
        ttlusrs.returning as returning_users,
        newusrs.new_users,
        ttlusrs.returning + newusrs.new_users as total
      from (select
          chart_interval,
          count (id) as new_users
        from (select
            distinct cl.id,
            date_trunc('day', dd)::date as chart_interval
          FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
          left outer join social_accounts sa on date_trunc('day', sa.created_at) = date_trunc('day', dd)
          left outer join clients cl on sa.client_id = cl.id
          join social_logs sl on sa.id = sl.social_account_id
            and location_id in(52)
      	  order by chart_interval) as chart
        group by chart_interval
        order by chart_interval
      ) as newusrs join (select
          date_trunc('day', dd):: date as chart_interval,
          count (distinct cl.id) as returning
        FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
        left outer join social_logs sl on date_trunc('day', sl.created_at) = date_trunc('day', dd)
          and location_id in(52)
        join social_accounts sa on sa.id = sl.social_account_id
        left outer join clients cl on date_trunc('day', cl.created_at) < date_trunc('day', dd)
          and sa.client_id = cl.id
        group by chart_interval
        order by chart_interval
      ) as ttlusrs on ttlusrs.chart_interval = newusrs.chart_interval[0m
[INFO ] Completed [32m200 OK[0m in 26ms [30m(Views: 0.6ms | ActiveRecord: 7.8ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.9ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "307.290.6860 x427"], ["created_at", "2017-07-28 07:56:04.908026"], ["updated_at", "2017-07-28 07:56:04.908026"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "casimer.casper"], ["email", "gust_metz@kuhic.net"], ["password", "TbG07zTi"], ["created_at", "2017-07-28 07:56:04.912725"], ["updated_at", "2017-07-28 07:56:04.912725"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "992091"], ["username", "derek_weinat"], ["image", "http://vk.com/img/derek_weinat.jpg"], ["profile", "https://vk.com/derek_weinat"], ["email", "eli_moen@nolan.net"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 37], ["user_id", 85], ["created_at", "2017-07-28 07:56:04.916692"], ["updated_at", "2017-07-28 07:56:04.916692"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Tin"], ["created_at", "2017-07-28 07:56:04.923793"], ["updated_at", "2017-07-28 07:56:04.923793"], ["local_path", "http://larson.name/emie_labadie"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Biodex"], ["title_ru", "Название54"], ["created_at", "2017-07-28 07:56:04.927658"], ["updated_at", "2017-07-28 07:56:04.927658"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 54[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_54[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 54) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>54, "title"=>"Tin", "created_at"=>Fri, 28 Jul 2017 07:56:04 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:04 UTC +00:00, "local_path"=>"http://larson.name/emie_labadie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "matsoft"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "matsoft"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Matsoft"], ["category_id", 54], ["slug", "matsoft"], ["created_at", "2017-07-28 07:56:04.939028"], ["updated_at", "2017-07-28 07:56:04.939028"], ["layout_id", 54]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "fugit-harum"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Y-Solowarm"], ["phone", "(968) 439-9868"], ["address", "31936 Sally Cove"], ["url", "http://frami.com/jordon"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://torp.net/joanie.turcotte"], ["auth_expiration_time", 900], ["slug", "fugit-harum"], ["brand_id", 54], ["user_id", 85], ["created_at", "2017-07-28 07:56:04.944659"], ["updated_at", "2017-07-28 07:56:04.944659"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Latlux"], ["created_at", "2017-07-28 07:56:04.953135"], ["updated_at", "2017-07-28 07:56:04.953135"], ["local_path", "http://williamsonbartoletti.name/maiya"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "It"], ["title_ru", "Название55"], ["created_at", "2017-07-28 07:56:04.957201"], ["updated_at", "2017-07-28 07:56:04.957201"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 55[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_55[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 55) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>55, "title"=>"Latlux", "created_at"=>Fri, 28 Jul 2017 07:56:04 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:04 UTC +00:00, "local_path"=>"http://williamsonbartoletti.name/maiya"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "latlux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "latlux"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Latlux"], ["category_id", 55], ["slug", "latlux"], ["created_at", "2017-07-28 07:56:04.968179"], ["updated_at", "2017-07-28 07:56:04.968179"], ["layout_id", 55]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "ru"], ["email", "opal.brakus@emard.io"], ["password", "1c5aN3E1Uv"], ["created_at", "2017-07-28 07:56:04.972958"], ["updated_at", "2017-07-28 07:56:04.972958"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "repellendus.sunt"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Prodder"], ["phone", "1-514-646-7700"], ["address", "4679 Boyer Lake"], ["url", "http://wisozk.net/alfredo.sauer"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://harvey.net/helmer"], ["auth_expiration_time", 900], ["slug", "repellendus.sunt"], ["brand_id", 55], ["user_id", 86], ["created_at", "2017-07-28 07:56:04.978506"], ["updated_at", "2017-07-28 07:56:04.978506"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "bridget"], ["email", "berta_bins@lebsack.info"], ["password", "Q89gT72f"], ["created_at", "2017-07-28 07:56:04.983868"], ["updated_at", "2017-07-28 07:56:04.983868"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53316"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53316"], ["comment", "comment 116"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "153.226.178.75"], ["router_admin_ip", "227.253.163.123"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "329"], ["status", "t"], ["location_id", 55], ["user_id", 87], ["created_at", "2017-07-28 07:56:04.989212"], ["updated_at", "2017-07-28 07:56:04.989212"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53316"], ["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 16], ["serial", "643705CA5E36/53316"], ["comment", "comment 116"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "153.226.178.75"], ["router_admin_ip", "227.253.163.123"], ["admin_password", "a0e32265519ecbf9"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "16"], ["status", "t"], ["location_id", 55], ["user_id", 87], ["created_at", "2017-07-28 07:56:04.989212"], ["updated_at", "2017-07-28 07:56:04.989212"], ["id", 16]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: f5494347-4c34-468a-9237-de8988753527) to Async(routers) with arguments: #<GlobalID:0x007fdba6c02ef0 @uri=#<URI::GID gid://wifi-management/Router/16>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: b06c74fc-8234-40ae-9209-8f8abba8efa4) to Async(routers) with arguments: #<GlobalID:0x007fdba6c02ef0 @uri=#<URI::GID gid://wifi-management/Router/16>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.5ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.3ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 16], ["provider", "instagram"], ["location_id", 54], ["router_id", 16], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mPOST   [0m[0m[1m[37m "/auth/password" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:05 +0300[0m
[INFO ] [35m===[0m Processing by [35mAuthController#authenticate[0m as [33mHTML[0m
[INFO ]   Parameters: {"username"=>"casimer.casper", "email"=>"gust_metz@kuhic.net", "password"=>"TbG07zTi", "redirectUri"=>"dashboard.app.dev", "provider"=>"password"}
[INFO ] [36mnormalized params {:username=>"casimer.casper", :email=>"gust_metz@kuhic.net", :password=>"TbG07zTi", :redirectUri=>"dashboard.app.dev", :controller=>"auth", :action=>"authenticate", :provider=>"password"}[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: username, redirectUri, provider
[[1m[30mDEBUG[0m[0m] [33mpassword sign-up with params <ActionController::Parameters {"email"=>"gust_metz@kuhic.net", "password"=>"TbG07zTi"} permitted: true>[0m
[[1m[30mDEBUG[0m[0m] Unpermitted parameters: redirectUri, provider
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."username" = $1 AND "users"."email" = $2 AND "users"."password" = $3 LIMIT $4[0m  [["username", "casimer.casper"], ["email", "gust_metz@kuhic.net"], ["password", "TbG07zTi"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [33msign-in instead, found user #<User id: 85, username: "casimer.casper", email: "gust_metz@kuhic.net", password: "TbG07zTi", avatar: "/images/avatars/default.jpg", role_cd: 0, tour: true, created_at: "2017-07-28 07:56:04", updated_at: "2017-07-28 07:56:04", lang: "en", sms_count: nil, user_id: 274, expiration: "2017-06-05 06:29:47">[0m
[[1m[30mDEBUG[0m[0m] [36mbuilding token for user 85[0m
[INFO ] Completed [32m201 Created[0m in 5ms [30m(Views: 0.2ms | ActiveRecord: 1.0ms)[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "//stats/clients_count" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:05 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::StatsController#clients_count[0m as [33mJSON[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 85[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_85[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (id = 85) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 85]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 85]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 85]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 85]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = $1[0m  [["user_id", 85]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "routers"."id" FROM "routers" INNER JOIN "locations" ON "routers"."location_id" = "locations"."id" WHERE "locations"."user_id" = $1[0m  [["user_id", 85]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "brands"."id" FROM "brands" WHERE "brands"."user_id" = $1[0m  [["user_id", 85]]
[[1m[30mDEBUG[0m[0m]   [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "polls"."id" FROM "polls" WHERE "polls"."user_id" = $1[0m  [["user_id", 85]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>85, "username"=>"casimer.casper", "email"=>"gust_metz@kuhic.net", "password"=>"TbG07zTi", "avatar"=>"/images/avatars/default.jpg", "role_cd"=>0, "tour"=>true, "created_at"=>Fri, 28 Jul 2017 07:56:04 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:04 UTC +00:00, "lang"=>"en", "sms_count"=>nil, "user_id"=>274, "expiration"=>Mon, 05 Jun 2017 06:29:47 UTC +00:00, :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/stats", :action=>"clients_count"}[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 85[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_85[0m
[[1m[30mDEBUG[0m[0m] [34mcache object user, id, 85[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_user_85[0m
[[1m[30mDEBUG[0m[0m] [1m[36mresolving scope Location for user {:id=>85, :username=>"casimer.casper", :email=>"gust_metz@kuhic.net", :password=>"TbG07zTi", :avatar=>"/images/avatars/default.jpg", :role_cd=>0, :tour=>true, :created_at=>"2017-07-28T07:56:04.912Z", :updated_at=>"2017-07-28T07:56:04.912Z", :lang=>"en", :sms_count=>nil, :user_id=>274, :expiration=>"2017-06-05T06:29:47.639Z", :active_role=>"free", :locations_count=>1, :routers_count=>0, :brands_count=>0, :polls_count=>0, :super_user=>false, :power_user=>false, :can_manage_child_items=>false, :can_create_as_child=>false, :can_view_child_items=>false, :can_view_peer_items=>false, :can_view_owner_items=>false, :can_create_normal_users=>false, :can_create_employees=>false, :pro=>false, :exclusive=>false}[0m[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations" WHERE "locations"."user_id" = 85[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 54[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 54 AND ("client_visits"."updated_at" BETWEEN $1 AND $2)[0m  [["updated_at", "2017-06-28 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(distinct client_id) FROM "client_visits" WHERE "client_visits"."location_id" = 54 AND ("client_visits"."updated_at" BETWEEN $1 AND $2)[0m  [["updated_at", "2017-07-21 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 28ms [30m(Views: 0.2ms | ActiveRecord: 9.0ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "616-049-1739"], ["created_at", "2017-07-28 07:56:05.139329"], ["updated_at", "2017-07-28 07:56:05.139329"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "trenton_langworth"], ["email", "abelardo@schoen.com"], ["password", "15GiKxMb29Rg373b"], ["created_at", "2017-07-28 07:56:05.144312"], ["updated_at", "2017-07-28 07:56:05.144312"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "instagram"], ["uid", "228476"], ["username", "cooper"], ["image", "http://instagram.com/img/cooper.jpg"], ["profile", "https://instagram.com/cooper"], ["email", "alivia@heller.biz"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 38], ["user_id", 88], ["created_at", "2017-07-28 07:56:05.148321"], ["updated_at", "2017-07-28 07:56:05.148321"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Holdlamis"], ["created_at", "2017-07-28 07:56:05.155683"], ["updated_at", "2017-07-28 07:56:05.155683"], ["local_path", "http://bernier.net/dallas"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Regrant"], ["title_ru", "Название56"], ["created_at", "2017-07-28 07:56:05.159472"], ["updated_at", "2017-07-28 07:56:05.159472"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 56[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_56[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 56) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>56, "title"=>"Holdlamis", "created_at"=>Fri, 28 Jul 2017 07:56:05 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:05 UTC +00:00, "local_path"=>"http://bernier.net/dallas"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tempsoft"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "tempsoft"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Tempsoft"], ["category_id", 56], ["slug", "tempsoft"], ["created_at", "2017-07-28 07:56:05.170831"], ["updated_at", "2017-07-28 07:56:05.170831"], ["layout_id", 56]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "rhett"], ["email", "mckenna_kozey@rau.co"], ["password", "ZgWzNtAu"], ["created_at", "2017-07-28 07:56:05.175754"], ["updated_at", "2017-07-28 07:56:05.175754"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "laboriosam_placeat"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Quo Lux"], ["phone", "629-685-8487"], ["address", "5757 Teresa Crossing"], ["url", "http://schusterbode.co/aisha.huels"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://jaskolski.biz/maxie.kunde"], ["auth_expiration_time", 900], ["slug", "laboriosam_placeat"], ["brand_id", 56], ["user_id", 89], ["created_at", "2017-07-28 07:56:05.181618"], ["updated_at", "2017-07-28 07:56:05.181618"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Ventosanzap"], ["created_at", "2017-07-28 07:56:05.189285"], ["updated_at", "2017-07-28 07:56:05.189285"], ["local_path", "http://oharabradtke.net/josue"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Transcof"], ["title_ru", "Название57"], ["created_at", "2017-07-28 07:56:05.192858"], ["updated_at", "2017-07-28 07:56:05.192858"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 57[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_57[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 57) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>57, "title"=>"Ventosanzap", "created_at"=>Fri, 28 Jul 2017 07:56:05 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:05 UTC +00:00, "local_path"=>"http://oharabradtke.net/josue"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voltsillam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voltsillam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Voltsillam"], ["category_id", 57], ["slug", "voltsillam"], ["created_at", "2017-07-28 07:56:05.203562"], ["updated_at", "2017-07-28 07:56:05.203562"], ["layout_id", 57]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "skylar"], ["email", "mike@lakin.io"], ["password", "NdX4YyTt1oPi"], ["created_at", "2017-07-28 07:56:05.208672"], ["updated_at", "2017-07-28 07:56:05.208672"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "molestias.eos"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Voyatouch"], ["phone", "275.561.7022"], ["address", "324 Schinner Island"], ["url", "http://haley.info/heidi_labadie"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://wehner.info/abraham"], ["auth_expiration_time", 900], ["slug", "molestias.eos"], ["brand_id", 57], ["user_id", 90], ["created_at", "2017-07-28 07:56:05.214185"], ["updated_at", "2017-07-28 07:56:05.214185"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "cleo"], ["email", "urban.bradtke@mann.biz"], ["password", "I1QtLdM2AfW"], ["created_at", "2017-07-28 07:56:05.219545"], ["updated_at", "2017-07-28 07:56:05.219545"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53317"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53317"], ["comment", "comment 117"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "70.111.120.18"], ["router_admin_ip", "203.239.54.20"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "891"], ["status", "t"], ["location_id", 57], ["user_id", 91], ["created_at", "2017-07-28 07:56:05.224898"], ["updated_at", "2017-07-28 07:56:05.224898"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53317"], ["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 17], ["serial", "643705CA5E36/53317"], ["comment", "comment 117"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "70.111.120.18"], ["router_admin_ip", "203.239.54.20"], ["admin_password", "26b5411f9fe7ca95"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "17"], ["status", "t"], ["location_id", 57], ["user_id", 91], ["created_at", "2017-07-28 07:56:05.224898"], ["updated_at", "2017-07-28 07:56:05.224898"], ["id", 17]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 3b26ff52-be35-4c87-9fa7-32fb65cd0c61) to Async(routers) with arguments: #<GlobalID:0x007fdb9bdb3688 @uri=#<URI::GID gid://wifi-management/Router/17>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: ca5236f4-1896-4f7e-a38c-873c2097ffd4) to Async(routers) with arguments: #<GlobalID:0x007fdb9bdb3688 @uri=#<URI::GID gid://wifi-management/Router/17>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 17], ["provider", "instagram"], ["location_id", 56], ["router_id", 17], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/totals" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:05 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#all_connections[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"all_connections"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-06-28 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "social_logs" WHERE ("social_logs"."created_at" BETWEEN $1 AND $2)[0m  [["created_at", "2017-07-21 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(56, 57)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" IN (56, 57) AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.1ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(56, 57) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (2.8ms)[0m  [1m[34m
      select
        newusrs.chart_interval,
        ttlusrs.returning as returning_users,
        newusrs.new_users,
        ttlusrs.returning + newusrs.new_users as total
      from (select
          chart_interval,
          count (id) as new_users
        from (select
            distinct cl.id,
            date_trunc('day', dd)::date as chart_interval
          FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
          left outer join social_accounts sa on date_trunc('day', sa.created_at) = date_trunc('day', dd)
          left outer join clients cl on sa.client_id = cl.id
          join social_logs sl on sa.id = sl.social_account_id
            and location_id in(56, 57)
      	  order by chart_interval) as chart
        group by chart_interval
        order by chart_interval
      ) as newusrs join (select
          date_trunc('day', dd):: date as chart_interval,
          count (distinct cl.id) as returning
        FROM generate_series ('2017-06-29T00:00:00+00:00'::date,'2017-07-28T23:59:59+00:00'::date,'1 day'::interval) dd
        left outer join social_logs sl on date_trunc('day', sl.created_at) = date_trunc('day', dd)
          and location_id in(56, 57)
        join social_accounts sa on sa.id = sl.social_account_id
        left outer join clients cl on date_trunc('day', cl.created_at) < date_trunc('day', dd)
          and sa.client_id = cl.id
        group by chart_interval
        order by chart_interval
      ) as ttlusrs on ttlusrs.chart_interval = newusrs.chart_interval[0m
[INFO ] Completed [32m200 OK[0m in 27ms [30m(Views: 4.0ms | ActiveRecord: 10.1ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-545-428-8730"], ["created_at", "2017-07-28 07:56:05.326733"], ["updated_at", "2017-07-28 07:56:05.326733"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "evangeline.brown"], ["email", "josh@pfannerstill.net"], ["password", "XrSqS8U1XrFcCzP"], ["created_at", "2017-07-28 07:56:05.331667"], ["updated_at", "2017-07-28 07:56:05.331667"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "978190"], ["username", "michele.glover"], ["image", "http://vk.com/img/michele.glover.jpg"], ["profile", "https://vk.com/michele.glover"], ["email", "kari@ankunding.co"], ["gender", "female"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 39], ["user_id", 92], ["created_at", "2017-07-28 07:56:05.335530"], ["updated_at", "2017-07-28 07:56:05.335530"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Redhold"], ["created_at", "2017-07-28 07:56:05.343262"], ["updated_at", "2017-07-28 07:56:05.343262"], ["local_path", "http://parisian.biz/irma_witting"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Trippledex"], ["title_ru", "Название58"], ["created_at", "2017-07-28 07:56:05.347093"], ["updated_at", "2017-07-28 07:56:05.347093"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 58[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_58[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 58) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>58, "title"=>"Redhold", "created_at"=>Fri, 28 Jul 2017 07:56:05 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:05 UTC +00:00, "local_path"=>"http://parisian.biz/irma_witting"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bytecard"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "bytecard"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Bytecard"], ["category_id", 58], ["slug", "bytecard"], ["created_at", "2017-07-28 07:56:05.358535"], ["updated_at", "2017-07-28 07:56:05.358535"], ["layout_id", 58]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "lucile"], ["email", "madie@blanda.org"], ["password", "IlC47w11Qq"], ["created_at", "2017-07-28 07:56:05.363844"], ["updated_at", "2017-07-28 07:56:05.363844"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "excepturi.suscipit"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Duobam"], ["phone", "882-772-3606"], ["address", "5099 West Radial"], ["url", "http://mcdermott.co/kareem_jacobs"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://macgyver.co/gracie"], ["auth_expiration_time", 900], ["slug", "excepturi.suscipit"], ["brand_id", 58], ["user_id", 93], ["created_at", "2017-07-28 07:56:05.369455"], ["updated_at", "2017-07-28 07:56:05.369455"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Mat Lam Tam"], ["created_at", "2017-07-28 07:56:05.377615"], ["updated_at", "2017-07-28 07:56:05.377615"], ["local_path", "http://carrollpurdy.biz/lane.douglas"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Y-find"], ["title_ru", "Название59"], ["created_at", "2017-07-28 07:56:05.381369"], ["updated_at", "2017-07-28 07:56:05.381369"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 59[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_59[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 59) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>59, "title"=>"Mat Lam Tam", "created_at"=>Fri, 28 Jul 2017 07:56:05 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:05 UTC +00:00, "local_path"=>"http://carrollpurdy.biz/lane.douglas"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "span"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "span"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Span"], ["category_id", 59], ["slug", "span"], ["created_at", "2017-07-28 07:56:05.392280"], ["updated_at", "2017-07-28 07:56:05.392280"], ["layout_id", 59]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "oliver_cole"], ["email", "modesto.heller@ko.name"], ["password", "G3Yn0c90Vo8oLo3m"], ["created_at", "2017-07-28 07:56:05.397228"], ["updated_at", "2017-07-28 07:56:05.397228"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptatibus-et"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Solarbreeze"], ["phone", "1-302-495-5065"], ["address", "40802 Pink Greens"], ["url", "http://bechtelar.biz/kennedy"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kuphal.io/benton.schultz"], ["auth_expiration_time", 900], ["slug", "voluptatibus-et"], ["brand_id", 59], ["user_id", 94], ["created_at", "2017-07-28 07:56:05.402793"], ["updated_at", "2017-07-28 07:56:05.402793"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "mavis.dare"], ["email", "dayana.moore@gerholdreinger.com"], ["password", "B281Ht8xBcS1R3G"], ["created_at", "2017-07-28 07:56:05.408097"], ["updated_at", "2017-07-28 07:56:05.408097"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53318"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53318"], ["comment", "comment 118"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "9.158.41.229"], ["router_admin_ip", "7.60.247.95"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "937"], ["status", "t"], ["location_id", 59], ["user_id", 95], ["created_at", "2017-07-28 07:56:05.413441"], ["updated_at", "2017-07-28 07:56:05.413441"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53318"], ["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 18], ["serial", "643705CA5E36/53318"], ["comment", "comment 118"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "9.158.41.229"], ["router_admin_ip", "7.60.247.95"], ["admin_password", "cf4660fd5fe3e1b8"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "18"], ["status", "t"], ["location_id", 59], ["user_id", 95], ["created_at", "2017-07-28 07:56:05.413441"], ["updated_at", "2017-07-28 07:56:05.413441"], ["id", 18]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 87a85395-a9a4-4222-bd4b-ca0ae4a432c6) to Async(routers) with arguments: #<GlobalID:0x007fdba453ad90 @uri=#<URI::GID gid://wifi-management/Router/18>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: a1738ae9-af7c-4b6f-b263-2ad599cd5f42) to Async(routers) with arguments: #<GlobalID:0x007fdba453ad90 @uri=#<URI::GID gid://wifi-management/Router/18>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (0.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.8ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 18], ["provider", "instagram"], ["location_id", 58], ["router_id", 18], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/time" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:05 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#time_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"time_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.5ms)[0m  [1m[34m
    select
      sum (case when daytime in (6,7,8,9,10,11) then 1 else 0 end) as morning,
      sum (case when daytime in (12,13,14,15,16,17) then 1 else 0 end) as afternoon,
      sum (case when daytime in (18,19,20,21,22,23) then 1 else 0 end) as evening,
      sum (case when daytime in (0,1,2,3,4,5) then 1 else 0 end) as night
    from( select
            social_account_id,
            date_part('hour',sl.created_at) as daytime
          from social_logs sl
          join social_accounts sa on sl.social_account_id = sa.id
          where location_id in(58, 59)
            and date_trunc('day', sl.created_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
        ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 6ms [30m(Views: 1.3ms | ActiveRecord: 2.3ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(752) 971-2234 x927"], ["created_at", "2017-07-28 07:56:05.549320"], ["updated_at", "2017-07-28 07:56:05.549320"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "bert.balistreri"], ["email", "lyla@johnstonmurphy.io"], ["password", "V56d8e34KlCxL"], ["created_at", "2017-07-28 07:56:05.554378"], ["updated_at", "2017-07-28 07:56:05.554378"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "595780"], ["username", "jammie"], ["image", "http://twitter.com/img/jammie.jpg"], ["profile", "https://twitter.com/jammie"], ["email", "frankie.greenholt@tromprosenbaum.co"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 40], ["user_id", 96], ["created_at", "2017-07-28 07:56:05.558522"], ["updated_at", "2017-07-28 07:56:05.558522"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Flexidy"], ["created_at", "2017-07-28 07:56:05.565831"], ["updated_at", "2017-07-28 07:56:05.565831"], ["local_path", "http://fay.com/elna_boyer"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Sonsing"], ["title_ru", "Название60"], ["created_at", "2017-07-28 07:56:05.569660"], ["updated_at", "2017-07-28 07:56:05.569660"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 60[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_60[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 60) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>60, "title"=>"Flexidy", "created_at"=>Fri, 28 Jul 2017 07:56:05 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:05 UTC +00:00, "local_path"=>"http://fay.com/elna_boyer"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cardify"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "cardify"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Cardify"], ["category_id", 60], ["slug", "cardify"], ["created_at", "2017-07-28 07:56:05.582307"], ["updated_at", "2017-07-28 07:56:05.582307"], ["layout_id", 60]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "rylan_schulist"], ["email", "shannon_skiles@langosh.name"], ["password", "3kJzUqS40lM7"], ["created_at", "2017-07-28 07:56:05.587604"], ["updated_at", "2017-07-28 07:56:05.587604"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "enim-eum"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Voltsillam"], ["phone", "922.171.9940"], ["address", "8118 Maya Circles"], ["url", "http://halvorson.name/jennings"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://mannweimann.org/elias.schamberger"], ["auth_expiration_time", 900], ["slug", "enim-eum"], ["brand_id", 60], ["user_id", 97], ["created_at", "2017-07-28 07:56:05.593370"], ["updated_at", "2017-07-28 07:56:05.593370"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Y-Solowarm"], ["created_at", "2017-07-28 07:56:05.601251"], ["updated_at", "2017-07-28 07:56:05.601251"], ["local_path", "http://marks.info/garrett.aufderhar"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Wrapsafe"], ["title_ru", "Название61"], ["created_at", "2017-07-28 07:56:05.605195"], ["updated_at", "2017-07-28 07:56:05.605195"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 61[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_61[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 61) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>61, "title"=>"Y-Solowarm", "created_at"=>Fri, 28 Jul 2017 07:56:05 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:05 UTC +00:00, "local_path"=>"http://marks.info/garrett.aufderhar"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voltsillam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voltsillam"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Voltsillam"], ["category_id", 61], ["slug", "voltsillam"], ["created_at", "2017-07-28 07:56:05.616234"], ["updated_at", "2017-07-28 07:56:05.616234"], ["layout_id", 61]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "pasquale_rau"], ["email", "winston@mckenzienolan.net"], ["password", "I2A7UdPqXmPv"], ["created_at", "2017-07-28 07:56:05.621082"], ["updated_at", "2017-07-28 07:56:05.621082"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "officia.eius"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.4ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Opela"], ["phone", "(191) 157-2257"], ["address", "57666 Mertz Fields"], ["url", "http://cummings.com/joelle.bode"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://monahan.info/amber"], ["auth_expiration_time", 900], ["slug", "officia.eius"], ["brand_id", 61], ["user_id", 98], ["created_at", "2017-07-28 07:56:05.627951"], ["updated_at", "2017-07-28 07:56:05.627951"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jovani"], ["email", "ottilie.fisher@wunschwitting.biz"], ["password", "6sAe7jGcUe7w3f"], ["created_at", "2017-07-28 07:56:05.634309"], ["updated_at", "2017-07-28 07:56:05.634309"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53319"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53319"], ["comment", "comment 119"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "178.184.12.24"], ["router_admin_ip", "163.169.121.59"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "14"], ["status", "t"], ["location_id", 61], ["user_id", 99], ["created_at", "2017-07-28 07:56:05.639608"], ["updated_at", "2017-07-28 07:56:05.639608"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53319"], ["id", 19], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 19], ["serial", "643705CA5E36/53319"], ["comment", "comment 119"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "178.184.12.24"], ["router_admin_ip", "163.169.121.59"], ["admin_password", "1dafd3842139ed10"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "19"], ["status", "t"], ["location_id", 61], ["user_id", 99], ["created_at", "2017-07-28 07:56:05.639608"], ["updated_at", "2017-07-28 07:56:05.639608"], ["id", 19]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: e8eb4eed-9d83-4aec-a3b0-dd4f323639e7) to Async(routers) with arguments: #<GlobalID:0x007fdba5a3d4b8 @uri=#<URI::GID gid://wifi-management/Router/19>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 309103cb-9132-4d42-bbd7-408ac1f198cf) to Async(routers) with arguments: #<GlobalID:0x007fdba5a3d4b8 @uri=#<URI::GID gid://wifi-management/Router/19>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.1ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 19], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.3ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 19], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 19], ["provider", "instagram"], ["location_id", 60], ["router_id", 19], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/social" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:05 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#social_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"social_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(*) AS count_all, "social_logs"."provider" AS social_logs_provider FROM "social_logs" INNER JOIN "social_accounts" ON "social_accounts"."id" = "social_logs"."social_account_id" WHERE "social_logs"."location_id" IN (60, 61) AND ("social_accounts"."created_at" BETWEEN $1 AND $2) GROUP BY "social_logs"."provider"[0m  [["created_at", "2017-06-29 00:00:00"], ["created_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 7ms [30m(Views: 1.3ms | ActiveRecord: 2.0ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "(881) 668-1487"], ["created_at", "2017-07-28 07:56:05.796696"], ["updated_at", "2017-07-28 07:56:05.796696"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "oren.roberts"], ["email", "freddie@mills.info"], ["password", "L2CkDr5w"], ["created_at", "2017-07-28 07:56:05.801688"], ["updated_at", "2017-07-28 07:56:05.801688"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "vk"], ["uid", "930550"], ["username", "ned.heidenreich"], ["image", "http://vk.com/img/ned.heidenreich.jpg"], ["profile", "https://vk.com/ned.heidenreich"], ["email", "lorenza@mertz.com"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 41], ["user_id", 100], ["created_at", "2017-07-28 07:56:05.805639"], ["updated_at", "2017-07-28 07:56:05.805639"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Toughjoyfax"], ["created_at", "2017-07-28 07:56:05.812949"], ["updated_at", "2017-07-28 07:56:05.812949"], ["local_path", "http://mullerbednar.com/wendell_greenholt"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "It"], ["title_ru", "Название62"], ["created_at", "2017-07-28 07:56:05.816864"], ["updated_at", "2017-07-28 07:56:05.816864"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 62[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_62[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 62) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>62, "title"=>"Toughjoyfax", "created_at"=>Fri, 28 Jul 2017 07:56:05 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:05 UTC +00:00, "local_path"=>"http://mullerbednar.com/wendell_greenholt"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "toughjoyfax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "toughjoyfax"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Toughjoyfax"], ["category_id", 62], ["slug", "toughjoyfax"], ["created_at", "2017-07-28 07:56:05.828297"], ["updated_at", "2017-07-28 07:56:05.828297"], ["layout_id", 62]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jerrold.barton"], ["email", "ezekiel_hilpert@kunzeleuschke.biz"], ["password", "BqLuIc49G14sWwN2"], ["created_at", "2017-07-28 07:56:05.833327"], ["updated_at", "2017-07-28 07:56:05.833327"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "harum.distinctio"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Biodex"], ["phone", "(419) 979-6382"], ["address", "10319 Botsford Plain"], ["url", "http://schulist.org/mireille.armstrong"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://damorestiedemann.name/laurel.breitenberg"], ["auth_expiration_time", 900], ["slug", "harum.distinctio"], ["brand_id", 62], ["user_id", 101], ["created_at", "2017-07-28 07:56:05.839168"], ["updated_at", "2017-07-28 07:56:05.839168"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Gembucket"], ["created_at", "2017-07-28 07:56:05.846759"], ["updated_at", "2017-07-28 07:56:05.846759"], ["local_path", "http://okeefe.co/juliana_yost"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Ventosanzap"], ["title_ru", "Название63"], ["created_at", "2017-07-28 07:56:05.850285"], ["updated_at", "2017-07-28 07:56:05.850285"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 63[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_63[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.6ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 63) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>63, "title"=>"Gembucket", "created_at"=>Fri, 28 Jul 2017 07:56:05 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:05 UTC +00:00, "local_path"=>"http://okeefe.co/juliana_yost"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "flexidy"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "flexidy"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Flexidy"], ["category_id", 63], ["slug", "flexidy"], ["created_at", "2017-07-28 07:56:05.861000"], ["updated_at", "2017-07-28 07:56:05.861000"], ["layout_id", 63]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "leila.heller"], ["email", "cyril_rice@ortiz.org"], ["password", "60KoMuLaHkS"], ["created_at", "2017-07-28 07:56:05.865807"], ["updated_at", "2017-07-28 07:56:05.865807"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "vitae.modi"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Lotlux"], ["phone", "1-939-392-0532"], ["address", "528 Romaguera Tunnel"], ["url", "http://nikolaus.io/reed"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://donnellywuckert.name/clare.toy"], ["auth_expiration_time", 900], ["slug", "vitae.modi"], ["brand_id", 63], ["user_id", 102], ["created_at", "2017-07-28 07:56:05.871305"], ["updated_at", "2017-07-28 07:56:05.871305"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "alanis"], ["email", "schuyler@dibbert.co"], ["password", "UfG107Yd"], ["created_at", "2017-07-28 07:56:05.876640"], ["updated_at", "2017-07-28 07:56:05.876640"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53320"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53320"], ["comment", "comment 120"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "250.75.227.15"], ["router_admin_ip", "53.212.174.190"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "839"], ["status", "t"], ["location_id", 63], ["user_id", 103], ["created_at", "2017-07-28 07:56:05.882136"], ["updated_at", "2017-07-28 07:56:05.882136"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53320"], ["id", 20], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 20], ["serial", "643705CA5E36/53320"], ["comment", "comment 120"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "250.75.227.15"], ["router_admin_ip", "53.212.174.190"], ["admin_password", "6d9fbc83824a141b"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "20"], ["status", "t"], ["location_id", 63], ["user_id", 103], ["created_at", "2017-07-28 07:56:05.882136"], ["updated_at", "2017-07-28 07:56:05.882136"], ["id", 20]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 2b01d439-036b-4047-a70e-75262afb5581) to Async(routers) with arguments: #<GlobalID:0x007fdba1f70e48 @uri=#<URI::GID gid://wifi-management/Router/20>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 582a124e-cb96-4220-b443-5aa5f09715fb) to Async(routers) with arguments: #<GlobalID:0x007fdba1f70e48 @uri=#<URI::GID gid://wifi-management/Router/20>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 20], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.7ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 20], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 20], ["provider", "instagram"], ["location_id", 62], ["router_id", 20], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/age" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:06 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#age_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"age_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.6ms)[0m  [1m[34m
    select
      sum (case when age <= 18 then 1 else 0 end) as age_interval_1,
      sum (case when age between 19 and 25 then 1 else 0 end) as age_interval_2,
      sum (case when age between 26 and 30 then 1 else 0 end) as age_interval_3,
      sum (case when age between 31 and 40 then 1 else 0 end) as age_interval_4,
      sum (case when age between 41 and 55 then 1 else 0 end) as age_interval_5,
      sum (case when age >= 56 then 1 else 0 end) as age_interval_6
    from (select
            distinct social_account_id,
            date_part('year',age(make_date(bdate_year, bdate_month, bdate_day))) as age
          from social_logs sl
          join social_accounts sa
            on sl.social_account_id = sa.id
          where location_id in(62, 63) and date_trunc('day', sa.updated_at) between '2017-06-29T00:00:00+00:00' and '2017-07-28T23:59:59+00:00'
          ) as chart[0m
[INFO ] Completed [32m200 OK[0m in 6ms [30m(Views: 1.3ms | ActiveRecord: 2.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "clients" ("phone_number", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["phone_number", "1-256-535-6508"], ["created_at", "2017-07-28 07:56:06.034543"], ["updated_at", "2017-07-28 07:56:06.034543"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "agnes"], ["email", "kurt.mills@brakus.co"], ["password", "Wv3l7fNq0"], ["created_at", "2017-07-28 07:56:06.039703"], ["updated_at", "2017-07-28 07:56:06.039703"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "social_accounts" ("provider", "uid", "username", "image", "profile", "email", "gender", "location", "bdate_day", "bdate_month", "bdate_year", "client_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["provider", "twitter"], ["uid", "293785"], ["username", "johanna"], ["image", "http://twitter.com/img/johanna.jpg"], ["profile", "https://twitter.com/johanna"], ["email", "kris@donnellymoen.name"], ["gender", "male"], ["location", "Москва, Россия"], ["bdate_day", 28], ["bdate_month", 7], ["bdate_year", 1997], ["client_id", 42], ["user_id", 104], ["created_at", "2017-07-28 07:56:06.043905"], ["updated_at", "2017-07-28 07:56:06.043905"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Konklux"], ["created_at", "2017-07-28 07:56:06.051506"], ["updated_at", "2017-07-28 07:56:06.051506"], ["local_path", "http://langosh.biz/oda_hane"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zontrax"], ["title_ru", "Название64"], ["created_at", "2017-07-28 07:56:06.055365"], ["updated_at", "2017-07-28 07:56:06.055365"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 64[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_64[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 64) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>64, "title"=>"Konklux", "created_at"=>Fri, 28 Jul 2017 07:56:06 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:06 UTC +00:00, "local_path"=>"http://langosh.biz/oda_hane"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voyatouch"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "voyatouch"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Voyatouch"], ["category_id", 64], ["slug", "voyatouch"], ["created_at", "2017-07-28 07:56:06.066726"], ["updated_at", "2017-07-28 07:56:06.066726"], ["layout_id", 64]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "nat.ruecker"], ["email", "beverly@schultzheel.io"], ["password", "7dFjHoM3G8BkC"], ["created_at", "2017-07-28 07:56:06.071525"], ["updated_at", "2017-07-28 07:56:06.071525"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "voluptas.adipisci"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Andalax"], ["phone", "279.655.2671"], ["address", "72134 Antonette Courts"], ["url", "http://kubsipes.org/johnny_bogan"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://kshlerinthompson.info/courtney"], ["auth_expiration_time", 900], ["slug", "voluptas.adipisci"], ["brand_id", 64], ["user_id", 105], ["created_at", "2017-07-28 07:56:06.077428"], ["updated_at", "2017-07-28 07:56:06.077428"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "layouts" ("title", "created_at", "updated_at", "local_path") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Pannier"], ["created_at", "2017-07-28 07:56:06.085517"], ["updated_at", "2017-07-28 07:56:06.085517"], ["local_path", "http://framipouros.org/theresa_runolfon"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "categories" ("title_en", "title_ru", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title_en", "Zamit"], ["title_ru", "Название65"], ["created_at", "2017-07-28 07:56:06.089524"], ["updated_at", "2017-07-28 07:56:06.089524"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m] [34mcache object layout, id, 65[0m
[[1m[30mDEBUG[0m[0m] [34mRedis key: cached_layout_65[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLayout Load (0.7ms)[0m  [1m[34mSELECT  "layouts".* FROM "layouts" WHERE (id = 65) LIMIT $1[0m  [["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m] [34mcached data: {"id"=>65, "title"=>"Pannier", "created_at"=>Fri, 28 Jul 2017 07:56:06 UTC +00:00, "updated_at"=>Fri, 28 Jul 2017 07:56:06 UTC +00:00, "local_path"=>"http://framipouros.org/theresa_runolfon"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE ("brands"."id" IS NOT NULL) AND "brands"."slug" = $1 LIMIT $2[0m  [["slug", "matsoft"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[36mBrand Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "brands" WHERE "brands"."slug" = $1 LIMIT $2[0m  [["slug", "matsoft"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "brands" ("title", "category_id", "slug", "created_at", "updated_at", "layout_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Matsoft"], ["category_id", 65], ["slug", "matsoft"], ["created_at", "2017-07-28 07:56:06.100602"], ["updated_at", "2017-07-28 07:56:06.100602"], ["layout_id", 65]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "josefa.ryan"], ["email", "vernie@boehm.org"], ["password", "L4Z3Bb8tM0"], ["created_at", "2017-07-28 07:56:06.105610"], ["updated_at", "2017-07-28 07:56:06.105610"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mLocation Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "locations" WHERE "locations"."slug" = $1 LIMIT $2[0m  [["slug", "molestiae-sed"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "locations" ("title", "phone", "address", "url", "ssid", "staff_ssid", "staff_ssid_pass", "redirect_url", "auth_expiration_time", "slug", "brand_id", "user_id", "created_at", "updated_at", "sms_auth", "sms_count") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16) RETURNING "id"[0m  [["title", "Fix San"], ["phone", "(663) 282-1348"], ["address", "62414 Carolina Village"], ["url", "http://reichelhamill.net/maida.weinat"], ["ssid", "WiFi"], ["staff_ssid", ""], ["staff_ssid_pass", ""], ["redirect_url", "http://watsica.co/theo_bayer"], ["auth_expiration_time", 900], ["slug", "molestiae-sed"], ["brand_id", 65], ["user_id", 106], ["created_at", "2017-07-28 07:56:06.111412"], ["updated_at", "2017-07-28 07:56:06.111412"], ["sms_auth", "f"], ["sms_count", 0]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("username", "email", "password", "created_at", "updated_at", "lang") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["username", "jamal"], ["email", "ernest@denesik.name"], ["password", "KxQqByHr3nA0"], ["created_at", "2017-07-28 07:56:06.116777"], ["updated_at", "2017-07-28 07:56:06.116777"], ["lang", "en"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 LIMIT $2[0m  [["serial", "643705CA5E36/53321"], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "routers" ("serial", "comment", "common_name", "ip_name", "router_local_ip", "router_admin_ip", "radius_secret", "ssl_certificate", "ssl_key", "radius_db_nas_id", "status", "location_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["serial", "643705CA5E36/53321"], ["comment", "comment 121"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "40.105.250.207"], ["router_admin_ip", "10.77.254.221"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "406"], ["status", "t"], ["location_id", 65], ["user_id", 107], ["created_at", "2017-07-28 07:56:06.122155"], ["updated_at", "2017-07-28 07:56:06.122155"]]
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "routers" WHERE "routers"."serial" = $1 AND ("routers"."id" != $2) LIMIT $3[0m  [["serial", "643705CA5E36/53321"], ["id", 21], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "routers" SET "id" = $1, "serial" = $2, "comment" = $3, "common_name" = $4, "ip_name" = $5, "router_local_ip" = $6, "router_admin_ip" = $7, "admin_password" = $8, "radius_secret" = $9, "ssl_certificate" = $10, "ssl_key" = $11, "radius_db_nas_id" = $12, "status" = $13, "location_id" = $14, "user_id" = $15, "created_at" = $16, "updated_at" = $17 WHERE "routers"."id" = $18[0m  [["id", 21], ["serial", "643705CA5E36/53321"], ["comment", "comment 121"], ["common_name", "client58"], ["ip_name", "ip_name"], ["router_local_ip", "40.105.250.207"], ["router_admin_ip", "10.77.254.221"], ["admin_password", "5b658347721ca222"], ["radius_secret", "secret"], ["ssl_certificate", "ssl_certificate"], ["ssl_key", "ssl_key"], ["radius_db_nas_id", "21"], ["status", "t"], ["location_id", 65], ["user_id", 107], ["created_at", "2017-07-28 07:56:06.122155"], ["updated_at", "2017-07-28 07:56:06.122155"], ["id", 21]]
[ActiveJob] [INFO ] Enqueued RouterUpdater (Job ID: 8dc4cc65-59e9-46af-b7e5-65d14fe852e2) to Async(routers) with arguments: #<GlobalID:0x007fdba40f8b10 @uri=#<URI::GID gid://wifi-management/Router/21>>
[ActiveJob] [INFO ] Enqueued RouterPackageBuilder (Job ID: 188c4d09-ca85-46ad-9d15-39cd02fdef57) to Async(routers) with arguments: #<GlobalID:0x007fdba40f8b10 @uri=#<URI::GID gid://wifi-management/Router/21>>
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (1.0ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 21], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
[[1m[30mDEBUG[0m[0m]   [1m[36mRouter Load (2.9ms)[0m  [1m[34mSELECT  "routers".* FROM "routers" WHERE "routers"."id" = $1 LIMIT $2[0m  [["id", 21], ["LIMIT", 1]]
[[1m[30mDEBUG[0m[0m]   [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "social_logs" ("social_account_id", "provider", "location_id", "router_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["social_account_id", 21], ["provider", "instagram"], ["location_id", 64], ["router_id", 21], ["created_at", "2017-07-28 00:00:01"], ["updated_at", "2017-07-28 00:00:01"]]
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[INFO ] [1m[32mGET    [0m[0m[1m[37m "/public_stats/visitors" [0m[0m for [33m127.0.0.1[0m[30m  at 2017-07-28 10:56:06 +0300[0m
[INFO ] [35m===[0m Processing by [35mDashboard::PublicStatsController#visitors_pie[0m as [33mJSON[0m
[INFO ] [36mnormalized params {:format=>"json", :controller=>"dashboard/public_stats", :action=>"visitors_pie"}[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[34mSELECT "locations"."id" FROM "locations"[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (1.6ms)[0m  [1m[34mSELECT SUM("client_visits"."visits") AS sum_visits, "client_visits"."client_id" AS client_visits_client_id FROM "client_visits" WHERE "client_visits"."location_id" IN (64, 65) AND ("client_visits"."updated_at" BETWEEN $1 AND $2) GROUP BY "client_visits"."client_id"[0m  [["updated_at", "2017-06-29 00:00:00"], ["updated_at", "2017-07-28 23:59:59"]]
[INFO ] Completed [32m200 OK[0m in 7ms [30m(Views: 1.2ms | ActiveRecord: 2.5ms)[0m
[[1m[30mDEBUG[0m[0m]   [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
